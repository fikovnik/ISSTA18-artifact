library(testthat)

.Random.seed <<- .ext.seed

test_that("psi.andrew", {
    scale <- 2.84282474738129
    resid <- structure(c(3.23463722703989, -1.91748529210868, 4.55553299739217, 5.69777417064346, -1.7116535805794, -3.00693970496796, 
        -2.38949071446463, -1.38949071446463, -3.14437890302683, 1.26719408487546, 2.63629675721332, 2.77946036245323, -1.42856087682724, 
        -0.0504992905806506, 2.36141836109558, 0.905050803649625, -1.51995058882006, -0.455092954779501, -0.598256560019419, 
        1.41214727536619, -7.23771285908991), names = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", 
        "14", "15", "16", "17", "18", "19", "20", "21"))
    expect_equal(HoRM:::psi.andrew(u = resid/scale), structure(c(TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, 
        TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE), names = c("1", "2", "3", "4", "5", "6", "7", "8", 
        "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21")))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("reg.manova", {
    X <- structure(list(` Response TOT` = structure(list(Df = c(1, 1, 1, 1, 1, 11), `Sum Sq` = c(288658.118627451, 5616925.75420556, 
        341134.029183148, 280973.318139919, 308240.704652254, 870008.310485777), `Mean Sq` = c(288658.118627451, 5616925.75420556, 
        341134.029183148, 280973.318139919, 308240.704652254, 79091.6645896161), `F value` = c(3.64966548782624, 71.0179231066911, 
        4.31314767432439, 3.5525022718615, 3.89725903799884, NA), `Pr(>F)` = c(0.0824833595449516, 3.96979851243653e-06, 
        0.0620388915901367, 0.0861346554496305, 0.0740056944674429, NA)), row.names = c("GEN        ", "AMT        ", "PR         ", 
        "DIAP       ", "QRS        ", "Residuals  "), class = c("anova", "data.frame")), ` Response AMI` = structure(list(Df = c(1, 
        1, 1, 1, 1, 11), `Sum Sq` = c(532382.165686274, 5457338.37268791, 227012.030997108, 320150.627001294, 132785.786599783, 
        940708.899380568), `Mean Sq` = c(532382.165686274, 5457338.37268791, 227012.030997108, 320150.627001294, 132785.786599783, 
        85518.9908527789), `F value` = c(6.22530926028782, 63.8143448404662, 2.65452186389698, 3.74362026269035, 1.55270525617374, 
        NA), `Pr(>F)` = c(0.0297667291863666, 6.62304242087045e-06, 0.131531141996905, 0.0791323702174058, 0.238621922272175, 
        NA)), row.names = c("GEN        ", "AMT        ", "PR         ", "DIAP       ", "QRS        ", "Residuals  "), class = c("anova", 
        "data.frame"))), class = c("summary.aov", "listof"))
    i <- 2L
    expect_equal(HoRM:::reg.manova(AOV.out = X[[i]]), structure(list(Df = c("5", "11", "16"), `Sum Sq` = c("6669668.98297237", 
        "940708.899380568", "7610377.88235294"), `Mean Sq` = c("1333933.79659447", "85518.9908527789", ""), `F value` = c("15.598100296703", 
        NA, ""), `Pr(>F)` = c("0.000113221705982611", NA, "")), row.names = c("Regression", "Residuals  ", "Total"), class = c("anova", 
        "data.frame")))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("max.col.value", {
    probs <- structure(c(-2302.35050755409, -2307.7486153754, -2216.18603223545, -1983.93272847168, -2440.39930145747, 1275.93529504891, 
        -2535.33659732725, -2280.03961004936, -2336.85299733931, -2392.16174256994, -2408.88985749074, -2616.93134239366, 
        1489.09684994433, -2030.75313645511, -2448.51013597319, -2272.05723318054, -2278.49835062189, -2595.32136980192, 
        1468.94096792525, -2321.68894539754, -604.995375180912, -267.20738317834, -502.9036468917, 6.38630491476255, -696.05321120083, 
        -823.573357318551, 70.5918810228791, -524.578516689068, 217.78035131209, 338.19145167733, 58.7724677799274, -595.20014445521, 
        -858.09383025285, -644.352952608961, -397.785486781526, -358.272219788332, -416.851211483778, -324.818649368619, 
        -1061.10050057679, 249.534177408024, 440.081768783365, -763.653080638564, 228.441491375442, -815.208963815222, -778.21839860069, 
        -1310.9580994636, -697.942947138821, -574.443654602238, -845.593995444933, -804.527002652777, -690.511616387548, 
        -685.532341398706, -1201.58629838611, -730.1057435523, 171.340639069527, -14.1909609449843, 195.272346058344, 89.3147881418807, 
        -1240.02933625966, -750.945268479447, -488.295263048382, -9.7388442188446, -500.324586832946, -458.291992385015, 
        550.850886256453, -1011.66699570765, -303.730357610067, 126.757479107727, -473.908878923644, -605.623458001196, -366.64819404885, 
        472.238504034772, -1169.95592750422, 230.139572230981, -446.606552375765, -458.163162154405, -537.52749353217, -387.460197901538, 
        -906.163919091244, -584.519895637937), .Dim = c(20L, 4L), .Dimnames = list(c("TEST-8", "TEST-10", "TEST-1", "TEST-2", 
        "TEST-4", "TEST-7", "TEST-12", "TEST-24", "TEST-6", "TEST-21", "TEST-20", "TEST-17", "TEST-18", "TEST-22", "TEST-16", 
        "TEST-23", "TEST-14", "TEST-25", "TEST-15", "TEST-19"), c("BL", "EWS", "NB", "RMS")))
    expect_equal(sda:::max.col.value(x = probs), c(440.081768783365, -9.7388442188446, 228.441491375442, 6.38630491476255, 
        550.850886256453, 1275.93529504891, 70.5918810228791, 126.757479107727, 217.78035131209, 338.19145167733, 58.7724677799274, 
        472.238504034772, 1489.09684994433, 230.139572230981, 171.340639069527, -14.1909609449843, 195.272346058344, 89.3147881418807, 
        1468.94096792525, 249.534177408024))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("missForest", {
    iris.mis <- structure(list(Sepal.Length = c(5.1, 4.9, 4.7, 4.6, 5, NA, 4.6, NA, 4.4, 4.9, 5.4, 4.8, 4.8, 4.3, 5.8, 5.7, 
        5.4, NA, 5.7, 5.1, 5.4, 5.1, 4.6, NA, 4.8, 5, NA, 5.2, 5.2, 4.7, 4.8, 5.4, 5.2, 5.5, 4.9, 5, 5.5, NA, 4.4, 5.1, NA, 
        NA, 4.4, 5, 5.1, NA, NA, 4.6, 5.3, 5, 7, 6.4, 6.9, 5.5, 6.5, 5.7, NA, 4.9, 6.6, 5.2, NA, NA, NA, 6.1, 5.6, 6.7, NA, 
        NA, 6.2, 5.6, 5.9, 6.1, NA, 6.1, 6.4, 6.6, 6.8, 6.7, 6, 5.7, 5.5, NA, 5.8, 6, 5.4, 6, 6.7, 6.3, 5.6, 5.5, 5.5, 6.1, 
        NA, 5, 5.6, 5.7, 5.7, 6.2, NA, 5.7, 6.3, 5.8, 7.1, 6.3, NA, 7.6, 4.9, 7.3, 6.7, 7.2, 6.5, 6.4, NA, 5.7, 5.8, 6.4, 
        NA, 7.7, 7.7, 6, 6.9, 5.6, 7.7, 6.3, 6.7, NA, NA, 6.1, NA, 7.2, 7.4, 7.9, 6.4, NA, 6.1, 7.7, 6.3, 6.4, 6, 6.9, 6.7, 
        6.9, 5.8, 6.8, 6.7, 6.7, NA, 6.5, 6.2, 5.9), Sepal.Width = c(3.5, NA, 3.2, NA, 3.6, 3.9, 3.4, 3.4, 2.9, 3.1, 3.7, 
        3.4, 3, 3, 4, 4.4, 3.9, 3.5, 3.8, 3.8, 3.4, NA, 3.6, 3.3, 3.4, 3, NA, 3.5, 3.4, 3.2, 3.1, 3.4, 4.1, 4.2, 3.1, NA, 
        3.5, 3.6, 3, 3.4, 3.5, 2.3, 3.2, 3.5, 3.8, 3, NA, 3.2, 3.7, 3.3, 3.2, 3.2, 3.1, NA, 2.8, 2.8, 3.3, NA, 2.9, 2.7, 
        2, 3, 2.2, 2.9, 2.9, 3.1, 3, NA, NA, 2.5, 3.2, 2.8, 2.5, NA, NA, 3, 2.8, 3, 2.9, NA, 2.4, 2.4, 2.7, 2.7, 3, NA, 3.1, 
        2.3, 3, 2.5, 2.6, 3, NA, 2.3, 2.7, 3, 2.9, 2.9, 2.5, 2.8, 3.3, 2.7, 3, NA, 3, NA, 2.5, 2.9, 2.5, NA, NA, 2.7, 3, 
        2.5, 2.8, 3.2, NA, NA, 2.6, 2.2, 3.2, 2.8, 2.8, NA, 3.3, 3.2, 2.8, 3, 2.8, 3, 2.8, 3.8, 2.8, 2.8, 2.6, 3, 3.4, NA, 
        3, 3.1, 3.1, NA, 2.7, NA, 3.3, NA, 2.5, NA, NA, NA), Petal.Length = c(1.4, 1.4, 1.3, NA, 1.4, 1.7, 1.4, 1.5, 1.4, 
        1.5, NA, NA, 1.4, 1.1, 1.2, NA, 1.3, 1.4, 1.7, NA, NA, 1.5, NA, NA, 1.9, 1.6, 1.6, 1.5, NA, 1.6, 1.6, 1.5, 1.5, 1.4, 
        NA, 1.2, 1.3, NA, 1.3, 1.5, 1.3, 1.3, NA, NA, NA, 1.4, 1.6, 1.4, 1.5, NA, 4.7, 4.5, 4.9, 4, 4.6, 4.5, 4.7, 3.3, NA, 
        3.9, 3.5, 4.2, 4, NA, NA, 4.4, 4.5, 4.1, 4.5, NA, 4.8, 4, NA, 4.7, NA, 4.4, NA, 5, 4.5, 3.5, 3.8, 3.7, 3.9, NA, 4.5, 
        4.5, 4.7, 4.4, 4.1, 4, 4.4, NA, 4, NA, 4.2, 4.2, 4.2, 4.3, 3, NA, 6, 5.1, NA, NA, 5.8, 6.6, 4.5, 6.3, 5.8, 6.1, 5.1, 
        NA, 5.5, 5, 5.1, 5.3, 5.5, 6.7, 6.9, 5, 5.7, 4.9, 6.7, NA, 5.7, 6, 4.8, 4.9, NA, 5.8, 6.1, 6.4, 5.6, 5.1, 5.6, 6.1, 
        5.6, 5.5, 4.8, 5.4, 5.6, 5.1, 5.1, 5.9, 5.7, 5.2, 5, NA, 5.4, 5.1), Petal.Width = c(0.2, NA, 0.2, 0.2, 0.2, NA, 0.3, 
        NA, NA, 0.1, 0.2, 0.2, 0.1, 0.1, 0.2, 0.4, 0.4, 0.3, 0.3, 0.3, 0.2, NA, 0.2, NA, 0.2, 0.2, 0.4, 0.2, 0.2, 0.2, 0.2, 
        NA, NA, 0.2, 0.2, 0.2, 0.2, 0.1, 0.2, NA, 0.3, NA, 0.2, NA, 0.4, 0.3, 0.2, NA, 0.2, 0.2, 1.4, NA, NA, 1.3, 1.5, 1.3, 
        1.6, NA, 1.3, 1.4, 1, NA, 1, 1.4, NA, 1.4, 1.5, 1, NA, 1.1, 1.8, 1.3, 1.5, 1.2, 1.3, 1.4, 1.4, 1.7, 1.5, NA, 1.1, 
        NA, NA, NA, NA, 1.6, NA, 1.3, 1.3, 1.3, 1.2, 1.4, 1.2, 1, 1.3, 1.2, 1.3, 1.3, NA, 1.3, 2.5, 1.9, 2.1, NA, 2.2, 2.1, 
        NA, 1.8, 1.8, NA, 2, 1.9, 2.1, 2, 2.4, 2.3, NA, 2.2, 2.3, 1.5, NA, 2, 2, 1.8, 2.1, 1.8, 1.8, 1.8, 2.1, 1.6, 1.9, 
        2, NA, 1.5, 1.4, 2.3, 2.4, NA, 1.8, 2.1, 2.4, 2.3, NA, 2.3, 2.5, 2.3, 1.9, 2, 2.3, 1.8), Species = structure(c(1L, 
        NA, 1L, NA, 1L, 1L, 1L, 1L, 1L, 1L, 1L, NA, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, NA, 1L, 1L, 1L, NA, 1L, 1L, 1L, 
        1L, 1L, 1L, 1L, NA, 1L, NA, NA, NA, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, NA, 1L, 1L, 2L, 2L, 2L, 2L, NA, 2L, 2L, 2L, 2L, 
        2L, 2L, 2L, 2L, 2L, 2L, NA, 2L, 2L, 2L, 2L, 2L, NA, 2L, 2L, NA, 2L, NA, 2L, NA, NA, 2L, NA, NA, 2L, NA, NA, NA, 2L, 
        2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, NA, 3L, 3L, 3L, 3L, 3L, 3L, NA, 3L, 3L, 3L, 
        3L, NA, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, NA, 3L, 3L, 3L, 3L, 3L, NA, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
        3L, NA, 3L, 3L), .Label = c("setosa", "versicolor", "virginica"), class = "factor")), row.names = c(NA, -150L), class = "data.frame")
    expect_equal(missForest:::missForest(xmis = iris.mis), structure(list(ximp = structure(list(Sepal.Length = c(5.1, 4.9, 
        4.7, 4.6, 5, 5.5068, 4.6, 5.22006666666666, 4.4, 4.9, 5.4, 4.8, 4.8, 4.3, 5.8, 5.7, 5.4, 4.91016666666667, 5.7, 5.1, 
        5.4, 5.1, 4.6, 4.83840555555556, 4.8, 5, 5.4578, 5.2, 5.2, 4.7, 4.8, 5.4, 5.2, 5.5, 4.9, 5, 5.5, 5.00745, 4.4, 5.1, 
        5.09348611111111, 4.539975, 4.4, 5, 5.1, 4.63089444444445, 4.7433600140056, 4.6, 5.3, 5, 7, 6.4, 6.9, 5.5, 6.5, 5.7, 
        6.52633333333333, 4.9, 6.6, 5.2, 5.11573333333333, 5.651, 5.15623333333333, 6.1, 5.6, 6.7, 6.12113333333333, 5.23723333333333, 
        6.2, 5.6, 5.9, 6.1, 6.02505, 6.1, 6.4, 6.6, 6.8, 6.7, 6, 5.7, 5.5, 5.48175, 5.8, 6, 5.4, 6, 6.7, 6.3, 5.6, 5.5, 5.5, 
        6.1, 5.7186, 5, 5.6, 5.7, 5.7, 6.2, 5.43773333333333, 5.7, 6.3, 5.8, 7.1, 6.3, 6.96683333333334, 7.6, 4.9, 7.3, 6.7, 
        7.2, 6.5, 6.4, 6.55873333333333, 5.7, 5.8, 6.4, 6.28809999999999, 7.7, 7.7, 6, 6.9, 5.6, 7.7, 6.3, 6.7, 6.80925, 
        6.07878333333333, 6.1, 6.39529999999999, 7.2, 7.4, 7.9, 6.4, 6.21916666666667, 6.1, 7.7, 6.3, 6.4, 6, 6.9, 6.7, 6.9, 
        5.8, 6.8, 6.7, 6.7, 5.8399, 6.5, 6.2, 5.9), Sepal.Width = c(3.5, 3.28632777777778, 3.2, 3.28794411027569, 3.6, 3.9, 
        3.4, 3.4, 2.9, 3.1, 3.7, 3.4, 3, 3, 4, 4.4, 3.9, 3.5, 3.8, 3.8, 3.4, 3.44383333333333, 3.6, 3.3, 3.4, 3, 4.03705, 
        3.5, 3.4, 3.2, 3.1, 3.4, 4.1, 4.2, 3.1, 3.38366077694236, 3.5, 3.6, 3, 3.4, 3.5, 2.3, 3.2, 3.5, 3.8, 3, 3.17796452874611, 
        3.2, 3.7, 3.3, 3.2, 3.2, 3.1, 2.61086666666667, 2.8, 2.8, 3.3, 2.16813333333333, 2.9, 2.7, 2, 3, 2.2, 2.9, 2.9, 3.1, 
        3, 2.4315, 2.99386666666667, 2.5, 3.2, 2.8, 2.5, 2.88986666666667, 2.82562857142857, 3, 2.8, 3, 2.9, 2.61416666666667, 
        2.4, 2.4, 2.7, 2.7, 3, 2.90615238095238, 3.1, 2.3, 3, 2.5, 2.6, 3, 2.73841666666667, 2.3, 2.7, 3, 2.9, 2.9, 2.5, 
        2.8, 3.3, 2.7, 3, 2.75658333333333, 3, 2.90136666666667, 2.5, 2.9, 2.5, 2.926, 2.9165, 2.7, 3, 2.5, 2.8, 3.2, 2.81391666666667, 
        2.83786666666667, 2.6, 2.2, 3.2, 2.8, 2.8, 2.77258333333333, 3.3, 3.2, 2.8, 3, 2.8, 3, 2.8, 3.8, 2.8, 2.8, 2.6, 3, 
        3.4, 2.86175, 3, 3.1, 3.1, 3.08443333333333, 2.7, 3.11553571428571, 3.3, 3.10543333333333, 2.5, 2.9335, 3.01333333333333, 
        2.73298333333333), Petal.Length = c(1.4, 1.4, 1.3, 1.42030833333333, 1.4, 1.7, 1.4, 1.5, 1.4, 1.5, 1.45493095238095, 
        1.6929380952381, 1.4, 1.1, 1.2, 1.6015, 1.3, 1.4, 1.7, 1.4394, 1.49892380952381, 1.5, 1.46202857142857, 1.46835, 
        1.9, 1.6, 1.6, 1.5, 1.51625714285714, 1.6, 1.6, 1.5, 1.5, 1.4, 1.54310833333333, 1.2, 1.3, 1.40407857142857, 1.3, 
        1.5, 1.3, 1.3, 1.36993333333333, 1.41966666666667, 1.43506666666667, 1.4, 1.6, 1.4, 1.5, 1.34987738095238, 4.7, 4.5, 
        4.9, 4, 4.6, 4.5, 4.7, 3.3, 4.36715873015873, 3.9, 3.5, 4.2, 4, 4.45525, 4.17940873015873, 4.4, 4.5, 4.1, 4.5, 3.69718333333333, 
        4.8, 4, 4.40536666666667, 4.7, 4.33193253968254, 4.4, 4.51848809523809, 5, 4.5, 3.5, 3.8, 3.7, 3.9, 4.31641666666667, 
        4.5, 4.5, 4.7, 4.4, 4.1, 4, 4.4, 4.4715, 4, 3.82765, 4.2, 4.2, 4.2, 4.3, 3, 4.36219444444444, 6, 5.1, 5.86179761904762, 
        5.45870000000001, 5.8, 6.6, 4.5, 6.3, 5.8, 6.1, 5.1, 5.50490000000001, 5.5, 5, 5.1, 5.3, 5.5, 6.7, 6.9, 5, 5.7, 4.9, 
        6.7, 5.37870000000001, 5.7, 6, 4.8, 4.9, 5.50198095238096, 5.8, 6.1, 6.4, 5.6, 5.1, 5.6, 6.1, 5.6, 5.5, 4.8, 5.4, 
        5.6, 5.1, 5.1, 5.9, 5.7, 5.2, 5, 5.23900000000001, 5.4, 5.1), Petal.Width = c(0.2, 0.201219047619048, 0.2, 0.2, 0.2, 
        0.3236, 0.3, 0.1995, 0.242419047619048, 0.1, 0.2, 0.2, 0.1, 0.1, 0.2, 0.4, 0.4, 0.3, 0.3, 0.3, 0.2, 0.2005, 0.2, 
        0.174666666666666, 0.2, 0.2, 0.4, 0.2, 0.2, 0.2, 0.2, 0.202, 0.309016666666666, 0.2, 0.2, 0.2, 0.2, 0.1, 0.2, 0.2005, 
        0.3, 0.301633333333333, 0.2, 0.206380952380952, 0.4, 0.3, 0.2, 0.245452380952381, 0.2, 0.2, 1.4, 1.49041190476191, 
        1.814, 1.3, 1.5, 1.3, 1.6, 1.011, 1.3, 1.4, 1, 1.24416666666667, 1, 1.4, 1.28510714285714, 1.4, 1.5, 1, 1.48316190476191, 
        1.1, 1.8, 1.3, 1.5, 1.2, 1.3, 1.4, 1.4, 1.7, 1.5, 1.1435, 1.1, 1.093, 1.28666666666667, 1.338, 1.32068571428571, 
        1.6, 1.50816666666667, 1.3, 1.3, 1.3, 1.2, 1.4, 1.2, 1, 1.3, 1.2, 1.3, 1.3, 1.13283333333333, 1.3, 2.5, 1.9, 2.1, 
        1.896, 2.2, 2.1, 1.21783333333333, 1.8, 1.8, 1.87966666666667, 2, 1.9, 2.1, 2, 2.4, 2.3, 1.91433333333333, 2.2, 2.3, 
        1.5, 2.13233333333333, 2, 2, 1.8, 2.1, 1.8, 1.8, 1.8, 2.1, 1.6, 1.9, 2, 1.911, 1.5, 1.4, 2.3, 2.4, 2.00633333333333, 
        1.8, 2.1, 2.4, 2.3, 2.01391666666667, 2.3, 2.5, 2.3, 1.9, 2, 2.3, 1.8), Species = structure(c(1L, 1L, 1L, 1L, 1L, 
        1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
        1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 
        2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 
        2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
        3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L), 
        .Label = c("setosa", "versicolor", "virginica"), class = "factor")), row.names = c(NA, -150L), class = "data.frame"), 
        OOBerror = structure(c(0.13538492029537, 0.0245901639344262), names = c("NRMSE", "PFC"))), class = "missForest"))
})

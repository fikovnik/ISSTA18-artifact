library(testthat)

.Random.seed <<- .ext.seed

test_that("log_mean_exp", {
    logx <- c(1.37095844714667, -0.564698171396089, 0.363128411337339, 0.63286260496104, 0.404268323140999, -0.106124516091484, 
        1.51152199743894, -0.0946590384130976, 2.01842371387704, -0.062714099052421, 1.30486965422349, 2.28664539270111, 
        -1.38886070111234, -0.278788766817371, -0.133321336393658, 0.635950398070074, -0.284252921416072, -2.65645542090478, 
        -2.44046692857552, 1.32011334573019, -0.306638594078475, -1.78130843398, -0.171917355759621, 1.2146746991726, 1.89519346126497, 
        -0.4304691316062, -0.25726938276893, -1.76316308519478, 0.460097354831271, -0.639994875960119, 0.455450123241219, 
        0.704837337228819, 1.03510352196992, -0.608926375407211, 0.50495512329797, -1.71700867907334, -0.784459008379496, 
        -0.850907594176518, -2.41420764994663, 0.0361226068922556, 0.205998600200254, -0.361057298548666, 0.758163235699517, 
        -0.726704827076575, -1.36828104441929, 0.432818025888717, -0.811393176186672, 1.44410126172125, -0.431446202613345, 
        0.655647883402207, 0.321925265203947, -0.783838940880375, 1.57572751979198, 0.642899305717316, 0.0897606465996057, 
        0.276550747291463, 0.679288816055271, 0.0898328865790817, -2.99309008315293, 0.284882953530659, -0.367234642740975, 
        0.185230564865609, 0.581823727365507, 1.39973682729268, -0.727292059474465, 1.30254263204414, 0.335848119752074, 
        1.03850609869762, 0.920728568290646, 0.720878162866862, -1.04311893856785, -0.0901863866107067, 0.623518161999544, 
        -0.953523357772344, -0.542828814573857, 0.580996497681682, 0.768178737834591, 0.463767588540167, -0.885776297409679, 
        -1.09978089864786, 1.51270700980493, 0.257921437532031, 0.0884402291595864, -0.120896537539089, -1.19432889516053, 
        0.611996898040387, -0.217139845746521, -0.182756706331922, 0.93334632857116, 0.821773110508249, 1.39211637593427, 
        -0.476173923054674, 0.650348560726305, 1.39111045639, -1.1107888794479, -0.860792586877842, -1.13173868085377, -1.4592139995024, 
        0.0799825532411612, 0.65320433964919, 1.20096537559849, 1.04475108716773, -1.00320864683985, 1.84848190167275, -0.666773408757817, 
        0.105513812456069, -0.422255881868856, -0.122350171954971, 0.188193034501498, 0.119160957997006, -0.0250925508674029, 
        0.108072727942033, -0.485435235846668, -0.504217130687904, -1.66109907991481, -0.382333726873818, -0.5126502578778, 
        2.7018910003448, -1.36211623118972, 0.137256218558607, -1.49362506731629, -1.4704357414368, 0.124702386197007, -0.996639134884037, 
        -0.0018226143047082, -0.428258881425815, -0.613671606449495, -2.02467784541911, -1.22474795035999, 0.179516441117938, 
        0.567620594423535, -0.492877353553475, 6.28840653511241e-05, 1.12288964337997, 1.43985574297619, -1.09711376840582, 
        -0.117319560250177, 1.2014984009197, -0.469729580566301, -0.0524694849389963, -0.0861072982370896, -0.887679017906432, 
        -0.444684004884738, -0.0294448790882381, -0.413868849057924, 1.1133860233682, -0.480992841653982, -0.433169032600729, 
        0.696862576552103, -1.05636841317091, -0.0406984751512149, -1.55154482234759, 1.16716954923568, -0.273645701374081, 
        -0.467845324672254, -1.23825232798621, -0.00776203377732663, -0.80028217795166, -0.533492329950436, 1.28767524558459, 
        -0.175525870242127, -1.07178238415068, 0.163206882467382, -0.36273841562795, 0.590013547987339, 1.43242192773099, 
        -0.992692511109493, 0.454650297580283, 0.0848980586784873, 0.895565582264545, -0.229778138946266, 0.836619068460613, 
        -1.74505586133669, 1.68945892131337, 0.864777978518578, -0.150775988885748, -1.44900713013917, 0.643008700041982, 
        0.483193863814768, -0.00635562642138871, 0.151455892862424, -0.584108970349804, 0.368806732630242, 0.294654339719516, 
        -0.279259373342575, -1.33623665489315, 0.700748818440034, 0.554196622274033, -0.836306592801415, -1.59458816200624, 
        0.204958580587634, -0.34508797797289, 0.252611703364455, -1.29400246548455, -0.959170444380363, 1.0857748536799, 
        0.403774904715714, 0.586487536719298, 1.81522844615395, 0.128821428602383, -2.00092923773151, 0.33377719743357, 1.17132512735879, 
        2.0595392422993, -1.37686159824052, -1.15085556562711, -0.705821394760121, -1.05405578207719, -0.645743723142491, 
        -0.185377967676503, -1.20122205073999, 2.03697216698315, 0.107774744885547, -0.0841081005055806, 0.495619641604594, 
        0.0374151861179653, -0.13208803695591, 1.4767874235521, -0.217030210092104, -1.28360220409223, 0.385667890443402, 
        -0.351512873529092, -0.521796093356269, -1.06813120068717, 0.428365903266692, -0.174018234426995, 0.515667728648029, 
        -0.234365277305921, -0.658503425821771, 1.25023660407872, -0.271763715111397, 0.947951995875196, -1.20158243010894, 
        -0.466116096375502, -0.26935139515318, -0.390965408130861, 1.34870701199171, -0.0227647012984126, 0.24422585110345, 
        -0.942371707863923, -0.729217276509574, 0.998068908554848, 1.25848166459556, 1.2488636888101, -1.38063704952533, 
        2.04996069363639, 1.01687282979954, -0.0267174641382579, 0.703607778798261, -0.971385229151864, -1.09615624155886, 
        0.0490504509375971, -1.19849585655778, 0.190018998559748, 1.29770589960467, -1.03387372296475, -0.738440754213064, 
        0.0465639394508634, -1.01759611982611, -0.383283959886278, 0.872755411671398, 0.969545013970117, 0.383846665027094, 
        -1.85155566306746, -0.0539967368261657, 1.06477321433828, 0.813195037411605, -0.190816474104282, -2.6999298085637, 
        0.0609666388011166, 0.573751697483578, 0.0458035797250989, 0.157412540175875, 0.431565372868771, -0.396549736050212, 
        1.30997822575155, 0.470393399873943, -1.2426702705746, 1.38157545638553, 1.20445893700982, 0.824073963681881, -1.66262940218559, 
        -0.569306343605481, 0.635513817289526, 0.0437220075778579, 0.348012303661307, 2.45959354887041, -0.818380324399669, 
        -2.11320011492914, 0.273695272430415, -0.687596841243412, 0.446041052961866, -0.812384723790597, 2.21205548033514, 
        -0.12370597157743, -0.477335506030052, -0.166261491486608, 0.862563383626431, 0.0973404852028189, -1.62561673921129, 
        -0.0046207678264578, 0.760242167662055, 0.0389909128725626, 0.735072141614441, -0.14647262699887, -0.0578873353812826, 
        0.482369466104533, 0.992943636775734, -1.24639549803204, -0.0334875248456097, -0.0709621812499963, -0.75892065373095, 
        -1.03435936093915, -0.630731953970819, 0.586807720012995, -0.416322656183652, -0.784887809505321, 0.163416319486097, 
        -1.23671423510935, 1.04587377623667, -0.484595416218709, 0.189128811680665, 0.0510063315749732, -0.000240668886441977, 
        1.80938204244287, -0.825327957109945, 1.14547045222799, 0.0315731875532431, -0.83520580530672, -0.0687636490165125, 
        0.746771687012467, -0.425518734394604, -0.772082235193457, 0.152764106747895, 0.988596845178799, -0.073458334672174, 
        -1.38702655355974, -1.30667590437536, -0.768395325077939, -0.527108125374458, -0.0214270650416246, 0.670498070996282, 
        -0.434617038572407, -1.11387978331285, 0.6071059948785, 0.275456968739591, 1.15734706941474, -1.68248085947826, 0.0873190888948744, 
        1.35336189394267, 0.724173800683369, -0.832552825764212, 0.732528486768414, -0.871926869997213, -0.453397511229793, 
        1.18753427862908, -0.290145311790079, 0.828546144965436, -0.291227708779169, -1.57636240474791, -0.848815696948922, 
        -1.0885198619572, -0.484290571117173, -0.336311209009573, -0.153357890661644, -0.243247228574846, 1.89220204160011, 
        -1.38599833728542, -0.41482430070778, 0.349081528106831, 1.62844226581541, 0.0885218957136163, 1.23915070840056, 
        -1.64455553575371, 1.44635652537848, -0.690560171665183, -0.276431085453852, -1.10941875989944, 0.133869316429452, 
        1.78533905173155, 2.42216335525159, -1.07682890211841, 0.485941110403099, 1.38852173874429, -0.195656817284544, -0.218174797706211, 
        -0.304777954546445, 0.597832724111443, 1.39742941081576, 0.687619761239963, 0.320188014296969, -0.301869925777261, 
        0.498348685557949, -0.549536917916756, -0.279256503637243, 1.09651344311173, 0.442013088178811, 0.241016294026112, 
        -0.255607655355518, 0.931032901484882, 1.33491258537547, -0.869271763875442, 0.0554869546651026, 0.0490669131919192, 
        -0.578355728360897, -0.998738655996004, -0.00243278000660164, 0.655511882812969, 1.47684227897655, -1.90915278827921, 
        -0.702439473312409, -0.311430218011919, -1.66315703066738, -0.75053344179229, -0.777351759181508, -0.722569699859602, 
        -2.18883459914707, 0.213418550286554, -0.631922936254832, 1.52049119383216, 0.795955949415082, -1.4535295651328, 
        0.0983954210058388, -0.593770984233154, 0.888281168634515, 0.0530704154986665, -0.557023625844656, 0.43839703617272, 
        0.152608158642419, -0.164617581749564, 2.01989062147597, -0.529385886317261, -0.470786972984042, -1.54593692401752, 
        -0.0405267232951771, 0.890356305470676, -2.07138785092921, -0.250065120073019, -1.18165042665332, 1.44193726501691, 
        1.35789553887886, 0.33450284734065, 1.42933808040023, -0.867317850878684, 0.950651724971886, -0.585011508633235, 
        0.320957522525629, -0.299396016664908, -0.278543083293069, 0.546115158329532, -1.30382115364487, -0.25091446504246, 
        0.17100737371791, -0.403467478747509, 0.104659440835727, -0.318880786734009, 1.61834393588343, 0.714188601488617, 
        2.96586536983324, -0.795077604559211, 0.814365914679913, 2.09803081013037, 0.30098005515257, -1.08307514183923, -1.00632250180328, 
        -0.035414564917612, 1.30912436085341, 0.750400486646719, -2.13836832761242, -0.700354108866634, -0.00905647529298544, 
        -1.45813348724477, 0.694529646494869, -2.46133547518649, 0.143289764040456, -0.391222119127056, -0.491164085614075, 
        -0.283647452452051, 0.314794804707843, 0.396326577938989, -0.22560371103596, -1.92495043034056, -1.43922929832198, 
        -1.4696577739724, 0.761863446891932, -0.24361498187128, 0.269676607418008, -1.55892752095582, -0.535588006696314, 
        0.562451973173495, -0.178326123419918, -0.115135986202651, -0.0720614721063666, 1.2109098069263, -0.614896900799703, 
        0.676126458314701, 0.898599605537552, -1.18931790352102, 0.121258849819009, -0.0112216861304115, 1.02914071931376, 
        0.914774867719613, -0.00245626667956324, 0.136009552413727, -0.720153544943125, -0.198124330051216, -1.02920880604827, 
        -0.966955895852616, -1.22081308891909, 0.836207703944837, 1.1149717984954, -0.412944852927091, -1.12897739800683, 
        -0.0879313317770513, 2.24190369331262, 2.04131317075049, -1.71980033672145, -0.356906656122387, 1.53328049216229, 
        -0.0382440966102368, 1.59741324232643, -0.333585393309883, 0.604985923915378, 0.224241239250251, 3.22906949548006, 
        0.92045256677252, -1.20653906921592, -0.603881169163268, 0.370235284622062, -1.90100064667961, -1.80440994496324, 
        -1.12182260635522, -0.34792960655914, 1.23890214863198, -0.274197564852279, 0.162380715558193, -0.0646069097530627, 
        -0.705237097025142, 1.36219726875099, -1.09651318808332, -0.228433518546891, -0.347828080610269, 0.532128619506733, 
        1.60723456226119, 0.513814526116594, 1.38237316057303, 0.763097048549903, -0.624584544634111, 0.0815438004289869, 
        1.37607911136477, -1.56126578615704, 0.324770660594699, -0.156790316952238, 0.877783860734352, 0.750166575180638, 
        0.30105340384283, 1.49281111722931, -1.5254938001697, 0.910717558486022, -1.57953202785754, 0.587716257118581, 0.0896422960007244, 
        0.96726165694984, 0.0788123529148234, -1.56869983648609, -2.00782318401609, 0.540973524238763, -0.0733765981084255, 
        -0.571018393558081, -0.311068459853641, -0.671415067101365, -0.157340452080979, -0.931305070999869, -1.98300947947013, 
        -0.219599804249378, 1.04527586946239, 1.87732956629967, 0.00260619595716637, -0.0806699347091655, 0.96298228123987, 
        0.0535710165465174, -0.434898408910037, -1.73729725534231, -1.26369559978243, 0.406308512069273, -1.45965396777976, 
        1.0484573701547, -1.3464305394502, -0.193570558113494, -0.00233595711367605, -0.0128297338671881, 0.151947321984398, 
        0.598511131401079, -0.126212437298279, -0.248535565846776, 0.160327394904622, -0.433641941597269, 1.53741241910027, 
        -2.17024657661608, 1.02700461929143, -0.248482933189933, 0.422320385832393, 0.987653293639674, 0.835568172035023, 
        -0.660521859045705, 1.56406949329184, -1.62297593529155, 0.863896373478988, -0.5116027734362, -1.9173650254454, -1.86581384861995, 
        0.245179063439689, 2.22353430190807, 0.273376064144465, 1.13078479452828, 0.838669374060099, -0.654615277878206, 
        0.953960978479396, 0.352951465489323, 0.206599292649613, 1.00111323431025, 0.747451991640276, -0.626574836723139, 
        0.395223685936714, -0.892167954045577, 0.630818410091773, -0.432705183284567, 0.452138644218517, 0.367999045196345, 
        -0.270387489661909, 0.465512617712979, 0.574356225626969, -0.230699990157411, 1.17224250830245, 1.39270270673312, 
        -0.661991255709585, -0.777369206725014, 0.51353857890878, -0.913312238041272, -0.449423805250301, 0.802932699103618, 
        -0.573476850981104, -1.92812516784833, 0.664390833822148, -1.60254022379425, -1.35460025745385, -3.0179326794179, 
        0.831237822230063, 0.251097088847344, 0.462293465941329, 0.844792223223237, -0.0419715243215621, -1.10557590570003, 
        0.563775652330874, 1.30336475581967, -1.50022093779466, -0.606989235119036, -0.292245065656577, -1.2896833433236, 
        0.694105848774699, -0.599181902897119, 1.25690664397164, 0.053508013627363, 0.728092517671852, 1.56109806821061, 
        0.26562475359719, 1.07672625920727, 0.210697931679245, -1.51167352582237, 0.022402259913625, 0.718136206042103, 0.48945701784227, 
        -0.17388834587827, -1.2176994886684, 0.646398368709462, -0.91645602834789, -1.25182344242557, 0.594927718405501, 
        -1.23281066518983, 0.244364414906138, 0.00277218534359506, -1.32820968602556, 1.17969641183277, -0.592804999148929, 
        1.19997831633667, -0.475033679612135, -0.575057096150816, -0.031226024608499, -0.358056995978456, -0.356601077647731, 
        -0.877664383433726, -1.21289712517796, 0.613286618687034, -0.806203341462477, -1.3764569299089, -0.507847899163547, 
        -0.800935486737338, -2.19278568567007, -0.290937149267675, 0.167174121160518, 0.294692356485688, 0.392741265420726, 
        -1.00084371300082, -0.325727119823434, -1.00834880542884, -0.635431482033766, -1.20984068798734, -1.11646380065269, 
        0.629881162575935, -0.272521570178626, -0.258841168378671, 1.72955817989149, -0.0583921654073717, -0.537063784608919, 
        0.74728669616574, -0.487257835389733, 1.3729077814795, -0.377672360646221, -0.616152614118394, -1.16812505107469, 
        0.328640358591086, 1.46651062744016, -0.356009545088913, 0.261467641877431, 0.333328855175731, 1.42219324030954, 
        0.663876600666173, -1.07365515569531, -0.69690177466674, -0.746130456934561, 0.141572872132219, -0.00394722073065307, 
        0.367937501091765, -0.657342914697247, -0.376346670161052, 0.741360060425085, -0.0996067564484702, -0.654289878607095, 
        0.971164374061271, 0.0134963115683865, -0.916534667021545, 1.70968856126164, -1.16810098994666, -1.78103626015252, 
        -2.25313244856822, 0.6511259695467, -0.532832625602767, -0.275559356972283, 0.289626972629046, -0.466484061790764, 
        -1.60806017494469, -1.94978379604199, -0.340699918230981, 0.17472552733132, -2.27777756077723, 0.290524480947084, 
        0.422306357473614, 1.29473736320671, 0.164714018573954, 0.204953840800235, 0.604603626725806, -0.0191407691689314, 
        -0.0797143473788086, 0.115984464402805, 0.744173364048388, -0.431290603527693, -0.499528951911234, -0.865162076755711, 
        -0.957757283271874, 0.326799971338638, 1.54737222568518, -0.968859568864431, -0.188440426259463, -1.03000116145592, 
        0.908086441860496, -0.317381864708129, 0.179003966540422, 0.348028187729177, -1.05427902127444, -0.104744288110701, 
        -0.228342617094529, 0.675355562427539, -1.23324469350631, -1.19996154442278, 0.765866576616108, -0.588097861282977, 
        -0.660295829975576, 0.113013522197344, -0.320398799686039, 1.86638149693879, 0.259531455767799, 0.16156007091807, 
        0.931074909335354, -0.0599467492596211, 0.0487397000774502, -1.07287540073396, -2.29297143048067, -1.20720685006434, 
        0.114109429797191, -1.03329707910538, 0.688807752342063, 0.725083017674864, 0.217380210939088, -0.201656731618378, 
        -1.36568986058868, -0.30893760867716, -0.452902886537227, 0.663229144519792, 1.3086295367487, 0.501040309894498, 
        -1.12828853519737, 1.67099730539817, 1.01035303245212, 0.223521215874458, -2.20648459320962, -0.954585618553158, 
        -0.0685730672102366, 0.76130590156527, -1.17990419995829, 3.21119895676729, -2.55382485095083, -0.235933949334065, 
        -0.259562643261435, -0.663366916619193, -0.318990710826149, 0.742395157572315, -0.874292675785773, -2.08281376630328, 
        0.0937679028102175, -0.00181981200279561, -0.013100652371574, 0.667968074558104, -0.0131677029521626, 0.776047030476303, 
        -2.01073533263526, -1.1281804949718, 0.34879957158572, -0.352898482096924, 0.944774597917623, -1.00471985252646, 
        0.723902732496846, -0.668832740990364, -1.1130401937158, -0.342805189366945, 0.0497793231687396, -1.22768196152554, 
        -0.764005910827448, -1.24618206161788, 1.01677397775977, 0.723612624058863, -1.03252713710511, 0.557346004122758, 
        -0.255581423099522, -1.11339175714667, 0.421197439614804, -0.322950311846374, 0.880179901191522, -0.194863606775901, 
        1.18805498210378, -0.509764511767954, 0.219548010873294, 0.370294421364558, 0.279108393730607, 0.201942437313324, 
        -0.0129965424313442, -0.0908650060774901, 1.36503136531884, 0.908130568883166, -0.609888171401906, 1.39643722121945, 
        0.144798373308446, -0.640606771595302, 0.169802259558534, -0.157187487420844, 0.100939594546104, -0.97339415414828, 
        -0.819825275253199, 1.36291896902543, 0.961370930531278, -0.883724474401114, -0.900092115436322, 1.72333313279683, 
        1.90904216212893, -0.777141195855263, -1.30230526261311, 2.62349516681868, 0.229628914346807, 0.186749892141885, 
        0.0761366349502805, 1.40486018632133, -0.191722235336317, 1.45939216415609, -0.220655451134541, 0.50514588627314, 
        -1.03349700607288, 0.17047347145922, 1.20066816089193, -0.163405914765736, 1.28247586312264, 2.72719638791127, 0.941924217330924, 
        -0.248614037279559, 0.0964788597064851, -0.433930941301739, 2.17866786745157, -2.95877961913012, 0.0808882391991137, 
        0.110137804617221, 0.213448326312653, -1.55781961263232, 0.216211546257758, 0.18766381702644, 1.2586221252136, 0.523517780908964, 
        1.11545427747996, -0.95750224217047, -0.124405579855432, 0.191737829049968, 0.272217250603347, -0.693814463673255, 
        1.47917192085213, -0.611767021642771, -1.61430997435935, 0.402490110590671, 0.664555447289484, 0.944127070994937, 
        -0.946260797708288, -0.248288449238896, -1.32843646853908, 0.844763742098917, 0.347696732438648, 0.913762586431107, 
        0.608274553380681, -0.607547987804487, 0.179658070871844, -1.90840941941738, 0.502946257689095, 0.968899153478499, 
        -0.875737125773327, -2.13602453869801, -1.52282758158501, -1.11311820788607, 1.2409838955359, 0.00348193506299025, 
        -1.23779458599307, 0.555699118898025, -2.1831493493599, -0.247024457097248, 1.11285692758645, -0.341673237009086, 
        1.30543834214107, 1.79532387144079, -1.16783522747345, -1.15228762498202, -0.914455469345649, 0.528728032533629, 
        0.835078927048582, 1.20913697409153, 1.29947254536082, 1.07573230420989, 0.939801023514297, 0.163374693406766, -0.888138558640392, 
        -0.726160982756351, 0.407597005613739, 1.68353633925179, 1.70597982356461, -1.92616670082608, -0.833998015228465, 
        1.41913251633319, -1.06410971501924, -1.61357747248045, 0.599811088697427, 1.73296470538705, 1.93450456245773, 0.532820575670794, 
        0.719665756019785, 0.560093385755184, -0.018086931659967, -3.37173908255051, 0.760703244759755, -0.39122685224321, 
        1.00990122381185, -0.626973147073749, -1.63457736950186, 1.24524265203048, 0.181377446555404, 3.4953042639856, 0.915591913326913, 
        1.04850651742624, 0.763824936934856, -0.603387376859399, -0.370429662702776, 1.05982593833365, 1.05511052983939, 
        0.582972161120319, -0.986567435539539, 1.68462181174398, -1.36684104568263, -0.433214348611114)
    expect_equal(statnet.common:::log_mean_exp(logx = logx), 0.483592427155891)
})

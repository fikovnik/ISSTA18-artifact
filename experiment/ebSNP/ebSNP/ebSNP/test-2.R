library(testthat)

.Random.seed <<- .ext.seed

test_that("ebSNP", {
    dat <- structure(c(37, 3, 25, 15, 39, 1, 37, 3, 38, 2, 38, 2, 38, 2, 34, 6, 33, 7, 37, 3, 38, 2, 39, 1, 38, 2, 40, 0, 
        40, 0, 39, 1, 22, 18, 29, 11, 35, 5, 36, 4, 34, 6, 40, 0, 15, 25, 38, 2, 38, 2, 28, 12, 40, 0, 39, 1, 37, 3, 34, 
        6, 40, 0, 31, 9, 37, 3, 40, 0, 38, 2, 33, 7, 38, 2, 26, 14, 36, 4, 39, 1, 38, 2, 38, 2, 40, 0, 15, 25, 36, 4, 20, 
        20, 36, 4, 34, 6, 24, 16, 38, 2, 34, 6, 38, 2, 39, 1, 38, 2, 36, 4, 32, 8, 35, 5, 31, 9, 39, 1, 39, 1, 28, 12, 22, 
        18, 37, 3, 37, 3, 35, 5, 37, 3, 36, 4, 35, 5, 40, 0, 38, 2, 40, 0, 34, 6, 35, 5, 36, 4, 33, 7, 36, 4, 34, 6, 40, 
        0, 29, 11, 38, 2, 39, 1, 28, 12, 38, 2, 35, 5, 32, 8, 34, 6, 33, 7, 33, 7, 38, 2, 34, 6, 40, 0, 39, 1, 38, 2, 39, 
        1, 39, 1, 36, 4, 39, 1, 40, 0, 36, 4, 39, 1), .Dim = c(2L, 100L), .Dimnames = list(c("nc", ""), NULL))
    expect_equal(ebSNP:::ebSNP(dat = dat), list(pi0.hat = 0.945634064956469, alpha.hat = 1.43606347234927, beta.hat = 13.3460118376804, 
        delta = c(0.999999991506942, 0.497091228442436, 0.999999999972499, 0.999999991506942, 0.999999999420357, 0.999999999420357, 
            0.999999999420357, 0.999993819054122, 0.999961477880427, 0.999999991506942, 0.999999999420357, 0.999999999972499, 
            0.999999999420357, 0.999999999999246, 0.999999999999246, 0.999999999972499, 0.0981630303471566, 0.985253590301642, 
            0.999999159777753, 0.999999905524681, 0.999993819054122, 0.999999999999246, 0.497091228442436, 0.999999999420357, 
            0.999999999420357, 0.9525977958307, 0.999999999999246, 0.999999999972499, 0.999999991506942, 0.999993819054122, 
            0.999999999999246, 0.999027773530855, 0.999999991506942, 0.999999999999246, 0.999999999420357, 0.999961477880427, 
            0.999999999420357, 0.710601827399307, 0.999999905524681, 0.999999999972499, 0.999999999420357, 0.999999999420357, 
            0.999999999999246, 0.497091228442436, 0.999999905524681, 0.0363758325412852, 0.999999905524681, 0.999993819054122, 
            0.303141341898415, 0.999999999420357, 0.999993819054122, 0.999999999420357, 0.999999999972499, 0.999999999420357, 
            0.999999905524681, 0.999792968589152, 0.999999159777753, 0.999027773530855, 0.999999999972499, 0.999999999972499, 
            0.9525977958307, 0.0981630303471566, 0.999999991506942, 0.999999991506942, 0.999999159777753, 0.999999991506942, 
            0.999999905524681, 0.999999159777753, 0.999999999999246, 0.999999999420357, 0.999999999999246, 0.999993819054122, 
            0.999999159777753, 0.999999905524681, 0.999961477880427, 0.999999905524681, 0.999993819054122, 0.999999999999246, 
            0.985253590301642, 0.999999999420357, 0.999999999972499, 0.9525977958307, 0.999999999420357, 0.999999159777753, 
            0.999792968589152, 0.999993819054122, 0.999961477880427, 0.999961477880427, 0.999999999420357, 0.999993819054122, 
            0.999999999999246, 0.999999999972499, 0.999999999420357, 0.999999999972499, 0.999999999972499, 0.999999905524681, 
            0.999999999972499, 0.999999999999246, 0.999999905524681, 0.999999999972499), G = c(0, 1, 0, 0, 0, 0, 0, 0, 0, 
            0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 
            0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)))
})

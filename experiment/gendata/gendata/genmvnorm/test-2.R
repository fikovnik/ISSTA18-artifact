library(testthat)

.Random.seed <<- .ext.seed

test_that("genmvnorm", {
    dat <- structure(c(1, -0.117569784133002, 0.871753775886583, -0.117569784133002, 1, -0.42844010433054, 0.871753775886583, 
        -0.42844010433054, 1), .Dim = c(3L, 3L), .Dimnames = list(c("Sepal.Length", "Sepal.Width", "Petal.Length"), c("Sepal.Length", 
        "Sepal.Width", "Petal.Length")))
    expect_equal(gendata:::genmvnorm(cor = dat, k = 3, n = 100, seed = 123), structure(list(X1 = c(-1.17302527016734, -0.325699589783522, 
        1.3378774317005, -0.173914238186368, -0.205930448122039, 1.59731237799443, 0.223918750716713, -1.71772609614948, 
        -1.0554371131549, -0.00988528371906742, 0.836745980808782, 0.530870190878234, -0.521630471576503, 0.164877001519291, 
        -0.111872724629861, 1.43411098203446, 0.564831018607928, -1.89898389696061, 0.489263273104151, -0.624553222613088, 
        -0.807687622207314, -0.692486401561363, -1.3111956744784, -0.879426542371063, 0.264806994879495, -1.78800046286835, 
        0.967758275862991, 0.292805810314667, -1.56730261005589, 1.26675602074043, 0.64127408215385, -0.0619582122358275, 
        0.780686804785532, 0.738074871594654, -0.0140152788953615, 1.30966579692933, -0.076127674743476, 0.178002741001056, 
        0.458711287933735, -0.801888833563714, -0.195869560818589, -0.207771252713963, -2.03831387601345, 1.5103003744929, 
        0.450005335623085, -1.55110663322626, -0.946445343531873, 0.100687386998793, 1.67904363940356, -0.68947335565473, 
        0.616432051226515, 0.388676928048202, 0.158001430995397, 0.79217397329806, -0.526371450468128, 1.25579382062215, 
        -1.33877595078055, 0.260546255166621, 0.533678865178477, 0.302325204543801, 0.86385188517769, -0.798112853060116, 
        -0.826390860086952, 0.203286054142567, -1.525372177209, 0.128233306695239, 0.686600004865806, 0.150002113976179, 
        1.10516739817106, 1.97054405705281, -0.673532492068807, -2.20400145770281, 0.767674815450919, 0.484585128239656, 
        -1.06764567639945, 0.541632799411055, -0.26918265482786, -0.976443280175985, 0.268681196557513, -0.31770695216837, 
        -0.146842935426444, 0.739336723734588, -0.542308969183523, 0.264715907187372, -0.315083567294118, 0.192266907519378, 
        1.40119160840198, 0.141789561497281, 0.057505917682501, 0.792418465904765, 0.776014539436323, 0.174990894509498, 
        0.0554500095674932, -0.831853107687095, 0.331124084237124, 0.276209761944038, 1.883012974373, 1.08666865494637, -0.466740473052109, 
        -1.62257636986169), X2 = c(-0.172709300992443, 0.425842926243242, -1.02914108568125, -0.297146203820917, -0.90823678460985, 
        -0.951039763269021, -0.960957744032667, -0.817171885636012, 0.137954629374183, 1.01140901643414, -1.11274199979113, 
        0.351677955578259, -1.50733107135553, -0.138925448407676, 0.663285667168779, -0.547659248487697, -0.194767882917995, 
        0.413243604836302, -1.16983139646122, -0.719412031269939, 0.610496010551881, -0.657249607592203, 0.181474536941573, 
        0.202561650971638, 1.87399343359729, 0.312319032319349, -0.275988912683955, -0.0600888668182813, -0.17922448781015, 
        -0.772807172536439, 1.14777661651704, 0.531718797608499, -0.40997274659962, -0.861792873876523, -2.21685953087309, 
        0.526058874317253, -1.54623585184384, 0.692869254996662, 1.81204573652133, -1.09222299846682, 0.904265038366239, 
        -0.151182604578452, -0.595032190199889, -2.48563539755762, -2.00234050362951, 0.249890490174714, -1.05041810716048, 
        0.73705042061372, 1.35162608489258, -1.02572808778726, 0.518681435943526, 0.63493954581379, 0.283177442278595, -1.55932753868716, 
        0.120786895418411, -1.02446102668006, 1.34924452945275, -0.576555481546072, 0.764589389532551, -0.533988668291638, 
        0.670757414902321, -0.672445987500389, -0.903806899834387, 3.38276593939494, 0.34727543847335, 0.202922638037375, 
        0.305524536861788, -0.558722143033276, -0.057415767861981, -0.731024003179899, 0.12446098049352, 1.30599404510763, 
        -0.499726663115438, 2.09158456171128, -0.224039782766593, -1.49411814896688, 0.190255060316575, 0.897401874037514, 
        0.309024688338111, -0.319160434821934, -1.0242997640584, 0.932142621683537, -0.0829507633808653, -1.08909586025534, 
        -0.0810115670115427, -0.330064295428323, 0.401144016832474, -0.0410700090926902, 0.797772619091537, -1.00575737845003, 
        -0.248425073428107, -0.488750191347929, 0.0350339766037857, -0.482243626545667, -1.68592201914948, 2.02128229247516, 
        -0.484190995419083, -1.94786576222072, -0.400419636202856, -0.403433303625681), X3 = c(-0.176257261854502, 0.0456411935299592, 
        1.45684103350245, 0.148667024603743, -0.0212724472244338, 1.58367336184958, 0.243202257367, -1.47185760466804, -0.381751330539386, 
        -0.380821997867962, 1.1797958014716, 0.442534389368633, 0.513650917262127, 0.00504769031144629, -0.69782593667922, 
        2.09284090668009, 0.4099165581839, -2.10970017250356, 0.387742865515276, -0.78319577780884, -1.14710960474296, -0.162198661292692, 
        -0.825684712287597, -0.595530526435965, -0.549794716621596, -1.68591076211304, 0.70120140904561, 0.0176741121576343, 
        -1.01247840973711, 1.02658473280778, 0.896966788910215, -0.273866202012664, 0.920292322015651, 0.687095064770804, 
        0.546669204458167, 0.5014828180403, 0.402427941120024, 0.0729640168740355, -0.100466955452255, -0.626047770301805, 
        -0.781454723380886, -0.318880921336669, -1.06303703201855, 1.79555762671253, 1.03320757342353, -0.771108997221087, 
        -0.518306116242488, -0.669168295603705, 0.785674948047097, -0.080252331502837, 0.232002287805123, -0.0810404089970749, 
        -0.0843696457389695, 1.28472774869281, 0.0780826572923837, 1.44706994680087, -1.26751899797487, 0.666889951492122, 
        0.169240926590375, -0.110421070957709, 0.346588212904991, -0.6609439395278, -0.407186916463589, -0.514831473429772, 
        -0.637542606336114, 0.616189388997555, 0.458581470988298, -0.32073077807491, 0.864789423294094, 2.04998058819462, 
        -0.333380487053422, -2.07010176724207, 1.11355717454601, -0.810311610495648, -0.562897869136729, 0.839393159843081, 
        -0.242368129598932, -1.15816065830438, 0.291059592083107, -0.163976025989412, -0.391288975769489, 0.609160228267341, 
        -0.313498389428767, 0.517616450004975, -0.209959819343762, 0.336401715731214, 1.19540914573087, 0.747711665923721, 
        -0.307195735749032, 1.12095992264186, 1.21250865120096, 0.71633796438648, 0.460788746256675, -0.789703913844099, 
        1.62322287254918, -0.431761260010149, 2.54294472669114, 1.15050751833056, -0.270364579551774, -0.848854268312943)), 
        row.names = c(NA, -100L), class = "data.frame"))
})

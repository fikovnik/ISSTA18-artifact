library(testthat)

.Random.seed <<- .ext.seed

test_that("dtrans", {
    sdata <- structure(list(X1 = c(0.575660452140903, 0.222748744604014, -0.37982286066378, 0.415489527539401, -1.76148651259282, 
        0.935191086186228, -0.646823442005136, -0.427600734319356, 1.20026639696381, 0.743101793929119, 0.654688169767554, 
        -1.41277920545637, -0.790404295969033, -0.943715607739834, 0.892455920281999, -0.795301508509825, 0.587249836601643, 
        0.231774300804097, -0.563938136281401, 0.380564741609499, -0.823198649576934, -2.09114774183971, -0.0265477921156863, 
        1.31706617558916, 1.58196546447963, -1.5670123367261, 0.308116298182128, -0.419363301258446, -0.107540857440761, 
        0.10318565291922, -0.986007127631786, -2.42699251301702, -0.979187034080412, -1.73066922569929, -1.23965495203504, 
        -0.556394776371245, 0.907983643769611, 1.24053709238411, -1.61422069820281, -0.270348379109228, -1.34989097159793, 
        1.60374086554541, 1.03184792292033, -1.8518837035932, -1.30355195859725, -2.46915570128353, 1.55752157866891, 0.459297043051158, 
        -0.161948617197249, 0.270640895662472, 0.333473121857645, -2.086073066446, 0.000322887702328467, -0.679963640117907, 
        0.387061636487342, -0.800308958251778, -0.476523422375156, -1.24310055840004, -2.17400028557553, 1.39405880958384, 
        -0.477118775800583, 0.952370901916365, 0.0815394094540103, -1.12239849287162, 0.787974452135926, 1.42693946728409, 
        -0.835028597819541, -1.38737850553684, -0.666557625215671, 0.228216756816572, 0.583201943565587, 0.266862636077244, 
        0.305397252497926, -1.40424523442341, -1.24060854252569, -1.0213723116758, -0.73111584455792, 0.149867244065682, 
        0.302615631606457, -1.00808751298203, -1.08896919035194, -0.28290861944443, -0.157309442307615, -1.46256198556934, 
        -1.40214558835184, -1.82454270204051, -0.0691943604047631, -0.617281362004755, -0.169422453057209, -0.106231124041297, 
        0.832939872706223, 0.833555109267676, -2.00940872141634, 0.691658127914292, 0.756691655863535, -0.70563553881446, 
        0.504393446824143, -2.14477118186018, 0.0140309933686389, 0.795212794781559, 0.766059516493515, 1.10367498499816, 
        0.530553772937781, 1.11338958833549, 0.512133512095527, 1.39853562059621, 0.407769943507083, -0.6475289842994, -0.563328534329127, 
        -0.833319463193295, 1.01571141294335, 0.575530557379577, -0.668529037869931, -1.58290968357352, -0.426636211079601, 
        0.531750547841319, -0.0897228631248118, -0.289404700272408, -1.81486395198146, 0.20571184326346, -2.39353580305592, 
        -1.4187974637638, -0.181642598810796, -0.784576304284381, 0.702591911938064, 1.4963017274272, 1.84152015969553, -0.774899450483199, 
        1.99519311071259, 1.31156098909398, -0.931996081032253, -0.687930125714969, -1.91252763901476, 0.751513165374948, 
        -2.22186974895378, 1.24868007080837, 0.185505094785394, -0.312891933603007, -0.668283118583735, 0.254173839072801, 
        -0.355962770660292, 0.84228233511555, -0.465860212979033, 2.03779598301927, 0.559874223398392, -0.343400689013631, 
        1.39404887765902, -1.01953534467544, -0.546056031162639, 0.235643496818107, 1.6315050591961, -0.292558457721263, 
        -1.33505193827874, 0.569956921919838, 0.0634663414645598, 1.00889737266185, -0.767533810804121, -0.10414476802532, 
        0.455777265183439, -0.239614317356704, 1.27566167011977, -0.510686369897225, 0.443394426080273, 0.0355995191339092, 
        1.2371741822637, 0.586646090332225, 0.147786104046634, 1.14787834716259, -1.04305368702322, 0.56374911003337, 0.205909045491716, 
        -0.901351353633212, -0.0924963947794125, -1.72733297755971, 1.25014327865134, 0.123730823296037, -2.46972311368095, 
        -0.474862795967355, 0.441995038168309, 2.02374552751175, 0.449823326207287, -0.304592625185246, -0.129905789935174, 
        -0.707797192305539, -0.21746037865513, -0.449351618170314, -1.01619821547086, -0.0683664906093573, 0.664038129960984, 
        -0.0235226607799245, -1.43460348171707, 1.12571324798445, -0.421823920414896, 0.1774904776938, -1.5563919399124, 
        0.0472495197235437, -0.984064617946191, 0.652447117038503, 0.182726529619477, -0.381349613276988, 0.393401623136948, 
        0.228764640022964, -0.180218939038512, -0.975994868077168, 0.126713263847033, 0.225018809311368, 1.33928209024255, 
        -0.583078283677254, 0.26378705682764, -0.193530374095542, -0.717506317477723, 1.07413392703186, 0.675831154886099, 
        -2.2537198035797, -0.177831291136015, -0.840394109883064, -0.549078068452288, 0.560075347744013, 1.40780899232119, 
        0.00018474976123433, -1.2522001142787, 2.03055377560999, 0.595925635636046, 0.487270544218213, -1.01473205917578, 
        0.709431699620079, 1.17436246104893, -0.773390239218934, -1.61042690318303, 0.366615021397107, -0.444591670206937, 
        1.42570583450558, -0.152898404578161, -1.11342204978239, -0.92558378759555, 0.621755500703957, -0.123061943533575, 
        0.251298941516797, -0.489822078049106, -0.949719842257807, 1.02862273382162, 0.699230923182867, 0.338258528420227, 
        1.20500574674433, 0.13303248551952, -0.693415360903715, -3.71747231832517, -0.636629920923933, -0.911130977047469, 
        -0.508368816690561, 0.880124990018075, -0.641340255152114, -0.115425258959016, 1.54739698531057, -0.093524647213768, 
        0.16862444592402, 0.646028413763478, 0.127451125724349, -0.082659880671862, 1.72554420168121, -0.20244156129373, 
        -0.453735880442054, -0.100707296082288, -0.181725031041239, -1.65522986314296, -0.311108178703731, -0.0350502102289718, 
        -0.361228436775292, 0.28713329829635, 0.31445361929, -0.914884590561804, 0.406863900365751, -0.44769556714762, 2.50490075155924, 
        -0.625364986662806, -1.9315348422282, -0.714984094223165, 0.224567460968889, 0.34735772979972, -0.251305810939444, 
        1.31898838299871, 0.291014497304029, 1.01512428600252, -0.694383485780844, -0.605366500293815, -0.489251303996676, 
        -0.4377034003753, 0.122513760707359, -0.80968581400519, -1.68078399589976, -0.191601164173681, 0.888461734014628, 
        0.124992095305956, -0.00852889064679807, 0.527434138415242, 0.288003935101122, 1.94935163539417, -0.303336871803563, 
        0.839566773786497, -1.78070969320358, -0.797389645626032, -0.0284826810116343, -0.074331807396702, -1.51518567504008, 
        -0.158319757126699, 0.0715395851886208, -1.479992194557, -0.70473350363547, 0.520827128009425, -1.28939908975636, 
        1.04914350828289, -0.983756710922436, -0.625477356976069, -2.11845482149906, -1.03549328841903, 0.363392056024195, 
        0.674613261562232, 1.06843402985326, -1.6760228607052, 0.094636994252719, -0.875368217582923, -0.276235798678083, 
        -0.437943218420416, -1.03597125392982, 2.13578948025302, -0.921930405175108, -0.617538500554118, -0.672666581803876, 
        0.751260479597793, -0.455851245777088, -1.51122180120569, -0.10815336638044, -0.587022355753576, -0.785927196496735, 
        -0.887207281720401, -0.415046918269646, 1.60857232093717, -0.745774561356898, -1.07822504025252, -0.804523329982133, 
        -2.14813908925329, 0.609933629909412, -0.966396972224681, -0.729724766247346, 0.774982691688604, -0.135078072304224, 
        0.955047071402865, -0.446948358713453, 2.29397278834247, -0.60834975254939, -0.384040080666241, -0.695537005802832, 
        0.9164042418725, 1.08030331858852, -1.94625467134798, -0.507795223864746, -0.141379484239472, -0.554543443012845, 
        -0.666040294580425, 0.609375783833052, 0.567874252895709, 1.02362346921801, 0.525340681828613, 0.812153575445818, 
        0.820584877941462, -1.82733631640762, -0.301073914357978, -0.969205853120351, -0.371260941680739, 0.793261705722635, 
        -0.441203066701969, -1.53839714284899, -0.593841293297889, 0.177102279050039, -0.437889991519181, 1.20381082220283, 
        -1.31960033108896, 1.20942739789953, -0.656711158654077, -1.75450971803445, -0.134061137371752, -0.0789639830824592, 
        -0.684352418899605, 0.453663973927046, -0.806333182055196, 0.0830749688460413, -1.11740689111534, -1.67648595311761, 
        0.807117299321819, 0.371824106871597, -1.01038189312639, -0.512861363067426, 0.114743608880613, 1.2698287030141, 
        -0.483036379026225, -0.0387418855429127, -0.45969178987817, -0.520715148279785, -0.353078853639099, 1.01447504340534, 
        -0.570034866435276, 1.2000378087146, 0.161401842045831, 1.1313425146801, 1.02215590100164, -0.550013774585168, 0.037346890797564, 
        0.952900740347418, 1.10657252182224, 0.57581032697797, 1.25697072695946, -0.418197440392551, -1.20532489014252, -0.366195664617403, 
        0.642353927295584, -0.449863694303822, 0.355049024737182, 1.77875356606965, 1.51964024970337, 0.162695894190305, 
        0.156893191830849, 0.280132117418478, 0.296554690715463, -0.201770806190645, -0.608722274114188, -0.197685325155881, 
        -0.816986295412721, 0.680443886846995, -1.72669933709107, -0.107896158625081, 1.62457268567034, 0.205750005041416, 
        0.148297804139305, 0.648266995822809, -0.822743569278535, -1.35703861844402, -1.41083708827535, -0.759164130384785, 
        -0.588710667454296, -1.4302549861545, 0.178942794356936, -0.535395958848189, 0.0532773578028437, -0.251471183700075, 
        -0.888577263745523, -0.280117556415689, 0.705844337901978, 2.36924785453123, 0.612995764237982, 0.471407299740827, 
        0.52430467644056, -0.538867347085107, 0.343877131519175, 0.271455563414284, -1.33077145908007, -0.732963260462471, 
        -1.71652463193871, 0.631551023386302, 0.718762894141255, -0.480384533863376, 1.21441072444354, 0.310621477352947, 
        -0.200406668189294, 0.788911325002635, -0.351034225385825, 1.40114875898087, 1.4964126872782, 1.53879567990404, 2.46299908037621, 
        0.509972263998197, -1.86754017111059, -0.239024042864213, 0.656624166484587, -0.367311699265921, -1.09120183863682, 
        0.2296181976243, 0.219642671768218, 0.793540668793063, -0.54922976085054, -0.650939248027172, 0.872246347850508, 
        -0.0445672585757001, -0.35759425253082, -0.703469131831116, 1.03545352348883, -0.029336607733483, -0.733750542917823, 
        0.395639258733604, -0.188725561383005, 0.206708367570815, 0.743641433749556, -0.85213954358933, 0.125643649074146, 
        1.95941474821911, 1.72066613378923, -0.536299859734724, 0.594723278700015, 1.32800451779362, 0.0709521604461743, 
        0.295442164036798), X2 = c(-0.932493025216761, -0.235569690977718, 0.347270022973686, 0.879662480116966, -0.988049307380747, 
        2.41195242377776, -0.580300970194848, 0.496868965374672, 0.375177232492901, 1.01300035714806, 0.567636813828009, 
        -1.17142142776791, -0.283311797579903, 0.0746999231958801, 0.212348479771846, -1.05095812942477, 0.540142845677007, 
        1.01794984049797, -1.36467495020824, -0.679163919376596, -0.767381960784198, -0.737606691702969, 0.822615845240744, 
        1.65671898367548, 1.21780214847987, -1.75157128734968, 0.13971738475856, -0.465557808133431, -0.81002475908108, 1.11425129946656, 
        -0.340709614685395, -1.87599543835193, -2.3935393852478, -0.957156580550536, -0.26065024260967, -0.645659828626532, 
        -0.20637557123999, 1.09644988032994, -1.80634367503719, 0.267445578493059, -1.74594008723835, 2.74302603043678, 0.789845891929644, 
        -0.751228933296067, -1.0294279975001, -1.14867983023436, 1.29202089687991, -0.321224697924823, -0.0235890244011232, 
        1.79871598280296, 0.88008092778138, -1.32688650780886, -0.296171990988574, -0.529111656142658, 0.0802140475243526, 
        -0.771435561849174, -0.185639771632842, -0.82473590068919, -1.96673261558034, 3.18683553572415, 0.173130911687391, 
        1.4066089345641, -0.764869097698658, -1.98451872153632, 0.65767612031299, 2.18970772458763, -0.716569763932814, -1.28724394334355, 
        0.301407781592539, 1.38833357978688, -1.15639832693, 1.32210453559739, 1.31041774361718, -2.13123066538028, -1.57536833538235, 
        -0.940485850547402, -1.3820336327056, 1.07234745239709, -0.377388299948052, -0.824784615934895, -0.381159068055303, 
        -0.894954900047506, 0.593273205779336, -2.80924034157987, -0.670906043911449, -1.57993562505739, -0.325992352020077, 
        1.20322135035338, -1.22018407075927, -0.0511756694086799, 1.15305391076465, 1.36635737295136, -1.7349967450204, -0.391879889458226, 
        0.446202797093927, -1.38940817152612, 0.50605066916931, -1.56146374732728, 0.531689167866362, 0.656872987069523, 
        -0.360867748500261, 0.829648219272499, -1.08860775131353, 1.58550760930168, -0.729992129530788, 0.1905939309525, 
        0.0964279571633407, -1.95128503349642, 0.916831177864453, 0.285244742164652, 1.40928717443434, 1.68610253501487, 
        -0.860237844332472, -1.21566767725223, 0.564402068260222, -0.0629979581461805, 0.221938354580333, -0.887739586341869, 
        -2.26600222491386, 0.37441366544885, -1.04432432068034, -1.01627538708154, -0.365941111812998, -1.62648974678363, 
        -0.352238588504193, 0.563471499330766, 1.34711235616308, -1.30909724113269, 1.61358794114543, 0.310685824643338, 
        -1.46188036363914, -0.771557054610679, 0.134668959910337, 0.59876108635842, -2.30108218957108, 0.911318107980391, 
        1.38805040769346, -1.01799351067684, 0.539179446962925, 1.15808090536559, 1.59960239147668, 0.9564151195155, 1.00941534632697, 
        0.768739983355617, -0.0888718020256387, -1.32278683094866, 1.42831134949895, -0.956774639911472, -1.52317782428256, 
        -0.578755451674707, 1.65627711097055, -0.0415858451466023, -0.158589820021299, 0.841217782274206, -0.0216705026007381, 
        0.340023309718325, -1.68657262639833, 0.066212409870966, 0.107166810182284, 0.451412863479394, 0.257013632723498, 
        -0.297740771461542, 0.621670993628807, -0.143971728788737, 1.25813381730785, -0.0287440534579807, -0.815108323408689, 
        0.882427500325342, -2.25851944820532, -0.388268716139725, -0.381085716038075, -0.753415202652285, -0.473494494599764, 
        0.00273026497143669, 1.97598543140294, -0.0601191266989038, -2.62706334812002, -0.463297854534463, -0.947163312785017, 
        1.15379372883942, 1.54192385217405, -0.18418483101488, -0.261345406518136, -0.74122725831931, -0.678754423177976, 
        -0.347214721530907, -0.117988520069364, -0.789307491509361, -0.274098372618063, 1.0455120207744, -0.329572516882585, 
        0.710781593961818, -0.857515285273242, -0.0176219341329146, -1.5038873669984, -0.384716710610016, -0.207258567925777, 
        -0.0057764189246961, 0.0443763174462296, 0.0850051086037135, 0.994573714169546, -0.154832916312799, -0.22306715235879, 
        -1.12938118720819, -0.966940442059981, -0.411773972681273, 1.27430318768754, -0.370368716969348, -0.701712177613498, 
        0.450570043690709, -1.04712907076992, 0.709886266665573, 0.0685194280728596, -1.3385096718338, 1.07530326625428, 
        -0.209588625115815, -0.0127205583520353, 1.66679890120181, 1.76488740278125, -0.111584827186951, -0.104194036076936, 
        1.51725772051463, -0.231277336459569, 0.44760651155636, -1.86235917292093, -1.1244820382835, 0.266311807198993, -0.311964497490979, 
        -1.23470100693808, -0.25663675963538, 0.33598622487424, -0.00873493813184645, -0.188268045006139, 0.286272396556001, 
        -0.847956681000546, 0.0125778481526466, -0.256352733002121, 0.934977252857109, -0.379082251680465, 0.219578962802179, 
        0.692165350558946, 0.717107685871893, 0.378972873307219, 0.884533224399562, 0.396941204132309, -1.40491772029039, 
        -2.69935403354403, -0.170272277751476, 0.180663211618391, -0.527281917291254, 0.300981813739792, -1.1983456033215, 
        -1.0646229653955, 1.37100510191815, 0.0448433211856927, -0.983877211111398, 0.74332047671871, 0.752020362574936, 
        0.563816765450016, 0.77423269625085, -0.541614303891307, -1.13966940384476, 0.412022808119464, 0.72594240932234, 
        -0.868624040269676, 0.173019445049219, -0.547738410468146, -0.82106244966869, 0.538567597377116, 0.271338959534337, 
        1.14279959474329, 0.97451648692141, -0.340695485378963, 1.57868824460537, -0.0703544808882587, -0.485177526122325, 
        0.244272727665058, -0.164062063979685, 1.6706474117804, -0.958523399967406, 1.24979741738342, -0.0803370231416068, 
        0.318014105414482, -2.41798075718719, -0.572522298969857, -0.661245223129838, 0.472925753447949, 0.610963943245694, 
        -1.35954989626719, -0.172535425735216, 0.654061346677105, -0.182742115336628, -0.241948567861736, -0.391227952890364, 
        0.9968061347093, -0.765878918590854, 2.51803726110063, 1.34049714681448, 0.242577247937483, -0.0723823872826354, 
        0.320613962531055, 0.14311899748043, 0.639453965465945, -0.934056185397316, 0.125775892163396, -0.710454227558446, 
        -1.21573598254428, 0.970135745448224, -0.542296908475189, -1.99281518298229, 0.952591209483053, 1.06953457726136, 
        -1.56958485482124, -1.4118452723936, -2.5024245007566, -0.167285583337057, 0.293674082646858, 1.15443806521973, -2.8222499292748, 
        1.23349074260415, -0.260281457172389, -0.463198180310659, -0.954454733400267, -1.01030062522492, 1.74360246348568, 
        -1.06760884463193, 0.153103401593833, 0.229928226305231, 0.908792113237545, -1.1728696420158, -1.46833718170527, 
        -0.434084679819422, 0.0244554660984819, -1.18237742834959, -0.122480604918242, 0.813507280067169, 0.736741426749539, 
        -1.01743500426121, -0.0206942726986967, -0.922379836247661, -1.9799733373845, 0.494344119047302, -0.555307281146957, 
        -0.636867339581336, 0.618201323224114, 0.267123857782803, 2.28784021804996, -0.535325653399497, 2.58236044937258, 
        -0.922246024013995, -0.266207934621873, 0.427973047231239, 1.98389764454965, 0.983780443950756, -1.08852208324741, 
        0.772640678920342, -0.0570736054592376, 0.213469971172604, -0.160956691211976, 0.765824361038039, 0.628161107374007, 
        3.30364189060592, -0.461649526879845, -0.240234140470006, -0.2949129938202, -0.147498126746273, -0.0365153967032404, 
        -1.97650737518252, -0.47226330161131, 0.0354088306790371, 0.625727434930388, -1.69554572859458, -0.789363223582421, 
        -0.866945447638844, -1.20995660763366, 0.874915042621366, -0.887684377713292, 2.20370878727719, -0.621890771093398, 
        -2.53433302942105, 0.540347508501318, 0.207869100968808, -0.442076386008467, 0.225897183345023, 0.220803420690878, 
        -0.218660755736059, -0.856674081460923, -2.00563546367957, 0.997014509068165, 1.35459687392676, -0.459766596414314, 
        -0.49189065031346, -0.402623278345155, 0.380984244036479, 0.229041842593457, 0.0850799003603614, -0.0885468733665329, 
        -0.0168091994039161, 0.222486475003783, 1.71789456808488, -0.130104331499306, 0.0688174930576427, -0.727980057568174, 
        0.235847885258362, 0.110925845722995, -0.672494857340248, -0.361765220862336, 0.756226382031979, 1.18908335948961, 
        1.41715198891152, 0.428459803439942, 0.115346117405775, -0.631308183805711, -0.0473127064414969, 0.572359442716387, 
        0.506485004516069, -0.865928163949342, -0.573612695438681, 0.468401022516566, -1.21112220636548, -0.151483852000549, 
        -0.696275173591449, 0.744365204781604, -0.684817113490067, -1.08767838339154, 0.794089604671618, -1.67688746462069, 
        1.18026306977088, -1.20427891957163, -0.820491504761053, 0.672787399482737, 0.639327012915808, -0.354903539223827, 
        0.944089287258219, -0.167844390261004, 0.68747241083653, -1.67615640873862, -0.289275324248537, -0.671749268871682, 
        -1.74672952356965, -0.519660318652907, -0.687380900426976, 0.368876113365697, -0.723340417782752, -0.762418899330031, 
        -0.255764034740161, 0.697769372852785, 2.0882155872252, -0.62901652705433, 1.2557560084507, -0.815105709227937, -1.81868686618587, 
        0.848001400927492, 0.623401118796622, -0.646510365391155, -1.3180470409168, -0.769667946918598, -0.244069600591997, 
        1.23701708014743, 0.0947410117175044, 0.889913714502978, 0.578752856857853, -0.347507527723047, -0.217444761339514, 
        -0.236751248420907, 0.145718313755284, 1.07841800604069, 0.441840455956284, 1.75501359238371, 0.103613921128693, 
        -0.866864673887526, 0.490097695076375, 3.07567625414828, -0.522580106097762, -0.77899295897418, 0.0943858184574707, 
        0.425740815151447, 0.24991764105315, -0.382552583116871, 0.185198688710095, -0.598969933064082, 0.743747760518586, 
        -0.357409482995796, 0.0591667402090884, 1.16189322539182, -0.0509109055856142, -0.428129535042452, -0.506653641836705, 
        0.254576894524453, 0.00627067366663279, 1.27662537064396, -0.533842453937166, 0.223644971883232, 2.0522768355699, 
        -0.769875459473027, 0.194506594483291, -0.049911950547029, 0.895716824452398, 0.397207982667787, 0.127578204771107), 
        X3 = c(-1.41040032630496, -2.46196671615583, 0.416431138636134, -0.606116043016302, 2.48665194297866, 0.699394375153263, 
            -0.147870750646655, 0.825712080726049, -1.63435466470734, 0.261822352700088, -1.6529168666729, -2.04160506426357, 
            0.492460384418306, -0.396680405027911, 0.79846218399206, 0.250723989919503, 1.2181720127522, -0.969114852706041, 
            -0.662431480735188, -0.51326604153952, -0.0600266115848672, -0.39121724398618, 0.896669676487747, 0.43433160007026, 
            0.908029188304125, -0.74410258216683, 0.944982807674479, -0.688152996130064, -0.582727033202053, -1.51791360018971, 
            -0.638436675894546, -0.484246550392515, -1.4724952746868, -1.2327011362492, 1.60769219432389, 0.303987783478531, 
            -0.00807179446528933, 1.90936295748077, -0.439984425076402, -0.103326747630563, 1.26903552959779, 1.00197964396912, 
            0.66388258709144, 1.06217298214205, 0.923678467837649, 0.925581790838854, 0.170629450989859, -2.20620841803882, 
            -1.74473927794131, 1.0564681070343, -0.164934977653051, -1.11729703995095, 0.320688605591135, 0.79944133839318, 
            1.58334289435627, 1.67567807434163, -1.32468430000043, 0.579021292440853, -0.564965618142809, 0.467646347573167, 
            -0.0342175329917544, 0.727673818172959, -0.7666769578294, -0.32221399551287, -0.371464925931964, 0.317919108525011, 
            -0.510061559070798, -1.09606750712969, -1.23448721362674, 1.79417932205599, 0.832265449970913, 0.0445694767701595, 
            0.933003213981728, -2.21042683917411, -0.171348502105077, -0.00750856866887631, 0.681441736569337, 0.76318033734653, 
            -1.52884790303708, -0.505734732482933, 0.188142015453874, -1.66374366098117, 0.311056470853888, -1.46265405858691, 
            0.0585582429465741, -0.831189682429336, -1.69068415042609, 0.0357370022025385, 0.49225931710079, -2.64067580136299, 
            0.0287908705650912, -0.722705191364723, -0.327744871549012, 0.908344712578227, 1.43111714879368, 1.14115121492008, 
            0.071357664805836, -1.35575546749935, 1.17351869113668, -0.00292060233899023, -1.43673450284629, 0.814242163356915, 
            -0.492450012866144, 0.0902099535374615, -0.088647252169507, -0.758069516341925, 0.25556168296579, -1.0471668316709, 
            0.932730844412507, -0.241022184281171, 0.222414907890648, 0.805887018734393, -1.85252281807333, 0.070538378361385, 
            0.0196151601481908, 1.00596589465345, -0.0497808690028655, -0.206477034180124, -0.767877285447624, -0.742515004666377, 
            0.324303263828543, -0.552556483095571, -0.203389203524038, -1.29069904089512, 0.925577071614174, 0.631033898530924, 
            1.12740037015462, -0.537455895399855, 1.39355586772899, 1.50346645446168, -1.72154727655197, -0.643362021677841, 
            1.0891601853978, 1.89551727903127, -1.70850349296534, 0.0519038690339406, 0.863389492194306, -0.0843622016666546, 
            -0.275788686410591, -0.927051106871673, 1.85123627791543, 1.51334004284999, 1.12828942056205, 0.584598763343047, 
            -0.830634960569303, 0.944394941760977, 0.679441252546705, 0.344815305972807, 0.372136848670957, 0.117579240011461, 
            0.147103945761473, -1.37479326189035, 1.79779026056281, 0.44721182941024, 0.314663797971273, -1.37365492796407, 
            -1.80849361136121, 1.27105457951213, -1.17849062931009, 1.91087278788917, -0.839282187179789, 0.291382396391303, 
            -0.953045792889082, 1.88535023698687, -0.723769867233302, 0.0656331249149518, -1.07067790377647, 0.94449953075545, 
            -0.595921399173241, -0.182331221817084, -0.389114245730948, -1.95329891914725, 0.841505800551519, -0.0460033779091301, 
            0.522121673732788, -1.79523045600423, -0.129945483224338, 0.171204013293452, 0.140585179734556, 1.05383713798565, 
            -0.189556919873108, 0.994608383236865, 2.09285833338979, -1.53152532304319, -1.34266906639874, 1.07338061114269, 
            -3.23228510623272, 0.154824137894348, -0.0266464245176433, 0.0074070025236954, 1.03081180377959, -1.31028712450042, 
            -0.595252508301485, -1.32360690607905, 0.554568301254151, -2.2276378867052, -1.0087263847846, 0.490772499199269, 
            1.19412817131361, 0.438752407879128, 2.69309658155134, 2.10346291901716, -0.174847074718124, -0.165131124958071, 
            -1.47277091165331, -0.0344212155804144, 1.72003629670148, -0.668313483006658, 0.429096056042802, -0.184847210969037, 
            -0.501243114430421, 0.0235934323982278, -0.246353335052758, -1.23696022438147, 0.596879712321544, 0.642106292925625, 
            -1.39343933067559, 2.26682530720933, 2.14546127228307, -0.0509772255735603, -0.801561250036913, 2.08713748351422, 
            -0.0604449014435643, -0.631649274736512, -1.42010519733324, -1.60697787678636, -1.66760333630252, 1.77588774271442, 
            -0.607821282534887, -0.437863931906742, -0.117948275215422, 0.396597261750525, -0.0090119033418203, 0.417890624321576, 
            -0.143075664676608, 0.595677999456723, -2.02534426841097, 0.233634913252606, -0.745961507755023, 0.321284395797713, 
            -0.431019397010471, -0.395321917876604, -0.292552734926533, 0.226642372676278, -0.529324102637179, 0.852596893321466, 
            1.13310062969204, 1.64376959676724, -0.715358263788724, -0.900920372889808, 0.871040396295746, -0.399391584314135, 
            0.418317294078215, 0.125900253626696, 1.012065579161, -0.845446814684416, -0.888906436199631, 0.112396063722464, 
            1.95702993784801, -0.112742611936898, -1.23541743324926, -1.74974875625817, -0.038409160544894, 0.864941796020442, 
            -0.983486678995575, 0.790229316714407, 0.854292546250927, 0.311261777389173, 2.75276279492769, 1.34852196688945, 
            1.78343807691205, 0.119848655548502, -0.702895832952456, 0.572095611447949, 0.238671798446998, -0.00339609646917607, 
            0.712179961585274, 1.0081400280889, -0.0848297567927654, 0.39967707537345, 0.993475181443637, -0.922468596540966, 
            0.837005301995619, -0.297039477072536, -0.288068109804488, 0.69080421699573, -0.449505237727292, 1.12301804820067, 
            0.259396202043241, 0.420597616544662, 0.699600153720875, 1.35642874324387, 0.879898846027397, -0.720404761671106, 
            0.853199377013695, 0.194362959589571, 0.00649324018639272, 0.388451911445692, 0.886558995704577, 1.44050048936358, 
            -1.06985630484136, -0.233708796009288, 0.573519655672518, -0.104888262016313, 0.459479118101629, 0.970138737568642, 
            0.338277094356242, -1.71376458595209, 1.22946431973008, -0.316055307239044, -0.145784921314456, 0.097976753759115, 
            -0.910475951668998, -0.153502765065373, -1.59107397605417, 0.797694321921178, 0.40163378727341, 1.19428401417466, 
            -0.349618224240184, 0.433972227714586, 0.559491817604287, -0.87572553348064, -1.22172709548262, 1.78377865469059, 
            1.15643750157776, 0.0797096984631812, -0.914511776775178, -0.655555477157517, -0.248392629467, -0.699358098009171, 
            0.0178907813036609, -0.780378300661731, -0.299160269421325, 0.309247551885225, 0.256289498888344, -2.00544940845637, 
            1.41574140318264, -2.47003913102269, 0.0620879263326391, 1.29839423666189, -0.344307803803356, -0.77851829285234, 
            -0.79621464233286, 0.429592059284297, -2.01222555084404, 0.264204593150161, -1.35576458099972, -0.257980312225736, 
            0.844354397446307, -0.146886215401174, 0.0631713873261294, 0.721103913023951, 0.229377090429674, 0.330361542856292, 
            1.37462095650109, 0.780081885957597, -0.9020781217477, 0.451921165530032, -0.284983794623164, 0.908426986548471, 
            -0.699147241431873, -1.00049299875447, -1.09205002674584, -0.264489973769982, -0.914981174014895, 0.991666160892099, 
            -0.530775733520296, -0.8659475312086, -0.940270235098421, -0.398251878299739, 0.168027765321748, -0.522921898119208, 
            0.683304507041965, -0.849290628522912, 0.463518655151939, -0.758402703871674, -0.381495912983269, 1.11970491550945, 
            -0.549627765283051, -0.686800708699133, 0.972546446118225, 0.13419563014218, 0.596874074248736, 0.744809344482345, 
            -0.827963648078873, 0.769013410336935, 0.14241037166958, -1.66394781177906, 1.15451192073587, -1.47465595672854, 
            -0.345082237251386, -0.0575073640115172, 0.0820410351715358, -1.46718956828522, -0.517695911787133, -1.00741688171064, 
            -1.3421498457189, -0.189572647961644, 0.318710655147363, 0.20224926217446, -1.04275390801117, -2.11472668761652, 
            -0.0155007132245912, 1.24690454632892, 0.288693095192451, -0.847171214718202, 0.859686652219117, -1.35030167657927, 
            0.361759531405883, 0.200155352970736, 0.599494754329584, 1.06109697609623, -1.15795683720891, 0.453266072332138, 
            1.05765052647881, -0.0564026711767114, -0.252569753280763, 1.31718152690957, 0.65953656577213, -2.00955391515381, 
            -1.81011581858123, -0.297804994171575, 0.208340369713436, 0.784015115820108, -1.44323736440577, 0.474665337770603, 
            -0.44925911144572, -0.471890108672324, 0.595285216235962, -0.553323716123335, -0.953989412410966, -1.27395501906135, 
            -0.235742483348135, 1.61434803550154, 0.288414400974518, -0.662733385529829, -2.66122287211532, -1.38583651097446, 
            -0.681280107836769, -1.4380910192756, -0.790173887779386, -0.156690590046157, -1.0846983394427, -1.89535096979904, 
            -1.4923073522328, -0.859270346067859, 0.831624152414701, 0.215862642311411, -1.47718203569815, 0.68179643598819, 
            -1.97658347029818, 0.403281803421268, -0.020426650623829, 0.00517293514077924, -0.22180034773754, -0.754307481353789, 
            -1.09909810889043, -0.0748905761319432, -0.0247126765612995, -0.608524841063323, 0.98464932382438, -0.551540471229118, 
            0.37785972279406, 2.17238205135637, 1.41863615695001, 0.438959585796203, -0.794903253781494, -0.0922847136452624, 
            0.215224682538681, -0.528222671502304, 0.0106614303547657, -0.34431256993002, 1.49259973719467, -0.410882888496284, 
            0.223721505742866, 1.20922502390103, 1.01953317571691, 0.0583876277254136, 1.58622074400843, 1.10196820905096, 
            -0.329534183501824, -0.758106151578208, 1.67242792276324, -0.533975696070031, 1.23603013910789, -0.606532636475352, 
            -0.696290751109337, -0.270610949591911, -0.687897503870518, -1.15780130164285, 0.664388181050093, -0.678417950614144, 
            0.259272317756062, 0.318757952239339, -0.724076808538888, -0.235578604889569, 1.69514744035262, -0.761239025715106, 
            -0.408979211521059, 0.38806014492013)), row.names = c(NA, -500L), class = "data.frame")
    expect_equal(gendata:::dtrans(data = sdata, m = c(0, 100, 50), sd = c(1, 15, 10), rnd = TRUE), structure(list(X1 = c(1, 
        0, -0, 0, -2, 1, -1, -0, 1, 1, 1, -1, -1, -1, 1, -1, 1, 0, -1, 0, -1, -2, -0, 1, 2, -2, 0, -0, -0, 0, -1, -2, -1, 
        -2, -1, -1, 1, 1, -2, -0, -1, 2, 1, -2, -1, -2, 2, 0, -0, 0, 0, -2, 0, -1, 0, -1, -0, -1, -2, 1, -0, 1, 0, -1, 1, 
        1, -1, -1, -1, 0, 1, 0, 0, -1, -1, -1, -1, 0, 0, -1, -1, -0, -0, -1, -1, -2, -0, -1, -0, -0, 1, 1, -2, 1, 1, -1, 
        1, -2, 0, 1, 1, 1, 1, 1, 1, 1, 0, -1, -1, -1, 1, 1, -1, -2, -0, 1, -0, -0, -2, 0, -2, -1, -0, -1, 1, 1, 2, -1, 2, 
        1, -1, -1, -2, 1, -2, 1, 0, -0, -1, 0, -0, 1, -0, 2, 1, -0, 1, -1, -1, 0, 2, -0, -1, 1, 0, 1, -1, -0, 0, -0, 1, -1, 
        0, 0, 1, 1, 0, 1, -1, 1, 0, -1, -0, -2, 1, 0, -2, -0, 0, 2, 0, -0, -0, -1, -0, -0, -1, -0, 1, -0, -1, 1, -0, 0, -2, 
        0, -1, 1, 0, -0, 0, 0, -0, -1, 0, 0, 1, -1, 0, -0, -1, 1, 1, -2, -0, -1, -1, 1, 1, 0, -1, 2, 1, 0, -1, 1, 1, -1, 
        -2, 0, -0, 1, -0, -1, -1, 1, -0, 0, -0, -1, 1, 1, 0, 1, 0, -1, -4, -1, -1, -1, 1, -1, -0, 2, -0, 0, 1, 0, -0, 2, 
        -0, -0, -0, -0, -2, -0, -0, -0, 0, 0, -1, 0, -0, 3, -1, -2, -1, 0, 0, -0, 1, 0, 1, -1, -1, -0, -0, 0, -1, -2, -0, 
        1, 0, -0, 1, 0, 2, -0, 1, -2, -1, -0, -0, -2, -0, 0, -1, -1, 1, -1, 1, -1, -1, -2, -1, 0, 1, 1, -2, 0, -1, -0, -0, 
        -1, 2, -1, -1, -1, 1, -0, -2, -0, -1, -1, -1, -0, 2, -1, -1, -1, -2, 1, -1, -1, 1, -0, 1, -0, 2, -1, -0, -1, 1, 1, 
        -2, -1, -0, -1, -1, 1, 1, 1, 1, 1, 1, -2, -0, -1, -0, 1, -0, -2, -1, 0, -0, 1, -1, 1, -1, -2, -0, -0, -1, 0, -1, 
        0, -1, -2, 1, 0, -1, -1, 0, 1, -0, -0, -0, -1, -0, 1, -1, 1, 0, 1, 1, -1, 0, 1, 1, 1, 1, -0, -1, -0, 1, -0, 0, 2, 
        2, 0, 0, 0, 0, -0, -1, -0, -1, 1, -2, -0, 2, 0, 0, 1, -1, -1, -1, -1, -1, -1, 0, -1, 0, -0, -1, -0, 1, 2, 1, 0, 1, 
        -1, 0, 0, -1, -1, -2, 1, 1, -0, 1, 0, -0, 1, -0, 1, 1, 2, 2, 1, -2, -0, 1, -0, -1, 0, 0, 1, -1, -1, 1, -0, -0, -1, 
        1, -0, -1, 0, -0, 0, 1, -1, 0, 2, 2, -1, 1, 1, 0, 0), X2 = c(86, 96, 105, 113, 85, 136, 91, 107, 106, 115, 109, 82, 
        96, 101, 103, 84, 108, 115, 80, 90, 88, 89, 112, 125, 118, 74, 102, 93, 88, 117, 95, 72, 64, 86, 96, 90, 97, 116, 
        73, 104, 74, 141, 112, 89, 85, 83, 119, 95, 100, 127, 113, 80, 96, 92, 101, 88, 97, 88, 70, 148, 103, 121, 89, 70, 
        110, 133, 89, 81, 105, 121, 83, 120, 120, 68, 76, 86, 79, 116, 94, 88, 94, 87, 109, 58, 90, 76, 95, 118, 82, 99, 
        117, 120, 74, 94, 107, 79, 108, 77, 108, 110, 95, 112, 84, 124, 89, 103, 101, 71, 114, 104, 121, 125, 87, 82, 108, 
        99, 103, 87, 66, 106, 84, 85, 95, 76, 95, 108, 120, 80, 124, 105, 78, 88, 102, 109, 65, 114, 121, 85, 108, 117, 124, 
        114, 115, 112, 99, 80, 121, 86, 77, 91, 125, 99, 98, 113, 100, 105, 75, 101, 102, 107, 104, 96, 109, 98, 119, 100, 
        88, 113, 66, 94, 94, 89, 93, 100, 130, 99, 61, 93, 86, 117, 123, 97, 96, 89, 90, 95, 98, 88, 96, 116, 95, 111, 87, 
        100, 77, 94, 97, 100, 101, 101, 115, 98, 97, 83, 85, 94, 119, 94, 89, 107, 84, 111, 101, 80, 116, 97, 100, 125, 126, 
        98, 98, 123, 97, 107, 72, 83, 104, 95, 81, 96, 105, 100, 97, 104, 87, 100, 96, 114, 94, 103, 110, 111, 106, 113, 
        106, 79, 60, 97, 103, 92, 105, 82, 84, 121, 101, 85, 111, 111, 108, 112, 92, 83, 106, 111, 87, 103, 92, 88, 108, 
        104, 117, 115, 95, 124, 99, 93, 104, 98, 125, 86, 119, 99, 105, 64, 91, 90, 107, 109, 80, 97, 110, 97, 96, 94, 115, 
        89, 138, 120, 104, 99, 105, 102, 110, 86, 102, 89, 82, 115, 92, 70, 114, 116, 76, 79, 62, 97, 104, 117, 58, 119, 
        96, 93, 86, 85, 126, 84, 102, 103, 114, 82, 78, 93, 100, 82, 98, 112, 111, 85, 100, 86, 70, 107, 92, 90, 109, 104, 
        134, 92, 139, 86, 96, 106, 130, 115, 84, 112, 99, 103, 98, 111, 109, 150, 93, 96, 96, 98, 99, 70, 93, 101, 109, 75, 
        88, 87, 82, 113, 87, 133, 91, 62, 108, 103, 93, 103, 103, 97, 87, 70, 115, 120, 93, 93, 94, 106, 103, 101, 99, 100, 
        103, 126, 98, 101, 89, 104, 102, 90, 95, 111, 118, 121, 106, 102, 91, 99, 109, 108, 87, 91, 107, 82, 98, 90, 111, 
        90, 84, 112, 75, 118, 82, 88, 110, 110, 95, 114, 97, 110, 75, 96, 90, 74, 92, 90, 106, 89, 89, 96, 110, 131, 91, 
        119, 88, 73, 113, 109, 90, 80, 88, 96, 119, 101, 113, 109, 95, 97, 96, 102, 116, 107, 126, 102, 87, 107, 146, 92, 
        88, 101, 106, 104, 94, 103, 91, 111, 95, 101, 117, 99, 94, 92, 104, 100, 119, 92, 103, 131, 88, 103, 99, 113, 106, 
        102), X3 = c(36, 25, 54, 44, 75, 57, 49, 58, 34, 53, 33, 30, 55, 46, 58, 53, 62, 40, 43, 45, 49, 46, 59, 54, 59, 
        43, 59, 43, 44, 35, 44, 45, 35, 38, 66, 53, 50, 69, 46, 49, 63, 60, 57, 61, 59, 59, 52, 28, 33, 61, 48, 39, 53, 58, 
        66, 67, 37, 56, 44, 55, 50, 57, 42, 47, 46, 53, 45, 39, 38, 68, 58, 50, 59, 28, 48, 50, 57, 58, 35, 45, 52, 33, 53, 
        35, 51, 42, 33, 50, 55, 24, 50, 43, 47, 59, 64, 61, 51, 36, 62, 50, 36, 58, 45, 51, 49, 42, 53, 40, 59, 48, 52, 58, 
        31, 51, 50, 60, 50, 48, 42, 43, 53, 44, 48, 37, 59, 56, 61, 45, 64, 65, 33, 44, 61, 69, 33, 51, 59, 49, 47, 41, 69, 
        65, 61, 56, 42, 59, 57, 53, 54, 51, 51, 36, 68, 54, 53, 36, 32, 63, 38, 69, 42, 53, 40, 69, 43, 51, 39, 59, 44, 48, 
        46, 30, 58, 50, 55, 32, 49, 52, 51, 61, 48, 60, 71, 35, 37, 61, 18, 52, 50, 50, 60, 37, 44, 37, 56, 28, 40, 55, 62, 
        54, 77, 71, 48, 48, 35, 50, 67, 43, 54, 48, 45, 50, 48, 38, 56, 56, 36, 73, 71, 49, 42, 71, 49, 44, 36, 34, 33, 68, 
        44, 46, 49, 54, 50, 54, 49, 56, 30, 52, 43, 53, 46, 46, 47, 52, 45, 59, 61, 66, 43, 41, 59, 46, 54, 51, 60, 42, 41, 
        51, 70, 49, 38, 33, 50, 59, 40, 58, 59, 53, 78, 63, 68, 51, 43, 56, 52, 50, 57, 60, 49, 54, 60, 41, 58, 47, 47, 57, 
        46, 61, 53, 54, 57, 64, 59, 43, 59, 52, 50, 54, 59, 64, 39, 48, 56, 49, 55, 60, 53, 33, 62, 47, 49, 51, 41, 48, 34, 
        58, 54, 62, 47, 54, 56, 41, 38, 68, 62, 51, 41, 43, 48, 43, 50, 42, 47, 53, 53, 30, 64, 25, 51, 63, 47, 42, 42, 54, 
        30, 53, 36, 47, 58, 49, 51, 57, 52, 53, 64, 58, 41, 55, 47, 59, 43, 40, 39, 47, 41, 60, 45, 41, 41, 46, 52, 45, 57, 
        42, 55, 42, 46, 61, 45, 43, 60, 51, 56, 57, 42, 58, 51, 33, 62, 35, 47, 49, 51, 35, 45, 40, 37, 48, 53, 52, 40, 29, 
        50, 62, 53, 42, 59, 36, 54, 52, 56, 61, 38, 55, 61, 49, 47, 63, 57, 30, 32, 47, 52, 58, 36, 55, 46, 45, 56, 44, 40, 
        37, 48, 66, 53, 43, 23, 36, 43, 36, 42, 48, 39, 31, 35, 41, 58, 52, 35, 57, 30, 54, 50, 50, 48, 42, 39, 49, 50, 44, 
        60, 44, 54, 72, 64, 54, 42, 49, 52, 45, 50, 47, 65, 46, 52, 62, 60, 51, 66, 61, 47, 42, 67, 45, 62, 44, 43, 47, 43, 
        38, 57, 43, 53, 53, 43, 48, 67, 42, 46, 54)), row.names = c(NA, -500L), class = "data.frame"))
})

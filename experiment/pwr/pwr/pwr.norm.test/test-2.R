library(testthat)

.Random.seed <<- .ext.seed

test_that("pwr.norm.test", {
    d <- c(-0.333333333333333, -0.313131313131313, -0.292929292929293, -0.272727272727273, -0.252525252525252, -0.232323232323232, 
        -0.212121212121212, -0.191919191919192, -0.171717171717172, -0.151515151515151, -0.131313131313131, -0.111111111111111, 
        -0.0909090909090906, -0.0707070707070708, -0.05050505050505, -0.0303030303030302, -0.0101010101010104, 0.0101010101010104, 
        0.0303030303030302, 0.05050505050505, 0.0707070707070708, 0.0909090909090906, 0.111111111111111, 0.131313131313131, 
        0.151515151515152, 0.171717171717172, 0.191919191919192, 0.212121212121212, 0.232323232323232, 0.252525252525252, 
        0.272727272727273, 0.292929292929293, 0.313131313131313, 0.333333333333333, 0.353535353535353, 0.373737373737374, 
        0.393939393939394, 0.414141414141415, 0.434343434343434, 0.454545454545454, 0.474747474747475, 0.494949494949495, 
        0.515151515151516, 0.535353535353535, 0.555555555555555, 0.575757575757576, 0.595959595959596, 0.616161616161617, 
        0.636363636363636, 0.656565656565656, 0.676767676767677, 0.696969696969697, 0.717171717171717, 0.737373737373737, 
        0.757575757575757, 0.777777777777778, 0.797979797979798, 0.818181818181819, 0.838383838383839, 0.858585858585858, 
        0.878787878787879, 0.898989898989899, 0.919191919191919, 0.93939393939394, 0.959595959595959, 0.97979797979798, 1, 
        1.02020202020202, 1.04040404040404, 1.06060606060606, 1.08080808080808, 1.1010101010101, 1.12121212121212, 1.14141414141414, 
        1.16161616161616, 1.18181818181818, 1.2020202020202, 1.22222222222222, 1.24242424242424, 1.26262626262626, 1.28282828282828, 
        1.3030303030303, 1.32323232323232, 1.34343434343434, 1.36363636363636, 1.38383838383838, 1.4040404040404, 1.42424242424242, 
        1.44444444444444, 1.46464646464646, 1.48484848484849, 1.50505050505051, 1.52525252525253, 1.54545454545455, 1.56565656565657, 
        1.58585858585859, 1.60606060606061, 1.62626262626263, 1.64646464646465, 1.66666666666667)
    expect_equal(pwr:::pwr.norm.test(d = d, n = 20, sig.level = 0.05, alternative = "two.sided"), structure(list(d = c(0.333333333333333, 
        0.313131313131313, 0.292929292929293, 0.272727272727273, 0.252525252525252, 0.232323232323232, 0.212121212121212, 
        0.191919191919192, 0.171717171717172, 0.151515151515151, 0.131313131313131, 0.111111111111111, 0.0909090909090906, 
        0.0707070707070708, 0.05050505050505, 0.0303030303030302, 0.0101010101010104, 0.0101010101010104, 0.0303030303030302, 
        0.05050505050505, 0.0707070707070708, 0.0909090909090906, 0.111111111111111, 0.131313131313131, 0.151515151515152, 
        0.171717171717172, 0.191919191919192, 0.212121212121212, 0.232323232323232, 0.252525252525252, 0.272727272727273, 
        0.292929292929293, 0.313131313131313, 0.333333333333333, 0.353535353535353, 0.373737373737374, 0.393939393939394, 
        0.414141414141415, 0.434343434343434, 0.454545454545454, 0.474747474747475, 0.494949494949495, 0.515151515151516, 
        0.535353535353535, 0.555555555555555, 0.575757575757576, 0.595959595959596, 0.616161616161617, 0.636363636363636, 
        0.656565656565656, 0.676767676767677, 0.696969696969697, 0.717171717171717, 0.737373737373737, 0.757575757575757, 
        0.777777777777778, 0.797979797979798, 0.818181818181819, 0.838383838383839, 0.858585858585858, 0.878787878787879, 
        0.898989898989899, 0.919191919191919, 0.93939393939394, 0.959595959595959, 0.97979797979798, 1, 1.02020202020202, 
        1.04040404040404, 1.06060606060606, 1.08080808080808, 1.1010101010101, 1.12121212121212, 1.14141414141414, 1.16161616161616, 
        1.18181818181818, 1.2020202020202, 1.22222222222222, 1.24242424242424, 1.26262626262626, 1.28282828282828, 1.3030303030303, 
        1.32323232323232, 1.34343434343434, 1.36363636363636, 1.38383838383838, 1.4040404040404, 1.42424242424242, 1.44444444444444, 
        1.46464646464646, 1.48484848484849, 1.50505050505051, 1.52525252525253, 1.54545454545455, 1.56565656565657, 1.58585858585859, 
        1.60606060606061, 1.62626262626263, 1.64646464646465, 1.66666666666667), n = 20, sig.level = 0.05, power = c(0.319724352688023, 
        0.28826602054988, 0.258401849458148, 0.23029915637659, 0.204092614511999, 0.179884257113771, 0.15774473665227, 0.137715726391334, 
        0.119813301336617, 0.104032095713749, 0.0903500058772214, 0.0787331914369168, 0.0691411232495815, 0.0615314339906841, 
        0.0558643440908859, 0.0521064614120242, 0.0502337855555323, 0.0502337855555323, 0.0521064614120242, 0.0558643440908859, 
        0.0615314339906841, 0.0691411232495815, 0.0787331914369168, 0.0903500058772214, 0.10403209571375, 0.119813301336617, 
        0.137715726391334, 0.15774473665227, 0.179884257113771, 0.204092614511999, 0.23029915637659, 0.258401849458148, 0.28826602054988, 
        0.319724352688023, 0.352578191651825, 0.386600154495326, 0.42153796700851, 0.45711939434684, 0.493058072471133, 0.529060001146016, 
        0.564830425148805, 0.600080811320926, 0.634535626410089, 0.667938634424657, 0.700058461416041, 0.730693218109909, 
        0.759674023614903, 0.786867332896423, 0.812176032820175, 0.835539332337014, 0.856931528083706, 0.876359774170181, 
        0.893861021845875, 0.90949831962687, 0.923356676813044, 0.935538693531302, 0.946160149705006, 0.955345725495304, 
        0.963224999033544, 0.969928836116393, 0.975586253412635, 0.980321803891338, 0.98425350255207, 0.987491283617868, 
        0.990135958163811, 0.992278624243639, 0.99400047004895, 0.99537290422141, 0.996457945581001, 0.997308806480135, 0.99797060888821, 
        0.998481179275948, 0.998871876571647, 0.999168416166375, 0.999391661544237, 0.999558363142346, 0.999681831181583, 
        0.999772535265065, 0.99983862844186, 0.999886397195864, 0.999920641527792, 0.999944991080076, 0.999962164261557, 
        0.99997417771957, 0.999982513433578, 0.999988250304411, 0.999992166504128, 0.999994818129007, 0.999996598935913, 
        0.99999778519368, 0.999998568982019, 0.999999082642338, 0.99999941653796, 0.999999631817582, 0.999999769491797, 0.999999856821057, 
        0.999999911765584, 0.999999946053933, 0.999999967277883, 0.99999998030845), alternative = "two.sided", method = "Mean power calculation for normal distribution with known variance"), 
        class = "power.htest"))
})

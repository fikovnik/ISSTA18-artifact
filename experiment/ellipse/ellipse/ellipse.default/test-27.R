library(testthat)

.Random.seed <<- .ext.seed

test_that("ellipse.default", {
    mat <- structure(c(1, 1, 1, 1), .Dim = c(2L, 2L))
    expect_equal(ellipse:::ellipse.default(x = mat, t = 0.43), structure(c(0.43, 0.42913427088291, 0.426540569517242, 0.422229339822964, 
        0.416217941600433, 0.408530580628607, 0.399198211196911, 0.388258411463247, 0.375755232140008, 0.361739019117408, 
        0.346266210738355, 0.329399110541161, 0.31120563638518, 0.291759046969567, 0.271137646846345, 0.249424471115615, 
        0.226706951072516, 0.203076562152254, 0.178628455590811, 0.153461075284505, 0.127675761391158, 0.101376342269054, 
        0.0746687163967801, 0.0476604259574348, 0.0204602238042091, -0.00682236444896745, -0.0340774814484191, -0.0611953804575126, 
        -0.088066867268032, -0.114583739886715, -0.140639224226491, -0.166128404048045, -0.190948643420483, -0.215, -0.238185627462427, 
        -0.260412165469197, -0.281590115596473, -0.301634201713718, -0.320463713360574, -0.338002830739399, -0.354180930014828, 
        -0.36893286769104, -0.382199242921617, -0.39392663669579, -0.404067826937941, -0.412581978654234, -0.419434808360725, 
        -0.42459872213085, -0.428052926706426, -0.42978351322477, -0.42978351322477, -0.428052926706426, -0.42459872213085, 
        -0.419434808360725, -0.412581978654234, -0.404067826937941, -0.39392663669579, -0.382199242921617, -0.36893286769104, 
        -0.354180930014828, -0.338002830739399, -0.320463713360575, -0.301634201713718, -0.281590115596473, -0.260412165469197, 
        -0.238185627462427, -0.215, -0.190948643420483, -0.166128404048045, -0.140639224226491, -0.114583739886715, -0.0880668672680319, 
        -0.0611953804575126, -0.0340774814484192, -0.00682236444896727, 0.0204602238042092, 0.0476604259574347, 0.0746687163967799, 
        0.101376342269054, 0.127675761391158, 0.153461075284505, 0.178628455590811, 0.203076562152254, 0.226706951072516, 
        0.249424471115615, 0.271137646846345, 0.291759046969567, 0.31120563638518, 0.32939911054116, 0.346266210738355, 0.361739019117408, 
        0.375755232140008, 0.388258411463247, 0.399198211196911, 0.408530580628607, 0.416217941600433, 0.422229339822964, 
        0.426540569517242, 0.42913427088291, 0.43, 0.43, 0.42913427088291, 0.426540569517242, 0.422229339822964, 0.416217941600433, 
        0.408530580628607, 0.399198211196911, 0.388258411463247, 0.375755232140008, 0.361739019117408, 0.346266210738355, 
        0.329399110541161, 0.31120563638518, 0.291759046969567, 0.271137646846345, 0.249424471115615, 0.226706951072516, 
        0.203076562152254, 0.178628455590811, 0.153461075284505, 0.127675761391158, 0.101376342269054, 0.0746687163967801, 
        0.0476604259574348, 0.0204602238042091, -0.00682236444896745, -0.0340774814484191, -0.0611953804575126, -0.088066867268032, 
        -0.114583739886715, -0.140639224226491, -0.166128404048045, -0.190948643420483, -0.215, -0.238185627462427, -0.260412165469197, 
        -0.281590115596473, -0.301634201713718, -0.320463713360574, -0.338002830739399, -0.354180930014828, -0.36893286769104, 
        -0.382199242921617, -0.39392663669579, -0.404067826937941, -0.412581978654234, -0.419434808360725, -0.42459872213085, 
        -0.428052926706426, -0.42978351322477, -0.42978351322477, -0.428052926706426, -0.42459872213085, -0.419434808360725, 
        -0.412581978654234, -0.404067826937941, -0.39392663669579, -0.382199242921617, -0.36893286769104, -0.354180930014828, 
        -0.338002830739399, -0.320463713360575, -0.301634201713718, -0.281590115596473, -0.260412165469197, -0.238185627462427, 
        -0.215, -0.190948643420483, -0.166128404048045, -0.140639224226491, -0.114583739886715, -0.0880668672680319, -0.0611953804575126, 
        -0.0340774814484192, -0.00682236444896727, 0.0204602238042092, 0.0476604259574347, 0.0746687163967799, 0.101376342269054, 
        0.127675761391158, 0.153461075284505, 0.178628455590811, 0.203076562152254, 0.226706951072516, 0.249424471115615, 
        0.271137646846345, 0.291759046969567, 0.31120563638518, 0.32939911054116, 0.346266210738355, 0.361739019117408, 0.375755232140008, 
        0.388258411463247, 0.399198211196911, 0.408530580628607, 0.416217941600433, 0.422229339822964, 0.426540569517242, 
        0.42913427088291, 0.43), .Dim = c(100L, 2L), .Dimnames = list(NULL, c("x", "y"))))
})

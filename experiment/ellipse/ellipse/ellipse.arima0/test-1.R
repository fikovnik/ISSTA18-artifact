library(testthat)

.Random.seed <<- .ext.seed

test_that("ellipse.arima0", {
    arima0 <- stats::arima0
    USAccDeaths <- structure(c(9007, 8106, 8928, 9137, 10017, 10826, 11317, 10744, 9713, 9938, 9161, 8927, 7750, 6981, 8038, 
        8422, 8714, 9512, 10120, 9823, 8743, 9129, 8710, 8680, 8162, 7306, 8124, 7870, 9387, 9556, 10093, 9620, 8285, 8466, 
        8160, 8034, 7717, 7461, 7767, 7925, 8623, 8945, 10078, 9179, 8037, 8488, 7874, 8647, 7792, 6957, 7726, 8106, 8890, 
        9299, 10625, 9302, 8314, 8850, 8265, 8796, 7836, 6892, 7791, 8192, 9115, 9434, 10484, 9827, 9110, 9070, 8633, 9240), 
        .Tsp = c(1973, 1978.91666666667, 12), class = "ts")
    fit <- structure(list(coef = structure(c(-0.431534698300636, -0.548671377153979), names = c("ma1", "sma1")), sigma2 = 99655.4522533107, 
        var.coef = structure(c(0.0151318939705016, -0.00174916740551193, -0.00174916740551193, 0.0293855537220553), .Dim = c(2L, 
            2L), .Dimnames = list(c("ma1", "sma1"), c("ma1", "sma1"))), mask = c(TRUE, TRUE), loglik = -425.448142432806, 
        aic = 856.896284865612, arma = structure(c(0, 1, 0, 1, 12, 1, 1), names = c("ar", "ma", "sar", "sma", "period", "diff", 
            "sdiff")), residuals = structure(c(106.25406082865, 244.576551552718, 256.779094606941, -404.788449763238, -184.221735621496, 
            23.0835375054602, 251.931600361406, 65.7581866110334, 169.526781187426, 387.017890182222, 345.859935417854, 703.287535083398, 
            246.150962285644, -30.4157469902864, -558.351111770418, 703.786085762958, -308.973644144578, -154.272191279372, 
            -124.206080027426, -320.136616418627, -270.714298639534, 138.41253504964, 50.0902447995632, 475.650495871267, 
            776.791255643555, -243.938657538343, 16.2137232859144, -307.766968833045, -303.166004435745, 448.413632434904, 
            -258.657940952173, -60.5180163016045, 171.629386495584, -96.8649148700852, 843.450577937179, 65.1603462584211, 
            -237.298040201089, 42.8340643876749, 307.137926715079, 45.8388106942764, 13.3127402817448, 516.557472969865, 
            -449.176961746035, -11.7973166539807, 188.406075699588, 16.5199364285252, 250.84089324396, -160.706249030364, 
            -323.977028423643, 69.879727795585, 209.531463475965, 181.849266933965, -15.0747009141268, -2.23702376813995, 
            296.27841075157, 498.733524990121, -254.612898381486, 2.5806705466856, 210.831429701691), .Tsp = c(1974.08333333334, 
            1978.91666666667, 12), class = "ts"), call = arima0(x = USAccDeaths, order = c(0, 1, 1), seasonal = list(order = c(0, 
            1, 1))), series = "USAccDeaths", code = 0L, n.cond = 13L), class = "arima0")
    expect_equal(ellipse:::ellipse.arima0(x = fit), structure(c(-0.22764532636486, -0.242108382617819, -0.257334191787195, 
        -0.273261444913317, -0.289826008569272, -0.306961183103575, -0.324597971216131, -0.342665355786005, -0.361090585832305, 
        -0.379799469456704, -0.398716672588031, -0.417766022325985, -0.436870813662521, -0.455954118345843, -0.474939094643325, 
        -0.493749296756046, -0.512308982639042, -0.530543418987787, -0.548379182162837, -0.565744453840906, -0.582569310201911, 
        -0.598786003487515, -0.614329234797437, -0.62913641702508, -0.643147926873714, -0.656307344938455, -0.668561682887291, 
        -0.679861596826393, -0.690161585990564, -0.699420175958755, -0.707600085656928, -0.714668377475774, -0.720596589898851, 
        -0.725360852107055, -0.72894198009799, -0.731325553933175, -0.732501975802042, -0.732466508668935, -0.731219295347483, 
        -0.728765357925535, -0.725114577542986, -0.720281654603917, -0.714286049583254, -0.707151904666303, -0.698907946536693, 
        -0.689587370704159, -0.679227707837938, -0.667870672644015, -0.655561995894721, -0.642351240287054, -0.628291600871192, 
        -0.613439690852802, -0.597855313631638, -0.58160122199436, -0.564742865431213, -0.547348126594023, -0.529487047956723, 
        -0.51123154977903, -0.49265514050894, -0.473832620790157, -0.454839782266297, -0.435753102394691, -0.416649436498658, 
        -0.397605708298241, -0.378698600165538, -0.360004244351854, -0.341597916429993, -0.323553732186099, -0.305944349181538, 
        -0.28884067418655, -0.272311577663701, -0.25642361645085, -0.241240765760243, -0.226824161572918, -0.213231854465686, 
        -0.200518575861951, -0.188735517647574, -0.17793012603923, -0.168145910535229, -0.159422268718128, -0.151794327614569, 
        -0.145292802251142, -0.139943871975813, -0.135769075042929, -0.132785221886269, -0.131004327429365, -0.130433562705637, 
        -0.131075225983181, -0.132926733510448, -0.135980629920105, -0.140224618249164, -0.145641609454513, -0.15220979122446, 
        -0.159902715809218, -0.168689406516654, -0.178534482444495, -0.18939830094674, -0.201237117260596, -0.214003260651204, 
        -0.22764532636486, -0.2645428221457, -0.245532020445991, -0.227741853944598, -0.211243957363093, -0.196104761908181, 
        -0.182385227776674, -0.170140598690296, -0.159420179448711, -0.1502671373965, -0.142718328603499, -0.136804149458412, 
        -0.132548414273284, -0.129968259391669, -0.129074074186626, -0.12986945922638, -0.1323512117761, -0.13650933869419, 
        -0.142327096671133, -0.1497810596489, -0.158841213149407, -0.169471075132233, -0.181627842894918, -0.195262565424335, 
        -0.210320340505149, -0.226740535791659, -0.24445703295285, -0.263398493907581, -0.28348864807786, -0.304646599503536, 
        -0.326787152581786, -0.349821155119733, -0.373655857318866, -0.398195285245737, -0.423340627285124, -0.448990632019526, 
        -0.475042015932886, -0.50138987929686, -0.527928128564993, -0.554549903573995, -0.581148007831892, -0.607615340160474, 
        -0.633845325953933, -0.659732346317189, -0.685172163355902, -0.710062339905682, -0.734302652010395, -0.757795492488663, 
        -0.780446263963532, -0.802163759772721, -0.822860531225661, -0.842453239728508, -0.860862992359244, -0.878015659541635, 
        -0.893842173538863, -0.90827880656493, -0.921267427393961, -0.93275573543413, -0.942697471323686, -0.951052603201075, 
        -0.957787487899118, -0.962875006414174, -0.966294673104788, -0.968032718180148, -0.968082143146168, -0.966442748985954, 
        -0.963121136961175, -0.958130682031112, -0.95149147899642, -0.943230261584453, -0.933380294801984, -0.921981240988762, 
        -0.909079000111268, -0.894725524939749, -0.878978611852752, -0.861901668111503, -0.843563456541248, -0.824037818647623, 
        -0.803403377282972, -0.781743220059873, -0.759144564786647, -0.735698408272025, -0.711499159913115, -0.686644261542086, 
        -0.661233795062296, -0.635370079453793, -0.609157258770895, -0.582700882790841, -0.556107482002089, -0.529484138643641, 
        -0.502938055522657, -0.476576124346592, -0.450504495308013, -0.424828149655237, -0.399650476969904, -0.375072858853613, 
        -0.351194260700003, -0.328110833196036, -0.305915525157117, -0.284697709255025, -0.2645428221457), .Dim = c(100L, 
        2L), .Dimnames = list(NULL, c("ma1", "sma1"))))
})

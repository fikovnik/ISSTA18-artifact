library(testthat)

.Random.seed <<- .ext.seed

test_that("d3ForceNetwork", {
    MisNodes <- structure(list(name = structure(c(63L, 64L, 51L, 57L, 21L, 33L, 12L, 23L, 20L, 65L, 44L, 74L, 49L, 55L, 39L, 
        34L, 72L, 45L, 27L, 6L, 30L, 24L, 77L, 28L, 59L, 71L, 19L, 40L, 29L, 4L, 66L, 70L, 69L, 75L, 43L, 11L, 9L, 13L, 17L, 
        67L, 8L, 26L, 1L, 76L, 61L, 37L, 42L, 54L, 32L, 35L, 48L, 52L, 58L, 53L, 46L, 50L, 5L, 47L, 25L, 18L, 68L, 31L, 22L, 
        3L, 7L, 41L, 36L, 62L, 38L, 2L, 16L, 60L, 73L, 14L, 15L, 10L, 56L), .Label = c("Anzelma", "Babet", "Bahorel", "Bamatabois", 
        "BaronessT", "Blacheville", "Bossuet", "Boulatruelle", "Brevet", "Brujon", "Champmathieu", "Champtercier", "Chenildieu", 
        "Child1", "Child2", "Claquesous", "Cochepaille", "Combeferre", "Cosette", "Count", "CountessdeLo", "Courfeyrac", 
        "Cravatte", "Dahlia", "Enjolras", "Eponine", "Fameuil", "Fantine", "Fauchelevent", "Favourite", "Feuilly", "Gavroche", 
        "Geborand", "Gervais", "Gillenormand", "Grantaire", "Gribier", "Gueulemer", "Isabeau", "Javert", "Joly", "Jondrette", 
        "Judge", "Labarre", "Listolier", "Lt.Gillenormand", "Mabeuf", "Magnon", "Marguerite", "Marius", "Mlle.Baptistine", 
        "Mlle.Gillenormand", "Mlle.Vaubois", "Mme.Burgon", "Mme.deR", "Mme.Hucheloup", "Mme.Magloire", "Mme.Pontmercy", "Mme.Thenardier", 
        "Montparnasse", "MotherInnocent", "MotherPlutarch", "Myriel", "Napoleon", "OldMan", "Perpetue", "Pontmercy", "Prouvaire", 
        "Scaufflaire", "Simplice", "Thenardier", "Tholomyes", "Toussaint", "Valjean", "Woman1", "Woman2", "Zephine"), class = "factor"), 
        group = c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 3L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 4L, 4L, 
            5L, 4L, 0L, 2L, 3L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 4L, 6L, 4L, 4L, 5L, 0L, 0L, 7L, 7L, 8L, 5L, 5L, 5L, 5L, 5L, 
            5L, 8L, 5L, 8L, 8L, 8L, 8L, 8L, 8L, 8L, 8L, 8L, 8L, 9L, 4L, 4L, 4L, 4L, 5L, 10L, 10L, 4L, 8L)), class = "data.frame", 
        row.names = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", 
            "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", 
            "38", "39", "40", "41", "42", "43", "44", "45", "46", "47", "48", "49", "50", "51", "52", "53", "54", "55", "56", 
            "57", "58", "59", "60", "61", "62", "63", "64", "65", "66", "67", "68", "69", "70", "71", "72", "73", "74", "75", 
            "76", "77"))
    MisLinks <- structure(list(source = c(1L, 2L, 3L, 3L, 4L, 5L, 6L, 7L, 8L, 9L, 11L, 11L, 11L, 11L, 12L, 13L, 14L, 15L, 
        17L, 18L, 18L, 19L, 19L, 19L, 20L, 20L, 20L, 20L, 21L, 21L, 21L, 21L, 21L, 22L, 22L, 22L, 22L, 22L, 22L, 23L, 23L, 
        23L, 23L, 23L, 23L, 23L, 23L, 23L, 24L, 24L, 25L, 25L, 25L, 26L, 26L, 26L, 26L, 27L, 27L, 27L, 27L, 27L, 28L, 28L, 
        29L, 29L, 29L, 30L, 31L, 31L, 31L, 31L, 32L, 33L, 33L, 34L, 34L, 35L, 35L, 35L, 36L, 36L, 36L, 36L, 37L, 37L, 37L, 
        37L, 37L, 38L, 38L, 38L, 38L, 38L, 38L, 39L, 40L, 41L, 41L, 42L, 42L, 42L, 43L, 43L, 43L, 44L, 44L, 45L, 47L, 48L, 
        48L, 48L, 48L, 49L, 49L, 50L, 50L, 51L, 51L, 51L, 52L, 52L, 53L, 54L, 54L, 54L, 55L, 55L, 55L, 55L, 55L, 55L, 55L, 
        55L, 55L, 55L, 56L, 56L, 57L, 57L, 57L, 58L, 58L, 58L, 58L, 58L, 59L, 59L, 59L, 59L, 60L, 60L, 60L, 61L, 61L, 61L, 
        61L, 61L, 61L, 62L, 62L, 62L, 62L, 62L, 62L, 62L, 62L, 63L, 63L, 63L, 63L, 63L, 63L, 63L, 63L, 64L, 64L, 64L, 64L, 
        64L, 64L, 64L, 64L, 64L, 64L, 65L, 65L, 65L, 65L, 65L, 65L, 65L, 65L, 65L, 65L, 66L, 66L, 66L, 66L, 66L, 66L, 66L, 
        66L, 66L, 67L, 68L, 68L, 68L, 68L, 68L, 68L, 69L, 69L, 69L, 69L, 69L, 69L, 69L, 70L, 70L, 70L, 70L, 70L, 70L, 70L, 
        70L, 71L, 71L, 71L, 71L, 71L, 71L, 71L, 71L, 72L, 72L, 72L, 73L, 74L, 74L, 75L, 75L, 75L, 75L, 75L, 75L, 75L, 76L, 
        76L, 76L, 76L, 76L, 76L, 76L), target = c(0L, 0L, 0L, 2L, 0L, 0L, 0L, 0L, 0L, 0L, 10L, 3L, 2L, 0L, 11L, 11L, 11L, 
        11L, 16L, 16L, 17L, 16L, 17L, 18L, 16L, 17L, 18L, 19L, 16L, 17L, 18L, 19L, 20L, 16L, 17L, 18L, 19L, 20L, 21L, 16L, 
        17L, 18L, 19L, 20L, 21L, 22L, 12L, 11L, 23L, 11L, 24L, 23L, 11L, 24L, 11L, 16L, 25L, 11L, 23L, 25L, 24L, 26L, 11L, 
        27L, 23L, 27L, 11L, 23L, 30L, 11L, 23L, 27L, 11L, 11L, 27L, 11L, 29L, 11L, 34L, 29L, 34L, 35L, 11L, 29L, 34L, 35L, 
        36L, 11L, 29L, 34L, 35L, 36L, 37L, 11L, 29L, 25L, 25L, 24L, 25L, 41L, 25L, 24L, 11L, 26L, 27L, 28L, 11L, 28L, 46L, 
        47L, 25L, 27L, 11L, 26L, 11L, 49L, 24L, 49L, 26L, 11L, 51L, 39L, 51L, 51L, 49L, 26L, 51L, 49L, 39L, 54L, 26L, 11L, 
        16L, 25L, 41L, 48L, 49L, 55L, 55L, 41L, 48L, 55L, 48L, 27L, 57L, 11L, 58L, 55L, 48L, 57L, 48L, 58L, 59L, 48L, 58L, 
        60L, 59L, 57L, 55L, 55L, 58L, 59L, 48L, 57L, 41L, 61L, 60L, 59L, 48L, 62L, 57L, 58L, 61L, 60L, 55L, 55L, 62L, 48L, 
        63L, 58L, 61L, 60L, 59L, 57L, 11L, 63L, 64L, 48L, 62L, 58L, 61L, 60L, 59L, 57L, 55L, 64L, 58L, 59L, 62L, 65L, 48L, 
        63L, 61L, 60L, 57L, 25L, 11L, 24L, 27L, 48L, 41L, 25L, 68L, 11L, 24L, 27L, 48L, 41L, 25L, 69L, 68L, 11L, 24L, 27L, 
        41L, 58L, 27L, 69L, 68L, 70L, 11L, 48L, 41L, 25L, 26L, 27L, 11L, 48L, 48L, 73L, 69L, 68L, 25L, 48L, 41L, 70L, 71L, 
        64L, 65L, 66L, 63L, 62L, 48L, 58L), value = c(1L, 8L, 10L, 6L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 3L, 3L, 5L, 1L, 1L, 1L, 
        1L, 4L, 4L, 4L, 4L, 4L, 4L, 3L, 3L, 3L, 4L, 3L, 3L, 3L, 3L, 5L, 3L, 3L, 3L, 3L, 4L, 4L, 3L, 3L, 3L, 3L, 4L, 4L, 4L, 
        2L, 9L, 2L, 7L, 13L, 1L, 12L, 4L, 31L, 1L, 1L, 17L, 5L, 5L, 1L, 1L, 8L, 1L, 1L, 1L, 2L, 1L, 2L, 3L, 2L, 1L, 1L, 2L, 
        1L, 3L, 2L, 3L, 3L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 1L, 2L, 3L, 2L, 2L, 1L, 3L, 
        1L, 1L, 3L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 3L, 2L, 1L, 1L, 9L, 2L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 6L, 12L, 1L, 1L, 21L, 
        19L, 1L, 2L, 5L, 4L, 1L, 1L, 1L, 1L, 1L, 7L, 7L, 6L, 1L, 4L, 15L, 5L, 6L, 2L, 1L, 4L, 2L, 2L, 6L, 2L, 5L, 1L, 1L, 
        9L, 17L, 13L, 7L, 2L, 1L, 6L, 3L, 5L, 5L, 6L, 2L, 4L, 3L, 2L, 1L, 5L, 12L, 5L, 4L, 10L, 6L, 2L, 9L, 1L, 1L, 5L, 7L, 
        3L, 5L, 5L, 5L, 2L, 5L, 1L, 2L, 3L, 3L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 3L, 5L, 1L, 1L, 1L, 1L, 1L, 6L, 6L, 1L, 1L, 2L, 
        1L, 1L, 4L, 4L, 4L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, 2L, 3L, 3L, 3L, 3L, 1L, 1L, 
        1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L)), class = "data.frame", row.names = c("1", "2", "3", "4", "5", "6", "7", "8", 
        "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", 
        "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "46", 
        "47", "48", "49", "50", "51", "52", "53", "54", "55", "56", "57", "58", "59", "60", "61", "62", "63", "64", "65", 
        "66", "67", "68", "69", "70", "71", "72", "73", "74", "75", "76", "77", "78", "79", "80", "81", "82", "83", "84", 
        "85", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", 
        "104", "105", "106", "107", "108", "109", "110", "111", "112", "113", "114", "115", "116", "117", "118", "119", "120", 
        "121", "122", "123", "124", "125", "126", "127", "128", "129", "130", "131", "132", "133", "134", "135", "136", "137", 
        "138", "139", "140", "141", "142", "143", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", 
        "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "171", 
        "172", "173", "174", "175", "176", "177", "178", "179", "180", "181", "182", "183", "184", "185", "186", "187", "188", 
        "189", "190", "191", "192", "193", "194", "195", "196", "197", "198", "199", "200", "201", "202", "203", "204", "205", 
        "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", 
        "223", "224", "225", "226", "227", "228", "229", "230", "231", "232", "233", "234", "235", "236", "237", "238", "239", 
        "240", "241", "242", "243", "244", "245", "246", "247", "248", "249", "250", "251", "252", "253", "254"))
    expect_equal(d3Network:::d3ForceNetwork(Links = MisLinks, Nodes = MisNodes, Source = "source", Target = "target", Value = "value", 
        NodeID = "name", Group = "group", opacity = 0.4), NULL)
})

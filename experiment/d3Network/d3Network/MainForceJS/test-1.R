library(testthat)

.Random.seed <<- .ext.seed

test_that("MainForceJS", {
    expect_equal(d3Network:::MainForceJS(), "var width = {{width}}\nheight = {{height}};\n\nvar color = d3.scale.category20();\n\nvar force = d3.layout.force()\n.nodes(d3.values(nodes))\n.links(links)\n.size([width, height])\n.linkDistance({{linkDistance}})\n.charge({{charge}})\n.on(\"tick\", tick)\n.start();\n\nvar svg = d3.select(\"{{parentElement}}\").append(\"svg\")\n.attr(\"width\", width)\n.attr(\"height\", height);\n\nvar link = svg.selectAll(\".link\")\n.data(force.links())\n.enter().append(\"line\")\n.attr(\"class\", \"link\")\n.style(\"stroke-width\", {{linkWidth}});\n\nvar node = svg.selectAll(\".node\")\n.data(force.nodes())\n.enter().append(\"g\")\n.attr(\"class\", \"node\")\n.style(\"fill\", function(d) { return color(d.group); })\n.style(\"opacity\", {{opacity}})\n.on(\"mouseover\", mouseover)\n.on(\"mouseout\", mouseout)\n.call(force.drag);\n\nnode.append(\"circle\")\n.attr(\"r\", 6)\n\nnode.append(\"svg:text\")\n.attr(\"class\", \"nodetext\")\n.attr(\"dx\", 12)\n.attr(\"dy\", \".35em\")\n.text(function(d) { return d.name });\n\nfunction tick() {\nlink\n.attr(\"x1\", function(d) { return d.source.x; })\n.attr(\"y1\", function(d) { return d.source.y; })\n.attr(\"x2\", function(d) { return d.target.x; })\n.attr(\"y2\", function(d) { return d.target.y; });\n\nnode.attr(\"transform\", function(d) { return \"translate(\" + d.x + \",\" + d.y + \")\"; });\n}\n\nfunction mouseover() {\nd3.select(this).select(\"circle\").transition()\n.duration(750)\n.attr(\"r\", 16);\nd3.select(this).select(\"text\").transition()\n.duration(750)\n.attr(\"x\", 13)\n.style(\"stroke-width\", \".5px\")\n.style(\"font\", \"{{clickTextSize}}px serif\")\n.style(\"opacity\", 1);\n}\n\nfunction mouseout() {\nd3.select(this).select(\"circle\").transition()\n.duration(750)\n.attr(\"r\", 8);\n}\n\n</script>\n")
})

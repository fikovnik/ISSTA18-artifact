library(testthat)

.Random.seed <<- .ext.seed

test_that("acy", {
    Z <- structure(c(0.62911404389888, 0.0617862704675645, 0.205974574899301, 0.176556752528995, 0.5310173262842, 0.74424779927358, 
        1.14570672670379, 1.81641557998955, 0.605045793112367, 2.69516905490309, 2.83402580581605, 1.98239337746054, 2.74809138663113, 
        1.53641487285495, 3.07936567999423, 1.99079696834087), .Dim = c(4L, 4L))
    X <- structure(c(0.2655086631421, 0.37212389963679, 0.572853363351896, 0.908207789994776, 0.201681931037456, 0.898389684967697, 
        0.944675268605351, 0.660797792486846, 0.62911404389888, 0.0617862704675645, 0.205974574899301, 0.176556752528995, 
        0.687022846657783, 0.384103718213737, 0.769841419998556, 0.497699242085218), .Dim = c(4L, 4L))
    expect_equal(ica:::acy(X = X, Y = Z), 1.27675647831893e-15)
})

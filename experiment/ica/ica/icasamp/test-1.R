library(testthat)

.Random.seed <<- .ext.seed

test_that("icasamp", {
    nobs <- 1000
    expect_equal(ica:::icasamp(dname = "b", query = "rnd", nsamp = nobs), c(-0.0885270223272914, -0.506593306361713, -2.75539408953503, 
        0.709423790324294, 0.751222939188775, -0.0611585964331679, -2.01759083369489, -0.131758304505554, -0.210266444146136, 
        -0.0563465840576492, -0.390272405950986, -0.0873369111811448, -0.958310750338282, 0.978941184874099, -0.141379308302184, 
        -0.947745928238235, -1.64338538757854, -0.21973144851483, 2.00510384364019, 1.1463663057833, -0.138533558376695, 
        4.19228615055503, 0.698072256467032, -0.0785999202196787, 0.0810039277247205, -0.69087885599164, 1.12812711095328, 
        -0.465697020139165, 0.53152627400704, -0.537516885385524, 0.588058160089756, 0.517379942453805, 0.0573848861735039, 
        -0.318742809890098, -1.31747772575313, -1.32191304540491, -0.0031612803544306, -0.553947810651679, 0.220473361464801, 
        -0.0112190600562195, 0.667656104740772, 1.36095696785436, 0.0514023751620386, 0.261685020798076, 0.145032877671068, 
        0.212956020588439, -0.359189228322024, -0.138318655200522, 1.77643015988042, -0.279749366194276, 2.66390532487984, 
        -0.12219927729839, 0.110111941371968, 0.75512554835861, -0.352951699870507, -0.411569365566406, -0.342609670959292, 
        0.703519035945709, -0.0272423135254717, -0.683733368475297, 0.376073997356605, -0.17342680088599, -0.89136351605182, 
        -0.26941087889488, 0.0223600990518558, -0.211145716968126, 0.521731333900762, -0.599816582817208, 0.141213931949842, 
        -0.804092634139851, -0.241032490252241, -0.883567500871649, 0.133220496074002, 0.242553635268214, 0.917027695560718, 
        1.64294646502979, 1.21357084789701, -2.10573135160484, -0.860161069427018, -0.301846983563957, -0.507517913125777, 
        -0.929179195700508, 0.430488216254923, -0.417092379474415, 0.873471284555503, -0.348547408210288, -0.590056210600284, 
        -2.44292813507856, 0.120482384182316, -0.000779074365157423, -0.342907790842257, -0.822282234507583, -3.37945223240485, 
        0.0514242602203166, 0.354738484570054, 2.66425371072963, 0.280584891575329, 0.127456903583922, 0.417652912803275, 
        0.798345884546132, 0.74500802252863, -0.259536492999002, -0.478728932712216, 0.899653627956707, -0.0125183450018563, 
        0.260640015372484, 0.577426766357025, -0.255291496332027, 0.223631766937594, 0.973975409596776, -0.147240063346557, 
        -0.916246302867494, -0.0514297910063669, 0.121568988993741, -0.937814924934075, -0.0569530182827971, 0.086460360755956, 
        -0.751300785735063, 0.489828285840497, -1.67113706427423, -1.47056281741296, -1.66013875051022, 0.170463188672423, 
        0.542878758802571, -0.597718006530553, 0.976787538208565, -0.338383140209593, 0.176567061595937, -0.104943425265328, 
        1.89137407510294, -1.03528682983238, 1.0793841343936, 1.31050061791263, 2.7625152842797, -0.531969586413478, 2.23963048267288, 
        -2.04361186819257, 1.20330402706499, 0.119927061586876, -0.981800247923267, 0.292033775433028, -0.34208733591676, 
        0.116900956638444, -0.264694993631492, 1.11270651547348, -2.74613528039087, 1.03965058676957, -0.271651951985687, 
        -0.658813554336117, 0.769382683318035, 0.233935773737938, -0.192390383539485, 0.442836711093925, -0.0458723720990822, 
        0.519603274193936, -0.156937277752756, 0.180934685721762, -1.15767326210427, -0.956918343586939, 0.582069941682172, 
        0.859464598023731, -0.405551416277249, 0.249166338734664, -0.941730537723764, -0.0139643440431651, -0.87817068187207, 
        -0.582872247773336, 0.479429664239924, 0.107233068945023, 0.205568901620175, -0.808142861329506, -0.15164649133368, 
        -0.417594945056291, 0.668901569129394, -1.52303764051597, -0.913716749118635, 0.603493337444521, 0.39097730310198, 
        -0.0397987287130684, 1.52030821252213, 0.26990506388164, -0.391011953409084, 0.201183625094832, -0.749677578890007, 
        -0.38966544918558, -0.580150644665248, 0.981365879666171, -0.206358076333851, 0.441377495660791, -1.31006082213386, 
        0.321705779388, -0.138963082489887, 0.659766136991281, 0.394553249171164, 0.363470796270434, 0.215352051721681, 0.203348039621617, 
        0.8615485792414, 1.49944442385647, 0.0931653836745193, -1.80993522910935, 1.69147709280785, 0.853444706357548, -0.647723915727146, 
        -0.288261594295722, -0.28201632433276, -0.34002799242481, 0.590781186057957, -0.581319773876793, 0.356964442715287, 
        -0.0774566411832514, -0.384987333064061, -0.0170801993613136, 0.155432177243212, 0.227240624097837, 0.25271122247298, 
        -0.980341569203907, 0.208533852070487, -1.24313648990258, 0.452639297889757, 0.863174493964223, -0.40500634458562, 
        -0.113262385644357, -0.295023351496671, 0.427597162400942, 0.557753769203464, -0.028562761185151, 0.667650840335975, 
        -0.0724976650487006, -1.36018672892946, -0.146886396141756, -0.0361512357343589, 0.976722349546264, 0.30523609660496, 
        1.13831786851758, 0.829586057667641, 0.537849196904205, -0.442684167490457, 0.196469784909389, 0.377022894138157, 
        0.119604023444469, 0.168153845061181, 2.39349813728923, 2.78656337039128, 0.557933846962631, 0.598525337721914, 0.643487476980858, 
        -0.41385052752211, -0.520679939276354, 1.2933911679799, 1.78643499985336, 0.601876336182428, 1.2367189693009, -0.227955352330518, 
        -1.19576777937581, -0.410300400678178, -1.40552313371474, -0.0445022547382688, -1.78938479982872, 1.06849870846092, 
        -1.40766105894724, -0.0864210878470615, -0.223052856265694, 0.758587514861441, -0.0380575597537476, -0.645112087719371, 
        -0.587386403763797, -0.0872054769177972, 0.22596168917503, 0.798994029889464, 0.0584595197574015, 0.735289979678106, 
        0.46013782777152, -0.104482540985331, 0.0771752204195713, -1.22393584849554, -0.548782990296817, 1.50531348973065, 
        0.17631523076938, -0.309847940099918, 0.195151040971075, 0.236951992271873, 1.80804870192569, -0.588614389073654, 
        -0.0770769315283675, -0.475202955024664, -0.487943549239352, 0.856109633149645, 0.257105633010649, 0.564261088183005, 
        -0.459448591796743, 0.603428145673399, -1.6468211802299, -0.74419203155469, 1.04880193774322, -0.255374302706278, 
        -0.709143901005868, -0.119765792006131, -0.238558193192827, -0.412686382175401, 0.616327340753149, 0.708661108967112, 
        -0.0373804873594809, -0.0500864971873398, -0.246372614691996, -0.260378041098853, 3.70149520471174, -0.357548518022491, 
        0.536755884604774, -0.0345162581816556, -0.783385718879055, 0.327528248351571, -0.62321436749874, 0.336440655511271, 
        0.320412411195742, -1.4576203447627, 1.65256974694898, -0.0363452804834476, -0.120038951262232, 1.72706587693045, 
        -4.98562789137691, 0.310020914058929, -0.23368465308326, -0.897224088679365, -3.43174053855134, -2.60296600794477, 
        -0.288053172861479, -0.178051172770662, -0.496667975236867, -0.21198537372815, -1.12690171275584, -0.20613115210384, 
        0.771620723120812, -0.564912175121979, -0.0614483797422726, 0.18456471410012, -0.958086157026557, 0.316927161193286, 
        0.21377750140176, 0.303599722162466, 0.537028745277667, 0.691852691471851, -0.995842474126502, -0.176535683510659, 
        -0.025205059070818, -0.578021590027275, -1.19894724279706, 0.207210713622019, -0.171794092231501, -0.356318598896686, 
        -2.4725796142699, 0.0765062897041924, 0.0926644980803327, 0.0309161108605784, 0.255737213503051, 0.312497112202479, 
        0.0936932180185464, -1.3774969177162, -1.49248259780171, -0.445187569449087, -0.28377869875451, -2.24291493389378, 
        -0.399943878322514, 0.585969403667803, 0.519740047721361, 0.144445057879793, 0.710103490574596, -1.95792646190748, 
        5.06335532225547, 0.0346687292283391, -0.867050352454849, 0.820886785474499, -2.58264698066753, 0.0181289395987097, 
        -0.740190311375007, -2.35796476151243, 1.41318342616454, 2.43391590607161, 0.550661522084099, -1.4855452754644, 0.546679673485925, 
        0.333041797987184, -0.575080820672752, -1.36611129166831, 1.79961106090449, 0.2546124585775, -0.502384114168509, 
        -0.516157340086756, 1.11596123999528, 0.816246346028062, -0.271769749085072, -2.92681674422478, 0.145087108576635, 
        -0.370893353494306, 1.77816083592082, -0.0592278634664917, 0.941494392882825, 1.69951589991787, 1.02112939180488, 
        1.32036616650251, 0.289688282259888, -1.66549571386941, -0.487929937453644, 2.64216302928057, -1.08436990900908, 
        -0.235548247689008, -0.167706163368764, 0.885466991109634, -0.059746072720599, -0.19971882465318, -0.384921114108878, 
        -0.881061012644182, -1.9916947816396, 0.903685532462517, 0.256009515084229, 3.15747146157346, -0.00791474713296542, 
        0.357499682337412, 0.765867068945446, -0.332913969888373, -0.325734533138141, -0.746074045732839, -0.279296188461836, 
        -0.0559368143012619, 0.0370812017706989, -0.198688950497294, 2.88953493804763, 1.44382826142246, -0.189228953701039, 
        0.0868846096686396, -0.360175968363728, -2.63700619463582, 0.169486125209416, -0.0969306801241295, 1.12941662796783, 
        -2.41854071466141, 2.20157529236227, 1.2729639905723, 1.06535694576475, 0.684415918394838, 2.00178509859464, -0.194424005675443, 
        -0.915691910466171, -1.30105585466679, -0.0289246389655493, 1.45648600448187, 0.334255949581834, -0.0283797572640109, 
        1.21789431771537, -0.057319762048565, -0.851506272695767, 0.139929897207967, -0.631999732606209, 0.783447433060531, 
        0.72477380722419, 0.445817299012851, -1.30237696696157, -0.255071502233676, -0.468863614283642, 0.0139761537902202, 
        -0.175450289192972, -0.388062072432749, 0.377141954375389, -1.01774340969566, 1.73033254481545, -0.0946906166140795, 
        0.625103046728497, 2.1529349157798, -0.518017625989224, 0.0979454231246738, 1.02922021377482, -1.1343370420409, 0.633432170961103, 
        -0.864577458558368, -1.40151587062733, 0.485364815386637, -0.661208932275652, 0.730789409460844, -0.259255371543801, 
        -0.0714959319241839, -1.6685708032081, -1.01061875223392, -0.442508923528527, 0.402117917777689, -0.646769337536754, 
        0.730490669964421, 0.283334619472992, -1.57281390364178, 0.0281242927028407, 0.276311194880152, -0.310845776287309, 
        -0.32793876787569, -0.186193681140849, -0.157335211468026, 1.83967459596184, 1.16139574815591, -1.03675566067388, 
        -0.329082632027187, -0.557480545005883, -0.0580205166490936, -1.41563713450767, 1.30213774671778, -0.0568304464709742, 
        2.4434171807669, 0.63408623727435, -0.352055017026432, 4.54049433707352, -0.593031412383366, 0.169601442279664, 0.0854204580254441, 
        1.30036017572296, 1.19859927446449, 0.315420425847001, -0.208364581529959, -0.00740219436914063, -0.399641122551534, 
        0.331294521027552, 0.783967490460817, 0.251452460744087, -0.949771798829975, -0.958008888023802, -1.93262960996406, 
        0.289987088556987, 0.150733250525819, 0.333474711646569, -0.935640852193536, -0.467809750775874, -0.147083137787933, 
        0.49194320684278, -0.24635146256373, 1.15841547261396, -0.504267046264657, -0.0657976184040982, -1.02662996978895, 
        -0.0953340778186514, 0.0162814915500505, 0.322557009746542, -0.716922977104204, 1.12854184641939, -0.73308986347791, 
        0.0573506701765026, -0.589103308321449, -0.63711567749629, 0.262181353939941, -3.35158262882702, -0.45027773225944, 
        -1.62918281347788, -0.176964933000254, 0.466717785858507, 3.00491594898673, 0.160260930915781, 1.34711640115036, 
        0.180123891321162, 0.322256903085462, 1.68858522472084, 3.04153129061713, -0.689651401086797, 0.591356268108599, 
        -1.09380849026721, 0.889849275127368, 0.0614192733921088, -0.360116765871005, -0.424320227148518, 1.44065013221238, 
        0.559045764372833, 0.177541984271735, -1.0616170999817, -0.0284453541353372, 0.178920905019372, 0.415526987568804, 
        0.706504105364204, -3.54443008470146, -0.383627883831164, 0.341427318174026, 0.637086163741539, -0.0620602788842104, 
        -0.546171294315844, -0.896154324614451, 0.667607047784739, 0.361419097233819, -2.41823673578488, 0.457312692576426, 
        -0.0706895190031273, 0.624903199328601, 1.25491777029659, 0.691130355629098, 0.191709265442858, 0.114888064721343, 
        0.255561186771659, 1.43167870925733, 0.470328612725373, -0.311954467247362, 1.05822164090651, -1.54242303607336, 
        -0.783617236786281, -0.143840627620392, -1.21261594255536, 0.227738151180895, 0.633204771370607, -0.376327786580546, 
        -0.287696758560904, -0.361198058086803, -0.0622543274012005, 0.512232650578113, 1.72419474824091, -0.404848990314521, 
        -0.347676832456342, 0.394068167297388, 0.256238051286597, -1.32132276430354, -0.614728391633664, 0.46219516790039, 
        0.141815324694018, 1.22996831111784, -0.6727225403932, -0.508085332854557, -1.05732617626213, -0.225038255895617, 
        0.139929650984039, 0.653622269640282, 2.00176546190029, 1.49233866539046, -0.694976969226149, -0.324691517175508, 
        -0.397594629638527, 0.0283919884111576, -0.700571345505405, 0.297111564192076, 0.288200948989769, -0.0731487765648217, 
        0.122101972654573, -1.24444625587489, 0.576146954060756, -0.651715803553838, 1.55832221027513, -0.745880673357693, 
        -0.902576603438624, 0.792010643372879, -0.265647107402966, 0.24061909670603, 1.33457512563845, 0.0784337987438193, 
        0.969278364601191, 0.918869660354614, -0.10989957492685, -0.962697390380029, -2.43842402255039, -0.140083497517816, 
        0.592948967220778, 0.254067702328691, -0.810702193143927, -0.165429925556344, -0.0131221457081438, 1.57142931381374, 
        -0.290274502755911, -0.516816832240286, 1.30664006273653, -1.75937881991508, 0.3703110951114, 0.1718370948586, 0.805802024704667, 
        0.230618417746564, 0.323564927963545, -1.73586902332447, -1.72480727080053, -1.29361143267858, 0.0934855157258746, 
        -0.267698497911479, 5.39051818504046, -2.27043748208333, 0.0735754476554064, 0.0799530107365726, -0.900951978088698, 
        -0.445457839737158, 0.79491118817031, 0.0329127661758415, 0.590685074277707, -0.523949793694561, 0.114784805233854, 
        0.381703931004291, -1.08430305303272, -0.506062932792374, 0.268334352926984, 0.69014949715231, -0.263949346404889, 
        -0.322026656896406, -0.117947315781747, -0.521286748341606, 1.50171358212332, 0.203273952562995, 1.11178651035658, 
        -0.043296470317024, -0.26928002613317, 0.69370284726332, -0.374458807961661, 0.532226348965874, 0.0378994324404378, 
        0.284723810880775, 0.327607408681439, 0.394352840577222, -0.855699257846774, -0.78550399577761, 0.518232863787395, 
        0.347237162788849, 1.20075884210369, -2.23228023034326, -0.0121167138432444, 0.0390049654939614, -0.921309009969492, 
        2.59023106371269, -0.00363128461934337, -0.53378290898559, -2.07614187211654, -0.0910144930836132, 0.71414998513398, 
        -0.454332726652788, -0.34113698532752, -0.269651470918908, -0.175306705087536, 0.0857697004007916, -0.519213205899117, 
        2.07147875533401, 0.715926711893914, -0.508510884939931, 0.199307310948672, -0.130761264281363, 1.06211422350606, 
        -0.77125926845526, -0.208038495220854, -0.207091826953917, -0.821483011257147, 0.771348013913155, -0.825543169297983, 
        0.0706843534940784, -0.729078678757955, -1.03636848591121, 1.56258250065049, -0.35109648813308, -1.03347444027234, 
        3.12215882991573, -0.165845013379103, -0.101816757028008, -1.51183834142817, 0.00392839513858957, 0.506814855860756, 
        0.121025330092273, 1.33370891043696, 1.36198531671371, 0.0795279533044675, 0.123410939511849, -1.21783730224896, 
        0.20396452519678, 1.3792018262271, -0.0453287831204129, 0.722140014770192, -0.108389926838206, 0.10429289129274, 
        0.567963006237038, -1.26449968943198, -0.511674906728668, -0.176140129711608, -0.386533074001554, -0.911499204538036, 
        -1.47014106446633, -0.201984847551009, 0.764065928347388, -1.05347356506685, 0.0309910666793576, 0.987390285857121, 
        -0.11910164914456, 1.4476126941218, 0.0286826969573061, 0.280632403592765, -0.556688001725544, 0.0976754916577522, 
        0.182697336073661, 0.700628293583279, 0.485252818039253, -0.146155534411637, -0.0593283991890752, -0.0855121653756883, 
        -0.461958365173487, -2.84019436006578, -0.103500140353114, 0.504233911032238, -0.26994406751216, -1.42549277020327, 
        -1.28285501429792, 0.215634223059771, -0.12359041857351, -0.0814973095993734, 0.174089091524407, -0.166912068339797, 
        -1.10488215324496, -0.624962343577077, 0.374521444763993, -0.167137609626341, 0.21736690099498, 0.298453702065146, 
        1.20936407084837, 0.371245320179859, 0.399758595037957, 1.41579752254024, -0.938333393073942, 0.10047961170978, 0.615700708074632, 
        0.400873283362845, -0.066095531759571, -1.21490683055491, 0.0808202853841845, -0.296773250780534, 1.90852101202323, 
        1.07332148935941, 0.941282558212397, -0.194567025920694, -2.82928840993496, 1.11458844996774, -0.511350136400054, 
        0.314694161560901, 0.540279298973601, -0.0115524788357054, 0.0276913685067432, -0.0845546433915906, 0.960172235708484, 
        0.507790302304644, 0.357568767936839, 0.183952949275118, 0.764285235359063, 0.393331256287057, 1.09724997801148, 
        -0.00436511123396409, -0.3429843689549, -1.41242772263403, 0.238202867930284, 0.633939149732271, -0.0844311836636254, 
        2.72702039797758, 0.276601125301029, 1.23399321661262, -0.357025085115577, -0.643118271440913, 0.263030559595331, 
        1.5129375131399, -1.00570149258904, -0.823464789001355, -0.50271361250921, 0.0271255684562847, -0.673841086929661, 
        0.567516432059652, -0.664403248481226, -0.203753002203126, -0.739527384973265, 0.463116381117188, 1.20058548684741, 
        -0.869959592015418, -0.252617539906908, 0.11299588451959, -1.73580391171188, -0.294031527162094, 0.0857987758456151, 
        -1.54550177906338, 0.0752595493487085, 0.776801588534507, 1.13817055335685, 0.115351913423042, -0.122988596479634, 
        1.5711720415479, 2.09389564199587, -0.341790051733013, -0.158323669358563, 0.35785466779099, -0.524916151288865, 
        0.431739200573177, 0.461347395896395, 1.31907769651377, -2.84058321742685, 0.743662761967802, -0.0239783381664159, 
        0.198334829294486, 2.10343548916622, 0.660159898533305, 0.3701346723548, 3.00355427546029, 0.196865339338836, -2.26944717055315, 
        -0.160576724634667, 1.49371937794348, -0.376377160296488, 0.120800495423986, 0.507177950007688, 0.825127436490319, 
        1.16755571816585, -0.366588860953029, -0.619487421166617, 0.449653477505443, -0.1694362733771, 0.210370070405006, 
        -1.42115201885993, 0.457405232238505, -0.336176660493817, -0.21488225174976, -1.10620858799011, -0.415618863747291, 
        -0.323500245392698, -0.00420522123148399, 0.168118303241645, -0.635919391247401, 0.493244864438316, 1.38816994855708, 
        -2.0430500474689, -2.22125154858958, 0.0694615414128722, -0.660983863494793, 1.26507082097941, 0.0424564426974703, 
        -0.162170899874361, -0.919907641744484, -1.2329322724343, -0.469458990873147, -0.237443745236686, -0.0264662699267365, 
        -0.0377658186098107, -0.303512017534165, -0.438880809959794, -0.447096571439718, 1.13352067865867, -0.315091952407498, 
        -0.203930784998186, -0.266270919285781, -1.31923871459724, -1.74837698350834, -0.291508256257113, 0.0731567412945617, 
        -0.0322542505346221, 0.564484655805393, -1.91564739346445, 2.72562490521024, -0.370380369383828, 0.547726709930704, 
        -0.326559756907456, -2.0649037995511, -0.160222430652823, 0.140315376444693, -0.112053773611035, 0.83216886198396, 
        0.236836858620269, -0.159133606334214, 0.863252491374454, -0.832837788446111, -0.304074333143946, -0.715738243021998, 
        -0.176712077921697, -0.278116282822718, 0.383339835475556, -2.85896214097344, 0.491885652939987, 0.569730725406015, 
        0.269685879210905, -1.62476150918259, -1.18493388981923, 0.000966956706139218, 0.866451824400601, 0.599303161293066, 
        1.52102056240983, -0.891940023036265, -0.0263670250068125, -0.428339912690254, -0.582105559720431, -0.725808796517211, 
        -0.214915058132242, -1.73126504120458, -0.174537447103429, -0.358811408496177, -0.508842337010472, -0.0780499960067108, 
        0.320081722345497, 0.229567055720109, 1.10742735006007, 0.313459632952812, -0.0622372212324267, 0.0286394685220093, 
        0.260971224735146, -0.855995275578745, 0.798909774933827, 0.926374668010292, -1.67917508204874, 2.0319545787654, 
        0.236414791833476, 2.36526208266867, -0.132625167647021, 0.591240473703202, -0.818102418464989, -0.118437440928245, 
        -0.0747422288224424, 0.938764895143175, -2.73032226751834, -0.524460217197638, -0.144870569958015, -1.91344606620091, 
        3.29934591574748))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("icasamp", {
    nobs <- 1000
    expect_equal(ica:::icasamp(dname = "a", query = "rnd", nsamp = nobs), c(-0.775715835430631, -1.2775287929172, -0.141765976340032, 
        -2.35979229184609, 1.65351412098475, 2.4295407705308, 0.613495846601041, 0.618364667327073, -0.897259749412917, -4.88667279674556, 
        -2.4164436243985, 1.26571278542902, -0.249652227778084, 0.762331086108041, 0.660482234636367, -0.089521108401685, 
        -1.22800152745043, 1.06751161955367, 3.37429522953821, 0.887862526693381, -0.0906270782048126, -0.035728337287072, 
        0.710935083123212, -1.46778376792385, 0.136907806675384, 0.62091045019463, 7.91141600691362, 0.30368733114728, 0.0444289618002437, 
        3.32787616040896, -1.74428915152676, -0.557008856529529, -0.895116661525877, -1.57025835080967, 0.579216375384523, 
        -1.36990259649637, 1.10328364530803, -0.253545523368784, 0.954944438901118, 0.426188707799486, 2.06027106522071, 
        2.12782110333996, 0.119065554512732, 0.0290608788319311, -1.29756355895898, -0.929888750773648, 0.109983242962481, 
        -0.115345948647289, -0.544580559317922, -0.190127200992388, 0.795967493418414, 0.294095133837338, 5.13793989968555, 
        0.803646020171445, 0.989188081305736, -0.518339568108193, -2.41609581851944, 2.99267806044055, 0.69683235535794, 
        0.820600659944642, -0.0247586589446309, -0.30644711738822, -0.3005629517525, -3.47363186396078, -1.31714798654396, 
        -0.465329168135558, -0.019321167476781, 5.99328176823824, -0.0202127554440068, -2.00872529353283, -0.57321111261463, 
        -0.168506642189968, -1.41785208826196, -1.20204134509203, -0.525412581769005, 1.23078375903351, 0.634668498811343, 
        2.34977229425361, 1.88108474718876, -2.2068700664465, 6.41947266295953, -0.25537575253832, -0.666066864025529, -0.0111493020889124, 
        -0.0624473920921399, 0.184660267141072, -1.25469184323493, 0.0833547811941259, 0.356425869999062, -0.537031996487917, 
        1.00405278686629, -0.432467457799344, -1.34543673669668, 1.92487879769632, -0.0999020276056496, -1.26894057625033, 
        0.839614971506371, -0.150322122112936, -0.831063771443331, 0.01523773104747, 1.00633018649623, -0.125472715663335, 
        -1.77088586568877, -3.2206162348834, -0.0732226425298708, -0.50701694757495, -0.502959335632232, 0.0752058492991079, 
        0.181764183365339, -0.856645671029788, 0.67830426170005, 1.78504380617788, -0.247484075129195, 0.937057853090731, 
        1.9720542270783, 0.214571138634223, 0.365451861097102, 1.7089419746653, -0.349147325472906, 0.930529100773719, 4.51244482630887, 
        -1.46438907337376, 1.56468816678662, 0.490413745987005, 1.11727467597329, 0.43312514243896, 0.297182967687439, -2.04567259534797, 
        -1.36525724582638, -0.66750686608933, -0.494471225387214, -0.937443773340039, 0.512359886621697, -8.61233265110554, 
        0.701519382094138, 0.890784222210357, -0.216084931868773, -0.810581603263309, -0.255686355551486, -2.63293863693622, 
        -1.00076992845391, -3.08952377816882, -0.0126013606560724, -0.200010642687375, 0.933247328715816, -0.0687963278306192, 
        2.80205972983831, -0.954410149497136, -0.78877949484659, 0.422894979793832, 0.758301629451054, 0.531656326552183, 
        0.852370621436191, 0.557516301464733, 0.657199665782818, 1.41166493172007, 0.329957412099599, 2.43177704578343, 0.574078709257496, 
        -0.477481852761058, -0.196209326570575, 0.739107138560427, 0.282923082403498, 0.833982110290041, -4.2360775640337, 
        0.789198907162127, 1.64763414665775, 2.04515634503187, 0.693180429299164, -1.0183718879898, -0.671189898925613, 2.50575510026244, 
        -2.08618437980059, 0.231139243005281, 0.109541243543912, 0.654531065278546, -0.387929320204823, -0.492631098002705, 
        0.294376566615167, -1.36744130834608, 0.205757771703787, 0.34946711439658, -1.46509816984615, -0.0928957934065024, 
        -0.0539871348199345, 0.627362364961843, 0.18368424380576, 0.363993946923156, 0.303976163393067, -1.40259888701069, 
        0.693831168545815, -1.4007126796288, -1.63518427401623, 1.70170952087804, 1.21002577583418, -0.829173680145073, -1.30138647914267, 
        -1.02322225502476, 2.64136724447556, 0.736708865218641, -0.791353294679963, 0.775402824728238, 1.55782140914841, 
        1.33532957047541, -0.352591052448298, -1.40360025641509, 4.46688124924379, 1.0315900737886, 1.15980940453209, 0.708399497152266, 
        -1.18089467092999, 2.04649562237003, 0.0379738873830391, -0.862572838677837, 0.768031881084295, -0.272106093912267, 
        -0.634016773119467, -0.964603814554227, 0.273241430557287, 1.55916694202564, 1.48204762769003, -0.0340606839911366, 
        -1.16790968930618, 3.70759960472186, 0.766363589238928, 1.91986325447141, 0.606466426417071, -2.1292532327705, -0.784863246967977, 
        0.951862243467717, -0.728938609832385, 0.083877580159426, 1.03391811614065, 0.953344708217902, -0.686309512743572, 
        0.0444890050653388, 1.6960939564133, 0.53621992565563, -2.82885246931848, 2.44283438080612, 0.578948608696817, -0.148159685535719, 
        1.67045611180913, -0.448659030725375, 0.420645877686608, -2.22973403664142, 1.79308077965525, -0.486260702069484, 
        3.27659221730619, 1.08518929032764, -0.416892425757096, 1.0990907785297, 3.44233029712522, 0.201733716043276, 1.45434878747291, 
        -0.75926320802781, -0.26980479932589, -0.296572582864968, 0.217061141754285, -0.569945394644635, -1.03052778273819, 
        1.78609833812402, 1.1963662472741, -0.0618469327411894, 0.610755594854689, 0.288932056471076, 3.3909641895773, -2.76661638757164, 
        -2.95846609864011, -1.74978331013239, 0.723547772752291, -0.328370115887024, -0.0528362590211009, 0.231060846842517, 
        0.176629602560723, -0.00577767256032946, -0.321787657818065, -0.973216927654958, -0.611080607033355, -4.54954986939708, 
        0.446378051360666, 1.32660318135568, -3.25911369298513, 0.650312248225515, -4.78095576771544, 0.183427298424469, 
        -0.413891647298155, -1.6161920666334, 1.51641315039091, 0.300519683490179, -0.563223280612477, 0.649166151451321, 
        1.20867113984282, -1.21390434393244, -0.355853230935424, 1.05599757045721, -1.84894678398383, -0.360141333033977, 
        0.172650699985604, 0.583386816081085, 4.26601745759025, 0.163448407209773, -1.07580639881878, 1.03041152666658, -3.45521059059324, 
        2.95058120866996, 1.51126567967588, -0.400412829509795, 1.36611372451492, 0.107148355918159, -1.11815825531723, 1.88115916046539, 
        0.662526614215255, -1.43637052508434, 1.39078010476706, -0.130408311530694, -1.31193117542413, -0.291625628295962, 
        0.386547810021124, -0.19334658392108, -0.946994178295654, -0.714282041010035, 0.868527269824286, 1.53108325601905, 
        0.60507097281826, 0.278303697030433, 1.03672074744343, -0.0932181297779295, -0.264665344379101, -1.21063094828099, 
        -0.106496476545971, 2.50681912193745, 0.702917480598131, -0.581411545518704, 0.377458675467875, -0.231575051212551, 
        -1.66291748588487, -0.42306190283636, 0.145449765344383, 0.717754235451815, 1.09403436246332, -0.46947749235857, 
        0.119742898716672, 0.329310140542173, 1.31726629502965, 0.840522524209563, 2.61180796355622, 0.0545998615647029, 
        0.10859564549366, 0.785926337830781, -0.559691496920361, 0.999400573250745, -0.586432688982783, -0.783509284601458, 
        0.0833082958643031, -1.62564520667351, -1.91819939869222, 1.35461500988467, 0.604974325222875, 1.7879508779198, -1.42105440712652, 
        -0.0717772907077877, -2.24011367257857, -0.337037524992534, -0.0235795205642965, -1.36051470301569, 2.20411107570945, 
        -0.228212002983758, 8.87957701072987, 0.182866100700653, 0.387607417947045, 0.18658378060809, -0.218791914488215, 
        2.79483998529728, 0.153234083395306, 1.43255133568228, 2.19985111552409, 0.709848656453728, 0.51057901875613, 4.5654586326608, 
        -1.27978202649718, 3.77750617439718, -2.13699347638249, -0.142234386519041, -0.388644799333789, -1.1786958605094, 
        1.05970165757584, -0.847478342336204, 0.542198945787239, -1.6363947627423, -0.458221761585922, 0.36525653727749, 
        -1.55809168084206, -2.26197950579976, -1.33805516187207, 0.82455510681299, -0.049741157181964, -0.205707112071092, 
        1.84414062883701, 0.937470133073775, -1.1584204652598, -1.49605706508022, -0.517643097685525, 5.47845716807333, -0.715984508053852, 
        0.486661342464128, -3.62052586835506, 1.46907088008719, 1.31488380779972, -0.0787570893187148, -0.245945830942429, 
        1.61769555432267, -1.37865075497318, 2.26872472249701, -0.526171068166663, -3.00815555493539, -1.58613882526469, 
        -0.552486914287861, 0.805298959844934, 0.672508200565745, 1.61927764669244, -0.356458652140884, -2.49469955196729, 
        0.0689813700007846, -3.05915698666274, -2.10519565106924, 2.62290277720279, 3.49928324076067, -1.08205625736399, 
        -0.0884892573285354, -0.708859970162313, -0.96949029935429, -0.884328494247533, 0.476669264932528, -0.291879100600559, 
        0.641508146377883, 0.78758212955851, -2.95132361431504, -0.832509309181981, 1.22199502296914, -0.497892992952223, 
        -0.0874550542839088, -7.64257438006788, 0.327460866119398, -0.46136054071061, -1.61703286365349, -0.256123551760186, 
        0.0801403793455379, 1.56369250441587, -3.89159889129936, 0.312231066083864, 1.18604500553649, 0.773505664084781, 
        -1.30416969196835, -0.145885854569861, -0.0321213191331233, -0.633826678556228, 2.86947209327298, 0.979052245019033, 
        0.394814473358724, 0.310697557547108, 0.626967355758559, 0.287334237235207, -2.74360515856596, 0.338945862392154, 
        -0.459189261382903, -0.595526315287285, -0.956148650767076, 0.1520730788035, -1.17109102490911, 3.22731661891236, 
        0.590543998788987, -2.13447025320091, 1.2220022134796, -0.575160831715483, -0.137328604155341, -0.41703992356357, 
        0.105412260653294, -2.9643662440015, -3.39587211034279, 1.75588192270978, 0.121727298270989, -1.09453881193214, -0.566316606348368, 
        2.96064540683853, 0.392902656525584, -1.41793018389731, -1.15645223007865, -0.995590899273506, 0.0154392401587732, 
        -0.0666606396154419, -0.798181334109142, -2.90205721113844, 2.31055166212065, 0.561325902827959, -1.37210114275583, 
        -0.27800027078205, -0.996773277528675, -0.154753925552285, -1.17162213961849, 3.65306417520069, 0.878859942800223, 
        2.06355409521669, 0.239788429505004, 1.45412522399112, -0.00393578980558096, -0.193559199868406, -2.46127418309235, 
        -0.860212907812407, 1.12390190166068, -1.22117578346143, 1.29985710251024, -1.51735056529648, -1.56414853881057, 
        0.908050085319144, -0.239005132786794, -0.645283962336427, 0.795900020943739, -1.02058836967563, 0.332603073791661, 
        0.661234232545, 0.0255556072311057, -0.223970155212808, 0.942878303808127, 1.93949405385647, -0.168607909930102, 
        1.36745204687926, 0.489542711468698, -2.78763926826707, -1.99695777491749, -0.851956484195306, 0.54714724003816, 
        11.7221298603294, -0.887274868869364, -1.59403992527256, -0.602122431513579, -0.246441367998505, -0.267492429866751, 
        0.771578936238201, -0.779138621972948, 0.465178325950125, 0.577097180071746, -1.94668476633016, -1.18919980318825, 
        -1.06243907858386, 0.576531309207774, 1.89739922267279, 0.630047703270046, 0.339588537148638, -0.692307707597675, 
        -0.7187554654306, 1.82671491018986, 2.10977448107026, 2.4549914967993, 0.181625626118671, 0.807817002041429, -0.338912874433515, 
        0.327145356718306, -0.00895796652872929, 0.33673747741349, -0.251943126095275, -0.173562625201676, -5.78460630977211, 
        -0.388525796961941, -5.92752291474289, -0.185810571691952, 1.7790711366192, -0.0199054566595103, -0.145107541048115, 
        -0.350530274360288, 0.364081801135393, -2.47945777477456, 1.57826712417996, 1.99420949472411, 0.172582771274632, 
        -0.561356268145045, 0.0372072625429725, -1.5111339131437, -1.89873604109964, 0.0509909488604508, -1.36747445853433, 
        1.74830031657922, 1.8583168770856, -0.0712686807383086, -0.519940791056017, 0.89325670798411, -1.47570774300565, 
        -8.1320492705175, -2.47078281734484, -1.28184470892178, 0.692385023567434, 1.18697262466821, 0.117210873622369, 1.04018141879747, 
        0.346892283026784, -1.80345713719455, -0.378080704361909, 0.965545674697799, 0.821511480475663, 0.272693631605232, 
        0.726589304988373, 0.160445479774987, 1.14594626675883, 0.234732070923634, -3.6114849822984, -0.267363861613827, 
        -3.43744243959128, 3.10678311844011, -0.283819819351105, 2.48126272938279, -0.207682720872297, 1.1477227501308, 1.90087289447215, 
        -0.965840070913402, 0.623087716637145, -0.963322091919348, -0.815428346317268, 0.238408542756738, -0.254412188464767, 
        -0.754579878641955, -0.447436273545333, 0.470244938979905, -0.814268547462228, -0.424165682576502, -0.758616246163034, 
        0.331991070096549, -1.4719693180701, 1.2075831699546, -1.47229625366091, 0.511546942797237, -0.573537102856726, -1.00816372054867, 
        0.216786507422355, 0.583035453670619, 0.0970520499469829, 0.316029192175674, -0.652561590228559, -3.76218356613103, 
        0.411067931455904, -1.52517053069739, 2.18059957123367, -0.236218181054066, 0.491660968160068, -0.101777368782708, 
        -0.439772281163445, 2.81063585312548, -0.26489410829908, 0.552111967509858, -0.3461496437773, -1.83267713441246, 
        -2.24613559008006, -0.625861131950314, -0.946752769803973, -0.0730167662811993, 0.634950680803584, 0.656594094503553, 
        2.37669622640517, -2.83565527152054, -0.733652041713774, -1.17104629250721, 0.17529195534427, -0.210386187091992, 
        -0.536986870282393, 0.586781542269951, 0.197673555036161, 0.659516106451108, -0.633209582264311, -0.439554456554459, 
        -0.095534045393504, -0.869205919863171, 0.341321949374367, 2.46014111185146, 2.24754000999625, 0.00587157521921994, 
        2.4126215937631, -0.0358090243376295, -1.36549636304925, 4.00009083422665, 1.09148296839756, -1.07352861210687, -1.12595060288291, 
        -1.02203805614525, -1.21755305648876, -0.546220759148395, 1.41390486416917, 2.48364025186428, -0.427540513267093, 
        0.0783383672818492, 3.1161470166136, 3.48007510567155, 0.778168362811113, 0.352419464945143, -0.619677449437545, 
        -2.11733612235314, 0.824463609418502, 1.35327598584893, 4.32762758787288, 7.11328208080426, -1.63404481551271, -2.59929656153344, 
        1.63247274838007, 0.93665068624228, 1.32575462811983, -0.567469611299123, -0.145955591292379, 1.13063479578839, -1.02013295148519, 
        -0.84028885187039, -0.107672687103051, 1.35243742407938, -1.36337787739996, 0.279104911884136, -1.89854054031912, 
        -0.141595057449314, 0.220075097552101, 1.45788382276498, 0.110898782778567, 0.212720098103475, 0.987397261884495, 
        -0.930912585986038, -1.31995913357383, -0.615291873032698, -0.169755033237335, 1.47696903087642, 0.577412952521354, 
        0.124957901555163, -0.474728620835077, 0.695887674452102, -2.18728347006694, -1.08476560055802, 0.302345843509977, 
        1.81057350891255, -0.587773020435101, 0.178045570490426, -5.16287257614632, -1.28206826658095, 0.843245835555111, 
        2.27046074795547, 0.877019050126217, -2.50657879784338, -0.280448877971923, -1.04808114397616, -0.159770081226164, 
        0.937488155333341, 0.589552692375972, -0.0923889717771143, 0.498966876213087, -0.0138712462989639, -0.042709780666948, 
        -3.05006112249826, -0.609825393547691, -0.770201848057235, -0.0328823537289404, 1.58081098108725, -1.45729842560729, 
        1.21340218698602, 0.784117117920149, -0.0403164274343006, 0.555185641871972, 0.578803253154366, -0.0121749643384286, 
        -0.0663043944314928, 0.23929333366335, 2.69220929121329, 1.2521641957014, -2.20606498808928, 0.286488066682385, -0.865227324337251, 
        -1.0360308800937, 0.325791645647469, 1.76982400339059, -0.85159431222501, -2.54979773409594, 0.449824231896937, -1.80638515541885, 
        0.338570503153016, -1.20271953020139, 0.157003347385819, -0.140152606401749, -1.60314804967804, 0.625731807588174, 
        -0.245424268273095, -0.235955980061447, -1.19370912646661, -0.132271129094984, -0.807758633931605, 0.287449575843886, 
        -0.75049388249362, -0.0609479757948404, 1.21459728314809, 0.239702821226558, 0.0279903673976379, 0.867264868582421, 
        0.0220911466242717, 1.55363106873325, -2.83453820316389, -7.12893525604627, 0.618407514741825, 1.42242882784086, 
        0.0908379935366877, 0.207921511450876, -0.786096825225759, -3.59905066843731, 0.652712679860717, -0.172479380584683, 
        1.09353475040822, 1.68221023588727, 1.00724751382696, 1.51957796936523, 1.77654401883978, 0.989920774885199, -0.359259224860883, 
        0.158705886372719, -0.4545506759725, 1.01522199012476, 6.01547001336439, 0.65878377672854, -0.60551390131845, -1.33389723303122, 
        0.104013362656834, 0.419516627092937, -2.81853095943027, 2.19148035682038, -1.70457773112361, -1.07604775086695, 
        -1.4403188845675, 0.158299852461868, -0.638640519647117, -2.40285694703048, -1.33309053649133, 0.240974191816618, 
        0.645362460502895, 0.539999227396794, -0.542281125874495, -0.72434749149948, 0.260577420091341, -5.07141875321574, 
        0.488537888171765, 0.66166679335721, -1.46005149976052, -1.38248019438455, 1.03200845787578, -0.770054388669691, 
        -0.104422507400546, 1.83877582894697, 0.713338749890658, -2.03164295522348, 0.231498893960001, -0.973633830045735, 
        0.792567380333945, -0.225252760570523, 2.51106946700308, 0.595436114746986, -2.12489842223911, 2.62770279514884, 
        3.8138034407466, -0.492960446066061, 0.172187624105371, -3.51460390773965, -0.605557221405359, 1.55030813537833, 
        -0.296452879961079, 0.205549246004363, 1.93769020302811, -1.61991615391923, -0.781359100907746, 9.16609560559965, 
        -0.239920919814398, 0.423361141234176, 0.418429583564903, 1.00864006087944, 0.151391698758876, -0.664594989206843, 
        0.113764254055715, -0.895971096296366, 0.346841923711989, -4.48333592876188, -0.544610648600303, -0.491425423299915, 
        -1.26667826141664, 1.51100929785536, 0.266332915196897, 0.81097925857817, -0.142084616195844, 0.297254769789824, 
        0.504569043483253, 0.486271722678178, 1.94491627428244, -0.171896238472354, -0.12129157058412, 0.780887546330438, 
        -0.0604191666619151, -2.43136958776793, -0.231628233207538, -0.906331204334237, -0.0696051585127547, 0.418358027427644, 
        -3.34372162307744, -1.45892359621595, 0.597534357176938, -0.990570802758856, 0.412861555219658, 0.78399342942155, 
        -2.97165553388241, 0.0682756367270886, -3.42196995078361, 2.52400162745226, 0.220712574654797, -0.276644936254881, 
        -0.0459968515564299, -0.224518084014504, -1.90196130175708, -1.56211522393598, -1.38775219846261, 0.00468587295496536, 
        0.00478562371969118, -1.89182481880722, 0.269149122852938, 1.94322723250693, -0.451500501954367, 1.01670254059542, 
        -0.555883072115045, -2.79959580033556, -0.345785945810609, 0.737342443527123, -0.737642621778737, 2.93277802894386, 
        -1.67547867645589, -2.13053528928521, -0.645893669519222, -1.17713665686728, -0.41061392292367, 1.16584156235412, 
        -0.502419798240771, 2.71316844630178, -0.488156812405349, -0.537372779631971, -0.603170664428443, 0.522202097569571, 
        3.58713979408063, -0.120395686293748, -0.408495433907479, -1.07738655129418, 0.0114628603106228, -0.613086519725568, 
        -0.281392291516532, 0.0159936390256611, -1.59302463853553, -1.65553453200366, -0.186537202279453, -1.98329778405926, 
        0.0143265056837906, -2.31751692115275, 0.538369567295398, -0.81154875348363, -0.914088565528959, -0.707497015775742, 
        0.831611500936011, -0.513670525885991, 0.186320302635446, 0.0170472923595094, -0.341339533750572, 0.326073411957214, 
        -0.698554971041, -0.488582111489287, -0.417860936227897, 0.97468404019706, -0.468857795394688, 0.533960480249372, 
        -0.861185361636311, 0.528280417714198, 1.88628410370643, -1.02153994821641, -0.947212590571663, 0.319695944770746, 
        1.55414494859854, -1.29278811854192, -0.654781862791968, -1.34814780510678, -0.739078029393269, 0.245920219311389, 
        -1.45593002577133, 0.237212089217768, -0.180102371744337, -0.693884042769646, -4.16959091487262, 0.744542861255222, 
        1.73277573805441, -1.93124057322409, 0.536289184825977, -1.02160818145807, -0.343809112645249, 0.0494421565320777, 
        2.09154479397478, 1.5411533687343, 0.185691315874786, 0.265464522347169, 0.12628876515103, -0.262822290062058, -0.02278477367513))
})

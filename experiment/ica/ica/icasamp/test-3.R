library(testthat)

.Random.seed <<- .ext.seed

test_that("icasamp", {
    expect_equal(ica:::icasamp(dname = "f", query = "rnd", nsamp = 1000), c(-1.58820189786728, 1.54532823485635, -1.5585215484565, 
        1.01020656302172, 1.25870892424007, -2.85031654546272, 1.55564614565319, 0.930279078155677, 0.923208417647004, -1.04685387900822, 
        0.645401484140886, -3.06786913605936, 0.972680990790091, 1.05462703710497, -1.48031513823142, 1.1620556114508, -0.94753993669041, 
        -0.94510365967957, -1.06363899330985, 0.484508636136354, 0.920518541731586, 1.18253290091137, 1.28789572377881, 0.814414035656417, 
        1.19985327293124, 0.298437677594525, 2.18815415929238, 0.731257270885047, -1.03988257173026, -0.50202183703239, 0.884925731983661, 
        1.20084797302628, 0.812890238903655, 0.877974363190614, -0.113365920976654, -0.762121107485594, 0.382794718695447, 
        0.582108732536346, -1.34896642623643, -1.27290011179169, -0.770005489460569, -0.968682839370631, -1.07441163806255, 
        -0.542400143508092, -1.11723498333399, -1.18922126354755, -1.01548259804382, -1.44942902642448, -0.987995381220323, 
        1.13918623803431, -0.838931064382815, -0.150957117398491, 1.45311081936461, -0.962316607657774, 1.31754543568975, 
        -1.91630079806922, 0.30141112620288, 0.898101513446613, 0.236410518245563, -0.9081879788949, 1.39131371626849, -1.41195311399344, 
        -1.15447729412745, -1.61918953781029, 0.287530848306792, -0.823399868305029, 1.28899477657703, 0.269480370540841, 
        1.29893751677754, 0.42658570316621, 1.14954314594403, 1.24104393298775, 1.06615326470064, -0.503849312350746, -0.893283535087877, 
        -0.959674533598267, -1.52702572552175, 0.439949163023451, -1.12476704514964, -1.04392275503447, -1.44383642223158, 
        0.98910356649587, -1.1440537518856, 0.351819806442143, -0.606489783928479, -2.19129036424199, 0.431937288148819, 
        0.0567941395178339, 1.28770035400448, -1.4394484758779, -0.905135412390524, 0.853583918078543, -1.35257067325584, 
        0.960525447110772, -0.586556027249651, -0.681088400886819, 1.30205168395781, -0.539519307301424, -1.03049111236994, 
        0.93551166060014, 1.01111027065668, -0.430656446081118, -1.29072611507798, 1.2268256188978, 0.196677102900784, 1.35167099707864, 
        1.24212179731475, 2.08151349196204, -0.793614649880715, -0.997863669730877, 0.748029028470592, -0.755706939954126, 
        -1.17424200671161, 0.735092966905591, 0.826112771958989, -1.12132712902184, 0.37678570091618, 1.12000766562366, 0.808586650135467, 
        -0.868589627330273, 0.935392281298094, -1.46182559797601, -0.500401035850422, -1.22639046388218, -1.15324451560139, 
        0.796123541631, 0.286213084853055, -0.369891671099535, -1.06975535450247, 1.83780228481515, 1.14659450829972, 1.04502062199235, 
        1.29146192598976, 1.44596314059401, 1.1221372587864, 1.59528905112925, 0.239515952768262, 0.0899072904708196, 1.09894201680321, 
        -1.04528484157348, -0.67639496504441, -1.26770472509349, -1.09369220683442, -0.766118892965081, -0.207727213692753, 
        -1.00541278766718, -0.954819825406151, -0.884324752014483, -1.35118950390799, 0.694780869714379, 2.37991453271329, 
        -0.981526732007247, -0.895999763501792, -0.801280384048419, -0.68435787384215, -1.30085920432417, 0.942106236543949, 
        -0.916660373285419, -0.62702088624489, -2.14887237654879, 0.969115203090908, -1.12748813195884, -0.323158769913326, 
        -1.59749231780637, -1.03753353158424, 0.502384980402585, 1.2310587696109, -1.25735847958444, -1.4003752630151, -0.909065577145563, 
        0.980484343515759, -1.61817215174136, 1.02729345681723, 1.8687480027395, 0.461219139199507, 1.4880435627082, -0.941625420086325, 
        0.848287291244795, 0.713502560691398, 1.08560951537613, 0.842484518852146, -1.6745882372841, 1.0485891976314, -0.878709035114448, 
        1.07978313624145, -2.81364828149606, -1.41493441208351, 1.09731304258999, 1.07750386014156, 1.22506655119266, -1.7846003960404, 
        -0.938581029209093, 0.86206469524674, 1.02000274119167, 0.585906523569947, -1.14034118384352, -0.698372645977988, 
        0.170382638434025, -0.744073492592108, 0.961759311201656, 0.364137202416376, 1.73366248439121, 0.903555307448152, 
        1.15342362489031, -1.19577128436584, 1.79577040105319, -1.94024536179273, -1.22581509436508, -0.893977365001244, 
        -0.421198702494896, -1.04147487250352, -0.203331572094322, -1.04683092627121, 1.40827227192247, -1.35895507160465, 
        1.22886668951997, -1.29082148948012, -0.837380774549133, 0.745709316011445, 1.59364096815073, -1.15113530965952, 
        1.60840304635425, 0.736767059814051, 1.34394459499204, -0.883820959857339, -1.16125666410126, -1.05051284532262, 
        0.949664776156497, 1.30573392846647, 1.00341661215712, 0.998029304834013, -1.03421502598394, 0.956005157390967, -0.791855910460013, 
        -1.68501157175516, -1.14898634030635, -1.04646258652282, 2.57461964848773, -0.745105452580269, 0.527794275183731, 
        0.26950468466262, 0.968048030778801, -0.897191713994626, 0.850581529807489, -0.313142670311997, 0.66667635781987, 
        -0.34871766481965, 0.589516759479507, 0.406724162237051, 2.66397864859397, -0.97531886739563, -0.671803678096632, 
        1.05655305884914, -1.23311528859004, 0.635267335002537, 1.43176759074134, -1.07473406952083, -1.27184221907157, -0.822957499840965, 
        1.20897736204028, 0.555957232155369, 2.48714599727841, 0.977357994837162, 0.251077860490824, 1.1149790731028, 0.506143204111674, 
        -0.764282580458697, -0.738138541642925, -2.06554879515587, 1.21511480571213, 0.627280449587078, -0.482009985206722, 
        -1.19347355129004, -0.83952718735488, 1.25076000282545, 1.10002418570639, 1.29333274021112, -0.951189422683503, -2.01146409420868, 
        0.0572079688866503, 0.515604096882271, 0.162276932074067, 0.26784432846832, -0.937546360298098, -0.632705452315964, 
        -1.28649566387527, -0.655512211155993, -0.433902498945797, -1.25143945579229, 1.03635618100855, -0.910839624819905, 
        -0.744936729196784, -1.14649396188888, 1.17140637365852, 0.737460884856232, 0.948650041380886, 1.17360863083321, 
        -0.927795490257278, -0.462448980853753, 1.16321460225504, 0.663378784111838, -1.11859449282371, 1.4044258206039, 
        1.03874692055799, 1.27280964259355, -0.482887126978685, -1.64381527471889, -1.37482544289708, -0.641647926971538, 
        -1.19144022366957, -1.09545175659414, -1.19400442146936, 1.64243750764123, -1.45210861702714, -0.980994032224999, 
        0.979256945462967, 1.13464731357689, -1.11663976792325, -0.999683119578015, 0.97747171873493, 1.1995625707025, -1.19884107280351, 
        -0.428611270915671, 0.837536045514681, -0.816503716247529, -1.11371655009695, 0.904477797674865, -1.29285422657886, 
        -1.57610956070754, 1.01378580955134, 1.47535463526143, -1.23137732443756, 1.04461552475907, 1.2922023624456, -1.56709887027403, 
        -1.35140500244554, 1.23575061166623, 2.58481894348299, 1.32868624057282, 1.86899501988409, -1.22840050586276, -1.34196193318509, 
        0.747316201174136, -2.39697152035633, -0.179844144943565, -0.597206676467607, 0.815156117852326, -0.827973901385884, 
        -0.0657292266211169, 1.03509432680163, -1.04589900133408, 0.869360252329445, 0.56476760838027, -1.03251864742886, 
        0.790181665098499, 0.909954645051209, 0.0302901820767223, -0.320387496832463, -1.24190860752436, 0.564456458882816, 
        -0.688560849771888, -1.58175271545746, 1.03076334519558, -1.09790779092804, -1.66303241106666, 0.883674797056245, 
        -1.00850356330208, -0.829148972315253, -1.36741243571204, -1.83378052767101, -1.16989038543262, -1.62467757905366, 
        0.938845568184311, -0.717463476910046, 1.18612128200323, 1.00697889974011, 0.469224175360525, 0.135155103150875, 
        -1.11990297499222, 1.17414425927957, 0.499017675091998, 0.849248922505346, -0.686383205452957, -0.39382281886613, 
        1.63809180536028, 0.936101026783259, -1.05811191502978, -0.209402222395547, -1.21374685434037, -1.00277584767747, 
        1.57901901863054, -0.852067138282149, -0.102705965259466, 0.888863298342341, -1.55702614486043, -0.359239645194286, 
        -0.563119641908075, -1.1303583600013, -1.47867995575449, 0.970187077841866, 0.747293311344554, -1.60511369620264, 
        0.788659422016868, 0.460690131620755, -1.80274120925693, 0.327610632376127, 1.35889308709811, -0.668733821489454, 
        -1.06868256119903, 1.16214662032617, -0.49411353024518, 1.02984148070886, -0.940451535486601, -1.11196570003946, 
        -1.04755907820637, -0.736347656497365, 1.0921662437995, -1.68910971256395, -0.897783167854084, -1.08417286805252, 
        1.76262592313796, 1.05418860538146, 0.887893549572124, -0.952892610158896, 0.974284830967077, 0.809148502663123, 
        -1.60940687033946, -0.235816696200746, -0.89548823899725, 0.588633911047495, 1.12965482735452, 0.955210338346713, 
        -0.0893298114746806, 2.66547155409555, -1.82158451204877, 0.0428139495243404, -0.371583210498373, -0.979721577260035, 
        -0.833607864567693, -0.23945706579393, -1.30236644411555, 1.2740910343627, 0.835534388781319, -1.3157642848377, 1.1155733586487, 
        1.4219383072097, 0.87913880455308, -1.47519181968073, -0.850574029374187, 0.710987423952741, 1.16878955502445, -0.947022531935287, 
        0.426050169503963, -1.40443894525687, -0.656075951825916, 1.01603258955939, 0.189160286335685, 1.16428692306897, 
        -0.46322632152262, -1.14309899840443, 2.53971957125665, -0.798787754725487, -0.972852348692974, -1.12328283745852, 
        0.656643623354006, -0.952846481256381, -0.891313624577078, 0.70450499103903, -1.03399372138012, 0.750794044004648, 
        -0.201980403400068, 0.814279375981516, -0.924785917222667, 0.637564414308271, 0.855405258867594, -0.905167857189942, 
        0.768530677717852, -0.989114949703123, -0.904552422933351, 1.43867217603863, -0.845449911844367, 0.970307932710221, 
        -0.794987213204308, 1.58269542582297, 1.07356406609145, -1.04562130496886, -0.862507823919261, 0.777866868969788, 
        -0.664270237848322, 1.0089267079476, 0.829175853114252, -1.0994737307603, -0.84926809428676, 1.14142210809757, -1.17548478572993, 
        1.26181963287828, -0.717887804114076, -1.70074442329745, 1.06644819050392, -0.0417807543477595, -0.78663955652786, 
        -0.535414777848729, -1.34061047494167, -1.17381842149982, -0.799458508813284, -0.276649425007632, 2.06150042726273, 
        0.81065499906749, 0.891777737441073, -0.999138364960793, -1.10161410905347, -0.0579204613607269, 2.50679524524381, 
        -1.06535123939621, 0.388007995446062, -1.06435611785758, -1.01074083399727, 0.905595851728618, -1.02918617149546, 
        -0.0887550212275723, -0.380894703203172, -2.3956711425658, -0.557072976785647, -1.14798128548334, 1.11013580257976, 
        0.735153079722143, 0.846624182477522, -1.29233427915534, 1.21372507775521, -1.09137188452955, 1.07554957683218, 1.1638325138583, 
        -0.862108118848416, 0.680040545133866, -1.15434884701546, 0.846456081253962, -1.11538299005969, 0.856392269114398, 
        1.6814321386928, -1.06935177060447, 0.811081912233954, -0.487266401508049, 0.832386531545183, -0.837255667845576, 
        1.48551149364859, 0.473194932986543, -1.26804037582528, 0.590422962404944, 1.04817969753418, -0.566814917559194, 
        -0.288578466836991, -1.02493639349108, 0.56281844208937, 0.984451013522896, 0.391744392559582, 0.891556743356767, 
        2.03488071728811, 0.743747393138534, 0.951999415070982, -0.992149346029293, -0.735300430703472, 0.328832770384509, 
        1.17401605729211, -1.29100218029709, 1.01197567857731, 0.738247084924365, -1.18894593514375, 1.43734455327398, 0.714526985767131, 
        1.82069985628397, 0.999784429406579, 0.720103377952358, 1.2360575237, -2.28136255237816, 0.484810728901057, 1.67570478830213, 
        -1.71906135036371, -1.32995260388097, 0.475559620117828, -1.11383415560937, 1.06004282449128, 0.621906995088098, 
        0.777999202665486, -1.29199374150972, 1.24454655918096, -0.475867901265627, -0.983551116685739, 0.872625348595415, 
        0.281257874693468, 0.90704119098355, 1.65559885219824, -0.887423213462528, 1.16595294864258, -0.551081484358673, 
        -1.11798092558853, 0.898982624796269, 2.13746534577351, -1.67637093570646, 1.99538732899234, -1.10401942043309, -0.434465080291119, 
        0.534538616320267, -1.15733757436121, 0.0612150225316588, -0.759258888332167, 0.905906061725695, -0.896587325577645, 
        0.555084327458771, -0.267851624019383, -1.17853044805369, 1.26546636905876, -0.592061861707081, -1.00755462071834, 
        1.44083847960033, 1.80313884290905, 0.576708938320876, 1.0950775455922, 0.712781226309931, 0.986812862967362, -1.24151798197129, 
        0.513261553639339, 0.846214137270085, 0.833016216657192, -0.965251384291863, -2.00180218470282, -0.662004601872654, 
        -0.886385066119442, 0.557732345091839, -0.674213531798372, -0.856423789240226, 1.18885695672573, 1.13637050948897, 
        -1.02320701169418, 1.55970830613449, -0.90203691012198, -0.160850312048096, 0.883517832343157, 0.349093941892543, 
        0.837106016609513, -0.918946439915982, 0.00668104817636817, 1.29998891606081, 1.56119629941557, -0.981809084489635, 
        -1.23226748217709, 1.49539148575104, 1.22605021632542, -0.486095265576668, -1.12546062455472, 0.487379626074456, 
        0.964070481708341, 1.04805702995477, -1.57366459562387, 0.989135384073773, 0.896150768625732, 1.31615578363009, 0.969410898556754, 
        -0.773839572629173, 0.47024499007155, -0.534987750918701, 1.61942483794048, 0.940562905344231, -1.32990142015544, 
        1.52027277780169, -0.986157735656564, -1.20773802770364, 1.23895071732972, -1.05393362809828, 0.47617073960479, -1.91160607378448, 
        -0.677196812130053, 1.12494955450386, -1.7167850462741, -0.549989747461131, -1.21414948499519, 1.50897637690189, 
        1.12030693327277, -0.992144274424654, -0.463873957111322, -2.06501467347308, 0.436261322519167, 2.23588536972716, 
        1.02150360272132, 0.762406314386287, -0.233367511728761, 0.916754662917177, 1.35212314978655, -0.901556514724855, 
        -0.501817557184558, -0.668497173456892, -1.05874827449038, 0.816720582033362, 0.963440357846212, -0.867214322979802, 
        -0.583441793320459, 1.18774251500849, 0.671934761870932, -0.984016575400504, -1.21145763229379, -1.72334864348133, 
        1.43779608299879, -1.02996915031812, -1.17271301074996, 1.36291439101297, -0.648989318255529, 1.31277619773094, -0.119958061200976, 
        -0.924668529853122, -0.518692365718603, 0.120197658132226, 0.902688639482984, 0.907268123612888, -0.733572801527574, 
        1.22394372342229, -1.06084161461332, -0.870778813502634, -0.848567621406837, -0.712360170845615, 1.12269261365052, 
        -1.31158826281469, -0.949763050911186, -0.0654446387968419, 1.02240749598182, 0.776718039063429, 0.992698085495812, 
        1.13181905991863, 0.91016886217103, 1.30442446649653, 0.95245474934853, -1.14723235601045, -0.588338379606868, 0.825342149596556, 
        0.753756502167128, 1.03292966953819, -0.875892618008198, 0.281183796250659, 0.754549197156612, 1.32424373652973, 
        -0.885643834763037, -0.062986808896765, 0.930190286211995, -0.671380945400362, -0.678322964397735, 0.930504880434172, 
        -1.22393456208037, 0.34133309167201, 1.60483869704364, -0.229113159942276, 1.07580396710564, 0.896439116493028, -0.0547046383800994, 
        -0.936163572693119, -0.394307030925977, 0.249368078653658, 1.68571511724355, -1.23305716034804, 0.474133189414736, 
        0.670576209005306, -1.38282292456531, -0.988034042635065, 1.16973389039747, -1.08332980649888, 0.281476824937304, 
        -1.00614407966023, -0.0303118063861523, -0.990261855900177, -0.752642532669712, -1.22114725466963, 1.76066392016824, 
        2.46446005715493, 1.06806349109973, 1.11086699051798, 0.270417398374725, 1.15244245712296, -1.02572458252826, -2.1826539244389, 
        -1.2281938802794, -1.24859507101196, 1.01516668667008, 0.646052191639952, -1.88827072831363, 0.969118973918219, -0.923679822245065, 
        1.07428711192777, 0.895952127842646, -1.30688863724602, -0.772244152740359, -1.48171484955845, -0.98263088607013, 
        1.31986674210955, 0.892281605978471, 0.860538911338315, -0.52007704510869, -0.790264950728515, 0.909959093526315, 
        -1.05129886892794, -0.87536797787719, -0.834445220702478, -0.892028922286122, -0.278182533085828, -1.00169025053324, 
        -0.111263188173343, -1.2383620027411, -0.961670540389796, -0.926873187376245, 0.779834530483195, -0.736586573508565, 
        0.0786528589130644, 1.5277114086489, 1.97781514158068, -1.63269826196108, 1.04754953898955, -0.864022907469638, 1.13680141458761, 
        0.703873037241191, -1.31452965021324, -0.661166626439707, -1.02457994969069, 1.07594848058201, 0.996907784506432, 
        1.00311883814312, -1.29837457660011, 0.509588519564137, 1.06269243794287, 1.51963109124356, -0.95574075358201, -1.45652928446733, 
        -0.916342952363029, -0.758925638798619, 1.29916544299616, -0.96542059919034, 1.05626277473492, -0.968506615573059, 
        0.893572578930247, 0.960278955831271, 0.826400227459904, 1.37688744929871, 0.555191616212922, -0.610417599877174, 
        -0.913172869579021, 0.408766169803414, 0.378598928963439, -0.139302711292559, -0.927686696461943, 0.843249051488877, 
        -1.05870603890299, 1.01871955190671, -1.39181287489557, -0.165461933284283, -1.49972540535366, -0.591062916530739, 
        1.07081426608316, 0.50542397387775, 0.177053536249208, 1.24635489752497, -0.464969818766049, 1.41493244171834, -1.53358913899506, 
        -0.951919096325091, 1.03017960517317, -0.400430363470752, -0.984108748137194, 0.351710159440108, -0.881391226967911, 
        1.108434793208, -1.59252213423211, -1.6054525779381, -0.657923559866703, 0.809196361177889, 1.456015635811, -1.09206303653957, 
        -0.52488659617729, 0.591748299690872, 0.914542692863552, 0.883331503992807, 1.3005357717136, -1.46789894567554, 0.685451412039627, 
        1.17356118723309, 0.353737217387595, -0.256458517579274, 0.176722795158903, 0.798474146611162, -1.15074318772592, 
        0.236296389848151, 1.59079624135146, -1.42769780906033, -1.27722003425114, -2.70597793045151, -0.874368530889933, 
        1.23699080523881, 1.01432417255904, 0.56280530182153, 1.05383136321554, 1.52920146701407, 1.25331485028105, -1.3342460934606, 
        -0.847888740056631, -1.67024197853304, 1.53872509797831, 0.947595173428106, -0.182776611280736, 0.641025326107296, 
        1.42582043336663, 1.8743538198824, 1.12959776710709, 1.20478199789724, 1.46076821356003, 1.04646559180693, -0.208769125390519, 
        -1.3775162269138, -0.994987641761235, 1.1615496744251, 1.10794058579724, -0.77604175254322, 0.750605365336454, 0.637813078445941, 
        1.32034283332177, -0.92284456390381, -1.04309085216883, 1.1683799864386, -1.15867588154038, -0.976672568039424, 0.984550970603933, 
        1.68093751513248, 0.836329402973783, -0.719950258467396, 0.715383478876046, -0.438087462309195, 1.14614019276701, 
        1.04620136315457, -1.89359933456912, 0.95733288898009, 0.918498827707815, 0.965761935172279, -1.4479913816167, 0.519231105175515, 
        1.16508085890755, 0.435676061323236, -0.957756282555432, 1.93960828320153, -1.08729230864535, -1.25407697923032, 
        -0.638004512222703, -1.14137178084548, -0.695771408677022, -1.08861411020582, -0.91501717516937, -0.894911308706562, 
        -1.53202281030547, 0.986449692385522, -0.940347495991051, 0.165369187827046, -1.16185852784808, -0.919342783611023, 
        0.879158449100389, 0.689692758706387, -0.598567989381461, -0.907322138569875, -1.04852030760367, 1.25087520497968, 
        -1.32550582534754, 0.869991874547563, -1.11492760568301, 0.728632705864226, 0.896613184448024, 0.951986693243267, 
        -1.08581234099305, 1.23657433823461, -0.782233473782696, 0.436124067176383, -0.147547354738633, 0.802766265595042, 
        -0.892853789669591, -0.883736457072436, 1.12317469321596, 0.808555408204712, -1.4144660983641, -0.991849454307708, 
        -1.5201911464691, -0.63172243436782, 0.652876225545647, -0.449679908196213, 0.920723747657632, 1.03098930663162, 
        0.459972840991393, -1.12844160546008, -1.03691956761194, -0.743498304052946, -1.07260103688096, -1.69629898247513, 
        -1.7069928549326, 1.38579672672564, -1.51285389414251, 0.906025584453394, 1.20137576879056, 0.0186935381237, -0.461163391338694, 
        0.960327770959256, -1.14440765172856))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("estimate_prob_and_var", {
    ypar <- c(5, 6, 7, 8)
    xpar <- 1:4
    rpar <- 9
    ps_new <- structure(c(-0.735365272128125, -0.690761140849801, 0.940706239512013, 0.945563286338958, -0.0359094291951983, 
        0.630008888748633, -0.0547318113079465, 0.457405294053844, -0.398360521272436), .Dim = c(9L, 1L))
    expect_equal(mdsdt:::estimate_prob_and_var(xpar = xpar, ypar = ypar, rpar = rpar, ps_old = ps_new), list(prob = structure(c(0.346832331402608, 
        0.154429071848941, 0.0492953326558131, 0.0225708270099899, 0.422109135655635, 0.600713098397607, 0.124132377645739, 
        0.149614861694741, 0.167490379943708, 0.109915312472076, 0.472528604554801, 0.301119052920409, 0.0635681529980489, 
        0.134942517281377, 0.354043685143647, 0.52669525837486), .Dim = c(4L, 4L)), v = structure(c(-0.19484172680802, -0.109814397874627, 
        -0.0931878263466544, -0.0463272562384872, -0.10958660747326, -0.204452075998782, -0.163113198311787, -0.208802376978539, 
        0.19484172680802, 0.109814397874627, 0.0931878263466544, 0.0463272562384872, 0.10958660747326, 0.204452075998782, 
        0.163113198311787, 0.208802376978539, -0.316208116993202, -0.223823277616486, -0.0630237710618158, -0.0393213968313511, 
        0.316208116993202, 0.223823277616486, 0.0630237710618158, 0.0393213968313511, -0.0824770308462859, -0.103307867476509, 
        -0.335321426605553, -0.31999629918106, 0.0824770308462859, 0.103307867476509, 0.335321426605553, 0.31999629918106, 
        0.124166711890679, 0.126833037336656, 0.104894128363529, 0.0733890293268503, -0.124166711890679, -0.126833037336656, 
        -0.104894128363529, -0.0733890293268503, -0.124166711890679, -0.126833037336656, -0.104894128363529, -0.0733890293268503, 
        0.124166711890679, 0.126833037336656, 0.104894128363529, 0.0733890293268503), .Dim = c(4L, 4L, 3L))))
})

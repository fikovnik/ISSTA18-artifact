library(testthat)

.Random.seed <<- .ext.seed

test_that("make_parameter_mat", {
    ypar <- c(3, 4)
    xpar <- 1:2
    rpar <- c(5, 6, 7, 8)
    ps_new <- structure(c(-1.04088517575794, 1.09247179701, -0.496372464829015, 0.391664617794278, -0.196493283531003, 0.0623850137697199, 
        -0.163838660958472, -0.195845069416469), .Dim = c(8L, 1L))
    expect_equal(mdsdt:::make_parameter_mat(xpar = xpar, ypar = ypar, rpar = rpar, ps_new = ps_new), structure(c(-1.04088517575794, 
        -1.04088517575794, 1.09247179701, 1.09247179701, 1, 1, 1, 1, -0.496372464829015, 0.391664617794278, -0.496372464829015, 
        0.391664617794278, 1, 1, 1, 1, -0.196493283531003, 0.0623850137697199, -0.163838660958472, -0.195845069416469), .Dim = 4:5, 
        .Dimnames = list(NULL, c("mu", "sigma", "nu", "tau", "rho"))))
})

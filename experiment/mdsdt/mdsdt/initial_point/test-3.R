library(testthat)

.Random.seed <<- .ext.seed

test_that("initial_point", {
    PS_y <- TRUE
    PS_x <- TRUE
    prob <- structure(c(0.583657587548638, 0.307392996108949, 0.0817120622568093, 0.0311284046692607, 0.252918287937743, 
        0.556420233463035, 0.0622568093385214, 0.101167315175097, 0.132295719844358, 0.0428015564202335, 0.583657587548638, 
        0.315175097276265, 0.0311284046692607, 0.0933852140077821, 0.272373540856031, 0.552529182879377), .Dim = c(4L, 4L))
    PI <- "none"
    expect_equal(mdsdt:::initial_point(prob = prob, PS_x = PS_x, PS_y = PS_y, PI = PI), list(xpar = 1:2, ypar = c(3, 4), 
        rpar = c(5, 6, 7, 8), ps_old = structure(c(-1.03726817140036, 1.08874899044344, -0.497726194343817, 0.390052055669255, 
            -0.235724504426812, 0.0732223425329167, -0.190376457305318, -0.238186384515201), .Dim = c(8L, 1L)), rows = structure(c(TRUE, 
            FALSE, TRUE, FALSE, TRUE, FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, TRUE, FALSE, TRUE, FALSE, FALSE, FALSE, TRUE, 
            TRUE, FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, TRUE, FALSE, TRUE, FALSE, FALSE, FALSE, TRUE), .Dim = c(8L, 4L))))
})

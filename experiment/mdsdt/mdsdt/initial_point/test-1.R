library(testthat)

.Random.seed <<- .ext.seed

test_that("initial_point", {
    PS_y <- FALSE
    PS_x <- FALSE
    prob <- structure(c(0.326848249027237, 0.151750972762646, 0.0622568093385214, 0.0272373540856031, 0.439688715953307, 
        0.603112840466926, 0.108949416342412, 0.143968871595331, 0.186770428015564, 0.11284046692607, 0.459143968871595, 
        0.295719844357977, 0.0466926070038911, 0.132295719844358, 0.369649805447471, 0.533073929961089), .Dim = c(4L, 4L))
    PI <- "same_rho"
    expect_equal(mdsdt:::initial_point(prob = prob, PS_x = PS_x, PS_y = PS_y, PI = PI), list(xpar = 1:4, ypar = c(5, 6, 7, 
        8), rpar = 9, ps_old = structure(c(-0.727489622795373, -0.689875675942303, 0.949409360657049, 0.949409360657049, 
        -0.0341435937935389, 0.629253850166221, -0.0536695497781241, 0.459445338000602, -0.304745951114666), .Dim = c(9L, 
        1L)), rows = structure(c(TRUE, FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, FALSE, TRUE, FALSE, TRUE, FALSE, FALSE, FALSE, 
        TRUE, FALSE, FALSE, TRUE, FALSE, FALSE, TRUE, FALSE, FALSE, FALSE, TRUE, FALSE, TRUE, FALSE, FALSE, FALSE, TRUE, 
        FALSE, FALSE, FALSE, TRUE, TRUE), .Dim = c(9L, 4L))))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("pcgen", {
    mixture <- structure(list(z = c(18.0543738445618, 10.4019815020213, 10.4093719630546, 13.8421537052471, 13.8031395284107, 
        11.1769783344099, 16.0088937926245, 11.4323154908617, 16.7427331974229, 10.0498463122802, 11.5514642294434, 12.7547912919634, 
        12.2666727216297, 18.2167580389796, 14.7715729024648, 17.0144318889349, 19.3430774485827, 12.2361846412127, 9.86160258451125, 
        15.1869046887534), label = c(0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0)), row.names = c(NA, -20L), 
        class = "data.frame")
    expect_equal(pcensmix:::pcgen(r = 12, p = 0.3, data = mixture), structure(list(original_data = c(18.0543738445618, 10.4019815020213, 
        10.4093719630546, 13.8421537052471, 13.8031395284107, 11.1769783344099, 16.0088937926245, 11.4323154908617, 16.7427331974229, 
        10.0498463122802, 11.5514642294434, 12.7547912919634, 12.2666727216297, 18.2167580389796, 14.7715729024648, 17.0144318889349, 
        19.3430774485827, 12.2361846412127, 9.86160258451125, 15.1869046887534), label = c(0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 
        1, 1, 1, 0, 0, 0, 0, 0, 0, 0), censored_version_of_data = c(9.86160258451125, 10.0498463122802, 10.0498463122802, 
        10.4019815020213, 10.4093719630546, 11.1769783344099, 11.4323154908617, 11.5514642294434, 12.2361846412127, 12.7547912919634, 
        12.7547912919634, 13.8031395284107, 13.8421537052471, 13.8421537052471, 14.7715729024648, 14.7715729024648, 14.7715729024648, 
        14.7715729024648, 14.7715729024648, 14.7715729024648), component_indicator = c(0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0), censoring_indicator = c(1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0)), row.names = c(NA, 
        -20L), class = "pcgen"))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("dandelion", {
    facl <- structure(c(0.0822110092927023, 0.00602362992675965, 0.0732840637013216, -0.00691054657659198, -0.093922227496896, 
        -0.129359555334016, 0.00451459953242588, -0.11609381554958, -0.0809348454670367, -0.00979314973135021, 0.0413777422518876, 
        0.0538821827748425, 0.0412299151748225, -0.0172771584473925, 0.03458223754162, 0.0681575396110445, -0.539290743264292, 
        0.633156386164225, -0.350068859197784, 0.726542048396455, -0.325459881288869, -0.611239057554449, -0.252179601966345, 
        -0.302602226392409, 0.536532659063035, -0.353387866300353, -0.416110746781701, -0.16013920350055, -0.54040072013212, 
        0.633343503600172, 0.693702018267991, -0.5185249730037, 0.687181276524581, -0.414866137896234, -0.313301962618086, 
        -0.383074468504441, 0.690414844713405, -0.238392352575617, -0.0959645789620917, -0.0666164914653489, -0.0563823380468492, 
        -0.184456125416542, 0.00671119630661951, -0.0769283879785176, 0.0698745483295697, 0.106342778768369, -0.0683228911396047, 
        -0.0658013552802268, -0.10544783862513, 0.00921115239887373, -0.0743101198907177, -0.253722438778418, -0.148522897519285, 
        0.548982315913499, 0.503637131500078, 0.582515126097915, 0.397633569038791, 0.595144617423273, 0.457564913002506, 
        0.0533414607786438, 0.0234785072322695, 0.0996031733930905, 0.00685296057630722, 0.0422505983808865, 0.0443313941060759, 
        -0.00944398087063611, -0.0409465525982714, 0.146195426485374, -0.0301179539909966, -0.0511723423331946, 0.0844234861218267, 
        -0.00274770378580554, 0.118570411476128, 0.0760902723073017, -0.0295638091674601, 0.111874915060404, 0.0148374957813912, 
        -0.0211847629523492, -0.0341300529433534, 0.0589091187477721, 0.00631873258590245, 0.0345464314019005, -0.0295659220124627, 
        -0.0534771570438911, 0.0374859573391566, 0.0728762712578541, 0.102832466448247, -0.0387994425625194, 0.00783826312239403, 
        -0.0313899719990064, -0.0628300620687298, -0.0812655567096691, -0.0473436023047448, -0.151793249945023, -0.133081801533341, 
        -0.136010986866484, 0.00828929748088963, -0.00785618091374809, -0.00638992602083775, -0.0219725932803431, 0.00805214972501845, 
        -0.00601303494807096, -0.418543139797041, 0.15571134812604, -0.449547895323945, 0.221591346662326, -0.337382696752315, 
        -0.444766753262745, -0.481283640329378, -0.420191142533011, 0.0649233135424, -0.325897418857456, -0.412865698140287, 
        -0.381270541848699, -0.442606973763361, 0.0796703627177955, 0.158081270553903, -0.423923242574865, 0.0960126857013275, 
        -0.462064470971204, -0.490904267099195, -0.499734149174174, 0.083342039229096, -0.506642266370164, -0.620340514263008, 
        -0.713804602139932, -0.749213614546632, -0.654228590264993, -0.119799979502514, -0.101168565471522, -0.0639396918025408, 
        -0.0421319349558591, -0.543743683554687, -0.513884611760249, -0.499522102737804, -0.474604701806364, -0.337695792812869, 
        -0.327896182420999, -0.297603610937312, 0.0461464141894978, 0.0928159119973444, 0.093640859300919, 0.00940606235168116, 
        0.0324286577587961, 0.0487602179244428, -0.140259667513368, 0.046411943829142, -0.185253437626113, 0.0574908349890499, 
        -0.163531139476635, -0.14344727883226, -0.144520654722012, -0.26746118450828, 0.151739311371525, -0.192428797155313, 
        -0.276752830117778, -0.23912680936616, -0.135436711342542, -0.0298141203883103, -0.0110228433161231, -0.163432890425707, 
        -0.018402373760811, -0.124406697201096, -0.219768858029055, -0.213926815075858, -0.0479538019386737, -0.1581610404769, 
        -0.0925365712407584, 0.0470589025368997, 0.062472535311545, 0.0374221139182215, -0.105803331284138, -0.224243463518601, 
        0.00600379702801308, -0.128676439650442, -0.130239426444638, -0.0549934886567642, 0.000772446400358733, -0.0570405584929707, 
        0.317866174022321, 0.256277975630404, 0.248524521144923, 0.0095031102927188, 0.0211302794228361, -0.0567589095712125, 
        -0.0421484513820192, 0.00756519453132707, -0.0029923792789248, 0.0627837627077922, -0.163888794978842, -0.00713020636339809, 
        -0.173031138489661, 0.0420798550007325, 0.0688311872202773, 0.156991206667474, -0.138314806120961, -0.152452143397961, 
        0.0351320509163055, 0.0456918995132631, -0.124728475199034, -0.253514580750885, 0.0951284218573639, 0.0564995639619228, 
        -0.256156061632862, -0.0948224178750238, -0.361348279884933, -0.359218521370474, -0.360602505873481, 0.0306376242635763, 
        0.0581789797290724, 0.14186486516066, 0.123806859830788, 0.100719685355632, -0.00403955947271788, -0.0870298273069918), 
        .Dim = c(43L, 5L), class = "loadings", .Dimnames = list(c("X10A", "X10B", "X10C", "X11A", "X11B", "X11C", "X11D", 
            "X12A", "X12B", "X12C", "X13A", "X13B", "X13C", "X13D", "X13E", "X13F", "X17A", "X17B", "X17C", "X17D", "X17E", 
            "X17F", "X17G", "X18A", "X18B", "X18C", "X18D", "X18E", "X19A", "X19B", "X19C", "X19D", "X19E", "X19F", "X19G", 
            "X19H", "X19I", "X19J", "X19K", "X19L", "X19M", "X19N", "X21A"), NULL))
    dandpal <- c("#CCFF00FF", "#CFFF00FF", "#D2FF00FF", "#D5FF00FF", "#D8FF00FF", "#DBFF00FF", "#DFFF00FF", "#E2FF00FF", 
        "#E5FF00FF", "#E8FF00FF", "#EBFF00FF", "#EEFF00FF", "#F1FF00FF", "#F4FF00FF", "#F7FF00FF", "#FAFF00FF", "#FDFF00FF", 
        "#FFFD00FF", "#FFFA00FF", "#FFF700FF", "#FFF400FF", "#FFF100FF", "#FFEE00FF", "#FFEB00FF", "#FFE800FF", "#FFE500FF", 
        "#FFE200FF", "#FFDF00FF", "#FFDB00FF", "#FFD800FF", "#FFD500FF", "#FFD200FF", "#FFCF00FF", "#FFCC00FF", "#FFC900FF", 
        "#FFC600FF", "#FFC300FF", "#FFC000FF", "#FFBD00FF", "#FFB900FF", "#FFB600FF", "#FFB300FF", "#FFB000FF", "#FFAD00FF", 
        "#FFAA00FF", "#FFA700FF", "#FFA400FF", "#FFA100FF", "#FF9E00FF", "#FF9B00FF", "#FF9700FF", "#FF9400FF", "#FF9100FF", 
        "#FF8E00FF", "#FF8B00FF", "#FF8800FF", "#FF8500FF", "#FF8200FF", "#FF7F00FF", "#FF7C00FF", "#FF7900FF", "#FF7500FF", 
        "#FF7200FF", "#FF6F00FF", "#FF6C00FF", "#FF6900FF", "#FF6600FF", "#FF6300FF", "#FF6000FF", "#FF5D00FF", "#FF5A00FF", 
        "#FF5700FF", "#FF5300FF", "#FF5000FF", "#FF4D00FF", "#FF4A00FF", "#FF4700FF", "#FF4400FF", "#FF4100FF", "#FF3E00FF", 
        "#FF3B00FF", "#FF3800FF", "#FF3500FF", "#FF3100FF", "#FF2E00FF", "#FF2B00FF", "#FF2800FF", "#FF2500FF", "#FF2200FF", 
        "#FF1F00FF", "#FF1C00FF", "#FF1900FF", "#FF1600FF", "#FF1300FF", "#FF0F00FF", "#FF0C00FF", "#FF0900FF", "#FF0600FF", 
        "#FF0300FF", "#FF0000FF")
    expect_equal(DandEFA:::dandelion(fact_load = facl, bound = 0, mcex = c(1, 1.2), palet = dandpal), NULL)
})

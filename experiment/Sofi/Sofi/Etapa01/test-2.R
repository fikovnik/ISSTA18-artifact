library(testthat)

.Random.seed <<- .ext.seed

test_that("Etapa01", {
    InfCap <- structure(list(Cap = 1:20, Es = c(0.04, 0.015, 0.04, 0.015, 0.04, 0.035, 0, 0, 0.015, 0.015, 0.015, 0.04, 0.04, 
        0.04, 0.9, 0.9, 0.04, 0.04, 0.9, 0.9), ps = c(0.8234, 0.9239, 0.7688, 0.936, 0.7573, 0.8563, 0.5758, 0.6667, 0.877, 
        0.8808, 0.903, 0.6348, 0.8054, 0.8731, 0.5, 0.5, 0.7722, 0.8946, 0.5, 0.5), n = c(5L, 6L, 3L, 4L, 5L, 6L, 1L, 1L, 
        9L, 8L, 4L, 7L, 6L, 3L, 0L, 0L, 3L, 2L, 0L, 0L)), class = "data.frame", row.names = c(NA, -20L))
    DatCap <- structure(c("  1359", "  1565", "  2550", "  4922", "  5139", "  5273", "  5868", "  6883", "  7058", "  7601", 
        " 19979", " 21647", " 33762", " 37435", " 42207", " 42363", " 54902", " 56945", " 59244", " 65720", " 77577", " 86464", 
        " 87064", " 87262", " 87385", " 87465", " 87740", " 88057", " 88828", " 89596", " 93014", "127941", "129103", "158959", 
        "167249", "171499", "171699", "182314", "183093", "186620", "189772", "190184", "190341", "190503", "190955", "191023", 
        "191220", "191884", "191957", "193079", "193580", "195053", "195238", "195494", "196123", "196438", "198124", "198365", 
        "199025", "199085", "200643", "200873", "201735", "203316", "203330", "203334", "203356", "203361", "203373", "209128", 
        "216714", "229005", "230120", "246808", "253481", "258712", "270320", "270998", "272657", "281062", "285480", "292385", 
        "304004", "319727", "324570", "328316", "346623", "352114", "352671", "354682", "356660", "358158", "359780", "373112", 
        "373788", "374914", "378788", "381151", "381884", "382621", "382923", "384300", "384717", "391085", "395650", "395656", 
        "397111", "403279", "408802", "413731", "420394", "426091", "433841", "435661", "443839", "445683", "448243", "449359", 
        "450864", "450998", "451147", "451445", "451544", "451560", "451937", "451988", "452059", "452106", "452243", "452336", 
        "452352", "452423", "453045", "453190", "453226", "453315", "453540", "453570", "453657", "454308", "454529", "454912", 
        "456659", "460450", "461472", "462334", "463144", "468939", "471542", "474241", "476858", "477001", "477064", "477135", 
        "477200", "477539", "477847", "477913", "477917", "479317", "479732", "481612", "482615", "482736", "482792", "486236", 
        "487011", "A09", "A09", "A18", "A41", "A41", "A41", "A41", "B15", "B18", "B18", "C18", "C22", "C34", "C34", "C44", 
        "C45", "C56", "C61", "C61", "C71", "C91", "D50", "D53", "D58", "D61", "D61", "D61", "D64", "D64", "D64", "E11", "E11", 
        "E11", "E14", "E14", "E14", "E14", "E46", "E66", "E87", "F03", "F03", "F03", "F03", "F10", "F10", "F10", "F10", "F10", 
        "F10", "F20", "G12", "G20", "G20", "G20", "G30", "G37", "G40", "G40", "G40", "G80", "G80", "G91", "H44", "H54", "H66", 
        "H66", "H66", "H70", "I10", "I12", "I21", "I21", "I21", "I21", "I21", "I21", "I21", "I21", "I21", "I21", "I25", "I48", 
        "I61", "I63", "I64", "I77", "J18", "J18", "J18", "J18", "J18", "J18", "J44", "J44", "J44", "J44", "J44", "J44", "J44", 
        "J44", "J44", "J44", "J84", "K25", "K25", "K29", "K56", "K65", "K70", "K70", "K72", "K74", "K74", "K81", "K85", "K92", 
        "K92", "L02", "L03", "L08", "L89", "L89", "L89", "L89", "L90", "L93", "L97", "L98", "L98", "L98", "L98", "M06", "M06", 
        "M06", "M06", "M06", "M06", "M06", "M19", "M31", "M32", "M79", "N17", "N17", "N18", "N18", "N18", "N19", "N39", "Q21", 
        "Q22", "Q24", "Q24", "Q24", "Q26", "Q60", "Q61", "Q61", "R54", "R54", "R54", "R54", "R54", "R56", "R99", "R99"), 
        .Dim = c(167L, 2L), .Dimnames = list(NULL, c("ID", "CausaD")))
    expect_equal(Sofi:::Etapa01(IDm = DatCap[, 1], CausaD = DatCap[, 2], ps = InfCap$ps), structure(list(Id = c(1L, 2L, 3L, 
        4L, 5L, 6L, 7L, 8L, 9L, 11L, 12L, 13L, 14L, 15L, 16L, 17L, 18L, 19L, 20L, 23L, 24L, 25L, 26L, 27L, 28L, 29L, 30L, 
        32L, 33L, 34L, 35L, 36L, 37L, 38L, 39L, 40L, 41L, 42L, 43L, 44L, 45L, 47L, 48L, 49L, 50L, 51L, 52L, 53L, 54L, 55L, 
        56L, 57L, 59L, 60L, 61L, 62L, 63L, 65L, 67L, 68L, 69L, 70L, 71L, 73L, 74L, 75L, 76L, 77L, 78L, 79L, 80L, 81L, 82L, 
        83L, 84L, 85L, 86L, 87L, 88L, 89L, 90L, 91L, 92L, 93L, 94L, 95L, 96L, 97L, 98L, 99L, 100L, 102L, 103L, 104L, 105L, 
        106L, 107L, 108L, 109L, 111L, 112L, 113L, 114L, 115L, 116L, 117L, 118L, 119L, 120L, 121L, 122L, 124L, 125L, 126L, 
        127L, 128L, 129L, 130L, 131L, 132L, 133L, 134L, 135L, 136L, 137L, 138L, 140L, 141L, 142L, 143L, 144L, 145L, 146L, 
        147L, 149L, 150L, 151L, 152L, 153L, 154L, 155L, 156L, 158L, 159L, 160L, 161L, 162L, 163L, 164L, 165L, 167L), IDm = structure(c(3L, 
        4L, 49L, 146L, 147L, 148L, 151L, 154L, 155L, 32L, 43L, 61L, 71L, 88L, 89L, 149L, 150L, 152L, 153L, 159L, 160L, 161L, 
        162L, 163L, 164L, 165L, 166L, 1L, 2L, 5L, 6L, 7L, 8L, 9L, 10L, 11L, 12L, 13L, 14L, 15L, 16L, 18L, 19L, 20L, 21L, 
        22L, 23L, 24L, 25L, 26L, 27L, 28L, 30L, 31L, 33L, 34L, 35L, 37L, 39L, 40L, 41L, 42L, 44L, 46L, 47L, 48L, 50L, 51L, 
        52L, 53L, 54L, 55L, 56L, 57L, 58L, 59L, 60L, 62L, 63L, 64L, 65L, 66L, 67L, 68L, 69L, 70L, 72L, 73L, 74L, 75L, 76L, 
        78L, 79L, 80L, 81L, 82L, 83L, 84L, 85L, 87L, 90L, 91L, 92L, 93L, 94L, 95L, 96L, 97L, 98L, 99L, 100L, 102L, 103L, 
        104L, 105L, 106L, 107L, 108L, 109L, 110L, 111L, 112L, 113L, 114L, 115L, 116L, 118L, 119L, 120L, 121L, 122L, 123L, 
        124L, 125L, 127L, 128L, 129L, 130L, 131L, 132L, 133L, 134L, 136L, 137L, 138L, 139L, 140L, 141L, 142L, 143L, 145L), 
        .Label = c("127941", "129103", "1359", "1565", "158959", "167249", "171499", "171699", "182314", "183093", "186620", 
            "189772", "190184", "190341", "190503", "190955", "191023", "191220", "191884", "191957", "193079", "193580", 
            "195053", "195238", "195494", "196123", "196438", "198124", "198365", "199025", "199085", "19979", "200643", 
            "200873", "201735", "203316", "203330", "203334", "203356", "203361", "203373", "209128", "21647", "216714", 
            "229005", "230120", "246808", "253481", "2550", "258712", "270320", "270998", "272657", "281062", "285480", "292385", 
            "304004", "319727", "324570", "328316", "33762", "346623", "352114", "352671", "354682", "356660", "358158", 
            "359780", "373112", "373788", "37435", "374914", "378788", "381151", "381884", "382621", "382923", "384300", 
            "384717", "391085", "395650", "395656", "397111", "403279", "408802", "413731", "420394", "42207", "42363", "426091", 
            "433841", "435661", "443839", "445683", "448243", "449359", "450864", "450998", "451147", "451445", "451544", 
            "451560", "451937", "451988", "452059", "452106", "452243", "452336", "452352", "452423", "453045", "453190", 
            "453226", "453315", "453540", "453570", "453657", "454308", "454529", "454912", "456659", "460450", "461472", 
            "462334", "463144", "468939", "471542", "474241", "476858", "477001", "477064", "477135", "477200", "477539", 
            "477847", "477913", "477917", "479317", "479732", "481612", "482615", "482736", "482792", "486236", "487011", 
            "4922", "5139", "5273", "54902", "56945", "5868", "59244", "65720", "6883", "7058", "7601", "77577", "86464", 
            "87064", "87262", "87385", "87465", "87740", "88057", "88828", "89596", "93014"), class = "factor"), CausaD = structure(c(1L, 
        1L, 2L, 3L, 3L, 3L, 3L, 4L, 5L, 6L, 7L, 8L, 8L, 9L, 10L, 11L, 12L, 12L, 13L, 16L, 17L, 18L, 18L, 18L, 19L, 19L, 19L, 
        20L, 20L, 21L, 21L, 21L, 21L, 22L, 23L, 24L, 25L, 25L, 25L, 25L, 26L, 26L, 26L, 26L, 26L, 27L, 28L, 29L, 29L, 29L, 
        30L, 31L, 32L, 32L, 33L, 33L, 34L, 36L, 37L, 37L, 38L, 39L, 40L, 41L, 41L, 41L, 41L, 41L, 41L, 41L, 41L, 41L, 42L, 
        43L, 44L, 45L, 46L, 47L, 48L, 48L, 48L, 48L, 48L, 48L, 49L, 49L, 49L, 49L, 49L, 49L, 49L, 49L, 49L, 50L, 51L, 51L, 
        52L, 53L, 54L, 55L, 56L, 57L, 57L, 58L, 59L, 60L, 60L, 61L, 62L, 63L, 64L, 64L, 64L, 65L, 66L, 67L, 68L, 68L, 68L, 
        68L, 69L, 69L, 69L, 69L, 69L, 69L, 70L, 71L, 72L, 73L, 74L, 74L, 75L, 75L, 76L, 77L, 78L, 79L, 80L, 80L, 80L, 81L, 
        83L, 83L, 84L, 84L, 84L, 84L, 84L, 85L, 86L), .Label = c("A09", "A18", "A41", "B15", "B18", "C18", "C22", "C34", 
        "C44", "C45", "C56", "C61", "C71", "C91", "D50", "D53", "D58", "D61", "D64", "E11", "E14", "E46", "E66", "E87", "F03", 
        "F10", "F20", "G12", "G20", "G30", "G37", "G40", "G80", "G91", "H44", "H54", "H66", "H70", "I10", "I12", "I21", "I25", 
        "I48", "I61", "I63", "I64", "I77", "J18", "J44", "J84", "K25", "K29", "K56", "K65", "K70", "K72", "K74", "K81", "K85", 
        "K92", "L02", "L03", "L08", "L89", "L90", "L93", "L97", "L98", "M06", "M19", "M31", "M32", "M79", "N17", "N18", "N19", 
        "N39", "Q21", "Q22", "Q24", "Q26", "Q60", "Q61", "R54", "R56", "R99"), class = "factor"), CapAut = structure(c(1L, 
        1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 11L, 
        11L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 12L, 12L, 12L, 12L, 12L, 12L, 12L, 12L, 12L, 12L, 13L, 13L, 13L, 13L, 13L, 
        13L, 13L, 13L, 13L, 13L, 13L, 14L, 15L, 15L, 15L, 16L, 16L, 16L, 16L, 16L, 16L, 16L, 16L, 16L, 16L, 16L, 16L, 16L, 
        16L, 16L, 16L, 16L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 
        3L, 3L, 3L, 3L, 3L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 6L, 
        6L, 6L, 6L, 6L, 6L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 8L, 8L, 8L, 8L, 8L, 8L, 8L), .Label = c("1", "10", "11", "12", 
        "13", "14", "17", "18", "2", "3", "4", "5", "6", "7", "8", "9"), class = "factor"), Capit = c(1L, 1L, 1L, 1L, 1L, 
        1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 
        4L, 4L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 7L, 8L, 8L, 8L, 9L, 9L, 
        9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 
        10L, 10L, 10L, 10L, 10L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 12L, 12L, 12L, 12L, 12L, 
        12L, 12L, 12L, 12L, 12L, 12L, 12L, 12L, 13L, 13L, 13L, 13L, 13L, 13L, 13L, 13L, 13L, 13L, 14L, 14L, 14L, 14L, 14L, 
        14L, 17L, 17L, 17L, 17L, 17L, 17L, 17L, 17L, 18L, 18L, 18L, 18L, 18L, 18L, 18L), FactorExp = c(1.11111111111111, 
        1.11111111111111, 1.11111111111111, 1.11111111111111, 1.11111111111111, 1.11111111111111, 1.11111111111111, 1.11111111111111, 
        1.11111111111111, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.125, 1.125, 1.125, 1.125, 1.125, 1.125, 1.125, 
        1.125, 1.11111111111111, 1.11111111111111, 1.11111111111111, 1.11111111111111, 1.11111111111111, 1.11111111111111, 
        1.11111111111111, 1.11111111111111, 1.11111111111111, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.09090909090909, 
        1.09090909090909, 1.09090909090909, 1.09090909090909, 1.09090909090909, 1.09090909090909, 1.09090909090909, 1.09090909090909, 
        1.09090909090909, 1.09090909090909, 1.09090909090909, 2, 1.33333333333333, 1.33333333333333, 1.33333333333333, 1.05882352941176, 
        1.05882352941176, 1.05882352941176, 1.05882352941176, 1.05882352941176, 1.05882352941176, 1.05882352941176, 1.05882352941176, 
        1.05882352941176, 1.05882352941176, 1.05882352941176, 1.05882352941176, 1.05882352941176, 1.05882352941176, 1.05882352941176, 
        1.05882352941176, 1.05882352941176, 1.0625, 1.0625, 1.0625, 1.0625, 1.0625, 1.0625, 1.0625, 1.0625, 1.0625, 1.0625, 
        1.0625, 1.0625, 1.0625, 1.0625, 1.0625, 1.0625, 1.07692307692308, 1.07692307692308, 1.07692307692308, 1.07692307692308, 
        1.07692307692308, 1.07692307692308, 1.07692307692308, 1.07692307692308, 1.07692307692308, 1.07692307692308, 1.07692307692308, 
        1.07692307692308, 1.07692307692308, 1.07692307692308, 1.07692307692308, 1.07692307692308, 1.07692307692308, 1.07692307692308, 
        1.07692307692308, 1.07692307692308, 1.07692307692308, 1.07692307692308, 1.07692307692308, 1.07692307692308, 1.07692307692308, 
        1.07692307692308, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.16666666666667, 1.16666666666667, 1.16666666666667, 
        1.16666666666667, 1.16666666666667, 1.16666666666667, 1.125, 1.125, 1.125, 1.125, 1.125, 1.125, 1.125, 1.125, 1.14285714285714, 
        1.14285714285714, 1.14285714285714, 1.14285714285714, 1.14285714285714, 1.14285714285714, 1.14285714285714), EnMuestra = c(1L, 
        1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
        1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
        1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
        1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
        1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
        1L, 1L, 1L, 1L, 1L)), row.names = c(1L, 2L, 3L, 4L, 5L, 6L, 7L, 8L, 9L, 11L, 12L, 13L, 14L, 15L, 16L, 17L, 18L, 19L, 
        20L, 23L, 24L, 25L, 26L, 27L, 28L, 29L, 30L, 32L, 33L, 34L, 35L, 36L, 37L, 38L, 39L, 40L, 41L, 42L, 43L, 44L, 45L, 
        47L, 48L, 49L, 50L, 51L, 52L, 53L, 54L, 55L, 56L, 57L, 59L, 60L, 61L, 62L, 63L, 65L, 67L, 68L, 69L, 70L, 71L, 73L, 
        74L, 75L, 76L, 77L, 78L, 79L, 80L, 81L, 82L, 83L, 84L, 85L, 86L, 87L, 88L, 89L, 90L, 91L, 92L, 93L, 94L, 95L, 96L, 
        97L, 98L, 99L, 100L, 102L, 103L, 104L, 105L, 106L, 107L, 108L, 109L, 111L, 112L, 113L, 114L, 115L, 116L, 117L, 118L, 
        119L, 120L, 121L, 122L, 124L, 125L, 126L, 127L, 128L, 129L, 130L, 131L, 132L, 133L, 134L, 135L, 136L, 137L, 138L, 
        140L, 141L, 142L, 143L, 144L, 145L, 146L, 147L, 149L, 150L, 151L, 152L, 153L, 154L, 155L, 156L, 158L, 159L, 160L, 
        161L, 162L, 163L, 164L, 165L, 167L), class = "data.frame"))
})

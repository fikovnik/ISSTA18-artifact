library(testthat)

.Random.seed <<- .ext.seed

test_that("DefCap", {
    CausaD <- c("A09", "A09", "A18", "A41", "A41", "A41", "A41", "B15", "B18", "B18", "C18", "C22", "C34", "C34", "C44", 
        "C45", "C56", "C61", "C61", "C71", "C91", "D50", "D53", "D58", "D61", "D61", "D61", "D64", "D64", "D64", "E11", "E11", 
        "E11", "E14", "E14", "E14", "E14", "E46", "E66", "E87", "F03", "F03", "F03", "F03", "F10", "F10", "F10", "F10", "F10", 
        "F10", "F20", "G12", "G20", "G20", "G20", "G30", "G37", "G40", "G40", "G40", "G80", "G80", "G91", "H44", "H54", "H66", 
        "H66", "H66", "H70", "I10", "I12", "I21", "I21", "I21", "I21", "I21", "I21", "I21", "I21", "I21", "I21", "I25", "I48", 
        "I61", "I63", "I64", "I77", "J18", "J18", "J18", "J18", "J18", "J18", "J44", "J44", "J44", "J44", "J44", "J44", "J44", 
        "J44", "J44", "J44", "J84", "K25", "K25", "K29", "K56", "K65", "K70", "K70", "K72", "K74", "K74", "K81", "K85", "K92", 
        "K92", "L02", "L03", "L08", "L89", "L89", "L89", "L89", "L90", "L93", "L97", "L98", "L98", "L98", "L98", "M06", "M06", 
        "M06", "M06", "M06", "M06", "M06", "M19", "M31", "M32", "M79", "N17", "N17", "N18", "N18", "N18", "N19", "N39", "Q21", 
        "Q22", "Q24", "Q24", "Q24", "Q26", "Q60", "Q61", "Q61", "R54", "R54", "R54", "R54", "R54", "R56", "R99", "R99")
    expect_equal(Sofi:::DefCap(cau = CausaD), list(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 
        3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 
        6, 6, 7, 7, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 
        10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12, 12, 12, 12, 12, 12, 
        12, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 14, 14, 17, 17, 17, 17, 
        17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18), 0L))
})

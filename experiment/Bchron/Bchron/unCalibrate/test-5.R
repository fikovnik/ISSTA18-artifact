library(testthat)

.Random.seed <<- .ext.seed

test_that("unCalibrate", {
    ageRange <- c(8000, 8005, 8010, 8015, 8020, 8025, 8030, 8035, 8040, 8045, 8050, 8055, 8060, 8065, 8070, 8075, 8080, 8085, 
        8090, 8095, 8100, 8105, 8110, 8115, 8120, 8125, 8130, 8135, 8140, 8145, 8150, 8155, 8160, 8165, 8170, 8175, 8180, 
        8185, 8190, 8195, 8200, 8205, 8210, 8215, 8220, 8225, 8230, 8235, 8240, 8245, 8250, 8255, 8260, 8265, 8270, 8275, 
        8280, 8285, 8290, 8295, 8300, 8305, 8310, 8315, 8320, 8325, 8330, 8335, 8340, 8345, 8350, 8355, 8360, 8365, 8370, 
        8375, 8380, 8385, 8390, 8395, 8400, 8405, 8410, 8415, 8420, 8425, 8430, 8435, 8440, 8445, 8450, 8455, 8460, 8465, 
        8470, 8475, 8480, 8485, 8490, 8495, 8500, 8505, 8510, 8515, 8520, 8525, 8530, 8535, 8540, 8545, 8550, 8555, 8560, 
        8565, 8570, 8575, 8580, 8585, 8590, 8595, 8600, 8605, 8610, 8615, 8620, 8625, 8630, 8635, 8640, 8645, 8650, 8655, 
        8660, 8665, 8670, 8675, 8680, 8685, 8690, 8695, 8700, 8705, 8710, 8715, 8720, 8725, 8730, 8735, 8740, 8745, 8750, 
        8755, 8760, 8765, 8770, 8775, 8780, 8785, 8790, 8795, 8800, 8805, 8810, 8815, 8820, 8825, 8830, 8835, 8840, 8845, 
        8850, 8855, 8860, 8865, 8870, 8875, 8880, 8885, 8890, 8895, 8900, 8905, 8910, 8915, 8920, 8925, 8930, 8935, 8940, 
        8945, 8950, 8955, 8960, 8965, 8970, 8975, 8980, 8985, 8990, 8995, 9000)
    expect_equal(Bchron:::unCalibrate(calAges = ageRange, type = "ages"), c(7188, 7196, 7208, 7221, 7233, 7245, 7256, 7261, 
        7267, 7275, 7282, 7288, 7293, 7298, 7301, 7303, 7303, 7300, 7290, 7283, 7281, 7283, 7289, 7293, 7285, 7280, 7283, 
        7291, 7287, 7278, 7281, 7290, 7302, 7317, 7331, 7347, 7365, 7383, 7395, 7404, 7415, 7424, 7432, 7440, 7445, 7448, 
        7447, 7446, 7443, 7438, 7439, 7441, 7434, 7421, 7414, 7415, 7420, 7423, 7427, 7432, 7437, 7443, 7446, 7450, 7457, 
        7465, 7476, 7480, 7485, 7499, 7510, 7512, 7513, 7524, 7528, 7539, 7554, 7567, 7581, 7593, 7596, 7610, 7623, 7638, 
        7652, 7662, 7678, 7680, 7680, 7682, 7690, 7704, 7710, 7713, 7708, 7709, 7716, 7724, 7721, 7712, 7705, 7704, 7709, 
        7714, 7722, 7729, 7722, 7718, 7732, 7755, 7768, 7776, 7779, 7782, 7780, 7779, 7781, 7786, 7800, 7822, 7839, 7850, 
        7859, 7859, 7857, 7856, 7863, 7873, 7886, 7898, 7907, 7912, 7916, 7919, 7913, 7906, 7904, 7906, 7905, 7906, 7914, 
        7918, 7918, 7918, 7924, 7931, 7936, 7934, 7931, 7930, 7932, 7935, 7935, 7939, 7944, 7956, 7968, 7971, 7976, 7982, 
        7986, 7985, 7987, 7992, 7997, 7988, 7973, 7961, 7954, 7953, 7957, 7959, 7964, 7976, 7986, 7992, 7985, 7973, 7969, 
        7973, 7981, 7983, 7981, 7975, 7967, 7961, 7962, 7967, 7966, 7964, 7966, 7971, 7972, 7968, 7971, 7980, 7995, 8004, 
        8015, 8032, 8055))
})

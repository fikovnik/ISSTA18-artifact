library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11248.2626243949, 20.6853933274746)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11248, 
        ageSds = 21, calCurves = "intcal13", ageGrid = c(13057, 13058, 13059, 13060, 13061, 13062, 13063, 13064, 13065, 13066, 
            13067, 13068, 13069, 13070, 13071, 13072, 13073, 13074, 13075, 13076, 13077, 13078, 13079, 13080, 13081, 13082, 
            13083, 13084, 13085, 13086, 13087, 13088, 13089, 13090, 13091, 13092, 13093, 13094, 13095, 13096, 13097, 13098, 
            13099, 13100, 13101, 13102, 13103, 13104, 13105, 13106, 13107, 13108, 13109, 13110, 13111, 13112, 13113, 13114, 
            13115, 13116, 13117, 13118, 13119, 13120, 13121, 13122, 13123, 13124, 13125, 13126, 13127, 13128, 13129, 13130, 
            13131, 13132, 13133, 13134, 13135, 13136, 13137, 13138, 13139, 13140, 13141, 13142, 13143, 13144, 13145, 13146, 
            13147, 13148, 13149, 13150, 13151, 13152, 13153, 13154, 13155, 13156, 13157, 13158, 13159, 13160, 13161, 13162, 
            13163, 13164, 13165, 13166, 13167), densities = c(1.09011505004895e-05, 1.58110045951699e-05, 2.27575440999564e-05, 
            3.25025634804132e-05, 4.74645779740576e-05, 6.86649726962047e-05, 9.83894521542033e-05, 0.000139619185161747, 
            0.000196183374411829, 0.000279139500419832, 0.000392725173049546, 0.000546235205228689, 0.000750951197818121, 
            0.00102024621342616, 0.00136783435324364, 0.00181203868256842, 0.00237153854418728, 0.0030658300123761, 0.00391426979511594, 
            0.00501274532082798, 0.00632756011875625, 0.00787124151877975, 0.00964743388458726, 0.0116482925402659, 0.0136838856037397, 
            0.0158660280187625, 0.0181543448679924, 0.0204971105031908, 0.0228325703146808, 0.0249158814305432, 0.0268780744456658, 
            0.0286601937627642, 0.0302051510951869, 0.031460743239243, 0.0322531919427351, 0.032794100617692, 0.0330686687064444, 
            0.0330686114881169, 0.0327925688297218, 0.0323125837987481, 0.0316222398720059, 0.0307345735786534, 0.0296664410550139, 
            0.0284379725935042, 0.0273820368180461, 0.0262529583541952, 0.0250627658236758, 0.02382381257082, 0.0225485561627459, 
            0.0212533165285626, 0.0199467453970302, 0.0186402679757108, 0.0173446238019683, 0.0160697284863103, 0.0151811033647721, 
            0.0143107482741539, 0.0134612812247036, 0.0126350352851941, 0.0118340554403061, 0.0109158714423048, 0.0100389224585358, 
            0.0092050140854454, 0.00841541417375203, 0.00767088432972065, 0.00697630772779989, 0.00632661434683614, 0.005721236994883, 
            0.00515927694947667, 0.00463954858391286, 0.00416425197731742, 0.0037277058963321, 0.0033281207440565, 0.00296359501504614, 
            0.00263215016627115, 0.00228414950446806, 0.00197525756985968, 0.00170225250960864, 0.00146197909969997, 0.0012513861894669, 
            0.00106755638289589, 0.000907728518370714, 0.000769313608544486, 0.00064990496492819, 0.000547283261815139, 0.000471255116481256, 
            0.000404868159538984, 0.000347052959269641, 0.000296833877364177, 0.000253324859106404, 0.000209050218290726, 
            0.000171956738272752, 0.000140993405705465, 0.000115240426363007, 9.38972627405021e-05, 8.09082885507241e-05, 
            6.960488314097e-05, 5.97858811391797e-05, 5.12714318425594e-05, 4.39011432779292e-05, 3.74305878825412e-05, 3.18609837272903e-05, 
            2.70756305437574e-05, 2.29715360536933e-05, 1.9458026217164e-05, 1.7557541548489e-05, 1.58325547440285e-05, 1.42679508336378e-05, 
            1.28498029604104e-05, 1.15652904347972e-05, 1.07888344563621e-05, 1.00618781006264e-05))), class = "BchronCalibratedDates"))
})

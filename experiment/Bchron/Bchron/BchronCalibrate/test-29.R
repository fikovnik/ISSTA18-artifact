library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(12389.3, 16)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 12389, 
        ageSds = 16, calCurves = "intcal13", ageGrid = c(14219, 14220, 14221, 14222, 14223, 14224, 14225, 14226, 14227, 14228, 
            14229, 14230, 14231, 14232, 14233, 14234, 14235, 14236, 14237, 14238, 14239, 14240, 14241, 14242, 14243, 14244, 
            14245, 14246, 14247, 14248, 14249, 14250, 14251, 14252, 14253, 14254, 14255, 14256, 14257, 14258, 14259, 14260, 
            14261, 14262, 14263, 14264, 14265, 14266, 14267, 14268, 14269, 14270, 14271, 14272, 14273, 14274, 14275, 14276, 
            14277, 14278, 14279, 14280, 14281, 14282, 14283, 14284, 14285, 14286, 14287, 14288, 14289, 14290, 14291, 14292, 
            14293, 14294, 14295, 14296, 14297, 14298, 14299, 14300, 14301, 14302, 14303, 14304, 14305, 14306, 14307, 14308, 
            14309, 14310, 14311, 14312, 14313, 14314, 14315, 14316, 14317, 14318, 14319, 14320, 14321, 14322, 14323, 14324, 
            14325, 14326, 14327, 14328, 14329, 14330, 14331, 14332, 14333, 14334, 14335, 14336, 14337, 14338, 14339, 14340, 
            14341, 14342, 14343, 14344, 14345, 14346, 14347, 14348, 14349, 14350, 14351, 14352, 14353, 14354, 14355, 14356, 
            14357, 14358, 14359, 14360, 14361, 14362, 14363, 14364, 14365, 14366, 14367, 14368, 14369, 14370, 14371, 14372, 
            14373, 14374, 14375, 14376, 14377, 14378, 14379, 14380, 14381, 14382, 14383, 14384, 14385, 14386, 14387, 14388, 
            14389, 14390, 14391, 14392, 14393, 14394, 14395, 14396, 14397, 14398, 14399, 14400, 14401, 14402, 14403, 14404, 
            14405, 14406, 14407, 14408, 14409, 14410, 14411, 14412, 14413, 14414, 14415, 14416, 14417, 14418, 14419, 14420, 
            14421, 14422, 14423, 14424, 14425, 14426, 14427, 14428, 14429, 14430, 14431, 14432, 14433, 14434, 14435, 14436, 
            14437, 14438, 14439, 14440, 14441, 14442, 14443, 14444, 14445, 14446, 14447, 14448, 14449, 14450, 14451, 14452, 
            14453, 14454, 14455, 14456, 14457, 14458, 14459, 14460, 14461, 14462, 14463, 14464, 14465, 14466, 14467, 14468, 
            14469, 14470, 14471, 14472, 14473, 14474, 14475, 14476, 14477, 14478, 14479, 14480, 14481, 14482, 14483, 14484, 
            14485, 14486, 14487, 14488, 14489, 14490, 14491, 14492, 14493, 14494, 14495, 14496, 14497, 14498, 14499, 14500, 
            14501, 14502, 14503, 14504, 14505, 14506, 14507, 14508, 14509, 14510, 14511, 14512, 14513, 14514, 14515, 14516, 
            14517, 14518, 14519, 14520, 14521, 14522, 14523, 14524, 14525, 14526, 14527, 14528, 14529, 14530, 14531, 14532, 
            14533, 14534, 14535, 14536, 14537, 14538, 14539, 14540, 14541, 14542, 14543, 14544, 14545, 14546, 14547, 14548, 
            14549, 14550, 14551, 14552, 14553, 14554, 14555, 14556, 14557, 14558, 14559, 14560, 14561, 14562, 14563, 14564, 
            14565, 14566, 14567, 14568, 14569, 14570, 14571, 14572, 14573, 14574, 14575, 14576, 14577, 14578, 14579, 14580, 
            14581, 14582, 14583, 14584, 14585, 14586, 14587, 14588, 14589, 14590, 14591, 14592, 14593, 14594, 14595, 14596, 
            14597, 14598, 14599, 14600, 14601, 14602, 14603, 14604, 14605, 14606, 14607, 14608, 14609, 14610, 14611, 14612, 
            14613, 14614, 14615, 14616, 14617, 14618, 14619, 14620, 14621, 14622, 14623, 14624, 14625, 14626, 14627, 14628, 
            14629, 14630, 14631, 14632, 14633, 14634, 14635, 14636, 14637, 14638, 14639, 14640, 14641, 14642, 14643, 14644, 
            14645, 14646, 14647, 14648, 14649, 14650, 14651, 14652, 14653, 14654, 14655, 14656, 14657, 14658, 14659, 14660, 
            14661, 14662, 14663, 14664), densities = c(1.02130948664078e-05, 1.16228317059152e-05, 1.32134264563175e-05, 
            1.50059490389076e-05, 1.70236072454768e-05, 1.92919186064074e-05, 2.18388898346847e-05, 2.46952032664732e-05, 
            2.78944095472536e-05, 3.14731256228517e-05, 3.54712368876172e-05, 3.99321021181427e-05, 4.49727586131041e-05, 
            5.05879415113787e-05, 5.68343134286229e-05, 6.37729318813303e-05, 7.14694352696544e-05, 7.99942159474517e-05, 
            8.94225768569373e-05, 9.98348679102922e-05, 0.000111316598016952, 0.000123958518389891, 0.0001357905258417, 0.000148608979004163, 
            0.000162480313760592, 0.000177473785477667, 0.000193661416684909, 0.000211117922369264, 0.000229920611119873, 
            0.000250149260386143, 0.000271885964160228, 0.000295214951463729, 0.000324559604121282, 0.000356328516674118, 
            0.000390663842309024, 0.00042770953944651, 0.000467610588074684, 0.000510512114720665, 0.000556558425378094, 
            0.00060589194675533, 0.000658652077366307, 0.000714973951250859, 0.00077498711845774, 0.000838814147865461, 0.000906569159413137, 
            0.000978356294363726, 0.00105426813380872, 0.00113438407720112, 0.00121876869428291, 0.00130747006529168, 0.00140051812578131, 
            0.00149792303374704, 0.00158487276224483, 0.00167499518563857, 0.00176825687789994, 0.00186461074247613, 0.00196399542538496, 
            0.00206633478289816, 0.002171537411226, 0.00227949624551811, 0.00239008823530964, 0.00250317410326289, 0.00261932317480923, 
            0.0027376243650681, 0.00285788362976785, 0.00297989072058245, 0.00310341951067122, 0.00322822843599275, 0.00335406105416538, 
            0.00348064672166583, 0.00360770138911772, 0.00373492851333256, 0.00384037976954671, 0.00394558565230863, 0.00405036002348775, 
            0.00415451253586622, 0.00425784917360508, 0.00436017282433116, 0.00446128388071666, 0.00456098086917711, 0.00465906110307799, 
            0.00475532135761648, 0.00483052186945706, 0.00490436217897408, 0.00497673923482734, 0.00504755059387697, 0.00511669465889556, 
            0.00518407091829612, 0.00524958018710655, 0.00531312484839467, 0.00537460909433144, 0.00543393916607254, 0.00549102359161836, 
            0.00554577342081674, 0.00559810245666457, 0.00564792748206615, 0.00569516848121662, 0.00573974885477955, 0.00578159562804967, 
            0.00582063965130424, 0.00585681579156804, 0.00589006311504563, 0.00591303094397926, 0.00593430068380458, 0.0059538512069037, 
            0.00597166287740833, 0.00598771758411672, 0.00600199877119392, 0.00601449146657921, 0.00602518230803405, 0.0060340595667674, 
            0.00604111316857864, 0.00604479527316959, 0.0060476635866942, 0.00604971527896618, 0.00605094784995938, 0.00605135913265865, 
            0.00605094729568926, 0.00604971084572178, 0.00604764862964844, 0.00604475983652831, 0.00604104399929765, 0.00603650601129088, 
            0.00603114470577776, 0.0060249614886558, 0.00601795811052445, 0.00601013666601137, 0.00600149959285376, 0.00599204967073369, 
            0.0059817900198685, 0.00597072409935816, 0.0059588557052885, 0.00594622430186116, 0.00593280797171207, 0.00591861226101602, 
            0.00590364302828178, 0.005887906440246, 0.0058714089675613, 0.00585415738027935, 0.00583615874313479, 0.00581742041063634, 
            0.00579795002196593, 0.00578794277035457, 0.00577775549569572, 0.00576738923056937, 0.00575684502432432, 0.00574612394289916, 
            0.00573522706863876, 0.00572415550010919, 0.00571291035191011, 0.00570149275448375, 0.00568990385392343, 0.00567814481177781, 
            0.0056662168048537, 0.00565412102501678, 0.00564185867898885, 0.00562943098814521, 0.00561683918830771, 0.00560408452953679, 
            0.00559116827592158, 0.00557809170536674, 0.00556485610937989, 0.00553791307385341, 0.00551034976519552, 0.00548217698289058, 
            0.00545340572289847, 0.00542404717039589, 0.00539411269242872, 0.00536361383047591, 0.00533256229293438, 0.00530096994753456, 
            0.00526884881368673, 0.00523621105477341, 0.00520306897038788, 0.0051694349885284, 0.00513532165775844, 0.00510074163933216, 
            0.00506570769930124, 0.00503023270060254, 0.00499432959513615, 0.00495801141584432, 0.00492129126878972, 0.0048841823252497, 
            0.00484669781382495, 0.00480885101257244, 0.00477065524117257, 0.00473212385312849, 0.00469327022801416, 0.00465410776376883, 
            0.00461464986904743, 0.00457490995563652, 0.00453490143093277, 0.0044950893460671, 0.00445505418537595, 0.00441480906550164, 
            0.00437436704481424, 0.00433374111689524, 0.00429294420415307, 0.00425198915156484, 0.00421088872055166, 0.0041696555829945, 
            0.00412830231538448, 0.00408630159493583, 0.00404418892958412, 0.00400197697430828, 0.00395967828598643, 0.00391730531753546, 
            0.00387487041219665, 0.00383238579796087, 0.00378986358214035, 0.00374731574609356, 0.00370475414009625, 0.00366280860493652, 
            0.00362088620454234, 0.00357899784291347, 0.0035371542611842, 0.00349536603412509, 0.00345364356681818, 0.00341199709149583, 
            0.00337043666454719, 0.00332897216369576, 0.00328761328533812, 0.0032247753605623, 0.00316220619475793, 0.00309993817060855, 
            0.00303800272521977, 0.00297643033150851, 0.00291525048148864, 0.00285449167145149, 0.0027941813890223, 0.00273434610207035, 
            0.00267501124945934, 0.00263574479353885, 0.00259671859305772, 0.00255793941479316, 0.00251941381868666, 0.0024811481575885, 
            0.00244314857715426, 0.00240542101588244, 0.00236797120529411, 0.00233080467025549, 0.00229392672943208, 0.00223841972681422, 
            0.00218359026142676, 0.00212945502991226, 0.00207602968017749, 0.00202332881801234, 0.001971366015165, 0.0019201538188293, 
            0.00186970376248737, 0.00182002637804915, 0.00177113120923955, 0.00173945574979294, 0.00170813041170432, 0.00167715698653689, 
            0.0016465370896506, 0.0016162721627688, 0.0015863634766165, 0.00155681213361999, 0.00152761907066676, 0.0014987850619252, 
            0.00147031072171355, 0.00144150752872544, 0.00141307311330795, 0.00138500801498617, 0.00135731261075643, 0.00132998711803275, 
            0.00130303159765126, 0.00127644595692307, 0.00125022995273429, 0.00122438319469202, 0.00119890514830703, 0.00117379513821647, 
            0.00114905235143736, 0.00112467584065001, 0.00110066452750981, 0.00107701720597876, 0.00105373254568006, 0.00103080909526676, 
            0.00100824528580394, 0.000986039434162813, 0.000964189746418917, 0.00093295255207039, 0.000902477982649089, 0.000872758177196475, 
            0.000843784872181209, 0.000815549425735211, 0.000788042841582309, 0.000761255792631261, 0.000735178644200574, 
            0.000709801476844867, 0.000685114108759964, 0.000668543594818854, 0.000652284908622825, 0.000636334880920446, 
            0.00062069029312453, 0.000605347880286614, 0.000590304334033106, 0.000575556305458096, 0.000561100407972877, 
            0.000546933220112106, 0.000533051288292131, 0.000526858677710139, 0.000520726477912214, 0.00051465427707674, 
            0.000508641663451786, 0.000502688225406787, 0.000496793551482218, 0.000490957230439085, 0.000485178851307612, 
            0.000479458003434571, 0.000473794276530972, 0.000461848313358331, 0.000450150600231122, 0.000438697647622148, 
            0.000427485963363042, 0.000416512054566756, 0.000405772429498261, 0.000395263599390862, 0.000384982080209287, 
            0.000374924394360538, 0.000365087072350319, 0.000360249966178275, 0.000355466654388045, 0.000350736706276632, 
            0.000346059691938362, 0.000341435182311038, 0.000336862749220423, 0.000332341965424358, 0.000327872404656058, 
            0.000323453641666215, 0.000319085252265109, 0.000310193344840643, 0.000301509125333094, 0.000293029080499498, 
            0.000284749713619064, 0.000276667545927013, 0.000268779117996397, 0.00026108099106642, 0.000253569748318418, 
            0.000246241996100628, 0.000239094365100519, 0.000235713474026349, 0.00023237381356257, 0.00022907499298685, 0.000225816623437346, 
            0.000222598317935926, 0.000219419691410128, 0.00021628036071474, 0.00021317994465273, 0.00021011806399524, 0.000207094341501495, 
            0.000204108401937512, 0.000201159872094455, 0.000198248380806365, 0.000195373558967, 0.000192535039546599, 0.000189732457607501, 
            0.000186965450319435, 0.000184233656974213, 0.000181536718999582, 0.000178874279973008, 0.00017604060630834, 
            0.000173245238499021, 0.000170487777980665, 0.000167767828299098, 0.000165084995134802, 0.000162438886326162, 
            0.000159829111892202, 0.000157255284054589, 0.000154717017258703, 0.000152213928194411, 0.000152213928194411, 
            0.000152213928194411, 0.000152213928194411, 0.000152213928194411, 0.000152213928194411, 0.000152213928194411, 
            0.000152213928194411, 0.000152213928194411, 0.000152213928194411, 0.000152213928194411, 0.000149928668689418, 
            0.000147673641969081, 0.00014544852069547, 0.000143252979831952, 0.000141086696648697, 0.000138949350727314, 
            0.000136840623965221, 0.000134760200579562, 0.00013270776711049, 0.000130683012424375, 0.000128685627716214, 
            0.000126715306511786, 0.000124771744669402, 0.000122854640381048, 0.000120963694173482, 0.000119098608908583, 
            0.000117259089783467, 0.000115444844330231, 0.000113655582415141, 0.000111891016237782, 0.000108434831551694, 
            0.00010507403447001, 0.000101806406394657, 9.86297658362685e-05, 9.55419682975987e-05, 9.25409061372446e-05, 
            8.96245084137463e-05, 8.67907407111749e-05, 8.40376049472386e-05, 8.1363139164035e-05, 7.87654173029843e-05, 
            7.6242548964057e-05, 7.37926791503021e-05, 7.14139879986117e-05, 6.91046904968745e-05, 6.68630361888807e-05, 
            6.46873088671145e-05, 6.25758262543329e-05, 6.05269396747712e-05, 5.85390337151291e-05, 5.48241293418941e-05, 
            5.13258050100076e-05, 4.80328675919077e-05, 4.49345986088643e-05, 4.2020741497125e-05, 3.92814886644012e-05, 
            3.67074683906588e-05, 3.42897316238897e-05, 3.20197387179811e-05, 2.98893461561513e-05, 2.78907933004675e-05, 
            2.60166892043352e-05, 2.42599995219558e-05, 2.26140335457089e-05, 2.10724313993797e-05, 1.9629151412658e-05, 
            1.82784576994169e-05, 1.70149079599245e-05, 1.58333415247408e-05, 1.47288676556754e-05, 1.344307664653e-05, 1.22630033349443e-05, 
            1.11806118996632e-05, 1.01884132149913e-05))), class = "BchronCalibratedDates"))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11256.643326808, 23.8775304159382)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11257, 
        ageSds = 24, calCurves = "intcal13", ageGrid = c(13057, 13058, 13059, 13060, 13061, 13062, 13063, 13064, 13065, 13066, 
            13067, 13068, 13069, 13070, 13071, 13072, 13073, 13074, 13075, 13076, 13077, 13078, 13079, 13080, 13081, 13082, 
            13083, 13084, 13085, 13086, 13087, 13088, 13089, 13090, 13091, 13092, 13093, 13094, 13095, 13096, 13097, 13098, 
            13099, 13100, 13101, 13102, 13103, 13104, 13105, 13106, 13107, 13108, 13109, 13110, 13111, 13112, 13113, 13114, 
            13115, 13116, 13117, 13118, 13119, 13120, 13121, 13122, 13123, 13124, 13125, 13126, 13127, 13128, 13129, 13130, 
            13131, 13132, 13133, 13134, 13135, 13136, 13137, 13138, 13139, 13140, 13141, 13142, 13143, 13144, 13145, 13146, 
            13147, 13148, 13149, 13150, 13151, 13152, 13153, 13154, 13155, 13156, 13157, 13158, 13159, 13160, 13161, 13162, 
            13163, 13164, 13165, 13166, 13167, 13168, 13169, 13170, 13171, 13172, 13173, 13174, 13175, 13176, 13177, 13178, 
            13179, 13180, 13181, 13182, 13183, 13184, 13185, 13186, 13187, 13188, 13189, 13190, 13191, 13192, 13193, 13194, 
            13195, 13196, 13197, 13198, 13199, 13200), densities = c(1.33257708519305e-05, 1.83465476163236e-05, 2.5109113793334e-05, 
            3.41575348920448e-05, 4.74109455760954e-05, 6.53278591284498e-05, 8.93509835831081e-05, 0.000121292979988192, 
            0.000163404011407782, 0.000222921619036319, 0.000301469781443161, 0.000404089493044632, 0.000536778329329486, 
            0.000706543685225242, 0.00092045523345703, 0.00118809553332143, 0.00151925204555788, 0.00192435230558559, 0.00241414869024044, 
            0.00304411726688508, 0.00379600760359226, 0.00468053490916432, 0.00570563173449385, 0.00687530224528835, 0.00808701338758518, 
            0.00941683246519738, 0.0108541798402082, 0.012382896174223, 0.013981074061676, 0.0154888453303275, 0.0170079326277507, 
            0.0185099398841532, 0.0199640370859105, 0.0213379356501468, 0.0223963255050867, 0.0233587409078484, 0.0242076547855248, 
            0.0249269949051481, 0.0255026501447814, 0.0258881240920381, 0.0261411963634503, 0.0262572760647696, 0.0262339454097701, 
            0.0260710401091482, 0.0258488547989, 0.025545026970333, 0.0251621388909441, 0.024703536840102, 0.0241732815554071, 
            0.0235769248058234, 0.0229193070196145, 0.0222062531291441, 0.0214439871092362, 0.0206390389479027, 0.0200432074745079, 
            0.0194317816126098, 0.0188072608155508, 0.0181721349219356, 0.0175288675645428, 0.0167530963758144, 0.0159735409662631, 
            0.0151940689868606, 0.0144183580741696, 0.0136498700996914, 0.0128948613817506, 0.01215339361668, 0.0114281188619031, 
            0.0107214107447074, 0.0100353598461426, 0.00937495365124898, 0.00873850355327757, 0.00812721711196305, 0.00754203805181867, 
            0.00698365781525838, 0.00636618391179338, 0.00578616077381074, 0.00524355308240297, 0.00473798463195806, 0.00426877790730894, 
            0.00383499414133128, 0.0034354730497018, 0.00306887153764561, 0.00273370077794378, 0.00242836116650086, 0.0021893652507662, 
            0.00196993608148759, 0.00176897470417463, 0.0015853799226416, 0.00141805822893272, 0.00123934905219934, 0.00108012830515352, 
            0.000938746168707306, 0.000813619359351469, 0.000703240588170436, 0.000632420590413714, 0.000567937737274005, 
            0.000509320885454438, 0.000456122708260222, 0.000407919819490791, 0.000363817081743477, 0.000324018808902158, 
            0.000288163703635795, 0.000255913595930987, 0.000226952834732171, 0.000210773654393606, 0.000195642193222993, 
            0.00018149921345045, 0.000168288154715066, 0.000155955064044313, 0.000148276483291415, 0.000140944011868739, 
            0.000133943836825119, 0.000127262600613786, 0.000120887391053653, 0.000114805731249374, 0.00010900556948738, 
            0.000103475269124844, 9.82035984875721e-05, 9.31797207914681e-05, 8.83931841022376e-05, 8.38339113462675e-05, 
            7.94921903853252e-05, 7.53586641668641e-05, 7.14243209605728e-05, 6.79362960883111e-05, 6.46084365168245e-05, 
            6.14339633760335e-05, 5.84063530681322e-05, 5.55193293500288e-05, 5.00443417994934e-05, 4.5078982588868e-05, 
            4.05792454087793e-05, 3.65045456645938e-05, 3.28174950968557e-05, 3.03018303690301e-05, 2.79691695243956e-05, 
            2.58070625637131e-05, 2.38038328286905e-05, 2.19485350943502e-05, 1.91288868928771e-05, 1.66549442425476e-05, 
            1.44867365380135e-05, 1.25885700494377e-05, 1.09286183260029e-05))), class = "BchronCalibratedDates"))
})

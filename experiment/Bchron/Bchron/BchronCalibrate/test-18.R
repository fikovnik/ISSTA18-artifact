library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11257.3028495789, 42.1097911834717)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11257, 
        ageSds = 42, calCurves = "intcal13", ageGrid = c(12998, 12999, 13000, 13001, 13002, 13003, 13004, 13005, 13006, 13007, 
            13008, 13009, 13010, 13011, 13012, 13013, 13014, 13015, 13016, 13017, 13018, 13019, 13020, 13021, 13022, 13023, 
            13024, 13025, 13026, 13027, 13028, 13029, 13030, 13031, 13032, 13033, 13034, 13035, 13036, 13037, 13038, 13039, 
            13040, 13041, 13042, 13043, 13044, 13045, 13046, 13047, 13048, 13049, 13050, 13051, 13052, 13053, 13054, 13055, 
            13056, 13057, 13058, 13059, 13060, 13061, 13062, 13063, 13064, 13065, 13066, 13067, 13068, 13069, 13070, 13071, 
            13072, 13073, 13074, 13075, 13076, 13077, 13078, 13079, 13080, 13081, 13082, 13083, 13084, 13085, 13086, 13087, 
            13088, 13089, 13090, 13091, 13092, 13093, 13094, 13095, 13096, 13097, 13098, 13099, 13100, 13101, 13102, 13103, 
            13104, 13105, 13106, 13107, 13108, 13109, 13110, 13111, 13112, 13113, 13114, 13115, 13116, 13117, 13118, 13119, 
            13120, 13121, 13122, 13123, 13124, 13125, 13126, 13127, 13128, 13129, 13130, 13131, 13132, 13133, 13134, 13135, 
            13136, 13137, 13138, 13139, 13140, 13141, 13142, 13143, 13144, 13145, 13146, 13147, 13148, 13149, 13150, 13151, 
            13152, 13153, 13154, 13155, 13156, 13157, 13158, 13159, 13160, 13161, 13162, 13163, 13164, 13165, 13166, 13167, 
            13168, 13169, 13170, 13171, 13172, 13173, 13174, 13175, 13176, 13177, 13178, 13179, 13180, 13181, 13182, 13183, 
            13184, 13185, 13186, 13187, 13188, 13189, 13190, 13191, 13192, 13193, 13194, 13195, 13196, 13197, 13198, 13199, 
            13200, 13201, 13202, 13203, 13204, 13205, 13206, 13207, 13208, 13209, 13210, 13211, 13212, 13213, 13214, 13215, 
            13216, 13217, 13218, 13219, 13220, 13221, 13222, 13223, 13224, 13225, 13226, 13227, 13228, 13229, 13230, 13231, 
            13232, 13233, 13234, 13235, 13236, 13237, 13238, 13239, 13240, 13241, 13242, 13243, 13244, 13245, 13246, 13247, 
            13248, 13249, 13250, 13251, 13252, 13253, 13254, 13255, 13256, 13257, 13258, 13259, 13260, 13261, 13262, 13263, 
            13264, 13265, 13266, 13267, 13268, 13269, 13270, 13271, 13272, 13273, 13274, 13275), densities = c(1.08461301114263e-05, 
            1.21445758940762e-05, 1.35888368006485e-05, 1.47074387822829e-05, 1.59125403135149e-05, 1.72103149808327e-05, 
            1.86073312215573e-05, 2.01105736676091e-05, 2.17126426231616e-05, 2.34342317321037e-05, 2.52835280039944e-05, 
            2.72692160809063e-05, 2.94005032200679e-05, 3.17076189264732e-05, 3.41831035400376e-05, 3.68381219658761e-05, 
            3.96844841930938e-05, 4.27346747926804e-05, 4.53248864359226e-05, 4.80605083138658e-05, 5.0948906151289e-05, 
            5.3997766167176e-05, 5.72151056769034e-05, 6.0644560826384e-05, 6.4263014846277e-05, 6.8079758738182e-05, 7.21044672210185e-05, 
            7.63472100190463e-05, 8.08184631979823e-05, 8.5529120528191e-05, 9.04905048527592e-05, 9.57143794367957e-05, 
            0.000101212959272362, 0.000108548605476654, 0.000116365628271107, 0.000124691479117272, 0.000133554851379858, 
            0.000142985712137425, 0.000153015332908719, 0.00016367631910522, 0.000175002638010424, 0.000187029645076469, 
            0.000199794108318968, 0.000216216966074962, 0.000233835304322297, 0.000252721635134713, 0.000272951578772675, 
            0.000294603885156415, 0.000321860092762888, 0.000351311111458234, 0.000383098970628033, 0.000417371412792418, 
            0.000454281778455222, 0.000505896444732087, 0.000562488864811053, 0.000624422792165746, 0.000692074193748619, 
            0.000765829839498424, 0.00086487279684457, 0.00097436782973628, 0.00109506172756077, 0.00122770373655467, 0.0013730373406333, 
            0.00154674191811396, 0.00173730554055958, 0.00194558680688909, 0.00217237349749318, 0.00241836291620335, 0.00270599776852826, 
            0.00301731884590157, 0.00335269748937406, 0.00371226347339651, 0.00409587440877028, 0.00450250794052311, 0.00493195999049286, 
            0.0053831239168813, 0.00585452767889144, 0.00634432165902687, 0.00688856528970105, 0.00744833180102948, 0.00801987103834016, 
            0.00859895746336755, 0.00918092860510031, 0.00971906966272199, 0.0102511297974263, 0.0107726392079405, 0.0112789993284071, 
            0.011765548238368, 0.012192550687145, 0.0125952560736088, 0.0129701631019233, 0.0133139248285069, 0.0136233986856496, 
            0.0138528821826371, 0.0140550900742151, 0.0142286545479764, 0.0143723823255097, 0.014485268490942, 0.0145598238847178, 
            0.0146083057971131, 0.0146304113351133, 0.0146259827864308, 0.0145950094206204, 0.0145526327351209, 0.0144943791933649, 
            0.0144204178037111, 0.0143309700181034, 0.0142263086133777, 0.014106813702007, 0.0139728274595647, 0.0138247711158706, 
            0.0136631095577848, 0.0134883488411944, 0.0133559165689909, 0.013217311819948, 0.013072754092974, 0.0129224708409404, 
            0.0127666968620488, 0.0125731586887011, 0.0123725435077303, 0.0121652921349687, 0.0119518542880434, 0.0117326869436528, 
            0.0115085609171802, 0.0112796727793635, 0.0110464909185617, 0.0108094841727758, 0.0105691202765818, 0.0103262652844809, 
            0.0100810140266443, 0.00983382040319759, 0.00958513121972438, 0.00933538491847542, 0.00904316910269578, 0.00875075488826961, 
            0.00845878331203157, 0.00816787136795923, 0.00787861016442039, 0.0075915632953073, 0.00730726542760076, 0.00702622110609769, 
            0.00674890377428975, 0.006475755008711, 0.00624534042062072, 0.00601852894382452, 0.00579554088284171, 0.00557657877145903, 
            0.00536182744412538, 0.00511554253509051, 0.00487546152535646, 0.00464179643841659, 0.0044147280489811, 0.00419440669104347, 
            0.00404106946913358, 0.00389127490969923, 0.00374505132416469, 0.00360242001821789, 0.00346339552359415, 0.00332744342430837, 
            0.00319512266416308, 0.00306643006002132, 0.00294135656545071, 0.00281988753773873, 0.00274832379243615, 0.0026780538753232, 
            0.00260907219671711, 0.0025413725379984, 0.00247494807329249, 0.00243152985998948, 0.00238867023728829, 0.00234636672658333, 
            0.00230461674571834, 0.00226341761182398, 0.00222276654415007, 0.00218266066688819, 0.00214309701198416, 0.00210407252193998, 
            0.0020655840526012, 0.00202762837593207, 0.00199020218277444, 0.00195330208559018, 0.00191692462118674, 0.00188106625342213, 
            0.0018465629361146, 0.00181255480257555, 0.00177903805500073, 0.001746008843833, 0.00171346327017485, 0.00164941244527019, 
            0.00158726500131268, 0.00152698821007561, 0.00146854873854746, 0.00141191272033149, 0.00137068734211939, 0.00133043935556644, 
            0.00129115403388761, 0.00125281655855175, 0.00121541203381461, 0.00115489035848897, 0.00109686256784931, 0.00104125869543737, 
            0.000988008691206809, 0.0009370425757938, 0.000888290585867902, 0.000841683310606843, 0.000797151819370026, 0.000754627780674827, 
            0.000714043572606738, 0.000682519411279203, 0.000652185081835473, 0.000623006533047345, 0.000594950122300385, 
            0.000567982642412425, 0.00053580272870502, 0.000505206331032901, 0.000476131952909968, 0.000448519396775791, 
            0.000422309811955203, 0.000407170488262919, 0.00039250667515342, 0.000378306301914902, 0.000364557486877023, 
            0.000351248539342829, 0.000338230422865006, 0.000325636959152067, 0.000313456814542317, 0.000301678852767191, 
            0.00029029213591803, 0.000282832775901824, 0.000275542489328056, 0.000268418117460443, 0.000261456541438722, 
            0.000254654682314903, 0.000248118573444081, 0.000241731832554972, 0.000235491596342405, 0.00022939504063766, 
            0.000223439380319526, 0.000217720564394791, 0.000212133240384679, 0.000206674831264877, 0.000201342797654046, 
            0.000196134637629728, 0.000191137088508181, 0.000186254914492168, 0.000181485811573517, 0.000176827511335713, 
            0.000172277780701662, 0.000165691810785372, 0.000159335472549931, 0.000153201759665722, 0.000147283835912892, 
            0.000141575032928819, 0.000134299851797109, 0.000127368058068959, 0.00012076529137332, 0.00011447768341595, 0.000108491847378966, 
            9.99711123144438e-05, 9.20690515028267e-05, 8.47453920969242e-05, 7.79620684277211e-05, 7.16831372636242e-05, 
            6.4968723046798e-05, 5.88413321794892e-05, 5.32542171645411e-05, 4.81638681107357e-05, 4.35298388588116e-05, 
            3.81310608186384e-05, 3.3362422950654e-05, 2.91560221859851e-05, 2.54504859400963e-05, 2.21904511993389e-05, 
            1.93260706301652e-05, 1.68125464012297e-05, 1.46096920063442e-05, 1.26815220309105e-05, 1.09958695120565e-05))), 
        class = "BchronCalibratedDates"))
})

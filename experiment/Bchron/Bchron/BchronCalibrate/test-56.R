library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11230.7333335876, 55.1539455413818)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11231, 
        ageSds = 55, calCurves = "intcal13", ageGrid = c(12834, 12835, 12836, 12837, 12838, 12839, 12840, 12841, 12842, 12843, 
            12844, 12845, 12846, 12847, 12848, 12849, 12850, 12851, 12852, 12853, 12854, 12855, 12856, 12857, 12858, 12859, 
            12860, 12861, 12862, 12863, 12864, 12865, 12866, 12867, 12868, 12869, 12870, 12871, 12872, 12873, 12874, 12875, 
            12876, 12877, 12878, 12879, 12880, 12881, 12882, 12883, 12884, 12885, 12886, 12887, 12888, 12889, 12890, 12891, 
            12892, 12893, 12894, 12895, 12896, 12897, 12898, 12899, 12900, 12901, 12902, 12903, 12904, 12905, 12906, 12907, 
            12908, 12909, 12910, 12911, 12912, 12913, 12914, 12915, 12916, 12917, 12918, 12919, 12920, 12921, 12922, 12923, 
            12924, 12925, 12926, 12927, 12928, 12929, 12930, 12931, 12932, 12933, 12934, 12935, 12936, 12937, 12938, 12939, 
            12940, 12941, 12942, 12943, 12944, 12945, 12946, 12947, 12948, 12949, 12950, 12951, 12952, 12953, 12954, 12955, 
            12956, 12957, 12958, 12959, 12960, 12961, 12962, 12963, 12964, 12965, 12966, 12967, 12968, 12969, 12970, 12971, 
            12972, 12973, 12974, 12975, 12976, 12977, 12978, 12979, 12980, 12981, 12982, 12983, 12984, 12985, 12986, 12987, 
            12988, 12989, 12990, 12991, 12992, 12993, 12994, 12995, 12996, 12997, 12998, 12999, 13000, 13001, 13002, 13003, 
            13004, 13005, 13006, 13007, 13008, 13009, 13010, 13011, 13012, 13013, 13014, 13015, 13016, 13017, 13018, 13019, 
            13020, 13021, 13022, 13023, 13024, 13025, 13026, 13027, 13028, 13029, 13030, 13031, 13032, 13033, 13034, 13035, 
            13036, 13037, 13038, 13039, 13040, 13041, 13042, 13043, 13044, 13045, 13046, 13047, 13048, 13049, 13050, 13051, 
            13052, 13053, 13054, 13055, 13056, 13057, 13058, 13059, 13060, 13061, 13062, 13063, 13064, 13065, 13066, 13067, 
            13068, 13069, 13070, 13071, 13072, 13073, 13074, 13075, 13076, 13077, 13078, 13079, 13080, 13081, 13082, 13083, 
            13084, 13085, 13086, 13087, 13088, 13089, 13090, 13091, 13092, 13093, 13094, 13095, 13096, 13097, 13098, 13099, 
            13100, 13101, 13102, 13103, 13104, 13105, 13106, 13107, 13108, 13109, 13110, 13111, 13112, 13113, 13114, 13115, 
            13116, 13117, 13118, 13119, 13120, 13121, 13122, 13123, 13124, 13125, 13126, 13127, 13128, 13129, 13130, 13131, 
            13132, 13133, 13134, 13135, 13136, 13137, 13138, 13139, 13140, 13141, 13142, 13143, 13144, 13145, 13146, 13147, 
            13148, 13149, 13150, 13151, 13152, 13153, 13154, 13155, 13156, 13157, 13158, 13159, 13160, 13161, 13162, 13163, 
            13164, 13165, 13166, 13167, 13168, 13169, 13170, 13171, 13172, 13173, 13174, 13175, 13176, 13177, 13178, 13179, 
            13180, 13181, 13182, 13183, 13184, 13185, 13186, 13187, 13188, 13189, 13190, 13191, 13192, 13193, 13194, 13195, 
            13196, 13197, 13198, 13199, 13200, 13201, 13202, 13203, 13204, 13205, 13206, 13207, 13208, 13209, 13210, 13211, 
            13212, 13213, 13214, 13215, 13216, 13217, 13218, 13219, 13220, 13221, 13222, 13223, 13224, 13225, 13226, 13227, 
            13228, 13229, 13230, 13231, 13232, 13233, 13234, 13235, 13236, 13237, 13238, 13239, 13240, 13241, 13242, 13243, 
            13244, 13245, 13246, 13247, 13248, 13249, 13250, 13251, 13252, 13253, 13254, 13255, 13256, 13257, 13258, 13259, 
            13260, 13261, 13262, 13263, 13264, 13265, 13266, 13267, 13268, 13269, 13270, 13271, 13272, 13273, 13274, 13275, 
            13276, 13277, 13278, 13279, 13280, 13281, 13282, 13283, 13284, 13285, 13286, 13287), densities = c(1.04296722108408e-05, 
            1.10855662488689e-05, 1.16371390021624e-05, 1.2214549406558e-05, 1.28189179736067e-05, 1.34514089665987e-05, 
            1.41132318572094e-05, 1.47995569709265e-05, 1.55172651775439e-05, 1.62676819447508e-05, 1.70521829118252e-05, 
            1.78721954914025e-05, 1.8288676429754e-05, 1.87143005883636e-05, 1.91492537022946e-05, 1.95937248928215e-05, 
            2.0047906719507e-05, 2.05200553103819e-05, 2.10026317289754e-05, 2.14958477792223e-05, 2.19999190895502e-05, 
            2.25150651700392e-05, 2.27636442903561e-05, 2.30148197058005e-05, 2.3268616621696e-05, 2.35250604640733e-05, 
            2.37841768813295e-05, 2.40552282157566e-05, 2.43291813038677e-05, 2.46060647608372e-05, 2.48859074530064e-05, 
            2.5168738499728e-05, 2.5454587275181e-05, 2.57434834102192e-05, 2.60354567942304e-05, 2.6330537576975e-05, 2.66287561704759e-05, 
            2.69301432508745e-05, 2.72347297603232e-05, 2.75425469088868e-05, 2.78536261764242e-05, 2.81679993145202e-05, 
            2.84963692974754e-05, 2.88283044706169e-05, 2.91638400746557e-05, 2.9503011654628e-05, 2.98458550620097e-05, 
            3.05540188268414e-05, 3.12777541735926e-05, 3.20173706955615e-05, 3.27731833039022e-05, 3.35455122984361e-05, 
            3.39441521366275e-05, 3.43471651448948e-05, 3.47545944611654e-05, 3.51664835874432e-05, 3.55828763921618e-05, 
            3.6403136138632e-05, 3.72409257115022e-05, 3.80965837106666e-05, 3.89704543723565e-05, 3.98628876411211e-05, 
            4.03304492508809e-05, 4.08030589416494e-05, 4.12807654861215e-05, 4.17636180562786e-05, 4.22516662258261e-05, 
            4.3213310851045e-05, 4.4195188325136e-05, 4.51976815809815e-05, 4.62211797382846e-05, 4.72660781781761e-05, 4.83493691631937e-05, 
            4.94554918569819e-05, 5.05848758116692e-05, 5.1737957382658e-05, 5.29151798059633e-05, 5.4098788747319e-05, 5.53067731559346e-05, 
            5.65395815257247e-05, 5.77976692958368e-05, 5.90814989274202e-05, 6.03915399804555e-05, 6.17282691907119e-05, 
            6.3092170546782e-05, 6.44837353671414e-05, 6.59034623773043e-05, 6.6624044599625e-05, 6.73518577869286e-05, 6.80869663974862e-05, 
            6.88294353669394e-05, 6.95793301107618e-05, 7.10788883727552e-05, 7.26081427004186e-05, 7.41676160370405e-05, 
            7.5757838981013e-05, 7.73793498619895e-05, 7.82143174453249e-05, 7.90575262916334e-05, 7.99090482324473e-05, 
            8.07689556125564e-05, 8.16373212924423e-05, 8.16373212924423e-05, 8.16373212924423e-05, 8.16373212924423e-05, 
            8.16373212924423e-05, 8.16373212924423e-05, 8.2488511302257e-05, 8.33478658168537e-05, 8.42154545118637e-05, 
            8.50913475563161e-05, 8.59756156150422e-05, 8.59756156150422e-05, 8.59756156150422e-05, 8.59756156150422e-05, 
            8.59756156150422e-05, 8.59756156150422e-05, 8.68683298509561e-05, 8.77695619274128e-05, 8.86793840105655e-05, 
            8.95978687716355e-05, 9.05250893893052e-05, 9.1489079190701e-05, 9.24624259134008e-05, 9.34452092557206e-05, 
            9.4437509464303e-05, 9.5439407336476e-05, 9.75017470376198e-05, 9.960446706423e-05, 0.000101748254896992, 0.000103933807295116, 
            0.000106161830366409, 0.000108433039636465, 0.00011074816011708, 0.000113107926373806, 0.000115513082592548, 
            0.000117964382645319, 0.000122973091522439, 0.000128173310046785, 0.000133571331065126, 0.000139173606476357, 
            0.000144986749104292, 0.000152591479525387, 0.000160552414408506, 0.000168883673026641, 0.00017759978779922, 
            0.000186715708235885, 0.000198132443862678, 0.000210167794875343, 0.000222849670884586, 0.000236206864384151, 
            0.000250269053913188, 0.000265130700395724, 0.000280764915863791, 0.000297204290233982, 0.000314482293327268, 
            0.000332633266483475, 0.000351535119184638, 0.000371368397342113, 0.000392169470929024, 0.000413975524135718, 
            0.000436824534530021, 0.00046485162932265, 0.000494413874909993, 0.000525575379455933, 0.000558401482313236, 
            0.000592958668604052, 0.000618622670278437, 0.000645222507612855, 0.000672783173348227, 0.000701329869429289, 
            0.000730887983719319, 0.000761348899437201, 0.000792865309548299, 0.000825462887765385, 0.000859167395323921, 
            0.000894004651176267, 0.000930152915635597, 0.000967493116596291, 0.00100605113264973, 0.0010458527542926, 0.00108692364603154, 
            0.00112067724530636, 0.00115527123102615, 0.00119071846302341, 0.00122703169023232, 0.00126422353620863, 0.00130249259674892, 
            0.0013416712871976, 0.0013817717566839, 0.0014228059589793, 0.00146478563602941, 0.00150772230117456, 0.00155162722206833, 
            0.00159651140330711, 0.00164238556878483, 0.0016892601437844, 0.00174949302412161, 0.00181133121287563, 0.00187479270473927, 
            0.00193989454130444, 0.00200665275247426, 0.00207508229737121, 0.00214519700484352, 0.00221700951367676, 0.00229053121262269, 
            0.00236577218036178, 0.00245854487455028, 0.00255382382888419, 0.00265161790267817, 0.00275193266595082, 0.00285477025511927, 
            0.00297811337415694, 0.00310488374718215, 0.00323506498016125, 0.00336863319113373, 0.00350555674391078, 0.00368650725849267, 
            0.00387283430722024, 0.00406441002918453, 0.00426108261063717, 0.00446267571854752, 0.00471548568043053, 0.00497492449887714, 
            0.00524051586790476, 0.00551172635234549, 0.00578796576683401, 0.00609417009847962, 0.00640468301926033, 0.00671851928235605, 
            0.00703462335127578, 0.00735187419710073, 0.00769494345260267, 0.00803646157192448, 0.00837480088127894, 0.00870828252947442, 
            0.00903518981677377, 0.00935362797759864, 0.009662033578825, 0.00995866584985642, 0.0102418072979121, 0.0105097803508725, 
            0.0107793755902604, 0.0110276338805627, 0.0112527413645919, 0.0114530263707559, 0.0116269804105171, 0.01176375071205, 
            0.0118757780979931, 0.0119623083911623, 0.0120227542454475, 0.0120567019068335, 0.0120643125108676, 0.0120490900727432, 
            0.0120111093389591, 0.0119505765742548, 0.0118678276619923, 0.0117822021428253, 0.0116817811094425, 0.0115669500025604, 
            0.0114381487299855, 0.0112958687999573, 0.0111567151454258, 0.0110074982506251, 0.0108486697174109, 0.0106807061856889, 
            0.0105041069026153, 0.0103609189621187, 0.0102130418693825, 0.0100607325142087, 0.00990425289872125, 0.00974386937190646, 
            0.00957999610812242, 0.00941277824894726, 0.00924249043437862, 0.0090694084742683, 0.00889380859933835, 0.00876714811125787, 
            0.00863945366560149, 0.00851082490421719, 0.00838136090794985, 0.00825116007176334, 0.00809437912747083, 0.00793686144897265, 
            0.00777877090171728, 0.00762026880371935, 0.00746151366821596, 0.00730290017968287, 0.00714435129389051, 0.00698601497468531, 
            0.00682803544675019, 0.00667055300812397, 0.00651396551377382, 0.00635815065450782, 0.00620323514948266, 0.00604934116716596, 
            0.00589658621338874, 0.00571991555881441, 0.00554511833450271, 0.00537235630718252, 0.00520178201077876, 0.00503353866629417, 
            0.00486776013479142, 0.00470457090246568, 0.00454408609669095, 0.00438641153182227, 0.00423164378344078, 0.004101406797861, 
            0.00397341935212399, 0.00384772633343831, 0.00372436791582016, 0.00360337964698742, 0.00346465755629507, 0.00332925578624989, 
            0.00319720985608906, 0.00306854745223108, 0.00294328868940167, 0.00285583345007036, 0.00277012539394658, 0.00268616531545616, 
            0.00260395228794663, 0.00252348372046702, 0.00244450365212382, 0.00236726430103571, 0.00229175869486699, 0.00221797840957798, 
            0.00214591362922276, 0.00210330415739707, 0.00206130895414266, 0.00201992528673684, 0.00197915026329375, 0.00193898083745984, 
            0.00191261175666884, 0.00188650846790052, 0.00186066995166758, 0.00183509516149491, 0.0018097830245277, 0.00178473244213868, 
            0.00175994229053296, 0.00173541142135051, 0.00171113866226692, 0.00168712281759047, 0.00166336266885769, 0.00163985697542553, 
            0.00161660447506054, 0.00159360388452548, 0.0015708539001616, 0.00154876244183009, 0.0015269127903314, 0.00150530356493487, 
            0.00148393336911689, 0.00146280079109564, 0.0014210473771649, 0.00138023332016809, 0.0013403468421839, 0.00130137596250036, 
            0.00126330851383225, 0.00123538855609534, 0.00120796341728822, 0.00118102779093557, 0.00115457632944475, 0.00112860364757478, 
            0.00108625335520555, 0.00104519776382135, 0.0010054113612065, 0.000966868470358343, 0.000929543288850443, 0.00089340992672873, 
            0.000858442442930801, 0.000824614880222496, 0.000791901298649459, 0.000760275807504884, 0.000735505209853581, 
            0.000711411438689551, 0.000687981228428875, 0.000665201369030446, 0.000643058714807219, 0.000616285751808385, 
            0.000590460986044921, 0.000565559323201576, 0.000541555912708146, 0.000518426168087082, 0.00050491679106381, 
            0.000491709464490197, 0.000478799006383524, 0.000466180275992683, 0.000453848175001063, 0.000441704814826157, 
            0.000429841535363455, 0.000418253309635181, 0.000406935156858307, 0.000395882143430078, 0.000388601829870287, 
            0.000381437233544311, 0.000374386909803093, 0.000367449423830266, 0.000360623350750301, 0.000353986573509102, 
            0.00034745625930468, 0.000341031042349847, 0.000334709567221954, 0.000328490488936803, 0.000322446567253893, 
            0.000316500364462861, 0.000310650595902913, 0.000304895987585845, 0.000299235276239871, 0.000293736376249837, 
            0.00028832696944153, 0.00028300585322389, 0.000277771835791341, 0.000272623736141698, 0.000265092154642162, 0.000257746010069095, 
            0.000250581484883717, 0.000243594816266909, 0.000236782296100091, 0.000227982573848755, 0.000219476359073551, 
            0.000211255350363832, 0.000203311417260369, 0.000195636599470845, 0.000184539105716945, 0.000174010519762588, 
            0.000164025756990203, 0.00015456057330468, 0.000145591554122696, 0.000135743790543882, 0.000126504059402518, 
            0.000117839456917341, 0.000109718501420407, 0.00010211109922394, 9.29781568724675e-05, 8.45977258350679e-05, 
            7.69145400999052e-05, 6.98767092835077e-05, 6.34355804482038e-05, 5.75455985642445e-05, 5.2164166554358e-05, 
            4.72515057619694e-05, 4.2770517592012e-05, 3.8686646985356e-05, 3.49425441351279e-05, 3.15376970948876e-05, 2.84439331716038e-05, 
            2.56351424701273e-05, 2.30871559213141e-05, 2.07695141940062e-05, 1.8671102673946e-05, 1.67727200050313e-05, 
            1.50566760500834e-05, 1.35066913809805e-05, 1.21026989304075e-05, 1.08369895233044e-05))), class = "BchronCalibratedDates"))
})

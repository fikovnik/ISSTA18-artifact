library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11234.5400268555, -16.6533508300781)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11235, 
        ageSds = -17, calCurves = "intcal13", ageGrid = c(13058, 13059, 13060, 13061, 13062, 13063, 13064, 13065, 13066, 
            13067, 13068, 13069, 13070, 13071, 13072, 13073, 13074, 13075, 13076, 13077, 13078, 13079, 13080, 13081, 13082, 
            13083, 13084, 13085, 13086, 13087, 13088, 13089, 13090, 13091, 13092, 13093, 13094, 13095, 13096, 13097, 13098, 
            13099, 13100, 13101, 13102, 13103, 13104, 13105, 13106, 13107, 13108, 13109, 13110, 13111, 13112, 13113, 13114, 
            13115, 13116, 13117, 13118, 13119, 13120, 13121, 13122, 13123, 13124, 13125, 13126, 13127, 13128, 13129, 13130, 
            13131, 13132, 13133, 13134, 13135, 13136, 13137, 13138, 13139, 13140), densities = c(1.42524050796084e-05, 2.24615665398795e-05, 
            3.49909294014032e-05, 5.58944164502936e-05, 8.80391423521011e-05, 0.000136699725178323, 0.000209188406017339, 
            0.000315415696496166, 0.000480801048290821, 0.000720702727228386, 0.00106197569023183, 0.00153781940111512, 0.00218775807047209, 
            0.00305198860340318, 0.00418203999898568, 0.00562722290242194, 0.00743339182253002, 0.00963742307517123, 0.0124590326703425, 
            0.0157623957943227, 0.0195092416603855, 0.0236165142407946, 0.0279535658651945, 0.0320262068516003, 0.0359805638049216, 
            0.0396323540593617, 0.0427943231160313, 0.0452920218174178, 0.0468802758049437, 0.0476976992835683, 0.0476975143999771, 
            0.0468753713960758, 0.0452701043886575, 0.0433862655687272, 0.0410730164390649, 0.0384063619213314, 0.035471076061604, 
            0.0323561091177886, 0.0294688347736915, 0.0265686459486464, 0.0237121066895771, 0.0209489417674505, 0.018320812753792, 
            0.0163712832305486, 0.0145357316145002, 0.0128233159091548, 0.0112400187856687, 0.00978885415894891, 0.00847914495080913, 
            0.00729868302212533, 0.00624327020192248, 0.00530711860431876, 0.00448321162224959, 0.00396429096938079, 0.00349477905206786, 
            0.00307154259141505, 0.00269141636900375, 0.00235124501793148, 0.00199687092548117, 0.00168912530604921, 0.00142314050211538, 
            0.00119432442480603, 0.000998390354522747, 0.000833439738617585, 0.000693230353177379, 0.000574551052018699, 
            0.000474510368139362, 0.000390523646303942, 0.000321269597585062, 0.000263459045970074, 0.0002153765949691, 0.000175528066014377, 
            0.00014261923379718, 0.000111450775732388, 8.67436379709184e-05, 6.7247250564653e-05, 5.19309931807881e-05, 3.99509156164929e-05, 
            3.06201730609901e-05, 2.33830989375943e-05, 1.77927332841205e-05, 1.34915548783757e-05, 1.01951242071051e-05))), 
        class = "BchronCalibratedDates"))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11234.0609678268, 12.7228495597839)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11234, 
        ageSds = 13, calCurves = "intcal13", ageGrid = c(13063, 13064, 13065, 13066, 13067, 13068, 13069, 13070, 13071, 13072, 
            13073, 13074, 13075, 13076, 13077, 13078, 13079, 13080, 13081, 13082, 13083, 13084, 13085, 13086, 13087, 13088, 
            13089, 13090, 13091, 13092, 13093, 13094, 13095, 13096, 13097, 13098, 13099, 13100, 13101, 13102, 13103, 13104, 
            13105, 13106, 13107, 13108, 13109, 13110, 13111, 13112, 13113, 13114, 13115, 13116, 13117, 13118, 13119, 13120, 
            13121, 13122, 13123, 13124, 13125, 13126, 13127, 13128), densities = c(1.08316557646644e-05, 2.0437579466656e-05, 
            3.77389640301052e-05, 7.05195316976265e-05, 0.000128656095676616, 0.000229009802754043, 0.000397458298744822, 
            0.000672148150251938, 0.00110294942835081, 0.00176287497001703, 0.00274282310674627, 0.00415177879155765, 0.00611077731297146, 
            0.00894086834943792, 0.0126656226383617, 0.0173594677210427, 0.0230055681418938, 0.0294622530008756, 0.035917365825702, 
            0.0424924557149068, 0.0487662613411146, 0.0542726872100517, 0.0585564518135594, 0.0610910002764737, 0.0620564160536578, 
            0.0613614006218046, 0.0590490237664896, 0.0552925871159886, 0.0512460712699772, 0.0465843916138079, 0.0415296607278712, 
            0.0363057386091139, 0.0311215341013963, 0.0266309828156075, 0.0224243552698845, 0.0185801104288626, 0.0151484160373287, 
            0.0121528432892763, 0.0100922213271662, 0.00829382014712692, 0.00674472377160247, 0.00542750566084138, 0.00432165369704399, 
            0.00341449388978135, 0.00267061324245857, 0.00206781446963696, 0.00158503133983213, 0.00120282318246949, 0.000985029190631246, 
            0.000802851523347691, 0.000651286183069758, 0.000525861200995355, 0.000422615702831482, 0.000325460321529958, 
            0.000249168322750132, 0.000189654786296955, 0.000143530889437126, 0.000108012107925852, 8.13518998282835e-05, 
            6.09693112476654e-05, 4.54719742122008e-05, 3.37525026328485e-05, 2.49366780975893e-05, 1.84816284318703e-05, 
            1.36434492863179e-05, 1.00330612514031e-05))), class = "BchronCalibratedDates"))
})

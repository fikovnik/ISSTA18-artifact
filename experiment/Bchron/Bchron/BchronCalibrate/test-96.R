library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11221.2552688599, -10.131273651123)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11221, 
        ageSds = -10, calCurves = "intcal13", ageGrid = c(13062, 13063, 13064, 13065, 13066, 13067, 13068, 13069, 13070, 
            13071, 13072, 13073, 13074, 13075, 13076, 13077, 13078, 13079, 13080, 13081, 13082, 13083, 13084, 13085, 13086, 
            13087, 13088, 13089, 13090, 13091, 13092, 13093, 13094, 13095, 13096, 13097, 13098, 13099, 13100, 13101, 13102, 
            13103, 13104, 13105, 13106, 13107, 13108), densities = c(1.12632402860215e-05, 2.49017136408865e-05, 5.32213387302311e-05, 
            0.000109876552873155, 0.000227276121601062, 0.000452611361803077, 0.000866839586281198, 0.00159492872939248, 
            0.00281652042915242, 0.00475141163069116, 0.00768987726467798, 0.0119296564276805, 0.0177261255687769, 0.0252107761899825, 
            0.0349693868478684, 0.0461210848937787, 0.0577902173560936, 0.0687464732402378, 0.0775984721973147, 0.0828195110082411, 
            0.084442627826225, 0.0822313057358963, 0.0764732902697021, 0.0679179740186053, 0.0583815252581508, 0.0482170044541304, 
            0.0382596742563094, 0.0291689155058031, 0.0213696955011448, 0.0159431051296362, 0.0115586734998846, 0.00814374965927717, 
            0.00557649872913442, 0.00371173859403723, 0.00250701887282247, 0.0016545702365771, 0.00106714210726877, 0.000672731864253111, 
            0.000414599263637418, 0.000275981680888625, 0.000180850055876672, 0.000116665586622719, 7.40893107747753e-05, 
            4.63194868195123e-05, 2.88318737876703e-05, 1.76941722959999e-05, 1.0707384204778e-05))), class = "BchronCalibratedDates"))
})

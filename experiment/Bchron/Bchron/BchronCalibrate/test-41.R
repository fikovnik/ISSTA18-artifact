library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11253.5178854127, 23.8328840815637)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11254, 
        ageSds = 24, calCurves = "intcal13", ageGrid = c(13055, 13056, 13057, 13058, 13059, 13060, 13061, 13062, 13063, 13064, 
            13065, 13066, 13067, 13068, 13069, 13070, 13071, 13072, 13073, 13074, 13075, 13076, 13077, 13078, 13079, 13080, 
            13081, 13082, 13083, 13084, 13085, 13086, 13087, 13088, 13089, 13090, 13091, 13092, 13093, 13094, 13095, 13096, 
            13097, 13098, 13099, 13100, 13101, 13102, 13103, 13104, 13105, 13106, 13107, 13108, 13109, 13110, 13111, 13112, 
            13113, 13114, 13115, 13116, 13117, 13118, 13119, 13120, 13121, 13122, 13123, 13124, 13125, 13126, 13127, 13128, 
            13129, 13130, 13131, 13132, 13133, 13134, 13135, 13136, 13137, 13138, 13139, 13140, 13141, 13142, 13143, 13144, 
            13145, 13146, 13147, 13148, 13149, 13150, 13151, 13152, 13153, 13154, 13155, 13156, 13157, 13158, 13159, 13160, 
            13161, 13162, 13163, 13164, 13165, 13166, 13167, 13168, 13169, 13170, 13171, 13172, 13173, 13174, 13175, 13176, 
            13177, 13178, 13179, 13180, 13181, 13182, 13183, 13184, 13185, 13186, 13187, 13188, 13189, 13190, 13191, 13192, 
            13193, 13194, 13195, 13196, 13197), densities = c(1.10128663379136e-05, 1.52289114799731e-05, 2.09349536463573e-05, 
            2.86070060107579e-05, 3.88537748063424e-05, 5.24466985278794e-05, 7.21763573318525e-05, 9.85907665412246e-05, 
            0.000133658444936315, 0.00017981704091128, 0.000240046868431396, 0.000324289643279992, 0.00043420992887647, 0.000576152750367401, 
            0.000757512601044553, 0.000986736429117127, 0.00127205092196965, 0.00162452609768582, 0.00205501251990452, 0.0025746396330555, 
            0.00319435535715042, 0.00398016669747731, 0.00490362704234733, 0.00597267729741349, 0.00719111617467682, 0.00855741090941033, 
            0.00994850064223563, 0.0114483580228511, 0.0130393836907674, 0.0146980483677821, 0.0163950989823421, 0.017961092840357, 
            0.0195015435945082, 0.0209841876390267, 0.0223755452077386, 0.023642135795183, 0.0245778774363253, 0.0253880567964388, 
            0.0260570834670421, 0.0265716311622578, 0.0269210815417485, 0.027088121448942, 0.0271120970706731, 0.0269920618928679, 
            0.0267294063292785, 0.026327834196979, 0.0259224577395387, 0.0254396942759428, 0.0248838083373392, 0.0242597250051633, 
            0.0235729552645533, 0.0228308054273683, 0.0220388340429355, 0.0212037885617474, 0.0203326197106495, 0.0194323827388495, 
            0.0187774280897176, 0.0181140318092929, 0.0174446879595548, 0.0167718322801376, 0.0160978278298743, 0.0152947598214757, 
            0.014497355049319, 0.0137090659548618, 0.0129330906080902, 0.0121723565185744, 0.0114327676838007, 0.0107134659264109, 
            0.0100164631666428, 0.00934347897023231, 0.00869594481236854, 0.00807822782729208, 0.00748788914579403, 0.00692551500543532, 
            0.00639145267225695, 0.0058858269628813, 0.00533128147829335, 0.00481491963199035, 0.00433599670319643, 0.00389350422224131, 
            0.00348621095256743, 0.00311270270546608, 0.00277142038280502, 0.00246069575395411, 0.00217878458274295, 0.00192389682566235, 
            0.00172577773325115, 0.00154501600802194, 0.00138048891219439, 0.00123109486329815, 0.00109576058039672, 0.000952044919252966, 
            0.000824900368793944, 0.000712782697893493, 0.000614233981846144, 0.000527887228040568, 0.000472798285874306, 
            0.000422876952344441, 0.000377710453441325, 0.000336910367654327, 0.000300112219834401, 0.000266583961130526, 
            0.000236468634040482, 0.00020946208817873, 0.000185281852712973, 0.000163666259492356, 0.00015162736120266, 0.000140399299472452, 
            0.000129933703718091, 0.000120184589209067, 0.000111108278147371, 0.000105472327405194, 0.000100099960220162, 
            9.49801273713152e-05, 9.0102172523347e-05, 8.54558219899745e-05, 8.10311745660066e-05, 7.68186914395442e-05, 
            7.28091861954215e-05, 6.89938149201867e-05, 6.53640664178234e-05, 6.19117525453086e-05, 5.86289986757732e-05, 
            5.55082342967181e-05, 5.25421837500473e-05, 4.97238571197776e-05, 4.72354625219491e-05, 4.4864770475441e-05, 
            4.26066077664357e-05, 4.04560064245121e-05, 3.84081967904334e-05, 3.45305548502218e-05, 3.10241799715927e-05, 
            2.78558595390784e-05, 2.4995089500165e-05, 2.24138822846505e-05, 2.06574792641445e-05, 1.90322366329172e-05, 
            1.75289383057194e-05, 1.61389654252448e-05, 1.48542619342773e-05, 1.2906407285339e-05, 1.12032104907041e-05))), 
        class = "BchronCalibratedDates"))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11206.0800537109, -49.3067016601562)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11206, 
        ageSds = -49, calCurves = "intcal13", ageGrid = c(12829, 12830, 12831, 12832, 12833, 12834, 12835, 12836, 12837, 
            12838, 12839, 12840, 12841, 12842, 12843, 12844, 12845, 12846, 12847, 12848, 12849, 12850, 12851, 12852, 12853, 
            12854, 12855, 12856, 12857, 12858, 12859, 12860, 12861, 12862, 12863, 12864, 12865, 12866, 12867, 12868, 12869, 
            12870, 12871, 12872, 12873, 12874, 12875, 12876, 12877, 12878, 12879, 12880, 12881, 12882, 12883, 12884, 12885, 
            12886, 12887, 12888, 12889, 12890, 12891, 12892, 12893, 12894, 12895, 12896, 12897, 12898, 12899, 12900, 12901, 
            12902, 12903, 12904, 12905, 12906, 12907, 12908, 12909, 12910, 12911, 12912, 12913, 12914, 12915, 12916, 12917, 
            12918, 12919, 12920, 12921, 12922, 12923, 12924, 12925, 12926, 12927, 12928, 12929, 12930, 12931, 12932, 12933, 
            12934, 12935, 12936, 12937, 12938, 12939, 12940, 12941, 12942, 12943, 12944, 12945, 12946, 12947, 12948, 12949, 
            12950, 12951, 12952, 12953, 12954, 12955, 12956, 12957, 12958, 12959, 12960, 12961, 12962, 12963, 12964, 12965, 
            12966, 12967, 12968, 12969, 12970, 12971, 12972, 12973, 12974, 12975, 12976, 12977, 12978, 12979, 12980, 12981, 
            12982, 12983, 12984, 12985, 12986, 12987, 12988, 12989, 12990, 12991, 12992, 12993, 12994, 12995, 12996, 12997, 
            12998, 12999, 13000, 13001, 13002, 13003, 13004, 13005, 13006, 13007, 13008, 13009, 13010, 13011, 13012, 13013, 
            13014, 13015, 13016, 13017, 13018, 13019, 13020, 13021, 13022, 13023, 13024, 13025, 13026, 13027, 13028, 13029, 
            13030, 13031, 13032, 13033, 13034, 13035, 13036, 13037, 13038, 13039, 13040, 13041, 13042, 13043, 13044, 13045, 
            13046, 13047, 13048, 13049, 13050, 13051, 13052, 13053, 13054, 13055, 13056, 13057, 13058, 13059, 13060, 13061, 
            13062, 13063, 13064, 13065, 13066, 13067, 13068, 13069, 13070, 13071, 13072, 13073, 13074, 13075, 13076, 13077, 
            13078, 13079, 13080, 13081, 13082, 13083, 13084, 13085, 13086, 13087, 13088, 13089, 13090, 13091, 13092, 13093, 
            13094, 13095, 13096, 13097, 13098, 13099, 13100, 13101, 13102, 13103, 13104, 13105, 13106, 13107, 13108, 13109, 
            13110, 13111, 13112, 13113, 13114, 13115, 13116, 13117, 13118, 13119, 13120, 13121, 13122, 13123, 13124, 13125, 
            13126, 13127, 13128, 13129, 13130, 13131, 13132, 13133, 13134, 13135, 13136, 13137, 13138, 13139, 13140, 13141, 
            13142, 13143, 13144, 13145, 13146, 13147, 13148, 13149, 13150, 13151, 13152, 13153, 13154, 13155, 13156, 13157, 
            13158, 13159, 13160, 13161, 13162, 13163, 13164, 13165, 13166, 13167, 13168, 13169, 13170, 13171, 13172, 13173, 
            13174, 13175, 13176, 13177, 13178, 13179, 13180, 13181, 13182, 13183, 13184, 13185, 13186, 13187, 13188, 13189, 
            13190, 13191, 13192, 13193, 13194, 13195, 13196, 13197, 13198, 13199, 13200, 13201, 13202, 13203, 13204, 13205, 
            13206, 13207, 13208, 13209, 13210, 13211, 13212, 13213, 13214, 13215, 13216, 13217, 13218, 13219, 13220, 13221, 
            13222, 13223, 13224, 13225, 13226, 13227, 13228, 13229, 13230, 13231, 13232, 13233, 13234, 13235, 13236, 13237, 
            13238, 13239, 13240, 13241, 13242, 13243, 13244, 13245, 13246, 13247, 13248, 13249, 13250, 13251, 13252, 13253, 
            13254, 13255, 13256, 13257, 13258, 13259, 13260, 13261), densities = c(1.05538912493125e-05, 1.1308747575063e-05, 
            1.21145089781911e-05, 1.29743612604072e-05, 1.3891670531642e-05, 1.48699919973535e-05, 1.59130790719268e-05, 
            1.6795075955661e-05, 1.77230141996146e-05, 1.8699103217495e-05, 1.97256476510864e-05, 2.08050508363297e-05, 2.19287521889197e-05, 
            2.31094053997676e-05, 2.43496680829615e-05, 2.56523083750854e-05, 2.70202087639453e-05, 2.77160374830989e-05, 
            2.84287162267192e-05, 2.91586214119394e-05, 2.99061369601483e-05, 3.06716544215276e-05, 3.14706476450301e-05, 
            3.22891099958452e-05, 3.31274759893074e-05, 3.3986188697322e-05, 3.48656998853412e-05, 3.52884639322159e-05, 
            3.57160710231926e-05, 3.61485725986345e-05, 3.65860205892137e-05, 3.70284674198599e-05, 3.74934674861609e-05, 
            3.79639400089391e-05, 3.84399440787642e-05, 3.89215393498372e-05, 3.94087860443922e-05, 3.99017449570501e-05, 
            4.04004774592377e-05, 4.09050455036286e-05, 4.14155116285551e-05, 4.19319389625122e-05, 4.24543912286096e-05, 
            4.29829327490901e-05, 4.35176284498694e-05, 4.40585438650451e-05, 4.4605745141499e-05, 4.5179793564757e-05, 4.57606967737116e-05, 
            4.63485288411698e-05, 4.69433645311715e-05, 4.75452793040045e-05, 4.87925063813924e-05, 5.0069916241193e-05, 
            5.13781645178362e-05, 5.2717918976926e-05, 5.40898596824877e-05, 5.48001497264316e-05, 5.55190055357523e-05, 
            5.62465192165752e-05, 5.69827837084103e-05, 5.77278927896297e-05, 5.91937035007432e-05, 6.06938590912678e-05, 
            6.22290813066196e-05, 6.38001047627801e-05, 6.54076771145301e-05, 6.62535600389344e-05, 6.71094539294139e-05, 
            6.79754637930912e-05, 6.88516955520968e-05, 6.97382560491266e-05, 7.14828455864021e-05, 7.32675670828018e-05, 
            7.50932436187958e-05, 7.69607124211851e-05, 7.88708250341618e-05, 8.08575969491005e-05, 8.2890105622167e-05, 
            8.49692810209393e-05, 8.70960686755957e-05, 8.92714298516382e-05, 9.14596881710819e-05, 9.36970260512056e-05, 
            9.59844164395553e-05, 9.83228481402733e-05, 0.000100713325983527, 0.000103156870994285, 0.00010565452056052, 
            0.000108207328600706, 0.000110816365730462, 0.000113482719428438, 0.000114837734479153, 0.000116207494201115, 
            0.000117592139345132, 0.000118991811746616, 0.000120406654330734, 0.000123235784652181, 0.000126125571414719, 
            0.000129077156592771, 0.000132091699517492, 0.000135170377035275, 0.000136759488845538, 0.000138365554850556, 
            0.000139988732505673, 0.000141629180424388, 0.000143287058383156, 0.000143287058383156, 0.000143287058383156, 
            0.000143287058383156, 0.000143287058383156, 0.000143287058383156, 0.000144909424351597, 0.000146548570416179, 
            0.000148204648988745, 0.000149877813594398, 0.000151568218876361, 0.000151568218876361, 0.000151568218876361, 
            0.000151568218876361, 0.000151568218876361, 0.000151568218876361, 0.000153276020600572, 0.000155001375660413, 
            0.000156744442081415, 0.000158505379025772, 0.000160284346797073, 0.000162139581980914, 0.000164014218562878, 
            0.000165908431683702, 0.000167822397709427, 0.000169756294235666, 0.000173745915078759, 0.000177819649887618, 
            0.000181979011952391, 0.000186225535111853, 0.000190560773865696, 0.000194986303482717, 0.000199503720105021, 
            0.00020411464084801, 0.00020882070389591, 0.000213623568592989, 0.000223451893366377, 0.000233682631972133, 0.000244329620842184, 
            0.000255407038927225, 0.0002669294095945, 0.000282047558228642, 0.000297919628226484, 0.000314576530398427, 0.000332050028407773, 
            0.000350372736973991, 0.000373374386950949, 0.000397691910951335, 0.000423385746202117, 0.000450518028664289, 
            0.000479152562556746, 0.000509492363686461, 0.000541479001326772, 0.000575181520943836, 0.000610670429337752, 
            0.000648017621871819, 0.000686957197405162, 0.000727875280403813, 0.000770846522926761, 0.00081594662328952, 
            0.000863252211475119, 0.000921332903407638, 0.000982645038303289, 0.00104731364307746, 0.00111546432563902, 0.00118722290274205, 
            0.00124050849416594, 0.00129573118898781, 0.00135293622829294, 0.00141216855009771, 0.00147347269995698, 0.00153660992609275, 
            0.00160189288874528, 0.00166936437391879, 0.00173906641776138, 0.00181104020170278, 0.00188564277180361, 0.00196260993362589, 
            0.00204197951390553, 0.00212378799361371, 0.00220807038726714, 0.00227723029723967, 0.00234800920432586, 0.0024204227300654, 
            0.00249448571482697, 0.00257021217548168, 0.00264798908851392, 0.00272746445657256, 0.00280864929760411, 0.002891553609486, 
            0.00297618632643584, 0.00306255527545055, 0.00315066713284343, 0.00324052738095597, 0.00333214026512383, 0.00342550875097108, 
            0.00354510830313596, 0.00366746248180256, 0.00379256729979352, 0.00392041514596954, 0.00405099466647753, 0.00418429064969326, 
            0.00432028391529496, 0.00445895120790827, 0.00460026509576511, 0.00474419387481958, 0.00492066871799042, 0.00510078862386542, 
            0.00528447218465647, 0.00547162837720914, 0.00566215642374846, 0.00588885417631918, 0.00611979568713632, 0.00635476803351239, 
            0.00659353965814039, 0.00683586040714994, 0.00715225858755976, 0.00747346069867825, 0.00779880211424669, 0.00812757081774065, 
            0.00845900926451158, 0.00886659769917083, 0.0092754281102825, 0.00968387423367659, 0.0100902376252233, 0.0104927586605719, 
            0.0109252328522375, 0.0113486070603017, 0.0117604570642726, 0.0121583520932342, 0.0125398787631655, 0.0129315842377764, 
            0.0132984969012313, 0.013637811699139, 0.0139468848188848, 0.014223268565794, 0.0144646937407173, 0.0146692835527185, 
            0.0148353561237656, 0.0149615381571399, 0.015046784222262, 0.0150920079892201, 0.0150885243219441, 0.0150363676086553, 
            0.0149360520257709, 0.0147885629364604, 0.0146105822102307, 0.0143946165741343, 0.0141424445250137, 0.0138561202200782, 
            0.0135379451126755, 0.0132178514466714, 0.0128747814921247, 0.0125109589668322, 0.012128694518026, 0.0117303609950697, 
            0.0113874869971786, 0.0110364701391061, 0.0106787125653812, 0.0103156049034851, 0.00994851737745045, 0.00961570371781149, 
            0.00928169455003494, 0.00894741538944268, 0.00861375950796328, 0.00828158431430744, 0.0080239936504341, 0.00776813444688988, 
            0.00751436241962899, 0.00726301669407456, 0.00701441924002726, 0.0067693173520558, 0.00652756150471614, 0.00628941738700634, 
            0.00605513217579153, 0.00582493442343716, 0.00566351516759186, 0.00550435955842188, 0.00534753249221513, 0.00519309409130965, 
            0.00504109974619422, 0.00486263230791265, 0.00468782962172962, 0.00451675914505987, 0.00434947920095016, 0.00418603919473495, 
            0.00402691286907862, 0.00387169056879516, 0.00372039528272789, 0.00357304219190967, 0.00342963896256362, 0.00329059311421683, 
            0.00315547880745298, 0.00302428218962586, 0.00289698322978955, 0.00277355604497128, 0.00263434688312112, 0.00250030877970748, 
            0.0023713741700371, 0.00224746726021503, 0.00212850472569195, 0.00201439639945826, 0.00190504594720042, 0.00180035152697425, 
            0.00170020643118586, 0.00160449970890469, 0.00152595139508714, 0.00145050347611068, 0.00137808058997008, 0.00130860623288173, 
            0.001242002995588, 0.00116730415582481, 0.00109632189849449, 0.00102893020521859, 0.00096500291607416, 0.000904414128263598, 
            0.000863054480676155, 0.000823292318518854, 0.000785082509559827, 0.000748380286277788, 0.000713141298661116, 
            0.000679153347283275, 0.000646552541403396, 0.000615295741610759, 0.000585340394484215, 0.000556644569984818, 
            0.000539899648573168, 0.000523589393137445, 0.000507704998972784, 0.000492237754231407, 0.000477179042009582, 
            0.000467405823180423, 0.000457806605301284, 0.000448378926723329, 0.000439120345780282, 0.000430028440980787, 
            0.000421100811190389, 0.000412335075802725, 0.00040372887490026, 0.000395279869404965, 0.000386985741218518, 
            0.000378844193352961, 0.000370852950051435, 0.000363009756899341, 0.000355312380926276, 0.000347758610698403, 
            0.000340551739891602, 0.000333477632577253, 0.000326534253589667, 0.000319719589165918, 0.000313031646955398, 
            0.000299934682193006, 0.000287327199756135, 0.00027519381565367, 0.000263519489780799, 0.000252289524932226, 
            0.000244169967482241, 0.000236285352495709, 0.00022862988520291, 0.000221197876984701, 0.000213983744764911, 
            0.000202383518716907, 0.000191352543441833, 0.000180866691087606, 0.000170902621953895, 0.000161437773018723, 
            0.000152450345677981, 0.000143919292775091, 0.000135824304995079, 0.000128145796694323, 0.000120864891234184, 
            0.000115234707638018, 0.000109844318012676, 0.000104684717996348, 9.97471788333063e-05, 9.50232420898623e-05, 
            8.94152340290336e-05, 8.41118882027766e-05, 7.90984418340433e-05, 7.43607303452255e-05, 6.98851705897869e-05, 
            6.73088249939469e-05, 6.48201355925951e-05, 6.24164280321949e-05, 6.0095097092432e-05, 5.78536053875174e-05, 
            5.56651077125697e-05, 5.35531018226358e-05, 5.15151838913913e-05, 4.95490145381482e-05, 4.76523175413427e-05, 
            4.64113784721393e-05, 4.52002941817095e-05, 4.40184183747242e-05, 4.28651167309641e-05, 4.17397667377817e-05, 
            4.06605265221418e-05, 3.96072054552277e-05, 3.8579239037663e-05, 3.75760734372838e-05, 3.65971653316208e-05, 
            3.56587911450214e-05, 3.47428825693446e-05, 3.38489482079147e-05, 3.29765061074948e-05, 3.21250836122683e-05, 
            3.13092733658245e-05, 3.05129065426788e-05, 2.97355567405178e-05, 2.89768058684877e-05, 2.82362440135209e-05, 
            2.71652985242784e-05, 2.61326164306662e-05, 2.5136933040783e-05, 2.41770211462064e-05, 2.32516900880169e-05, 
            2.20734373793236e-05, 2.0951642575604e-05, 1.98837891393464e-05, 1.88674620517254e-05, 1.79003443025983e-05, 
            1.65240564222722e-05, 1.52481397572312e-05, 1.40657518319917e-05, 1.29704759122259e-05, 1.19562978978261e-05, 
            1.08711117301316e-05))), class = "BchronCalibratedDates"))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11263, 16)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11263, 
        ageSds = 16, calCurves = "intcal13", ageGrid = c(13071, 13072, 13073, 13074, 13075, 13076, 13077, 13078, 13079, 13080, 
            13081, 13082, 13083, 13084, 13085, 13086, 13087, 13088, 13089, 13090, 13091, 13092, 13093, 13094, 13095, 13096, 
            13097, 13098, 13099, 13100, 13101, 13102, 13103, 13104, 13105, 13106, 13107, 13108, 13109, 13110, 13111, 13112, 
            13113, 13114, 13115, 13116, 13117, 13118, 13119, 13120, 13121, 13122, 13123, 13124, 13125, 13126, 13127, 13128, 
            13129, 13130, 13131, 13132, 13133, 13134, 13135, 13136, 13137, 13138, 13139, 13140, 13141, 13142, 13143, 13144, 
            13145, 13146, 13147, 13148, 13149, 13150, 13151, 13152, 13153, 13154, 13155, 13156, 13157, 13158, 13159), densities = c(1.37916829584652e-05, 
            2.3457268204718e-05, 3.92872169134893e-05, 6.4765453726344e-05, 0.000105041621402338, 0.000172311615957389, 0.000277426944629008, 
            0.000438139163156475, 0.000678356650371205, 0.00102907162791533, 0.00148420790139797, 0.00210236616727281, 0.00292346317566089, 
            0.00398914379583509, 0.0053392261998215, 0.0068516621626247, 0.00864901610541045, 0.0107360101410399, 0.0131003248785824, 
            0.0157089560889113, 0.0180177410053938, 0.0204144089863826, 0.0228440285763261, 0.0252421802988232, 0.0275372964698756, 
            0.0294510074547643, 0.0311656456995274, 0.0326284052017932, 0.0337915649960121, 0.0346150508109058, 0.0350008008382831, 
            0.0351536597096904, 0.0350680556823259, 0.034743311201682, 0.0341837498404482, 0.0333998189942127, 0.0324055717032107, 
            0.0312195227214904, 0.0298637762456768, 0.0283633195485005, 0.0272221083520861, 0.0260322018493506, 0.0248040126812561, 
            0.0235479256016284, 0.0222741493051075, 0.0207469924725476, 0.0192261476956937, 0.0177262866412108, 0.0162606367939125, 
            0.014840829824283, 0.0134859165489296, 0.0121949529191775, 0.0109741271592253, 0.00982796103985446, 0.00875940006549539, 
            0.00777815558509325, 0.00687542772301959, 0.00605010455552117, 0.00530012032387605, 0.00462262081491264, 0.00391815153776543, 
            0.00330144819510436, 0.00276560936908985, 0.00230342282015916, 0.0019075982156051, 0.00157095962209486, 0.00128659823424377, 
            0.00104798744641121, 0.000849063574983262, 0.000684276326764128, 0.000566611810350063, 0.000467434155066711, 
            0.000384202004618087, 0.000314649425361027, 0.000256771172640495, 0.00020016401420342, 0.000155200174628119, 
            0.000119700688696727, 9.18399281939365e-05, 7.010184773868e-05, 5.75525107722012e-05, 4.71254416049082e-05, 3.84870546578711e-05, 
            3.13511759096906e-05, 2.54732772799077e-05, 2.05444000286218e-05, 1.65234021255409e-05, 1.32529720668729e-05, 
            1.06009659856497e-05))), class = "BchronCalibratedDates"))
})

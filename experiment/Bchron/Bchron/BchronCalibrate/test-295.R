library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11256.7967349202, 24.9441824161433)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11257, 
        ageSds = 25, calCurves = "intcal13", ageGrid = c(13055, 13056, 13057, 13058, 13059, 13060, 13061, 13062, 13063, 13064, 
            13065, 13066, 13067, 13068, 13069, 13070, 13071, 13072, 13073, 13074, 13075, 13076, 13077, 13078, 13079, 13080, 
            13081, 13082, 13083, 13084, 13085, 13086, 13087, 13088, 13089, 13090, 13091, 13092, 13093, 13094, 13095, 13096, 
            13097, 13098, 13099, 13100, 13101, 13102, 13103, 13104, 13105, 13106, 13107, 13108, 13109, 13110, 13111, 13112, 
            13113, 13114, 13115, 13116, 13117, 13118, 13119, 13120, 13121, 13122, 13123, 13124, 13125, 13126, 13127, 13128, 
            13129, 13130, 13131, 13132, 13133, 13134, 13135, 13136, 13137, 13138, 13139, 13140, 13141, 13142, 13143, 13144, 
            13145, 13146, 13147, 13148, 13149, 13150, 13151, 13152, 13153, 13154, 13155, 13156, 13157, 13158, 13159, 13160, 
            13161, 13162, 13163, 13164, 13165, 13166, 13167, 13168, 13169, 13170, 13171, 13172, 13173, 13174, 13175, 13176, 
            13177, 13178, 13179, 13180, 13181, 13182, 13183, 13184, 13185, 13186, 13187, 13188, 13189, 13190, 13191, 13192, 
            13193, 13194, 13195, 13196, 13197, 13198, 13199, 13200, 13201, 13202, 13203, 13204), densities = c(1.17372417810109e-05, 
            1.59919841109713e-05, 2.16702270218018e-05, 2.92022224729233e-05, 3.91315144607343e-05, 5.21390574795477e-05, 
            7.07850358156437e-05, 9.54396844577071e-05, 0.000127786456669345, 0.000169890402658085, 0.000224254850206733, 
            0.000299555618019592, 0.000396858466106495, 0.000521391439645186, 0.000679220865681111, 0.000877257733695347, 
            0.00112220984772567, 0.0014231586411108, 0.00178902643939678, 0.00222903990644144, 0.00275240081356505, 0.00341497696519797, 
            0.00419315761701049, 0.00509465683049724, 0.00612427208117619, 0.00728295784572382, 0.00846851432656865, 0.00975487459456209, 
            0.0111304423041089, 0.0125789025495515, 0.0140792063106824, 0.015483437512559, 0.0168879581697195, 0.0182674953474256, 
            0.0195950396453656, 0.0208426728566508, 0.0217997439402297, 0.022666994841995, 0.023429654188078, 0.0240742531246523, 
            0.0245890217192407, 0.0249331939861858, 0.0251589097529011, 0.025262372471615, 0.0252415852418611, 0.0250964123535016, 
            0.024898342546244, 0.0246273312982158, 0.0242855121803164, 0.0238756534858824, 0.0234011202606663, 0.0228665231200522, 
            0.0222758967355767, 0.0216341090519578, 0.0209463810307477, 0.0202182139473004, 0.0196777809354616, 0.0191219634794898, 
            0.0185528987687674, 0.0179727259517976, 0.0173835726449951, 0.0166706651273931, 0.0159517614745876, 0.015230277567516, 
            0.0145094913357003, 0.0137925200041332, 0.0130849333120183, 0.0123869699331489, 0.0117011190398049, 0.0110296475101415, 
            0.01037459323741, 0.009740591275436, 0.00912638407985983, 0.0085332747613096, 0.00796234085515651, 0.00741444116188752, 
            0.00680474077910774, 0.00622797751374968, 0.0056845008449249, 0.00517434291479136, 0.00469724843080642, 0.00425270577068529, 
            0.00383997862432129, 0.0034581375662007, 0.00310609101892618, 0.00278261514069197, 0.00252733467008475, 0.00229116052936524, 
            0.00207318073134545, 0.00187246401670768, 0.00168806949320808, 0.00148959688561381, 0.00131101519245217, 0.00115084020597636, 
            0.00100762421846351, 0.00087996725089667, 0.000797329975133894, 0.000721506960505224, 0.000652043770017726, 0.000588504431715008, 
            0.000530472034614904, 0.000476990012816456, 0.000428326687190154, 0.00038411627179686, 0.000344012877846931, 
            0.000307690337357605, 0.000287279988798, 0.000268088629785273, 0.000250053760921486, 0.000233115333933308, 0.000217215709442597, 
            0.000207263399925178, 0.000197725140510637, 0.000188585904029304, 0.000179831098344371, 0.000171446559141262, 
            0.000163418542562109, 0.000155733717702901, 0.000148379158991006, 0.000141342338460033, 0.00013461111793772, 
            0.000128173741162963, 0.000122018825846323, 0.000116135355688327, 0.000110512672369216, 0.000105140467522582, 
            0.000100334192887221, 9.57330800930538e-05, 9.13291457846139e-05, 8.71146773016484e-05, 8.30822255128031e-05, 
            7.54065996631552e-05, 6.83960319268422e-05, 6.19975997886472e-05, 5.61621048088984e-05, 5.08438598571437e-05, 
            4.71905434741548e-05, 4.37848730504081e-05, 4.06112883070203e-05, 3.76551082319692e-05, 3.49024890908266e-05, 
            3.06923505916109e-05, 2.69643016786313e-05, 2.3666691031843e-05, 2.07529241841802e-05, 1.81810310212271e-05, 
            1.59132621809418e-05, 1.39157134866357e-05, 1.21579774127233e-05, 1.06128204790086e-05))), class = "BchronCalibratedDates"))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11244.8216701388, 29.6599627196789)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11245, 
        ageSds = 30, calCurves = "intcal13", ageGrid = c(13031, 13032, 13033, 13034, 13035, 13036, 13037, 13038, 13039, 13040, 
            13041, 13042, 13043, 13044, 13045, 13046, 13047, 13048, 13049, 13050, 13051, 13052, 13053, 13054, 13055, 13056, 
            13057, 13058, 13059, 13060, 13061, 13062, 13063, 13064, 13065, 13066, 13067, 13068, 13069, 13070, 13071, 13072, 
            13073, 13074, 13075, 13076, 13077, 13078, 13079, 13080, 13081, 13082, 13083, 13084, 13085, 13086, 13087, 13088, 
            13089, 13090, 13091, 13092, 13093, 13094, 13095, 13096, 13097, 13098, 13099, 13100, 13101, 13102, 13103, 13104, 
            13105, 13106, 13107, 13108, 13109, 13110, 13111, 13112, 13113, 13114, 13115, 13116, 13117, 13118, 13119, 13120, 
            13121, 13122, 13123, 13124, 13125, 13126, 13127, 13128, 13129, 13130, 13131, 13132, 13133, 13134, 13135, 13136, 
            13137, 13138, 13139, 13140, 13141, 13142, 13143, 13144, 13145, 13146, 13147, 13148, 13149, 13150, 13151, 13152, 
            13153, 13154, 13155, 13156, 13157, 13158, 13159, 13160, 13161, 13162, 13163, 13164, 13165, 13166, 13167, 13168, 
            13169, 13170, 13171, 13172, 13173, 13174, 13175, 13176, 13177, 13178, 13179, 13180, 13181, 13182, 13183, 13184, 
            13185, 13186, 13187, 13188, 13189, 13190, 13191, 13192, 13193, 13194, 13195, 13196, 13197, 13198, 13199, 13200, 
            13201, 13202, 13203, 13204, 13205, 13206, 13207, 13208, 13209, 13210, 13211, 13212), densities = c(1.1120731399141e-05, 
            1.24985020349229e-05, 1.40368022706713e-05, 1.57529480545632e-05, 1.76659413407171e-05, 1.97966114391357e-05, 
            2.21677654634563e-05, 2.48043481343581e-05, 2.77336111607513e-05, 3.09852923782826e-05, 3.53960830640593e-05, 
            4.03883421997472e-05, 4.60314433106709e-05, 5.24019499650373e-05, 5.95842066126383e-05, 6.91684750173121e-05, 
            8.01614261331895e-05, 9.27465475520716e-05, 0.000107127282187827, 0.000123528572423521, 0.000148008794683609, 
            0.000176835551279582, 0.00021067034367009, 0.000250252802260181, 0.000296405551796017, 0.000363106249277985, 
            0.000442844164723178, 0.000537676495867115, 0.000649871690508535, 0.000781906041478474, 0.00095143053850673, 
            0.00115138561090126, 0.001385689957172, 0.00165841775027344, 0.00197372264325723, 0.00236542132684862, 0.00281647312264029, 
            0.00333160123226085, 0.00391495945570315, 0.00456989190694797, 0.00529702860221442, 0.00609883112240101, 0.006974735894982, 
            0.00792238319630313, 0.00893741643484992, 0.0100945042232316, 0.0113113485379309, 0.0125740896780201, 0.0138659437045802, 
            0.0151674486496878, 0.0163643831612622, 0.0175324598689219, 0.018652097089713, 0.019703383510824, 0.0206666586930869, 
            0.0214605134729286, 0.0221502076050485, 0.0227234021799098, 0.0231695558060713, 0.0234802508521572, 0.0236312476076298, 
            0.0236818568059517, 0.0236311617957593, 0.0234795688376393, 0.0232288035643897, 0.0229207226714442, 0.0225377209699168, 
            0.0220835835362613, 0.0215627873302021, 0.0209804259926598, 0.0204873033385884, 0.0199628096711223, 0.0194099016491074, 
            0.0188316486512651, 0.0182312036083386, 0.0176128905606342, 0.0169790124432708, 0.0163327876490096, 0.0156773994063833, 
            0.0150159696761633, 0.0145428113359372, 0.0140692825736151, 0.013596415884204, 0.0131252073924683, 0.0126566137072426, 
            0.0121014784690446, 0.0115530174507696, 0.0110126013515166, 0.0104814980945064, 0.00996086997501467, 0.00945363208635789, 
            0.00895888055221488, 0.00847743575483635, 0.00801001111743296, 0.0075572148982875, 0.00712138080080511, 0.00670104249181023, 
            0.00629649660700034, 0.00590794949170313, 0.00553552192266627, 0.00512116789261736, 0.00472875784562443, 0.0043581015732241, 
            0.00400889332850683, 0.00368072417452309, 0.00337309429676139, 0.00308542513126066, 0.00281707117648766, 0.00256733137426604, 
            0.0023354599624121, 0.00215049921649581, 0.00197757189761048, 0.00181616275356454, 0.0016657511714634, 0.00152581468415289, 
            0.00137332547217484, 0.00123380757568852, 0.00110644124144411, 0.000990423655302916, 0.000884973378833143, 0.000815537798108738, 
            0.000750859016637561, 0.000690676822246216, 0.000634739190405433, 0.000582802605049925, 0.000534211038518747, 
            0.000489213184906939, 0.000447588577108234, 0.000409125945255556, 0.000373623249538517, 0.000353415016372953, 
            0.000334183311606384, 0.000315888251732715, 0.000298491143565499, 0.000281954474670215, 0.000271473922566996, 
            0.000261344205561956, 0.000251555239884894, 0.00024209716349323, 0.000232960333928091, 0.000224135326072477, 
            0.000215612929817033, 0.000207384147639749, 0.000199440192105659, 0.000191772483291789, 0.000184372646143704, 
            0.000177232507768562, 0.000170344094670224, 0.000163699629931702, 0.000157291530349527, 0.000151428676064014, 
            0.000145767778120554, 0.000140302601975484, 0.000135027075116156, 0.000129935284103296, 0.000120149126581912, 
            0.000111047178633619, 0.000102586225088983, 9.47253887259102e-05, 8.74260361879353e-05, 8.23218740690274e-05, 
            7.74959929346974e-05, 7.29345502027087e-05, 6.86243050214302e-05, 6.45525976396305e-05, 5.82162461660778e-05, 
            5.24644088188074e-05, 4.72473918268054e-05, 4.25192629885343e-05, 3.82376164609493e-05, 3.43633470006527e-05, 
            3.08604338685513e-05, 2.76957345206856e-05, 2.48387881287302e-05, 2.22616289035406e-05, 2.03318423027708e-05, 
            1.85603681762669e-05, 1.69350928728092e-05, 1.54447471544907e-05, 1.40788548931756e-05, 1.25364974661787e-05, 
            1.11550311347667e-05))), class = "BchronCalibratedDates"))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11255.4079411906, 24.4677143597434)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11255, 
        ageSds = 24, calCurves = "intcal13", ageGrid = c(13056, 13057, 13058, 13059, 13060, 13061, 13062, 13063, 13064, 13065, 
            13066, 13067, 13068, 13069, 13070, 13071, 13072, 13073, 13074, 13075, 13076, 13077, 13078, 13079, 13080, 13081, 
            13082, 13083, 13084, 13085, 13086, 13087, 13088, 13089, 13090, 13091, 13092, 13093, 13094, 13095, 13096, 13097, 
            13098, 13099, 13100, 13101, 13102, 13103, 13104, 13105, 13106, 13107, 13108, 13109, 13110, 13111, 13112, 13113, 
            13114, 13115, 13116, 13117, 13118, 13119, 13120, 13121, 13122, 13123, 13124, 13125, 13126, 13127, 13128, 13129, 
            13130, 13131, 13132, 13133, 13134, 13135, 13136, 13137, 13138, 13139, 13140, 13141, 13142, 13143, 13144, 13145, 
            13146, 13147, 13148, 13149, 13150, 13151, 13152, 13153, 13154, 13155, 13156, 13157, 13158, 13159, 13160, 13161, 
            13162, 13163, 13164, 13165, 13166, 13167, 13168, 13169, 13170, 13171, 13172, 13173, 13174, 13175, 13176, 13177, 
            13178, 13179, 13180, 13181, 13182, 13183, 13184, 13185, 13186, 13187, 13188, 13189, 13190, 13191, 13192, 13193, 
            13194, 13195, 13196, 13197, 13198), densities = c(1.30799945892e-05, 1.80255452500177e-05, 2.46936253020546e-05, 
            3.36248100001582e-05, 4.5506859204623e-05, 6.28060555834927e-05, 8.60422227353635e-05, 0.000116993361353806, 
            0.000157872084250245, 0.000211397605451388, 0.000286526205488939, 0.000384930441483851, 0.000512501155021873, 
            0.000676152520906373, 0.000883844514070452, 0.00114342638987175, 0.00146548451426308, 0.00186054844760635, 0.00233956631604238, 
            0.0029134945648308, 0.00364474538549742, 0.00450859652042357, 0.00551408000304178, 0.0066665541882223, 0.00796651772368484, 
            0.00929787810564293, 0.0107420161508099, 0.012283762423785, 0.0139020916728531, 0.0155701943490219, 0.0171213206496057, 
            0.0186599217379341, 0.0201548848355573, 0.0215734344249921, 0.0228822747301707, 0.0238642870037638, 0.0247304404809795, 
            0.0254643557923613, 0.0260516533473077, 0.0264804238329912, 0.0267232306655104, 0.0268259141568868, 0.0267862637731964, 
            0.0266043695636013, 0.0262826343259038, 0.0259380830190884, 0.0255143126627823, 0.0250150441904864, 0.0244446999859528, 
            0.0238083370233344, 0.0231127039876323, 0.0223631696436849, 0.0215662163586489, 0.0207285972992642, 0.0198572385916035, 
            0.0192198759578378, 0.0185716616656661, 0.0179151077701271, 0.0172526836948972, 0.0165868009862325, 0.0157903399137157, 
            0.0149964688431511, 0.0142087985092619, 0.0134307043393642, 0.0126653069608634, 0.0119186500101961, 0.0111901824246469, 
            0.010482136371595, 0.00979645385108443, 0.00913478811832431, 0.00850172249452315, 0.00789505579160242, 0.0073155771708348, 
            0.00676382698238152, 0.00624011185120439, 0.00566417192950359, 0.00512634247299366, 0.00462609957425631, 0.00416262910564977, 
            0.00373486763758979, 0.00334154269891817, 0.00298121170391543, 0.00265229897902999, 0.00235313043199219, 0.00208196551341668, 
            0.0018707092310428, 0.00167756238032008, 0.00150140348453649, 0.00134112512084019, 0.00119564199148411, 0.00104085586083967, 
            0.000903598547215477, 0.000782285274906585, 0.000675412096028404, 0.000581562038658462, 0.000521574295845327, 
            0.00046712819906699, 0.000417791128238774, 0.000373154815187677, 0.000332835095187572, 0.00029604770151483, 0.000262954123786043, 
            0.000233231458339395, 0.000206579058907512, 0.000182717733623414, 0.000169414659298002, 0.000156996167979786, 
            0.000145410395872154, 0.000134607967695539, 0.000124541919807888, 0.000118285905370348, 0.000112318974729671, 
            0.000106629200882311, 0.000101205070853127, 9.60354754369949e-05, 9.11096989769671e-05, 8.64174091922569e-05, 
            8.19486470690323e-05, 7.76938168261218e-05, 7.36436759665691e-05, 6.9789325425876e-05, 6.61221998263396e-05, 
            6.26340578465504e-05, 5.93169727143858e-05, 5.61633228308402e-05, 5.33750692120979e-05, 5.07174323975668e-05, 
            4.8184741394969e-05, 4.57715464675232e-05, 4.34726118579032e-05, 3.91172982822317e-05, 3.51751665903267e-05, 
            3.16096764733587e-05, 2.83872222030232e-05, 2.54769293158316e-05, 2.34948324905322e-05, 2.16594899778282e-05, 
            1.99606977454745e-05, 1.83889040358368e-05, 1.6935172496638e-05, 1.47293224086723e-05, 1.27983578716286e-05, 
            1.11098611713883e-05))), class = "BchronCalibratedDates"))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11253.1169776451, 24.9883869300829)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11253, 
        ageSds = 25, calCurves = "intcal13", ageGrid = c(13053, 13054, 13055, 13056, 13057, 13058, 13059, 13060, 13061, 13062, 
            13063, 13064, 13065, 13066, 13067, 13068, 13069, 13070, 13071, 13072, 13073, 13074, 13075, 13076, 13077, 13078, 
            13079, 13080, 13081, 13082, 13083, 13084, 13085, 13086, 13087, 13088, 13089, 13090, 13091, 13092, 13093, 13094, 
            13095, 13096, 13097, 13098, 13099, 13100, 13101, 13102, 13103, 13104, 13105, 13106, 13107, 13108, 13109, 13110, 
            13111, 13112, 13113, 13114, 13115, 13116, 13117, 13118, 13119, 13120, 13121, 13122, 13123, 13124, 13125, 13126, 
            13127, 13128, 13129, 13130, 13131, 13132, 13133, 13134, 13135, 13136, 13137, 13138, 13139, 13140, 13141, 13142, 
            13143, 13144, 13145, 13146, 13147, 13148, 13149, 13150, 13151, 13152, 13153, 13154, 13155, 13156, 13157, 13158, 
            13159, 13160, 13161, 13162, 13163, 13164, 13165, 13166, 13167, 13168, 13169, 13170, 13171, 13172, 13173, 13174, 
            13175, 13176, 13177, 13178, 13179, 13180, 13181, 13182, 13183, 13184, 13185, 13186, 13187, 13188, 13189, 13190, 
            13191, 13192, 13193, 13194, 13195, 13196, 13197, 13198, 13199, 13200), densities = c(1.27055392455143e-05, 1.63649022993311e-05, 
            2.10012911552195e-05, 2.83506321549863e-05, 3.80573692571806e-05, 5.07973748616493e-05, 6.74121225318198e-05, 
            8.8940025859823e-05, 0.000119443876316191, 0.000159281690018696, 0.000210893632369777, 0.00027721580527393, 0.000361735953525878, 
            0.000477261680612568, 0.000624395372190674, 0.000809935476080261, 0.00104154886312648, 0.00132769924210294, 0.00167617090486123, 
            0.00209745559223873, 0.00260122180953914, 0.00319689301165213, 0.00389316388266607, 0.00475883032109778, 0.00575565048835619, 
            0.00688702709107544, 0.00815194908291026, 0.009544104941907, 0.0109372316987458, 0.0124147407342767, 0.0139569476346704, 
            0.015539337925906, 0.0171329763215279, 0.0185818311976409, 0.0199858873885336, 0.0213163062249966, 0.0225439546624341, 
            0.0236404461105153, 0.0244339362012388, 0.0251045414179709, 0.0256400445828067, 0.0260303661049076, 0.0262678816958269, 
            0.0263468715119132, 0.0262964547113771, 0.0261169232794283, 0.0258105110658037, 0.025381348145858, 0.0249656591216819, 
            0.0244822452024434, 0.0239350766770663, 0.0233286444495067, 0.0226678969228341, 0.0219593882234943, 0.021207921061574, 
            0.0204193852473377, 0.0195998166785577, 0.0187553186035239, 0.0181419928350211, 0.0175214560166755, 0.0168958557594743, 
            0.0162672894914492, 0.0156377930998862, 0.0148875661340451, 0.0141423185800502, 0.0134050434301539, 0.0126785233783333, 
            0.0119653176060567, 0.0112706725511701, 0.0105937998358426, 0.00993650042057888, 0.00930033193271072, 0.00868661131523775, 
            0.0080993250176399, 0.0075363421599149, 0.00699826585363294, 0.00648549469021946, 0.00599823537303454, 0.00546160592853771, 
            0.00495953115533863, 0.00449150938928425, 0.00405680003601018, 0.00365445660540264, 0.00328335917734618, 0.00294224580033233, 
            0.00262974240265735, 0.00234439087473578, 0.00208467505835256, 0.00188150223257732, 0.00169501262115489, 0.00152422438816921, 
            0.00136816553038434, 0.00122588068541908, 0.00107383965927652, 0.0009382415797419, 0.000817677564535054, 0.000710804151933353, 
            0.000616349033343381, 0.000555637191551629, 0.000500264009032936, 0.000449835406275532, 0.000403977826655804, 
            0.000362338147290647, 0.000324164239428847, 0.000289632477999683, 0.000258442136787887, 0.000230311763239676, 
            0.00020497859464546, 0.000190798096845892, 0.000177510933473056, 0.000165067746884404, 0.000153421383216987, 
            0.000142526832419942, 0.000135730061526205, 0.000129230594258056, 0.000123016877595574, 0.000117077732142813, 
            0.00011140234382544, 0.000105980255581008, 0.000100801359053642, 9.58558863047924e-05, 9.11344015510739e-05, 
            8.66277929391419e-05, 8.23272643677408e-05, 7.82243273656832e-05, 7.43107930344016e-05, 7.05787640631158e-05, 
            6.70206268237743e-05, 6.38535252028666e-05, 6.08272233688961e-05, 5.79359463812648e-05, 5.5174130434423e-05, 
            5.25364164696426e-05, 4.75254369487606e-05, 4.29657535063023e-05, 3.88196397733404e-05, 3.5052212483162e-05, 
            3.16312494691435e-05, 2.92893154410767e-05, 2.71119432170004e-05, 2.50883168491995e-05, 2.320826972274e-05, 2.14622505134455e-05, 
            1.87998353079993e-05, 1.64525835591742e-05, 1.43853189864413e-05, 1.25664980991399e-05, 1.09678744614791e-05))), 
        class = "BchronCalibratedDates"))
})

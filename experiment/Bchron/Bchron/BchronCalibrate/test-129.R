library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11261.0512632616, 22.4889597732574)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11261, 
        ageSds = 22, calCurves = "intcal13", ageGrid = c(13062, 13063, 13064, 13065, 13066, 13067, 13068, 13069, 13070, 13071, 
            13072, 13073, 13074, 13075, 13076, 13077, 13078, 13079, 13080, 13081, 13082, 13083, 13084, 13085, 13086, 13087, 
            13088, 13089, 13090, 13091, 13092, 13093, 13094, 13095, 13096, 13097, 13098, 13099, 13100, 13101, 13102, 13103, 
            13104, 13105, 13106, 13107, 13108, 13109, 13110, 13111, 13112, 13113, 13114, 13115, 13116, 13117, 13118, 13119, 
            13120, 13121, 13122, 13123, 13124, 13125, 13126, 13127, 13128, 13129, 13130, 13131, 13132, 13133, 13134, 13135, 
            13136, 13137, 13138, 13139, 13140, 13141, 13142, 13143, 13144, 13145, 13146, 13147, 13148, 13149, 13150, 13151, 
            13152, 13153, 13154, 13155, 13156, 13157, 13158, 13159, 13160, 13161, 13162, 13163, 13164, 13165, 13166, 13167, 
            13168, 13169, 13170, 13171, 13172, 13173, 13174, 13175, 13176, 13177, 13178, 13179, 13180, 13181, 13182, 13183, 
            13184, 13185, 13186, 13187, 13188, 13189, 13190, 13191, 13192, 13193, 13194, 13195, 13196), densities = c(1.39459438232461e-05, 
            2.03053143011068e-05, 2.93211230655947e-05, 4.19855972267143e-05, 6.10300752364631e-05, 8.7866889321995e-05, 
            0.000125274690526243, 0.000176839211341377, 0.000247111485751374, 0.000341227815317268, 0.000466379758839335, 
            0.00063081522621086, 0.000844223136790126, 0.00111771856171772, 0.0014903136745969, 0.00196251775744829, 0.00255180477921803, 
            0.00327559085151066, 0.00415005624482393, 0.00510567404589632, 0.00620988830863065, 0.0074658739154247, 0.00887117516823476, 
            0.0104165966683715, 0.0119454590013245, 0.0135606846737232, 0.0152374766406423, 0.0169453426312611, 0.0186487252255776, 
            0.0200328029268244, 0.0213629875245137, 0.0226142972845792, 0.0237618037037421, 0.0247814383767831, 0.0255709829060108, 
            0.0262243743576361, 0.0267290412806833, 0.0270748943641041, 0.0272546629048138, 0.0272768543995509, 0.0271952248257629, 
            0.0270101272171034, 0.0267231243883494, 0.0263369693103236, 0.0258561001123436, 0.0252853755629747, 0.0246308439909664, 
            0.0238994201645808, 0.0230987602782634, 0.0224904798715211, 0.0218545797348835, 0.0211943115791078, 0.0205129828802555, 
            0.0198139287815068, 0.0189601378669892, 0.018091916999812, 0.0172147948689371, 0.0163341092610119, 0.0154549558822223, 
            0.0145857106527938, 0.0137275170636176, 0.0128844326897118, 0.0120601314060068, 0.0112578876167253, 0.0104844689879374, 
            0.0097384252060305, 0.00902173939323412, 0.00833600013348085, 0.00768241612021932, 0.00696104075859428, 0.00628537534936478, 
            0.00565561969658891, 0.00507145549084694, 0.00453210772345897, 0.00403640745468548, 0.00358285439516257, 0.00316967795217086, 
            0.0027948956004473, 0.00245636765211019, 0.00219365635829999, 0.00195443751208612, 0.00173724680586129, 0.00154062327005207, 
            0.0013631239026398, 0.00117530060259507, 0.00101001949841396, 0.000865145732398301, 0.000738650925267926, 0.000628624992794698, 
            0.000558891203760474, 0.000496077744660474, 0.000439605785223954, 0.000388931069190943, 0.000343543634160164, 
            0.000302456744333352, 0.000265835508539326, 0.000233257150776645, 0.000204330484123203, 0.000178694670873277, 
            0.000164501912505587, 0.000151339505954794, 0.000139141397208315, 0.000127845010161832, 0.000117391126958607, 
            0.000110938250209898, 0.000104812086614247, 9.89978334734828e-05, 9.34812551514819e-05, 8.82486673152804e-05, 
            8.32869212705869e-05, 7.85833884140175e-05, 7.41259448233226e-05, 6.99029560052634e-05, 6.59032618189095e-05, 
            6.2116161591355e-05, 5.85313994407388e-05, 5.51391498205083e-05, 5.19300032975037e-05, 4.88949525748947e-05, 
            4.62449058439153e-05, 4.37307687598832e-05, 4.13460545489931e-05, 3.90845565821996e-05, 3.69403380275563e-05, 
            3.28992537361522e-05, 2.9277969252213e-05, 2.60356636529229e-05, 2.31351450117663e-05, 2.05425683410638e-05, 
            1.87941913683929e-05, 1.71878447117288e-05, 1.57126479465881e-05, 1.43584919121264e-05, 1.31159897916125e-05, 
            1.1248530199862e-05))), class = "BchronCalibratedDates"))
})

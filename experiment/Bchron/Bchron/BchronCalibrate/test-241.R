library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11250.4456251878, 25.143765459524)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11250, 
        ageSds = 25, calCurves = "intcal13", ageGrid = c(13051, 13052, 13053, 13054, 13055, 13056, 13057, 13058, 13059, 13060, 
            13061, 13062, 13063, 13064, 13065, 13066, 13067, 13068, 13069, 13070, 13071, 13072, 13073, 13074, 13075, 13076, 
            13077, 13078, 13079, 13080, 13081, 13082, 13083, 13084, 13085, 13086, 13087, 13088, 13089, 13090, 13091, 13092, 
            13093, 13094, 13095, 13096, 13097, 13098, 13099, 13100, 13101, 13102, 13103, 13104, 13105, 13106, 13107, 13108, 
            13109, 13110, 13111, 13112, 13113, 13114, 13115, 13116, 13117, 13118, 13119, 13120, 13121, 13122, 13123, 13124, 
            13125, 13126, 13127, 13128, 13129, 13130, 13131, 13132, 13133, 13134, 13135, 13136, 13137, 13138, 13139, 13140, 
            13141, 13142, 13143, 13144, 13145, 13146, 13147, 13148, 13149, 13150, 13151, 13152, 13153, 13154, 13155, 13156, 
            13157, 13158, 13159, 13160, 13161, 13162, 13163, 13164, 13165, 13166, 13167, 13168, 13169, 13170, 13171, 13172, 
            13173, 13174, 13175, 13176, 13177, 13178, 13179, 13180, 13181, 13182, 13183, 13184, 13185, 13186, 13187, 13188, 
            13189, 13190, 13191, 13192, 13193, 13194, 13195, 13196, 13197), densities = c(1.18738696132786e-05, 1.53192777862866e-05, 
            1.96924838917052e-05, 2.52208800190579e-05, 3.21809629138834e-05, 4.31338453580213e-05, 5.7484146916996e-05, 
            7.61652024492998e-05, 0.000100325676438669, 0.000131366178446763, 0.000174956485723506, 0.000231343672438375, 
            0.000303688036243326, 0.000395733314923134, 0.000511853729172813, 0.000668950413443584, 0.000866799715937772, 
            0.00111345162268352, 0.00141776484420735, 0.00178925159073662, 0.00223621695998264, 0.00276985705887579, 0.00339983513264875, 
            0.00413498015897264, 0.00498269095868598, 0.00602181291876168, 0.00719995908385349, 0.00851572352956034, 0.00996216706624591, 
            0.0115260795627083, 0.0130633068136282, 0.0146636905752393, 0.0163011849676795, 0.0179452757957309, 0.0195617564373425, 
            0.0209942119958032, 0.0223430627088786, 0.0235783686681913, 0.0246712406388498, 0.0255949592673455, 0.0262180298377199, 
            0.0266963254839821, 0.0270207011718364, 0.0271846764689038, 0.0271846517386258, 0.027043839889436, 0.026771287985228, 
            0.0263706018528921, 0.0258472786073588, 0.0252085787386537, 0.0246362667961612, 0.0240035974382129, 0.0233157112900275, 
            0.0225781376925602, 0.0217967183783868, 0.0209791858808164, 0.0201304841886758, 0.0192568937109568, 0.0183646750730947, 
            0.0174599935404065, 0.0168116096320576, 0.0161622203695784, 0.0155138498061812, 0.0148684383433583, 0.0142278339687834, 
            0.0134719541217838, 0.0127284953410571, 0.0119999800981587, 0.0112886863033057, 0.010596641873453, 0.00992867170904225, 
            0.00928323096703329, 0.00866155702641811, 0.00806464753833861, 0.00749326903885869, 0.00695084614860538, 0.00643470581120862, 
            0.00594496522088292, 0.0054815648719045, 0.0050442838184423, 0.00456622800758797, 0.00412245371996117, 0.00371195282980175, 
            0.00333354300463653, 0.002985899967598, 0.00266758816079143, 0.00237708946886723, 0.00211282974157619, 0.00187320292996624, 
            0.00165659272151466, 0.00148821087791826, 0.00133453360697713, 0.00119458471994667, 0.00106741409356577, 0.000952102340618471, 
            0.000829526799806668, 0.000720907371894443, 0.000624941256848877, 0.000540403506196917, 0.000466149274505614, 
            0.00041866720210409, 0.000375548393388355, 0.000336448861308294, 0.000301045109712967, 0.000269033679326377, 
            0.000239798044652736, 0.000213464210007512, 0.000189778859539104, 0.000168506569355459, 0.000149429047227711, 
            0.00013877997497684, 0.000128827110045199, 0.000119530003276202, 0.000110850162879131, 0.000102750989171142, 
            9.77104420382393e-05, 9.28982138902931e-05, 8.83050121940113e-05, 8.39218668316288e-05, 7.97401217777534e-05, 
            7.57514268447833e-05, 7.19477295046003e-05, 6.83212667941059e-05, 6.48645573115963e-05, 6.15703933101313e-05, 
            5.84318328941137e-05, 5.54421923242337e-05, 5.25950384357965e-05, 4.98841811749628e-05, 4.73036662567452e-05, 
            4.50154111260241e-05, 4.28318064861259e-05, 4.07484029685495e-05, 3.87609221342457e-05, 3.68652508700886e-05, 
            3.32689675182812e-05, 3.0005430774627e-05, 2.70458686969059e-05, 2.43637784283275e-05, 2.1934770407156e-05, 2.02760520382838e-05, 
            1.87368541709372e-05, 1.73090739005525e-05, 1.59851149232876e-05, 1.47578593596466e-05, 1.28905737205218e-05, 
            1.12495305913011e-05))), class = "BchronCalibratedDates"))
})

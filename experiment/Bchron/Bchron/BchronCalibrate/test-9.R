library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11256.802870319, 27.9441135529429)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11257, 
        ageSds = 28, calCurves = "intcal13", ageGrid = c(13048, 13049, 13050, 13051, 13052, 13053, 13054, 13055, 13056, 13057, 
            13058, 13059, 13060, 13061, 13062, 13063, 13064, 13065, 13066, 13067, 13068, 13069, 13070, 13071, 13072, 13073, 
            13074, 13075, 13076, 13077, 13078, 13079, 13080, 13081, 13082, 13083, 13084, 13085, 13086, 13087, 13088, 13089, 
            13090, 13091, 13092, 13093, 13094, 13095, 13096, 13097, 13098, 13099, 13100, 13101, 13102, 13103, 13104, 13105, 
            13106, 13107, 13108, 13109, 13110, 13111, 13112, 13113, 13114, 13115, 13116, 13117, 13118, 13119, 13120, 13121, 
            13122, 13123, 13124, 13125, 13126, 13127, 13128, 13129, 13130, 13131, 13132, 13133, 13134, 13135, 13136, 13137, 
            13138, 13139, 13140, 13141, 13142, 13143, 13144, 13145, 13146, 13147, 13148, 13149, 13150, 13151, 13152, 13153, 
            13154, 13155, 13156, 13157, 13158, 13159, 13160, 13161, 13162, 13163, 13164, 13165, 13166, 13167, 13168, 13169, 
            13170, 13171, 13172, 13173, 13174, 13175, 13176, 13177, 13178, 13179, 13180, 13181, 13182, 13183, 13184, 13185, 
            13186, 13187, 13188, 13189, 13190, 13191, 13192, 13193, 13194, 13195, 13196, 13197, 13198, 13199, 13200, 13201, 
            13202, 13203, 13204, 13205, 13206, 13207, 13208, 13209, 13210, 13211, 13212, 13213, 13214, 13215, 13216, 13217), 
        densities = c(1.01353770120635e-05, 1.21019955232408e-05, 1.44250841557802e-05, 1.80363648813179e-05, 2.24853506051977e-05, 
            2.7948380627079e-05, 3.46343017733023e-05, 4.27893439687694e-05, 5.51855561978718e-05, 7.08424210669214e-05, 
            9.05140766896634e-05, 0.000115098742584306, 0.000145657924357538, 0.00018718212906965, 0.000239151743899424, 
            0.000303761916083249, 0.000383544763539921, 0.000481387498738647, 0.000610302153158001, 0.000768399011868849, 
            0.000960692868575999, 0.00119262324084653, 0.00146997176770505, 0.00179767357978621, 0.00218259990982956, 0.00263066956775226, 
            0.0031474287857734, 0.00373777145837836, 0.00445661147712447, 0.00526808293805858, 0.00617330935602356, 0.00717075044885087, 
            0.00825577038841606, 0.00933273176410283, 0.0104690577846951, 0.0116527468835711, 0.0128690543919472, 0.0141006698989263, 
            0.0152312411612617, 0.016342136352456, 0.0174157263861947, 0.0184338446991086, 0.0193782826366359, 0.0200953534947842, 
            0.0207396273882463, 0.0213020413832753, 0.0217744436336993, 0.02214979103138, 0.0223998100027189, 0.0225633537211732, 
            0.0226381970195286, 0.0226231731192867, 0.0225182026974912, 0.0223748620713803, 0.0221784537358861, 0.021930225478802, 
            0.0216318012005465, 0.0212851629431578, 0.020893040617194, 0.0204578442663985, 0.0199824998992752, 0.0194701739388835, 
            0.0189242371563761, 0.0185164436995099, 0.0180947752713598, 0.0176605880965269, 0.0172152548819586, 0.016760157485395, 
            0.0162049687955049, 0.0156403450913014, 0.0150686222061754, 0.0144920883303573, 0.0139129693201334, 0.0133351518039142, 
            0.0127590870955658, 0.0121867173407347, 0.0116198746561932, 0.0110602733811452, 0.0105114826800456, 0.00997303700924016, 
            0.0094462425558238, 0.00893227134507309, 0.00843216081534903, 0.00786707648131313, 0.00732329588370545, 0.00680179427862498, 
            0.00630331779044424, 0.00582839425786837, 0.00537734578463137, 0.00495030267325185, 0.00454721842486368, 0.00416788549842043, 
            0.00381195153780119, 0.00352535412644517, 0.00325521025203691, 0.00300109740679901, 0.00276254760973375, 0.00253905443678667, 
            0.0022938851497291, 0.00206789809598222, 0.00186015707993692, 0.00166969999374288, 0.00149555030777192, 0.00138033408454687, 
            0.00127260886598218, 0.00117202047943887, 0.00107821900133964, 0.000990860034494119, 0.000908907153816405, 0.000832811408476363, 
            0.000762246677734033, 0.000696895991476881, 0.000636452200291619, 0.000602000330160369, 0.000569178840164663, 
            0.000537925537938442, 0.000508179688272932, 0.00047988203575824, 0.000461935877757387, 0.00044458282996108, 0.000427806701990846, 
            0.000411591602644763, 0.000395921940328736, 0.000380782423182104, 0.000366158058908624, 0.000352034154325286, 
            0.000338396314641243, 0.000325230442477743, 0.00031252273664206, 0.000300259690666023, 0.000288428091120896, 
            0.000277015015720089, 0.000266007831219975, 0.000255939926026607, 0.000246219813103088, 0.000236836967643157, 
            0.000227781118839217, 0.000219042246504527, 0.000202250226037774, 0.000186640103221605, 0.00017213818281334, 
            0.00015867453715168, 0.000146182884463902, 0.000137455515558603, 0.000129210206833531, 0.000121423045377828, 
            0.000114071121622511, 0.000107132499290476, 9.63475939387654e-05, 8.65751610505881e-05, 7.77287023276045e-05, 
            6.97281402052378e-05, 6.24994485954268e-05, 5.5974292891879e-05, 5.00896805123128e-05, 4.47876230197627e-05, 
            4.00148106516443e-05, 3.57222998907367e-05, 3.25148852668079e-05, 2.9578521048303e-05, 2.68920182370951e-05, 
            2.44356757216847e-05, 2.21911918518591e-05, 1.96657603825902e-05, 1.74128133594433e-05, 1.54048633127615e-05, 
            1.36169573724262e-05, 1.20264724231135e-05, 1.1150519657212e-05, 1.0335148030466e-05))), class = "BchronCalibratedDates"))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11209.8609680176, 42.0883087158203)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11210, 
        ageSds = 42, calCurves = "intcal13", ageGrid = c(12897, 12898, 12899, 12900, 12901, 12902, 12903, 12904, 12905, 12906, 
            12907, 12908, 12909, 12910, 12911, 12912, 12913, 12914, 12915, 12916, 12917, 12918, 12919, 12920, 12921, 12922, 
            12923, 12924, 12925, 12926, 12927, 12928, 12929, 12930, 12931, 12932, 12933, 12934, 12935, 12936, 12937, 12938, 
            12939, 12940, 12941, 12942, 12943, 12944, 12945, 12946, 12947, 12948, 12949, 12950, 12951, 12952, 12953, 12954, 
            12955, 12956, 12957, 12958, 12959, 12960, 12961, 12962, 12963, 12964, 12965, 12966, 12967, 12968, 12969, 12970, 
            12971, 12972, 12973, 12974, 12975, 12976, 12977, 12978, 12979, 12980, 12981, 12982, 12983, 12984, 12985, 12986, 
            12987, 12988, 12989, 12990, 12991, 12992, 12993, 12994, 12995, 12996, 12997, 12998, 12999, 13000, 13001, 13002, 
            13003, 13004, 13005, 13006, 13007, 13008, 13009, 13010, 13011, 13012, 13013, 13014, 13015, 13016, 13017, 13018, 
            13019, 13020, 13021, 13022, 13023, 13024, 13025, 13026, 13027, 13028, 13029, 13030, 13031, 13032, 13033, 13034, 
            13035, 13036, 13037, 13038, 13039, 13040, 13041, 13042, 13043, 13044, 13045, 13046, 13047, 13048, 13049, 13050, 
            13051, 13052, 13053, 13054, 13055, 13056, 13057, 13058, 13059, 13060, 13061, 13062, 13063, 13064, 13065, 13066, 
            13067, 13068, 13069, 13070, 13071, 13072, 13073, 13074, 13075, 13076, 13077, 13078, 13079, 13080, 13081, 13082, 
            13083, 13084, 13085, 13086, 13087, 13088, 13089, 13090, 13091, 13092, 13093, 13094, 13095, 13096, 13097, 13098, 
            13099, 13100, 13101, 13102, 13103, 13104, 13105, 13106, 13107, 13108, 13109, 13110, 13111, 13112, 13113, 13114, 
            13115, 13116, 13117, 13118, 13119, 13120, 13121, 13122, 13123, 13124, 13125, 13126, 13127, 13128, 13129, 13130, 
            13131, 13132, 13133, 13134, 13135, 13136, 13137, 13138, 13139, 13140, 13141, 13142, 13143, 13144, 13145, 13146, 
            13147, 13148, 13149, 13150, 13151, 13152, 13153, 13154, 13155, 13156, 13157, 13158, 13159, 13160, 13161, 13162, 
            13163, 13164, 13165, 13166, 13167, 13168, 13169, 13170, 13171, 13172, 13173, 13174, 13175, 13176, 13177, 13178, 
            13179, 13180, 13181, 13182, 13183, 13184, 13185, 13186, 13187, 13188, 13189, 13190, 13191, 13192, 13193, 13194, 
            13195, 13196, 13197, 13198, 13199, 13200, 13201, 13202, 13203, 13204, 13205, 13206, 13207, 13208, 13209, 13210, 
            13211, 13212, 13213, 13214, 13215, 13216, 13217, 13218, 13219, 13220, 13221, 13222, 13223, 13224, 13225, 13226, 
            13227, 13228, 13229, 13230, 13231), densities = c(1.00646799046723e-05, 1.02403369073388e-05, 1.04188778639584e-05, 
            1.06003466448611e-05, 1.09552234981124e-05, 1.13213398096068e-05, 1.16990275843835e-05, 1.20886277692736e-05, 
            1.24904904635728e-05, 1.29147937595213e-05, 1.33526598033456e-05, 1.38044901355142e-05, 1.42706970273334e-05, 
            1.47517037274805e-05, 1.52366042729235e-05, 1.57365335210883e-05, 1.62519237719183e-05, 1.67832185718845e-05, 
            1.73308729659006e-05, 1.78953537535038e-05, 1.84771397493658e-05, 1.90767220481475e-05, 1.9694604293709e-05, 
            2.03313029527402e-05, 2.06568734077182e-05, 2.09873475927764e-05, 2.13227937972114e-05, 2.16632811646618e-05, 
            2.20088797022024e-05, 2.26996812511222e-05, 2.34109159409114e-05, 2.41431436666974e-05, 2.48969381341193e-05, 
            2.56728871490313e-05, 2.60783788795461e-05, 2.6489877975066e-05, 2.690746637443e-05, 2.73312270131405e-05, 2.7761243833518e-05, 
            2.7761243833518e-05, 2.7761243833518e-05, 2.7761243833518e-05, 2.7761243833518e-05, 2.7761243833518e-05, 2.81783111382459e-05, 
            2.86012967756713e-05, 2.9030278721592e-05, 2.94653358784256e-05, 2.99065480846143e-05, 2.99065480846143e-05, 
            2.99065480846143e-05, 2.99065480846143e-05, 2.99065480846143e-05, 2.99065480846143e-05, 3.03539961240357e-05, 
            3.08077617355251e-05, 3.12679276224654e-05, 3.17345774624039e-05, 3.22077959168026e-05, 3.27095922774459e-05, 
            3.32187004851517e-05, 3.37352181904317e-05, 3.42592441974655e-05, 3.47908784753139e-05, 3.59011072517855e-05, 
            3.70442633360514e-05, 3.82212341885386e-05, 3.94329281484034e-05, 4.06802748251968e-05, 4.19642254946392e-05, 
            4.32857534985184e-05, 4.46458546486176e-05, 4.60455476345699e-05, 4.74858744356513e-05, 5.04610908299778e-05, 
            5.36086420010559e-05, 5.69375210200376e-05, 6.0457123810479e-05, 6.41772629146257e-05, 6.91559300365839e-05, 
            7.44888613952275e-05, 8.01984885266022e-05, 8.63084336608228e-05, 9.28435547490352e-05, 0.000101205046397693, 
            0.000110252760568193, 0.000120036226209298, 0.000130607891139891, 0.000142023233284952, 0.000154420044513449, 
            0.00016779183431063, 0.000182204709906407, 0.00019772827163124, 0.000214435708472274, 0.000232185211700744, 0.000251248186556803, 
            0.000271707045860833, 0.000293648040591775, 0.000317161321936513, 0.000346706444279336, 0.000378676176651851, 
            0.000413234276247166, 0.000450551974480186, 0.000490807959317972, 0.000521261995522437, 0.000553361966280675, 
            0.000587179029325819, 0.000622786179759127, 0.000660258210467403, 0.000699421928920187, 0.000740584632122646, 
            0.000783825411036151, 0.000829224932111339, 0.000876865359585945, 0.000927134161203326, 0.000979835505300499, 
            0.00103505617677233, 0.00109288401560359, 0.00115340778441229, 0.00120375569833086, 0.00125592841500922, 0.00130997220872115, 
            0.00136593350460588, 0.00142385881914903, 0.00148420772235316, 0.00154663485449798, 0.00161118684089168, 0.00167791009237448, 
            0.00174685072836465, 0.00181805449691761, 0.00189156669183295, 0.00196743206685908, 0.00204569474705508, 0.0021263981373737, 
            0.0022312981110753, 0.00234018639075452, 0.00245314136821297, 0.00257023848461359, 0.00269154990506578, 0.00281714418580742, 
            0.00294708593476679, 0.00308143546635608, 0.00322024845141682, 0.00336357556330536, 0.00354211348761921, 0.00372730572618628, 
            0.00391920553588054, 0.00411785236496275, 0.00432327097185459, 0.00457197416655334, 0.00482990788236011, 0.00509702383533873, 
            0.00537323966636074, 0.00565843735377922, 0.00603817279460094, 0.00643207367251635, 0.00683960602558352, 0.00726012330471448, 
            0.00769286391581535, 0.00823716268659502, 0.00879655867818545, 0.0093689508552509, 0.00995198518221409, 0.010543064632669, 
            0.0111934307283296, 0.0118460838630012, 0.0124968133398646, 0.0131411861666349, 0.0137745946794661, 0.0144418710409337, 
            0.0150848912131852, 0.0156975689290139, 0.0162739089186289, 0.0168081052951067, 0.0172944602253954, 0.0177281077663853, 
            0.0181043756972252, 0.0184191492467224, 0.0186689474207075, 0.0188620878649668, 0.0189742130877177, 0.0190038325410545, 
            0.0189505514246626, 0.0188150796120789, 0.0186172033461208, 0.0183521929592298, 0.018023016684287, 0.017633324979892, 
            0.0171873818865812, 0.0167294684932544, 0.016231628748191, 0.0156982308321244, 0.0151338473006365, 0.0145431890045306, 
            0.0140336490845107, 0.0135118422474474, 0.0129805290693376, 0.0124424271833078, 0.0119001885905329, 0.0114105025389133, 
            0.0109213223593418, 0.0104343690114803, 0.00995127513926528, 0.00947357725179011, 0.00910529086911091, 0.00874173083636737, 
            0.0083834960877567, 0.00803114390449409, 0.00768518916251981, 0.00734687453029243, 0.00701586021339016, 0.00669252689099088, 
            0.00637721258605284, 0.00607021319195599, 0.00585681330032356, 0.00564785861599269, 0.00544341697343879, 0.00524354618421836, 
            0.00504829428560918, 0.00482116322397408, 0.00460075997517998, 0.00438711181215438, 0.00418022871560241, 0.00398010419605004, 
            0.0037873883241747, 0.00360134529281455, 0.00342192275709378, 0.00324905560573431, 0.00308266685091421, 0.00292326902630971, 
            0.0027701325873974, 0.00262314945492523, 0.00248220337546907, 0.00234717075544077, 0.00219684633362152, 0.00205418338041498, 
            0.00191895653049363, 0.00179093297002452, 0.00166987394192057, 0.00155553617201344, 0.00144767321301433, 0.00134603670398882, 
            0.00125037754388052, 0.0011604469783717, 0.00108778376228485, 0.00101898888237726, 0.000953909569092194, 0.000892395023741534, 
            0.000834296738106815, 0.000770060387307178, 0.000710112261412044, 0.000654227956873503, 0.000602189154252244, 
            0.00055378400010637, 0.000521261995522437, 0.000490421609263606, 0.000461191933645502, 0.000433503962656219, 
            0.000407290616128997, 0.000382326221172004, 0.000358723127545821, 0.000336419328395402, 0.000315354789543067, 
            0.000295471446087641, 0.000283982521661843, 0.000272892961635453, 0.000262191022435432, 0.000251865213369354, 
            0.000241904295118145, 0.000235497911278111, 0.00022924408133654, 0.000223139696670886, 0.000217181696635154, 
            0.000211367068260851, 0.00020569284594613, 0.000200156111133251, 0.000194753991974995, 0.000189483662990633, 
            0.000184342344711584, 0.000179327303317735, 0.000174435850264496, 0.00016966534190122, 0.000165013179081503, 
            0.000160476806765526, 0.000156214066268567, 0.000152055139718583, 0.000147997791117393, 0.00014403982387825, 
            0.000140179080387199, 0.000132670536087513, 0.000125532097899551, 0.000118747521505493, 0.000112301155339892, 
            0.000106177926026757, 0.000101802969296653, 9.7594719247352e-05, 9.3547470458342e-05, 8.96556829745274e-05, 8.59139788448175e-05, 
            7.99662818070587e-05, 7.44014218015878e-05, 6.91970666704719e-05, 6.43320084104883e-05, 5.97861200330053e-05, 
            5.55403130616294e-05, 5.15764957458519e-05, 4.78775320600467e-05, 4.44272015487433e-05, 4.12101600711196e-05, 
            3.87492341254551e-05, 3.64258652814474e-05, 3.42330004483718e-05, 3.2163906628401e-05, 3.02121590198758e-05, 
            2.79329638855966e-05, 2.58155980196928e-05, 2.38494339222838e-05, 2.20244707240223e-05, 2.03313029527402e-05, 
            1.93693788474767e-05, 1.84503501247494e-05, 1.7572442723998e-05, 1.67339488360417e-05, 1.59332247823966e-05, 
            1.515739092654e-05, 1.44171760709398e-05, 1.3711061896711e-05, 1.30375886839277e-05, 1.23953533595314e-05, 1.19777420044012e-05, 
            1.15733857818775e-05, 1.11818942461503e-05, 1.08028873679576e-05, 1.04359952940967e-05, 1.00887884548496e-05))), 
        class = "BchronCalibratedDates"))
})

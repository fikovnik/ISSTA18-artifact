library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11095.81484375, 90.793359375)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11096, 
        ageSds = 91, calCurves = "intcal13", ageGrid = c(12705, 12706, 12707, 12708, 12709, 12710, 12711, 12712, 12713, 12714, 
            12715, 12716, 12717, 12718, 12719, 12720, 12721, 12722, 12723, 12724, 12725, 12726, 12727, 12728, 12729, 12730, 
            12731, 12732, 12733, 12734, 12735, 12736, 12737, 12738, 12739, 12740, 12741, 12742, 12743, 12744, 12745, 12746, 
            12747, 12748, 12749, 12750, 12751, 12752, 12753, 12754, 12755, 12756, 12757, 12758, 12759, 12760, 12761, 12762, 
            12763, 12764, 12765, 12766, 12767, 12768, 12769, 12770, 12771, 12772, 12773, 12774, 12775, 12776, 12777, 12778, 
            12779, 12780, 12781, 12782, 12783, 12784, 12785, 12786, 12787, 12788, 12789, 12790, 12791, 12792, 12793, 12794, 
            12795, 12796, 12797, 12798, 12799, 12800, 12801, 12802, 12803, 12804, 12805, 12806, 12807, 12808, 12809, 12810, 
            12811, 12812, 12813, 12814, 12815, 12816, 12817, 12818, 12819, 12820, 12821, 12822, 12823, 12824, 12825, 12826, 
            12827, 12828, 12829, 12830, 12831, 12832, 12833, 12834, 12835, 12836, 12837, 12838, 12839, 12840, 12841, 12842, 
            12843, 12844, 12845, 12846, 12847, 12848, 12849, 12850, 12851, 12852, 12853, 12854, 12855, 12856, 12857, 12858, 
            12859, 12860, 12861, 12862, 12863, 12864, 12865, 12866, 12867, 12868, 12869, 12870, 12871, 12872, 12873, 12874, 
            12875, 12876, 12877, 12878, 12879, 12880, 12881, 12882, 12883, 12884, 12885, 12886, 12887, 12888, 12889, 12890, 
            12891, 12892, 12893, 12894, 12895, 12896, 12897, 12898, 12899, 12900, 12901, 12902, 12903, 12904, 12905, 12906, 
            12907, 12908, 12909, 12910, 12911, 12912, 12913, 12914, 12915, 12916, 12917, 12918, 12919, 12920, 12921, 12922, 
            12923, 12924, 12925, 12926, 12927, 12928, 12929, 12930, 12931, 12932, 12933, 12934, 12935, 12936, 12937, 12938, 
            12939, 12940, 12941, 12942, 12943, 12944, 12945, 12946, 12947, 12948, 12949, 12950, 12951, 12952, 12953, 12954, 
            12955, 12956, 12957, 12958, 12959, 12960, 12961, 12962, 12963, 12964, 12965, 12966, 12967, 12968, 12969, 12970, 
            12971, 12972, 12973, 12974, 12975, 12976, 12977, 12978, 12979, 12980, 12981, 12982, 12983, 12984, 12985, 12986, 
            12987, 12988, 12989, 12990, 12991, 12992, 12993, 12994, 12995, 12996, 12997, 12998, 12999, 13000, 13001, 13002, 
            13003, 13004, 13005, 13006, 13007, 13008, 13009, 13010, 13011, 13012, 13013, 13014, 13015, 13016, 13017, 13018, 
            13019, 13020, 13021, 13022, 13023, 13024, 13025, 13026, 13027, 13028, 13029, 13030, 13031, 13032, 13033, 13034, 
            13035, 13036, 13037, 13038, 13039, 13040, 13041, 13042, 13043, 13044, 13045, 13046, 13047, 13048, 13049, 13050, 
            13051, 13052, 13053, 13054, 13055, 13056, 13057, 13058, 13059, 13060, 13061, 13062, 13063, 13064, 13065, 13066, 
            13067, 13068, 13069, 13070, 13071, 13072, 13073, 13074, 13075, 13076, 13077, 13078, 13079, 13080, 13081, 13082, 
            13083, 13084, 13085, 13086, 13087, 13088, 13089, 13090, 13091, 13092, 13093, 13094, 13095, 13096, 13097, 13098, 
            13099, 13100, 13101, 13102, 13103, 13104, 13105, 13106, 13107, 13108, 13109, 13110, 13111, 13112, 13113, 13114, 
            13115, 13116, 13117, 13118, 13119, 13120, 13121, 13122, 13123, 13124, 13125, 13126, 13127, 13128, 13129, 13130, 
            13131, 13132, 13133, 13134, 13135, 13136, 13137, 13138, 13139, 13140, 13141, 13142, 13143, 13144, 13145, 13146, 
            13147, 13148, 13149, 13150, 13151, 13152, 13153, 13154, 13155, 13156, 13157, 13158, 13159, 13160, 13161, 13162, 
            13163, 13164, 13165, 13166, 13167, 13168, 13169, 13170, 13171, 13172, 13173, 13174, 13175, 13176, 13177, 13178, 
            13179, 13180, 13181, 13182, 13183, 13184, 13185, 13186, 13187, 13188, 13189, 13190, 13191, 13192, 13193, 13194, 
            13195, 13196, 13197, 13198, 13199, 13200, 13201, 13202, 13203, 13204, 13205, 13206, 13207, 13208, 13209, 13210, 
            13211, 13212, 13213, 13214, 13215, 13216, 13217, 13218, 13219, 13220, 13221, 13222, 13223, 13224, 13225, 13226, 
            13227, 13228, 13229, 13230, 13231, 13232, 13233, 13234, 13235, 13236, 13237, 13238, 13239, 13240, 13241, 13242, 
            13243, 13244, 13245, 13246, 13247, 13248, 13249, 13250, 13251, 13252, 13253, 13254, 13255, 13256, 13257, 13258, 
            13259, 13260, 13261, 13262, 13263, 13264, 13265, 13266, 13267, 13268, 13269, 13270, 13271, 13272), densities = c(1.0064842390495e-05, 
            1.16433008773009e-05, 1.34489266432863e-05, 1.55108488310633e-05, 1.78613401688436e-05, 2.05360627256497e-05, 
            2.35661111309e-05, 2.70009710888906e-05, 3.08877082749264e-05, 3.52777582420984e-05, 4.02271667032234e-05, 4.57921655719477e-05, 
            5.20423630653006e-05, 5.90488139468437e-05, 6.68879660660282e-05, 7.56417867963628e-05, 8.44081376615704e-05, 
            9.40611846350105e-05, 0.000104673317757671, 0.000116320649931695, 0.000129082934761864, 0.000143021600153354, 
            0.000158241884619192, 0.000174833317911093, 0.000192888285611789, 0.0002125016981704, 0.000231429329734218, 0.000251750488671935, 
            0.000273536538390008, 0.000296859302800356, 0.000321790700919901, 0.000343544344959205, 0.000366474329842372, 
            0.000390619754258326, 0.000416019025761835, 0.000442709663105287, 0.000466599835878225, 0.000491485309561486, 
            0.000517387474859829, 0.00054432681299772, 0.000572322785117306, 0.000593978443198135, 0.000616244456914654, 
            0.000639127715971636, 0.000662634663799398, 0.000686771268993087, 0.000705967293493827, 0.000725549524117196, 
            0.000745520118217324, 0.000765881022480297, 0.000786633964614786, 0.000798592888560371, 0.00081067968938016, 
            0.000822894607005717, 0.000835237855981257, 0.000847709624961947, 0.000860371233635419, 0.000873162287254166, 
            0.000886082876261936, 0.000899133062654704, 0.000912312879490062, 0.000922314109742352, 0.000932388463138907, 
            0.000942535915071223, 0.000952756431121831, 0.000963049966952043, 0.000973448274231111, 0.000983919675156499, 
            0.000994464088922547, 0.00100508142424813, 0.00101577157926982, 0.00103021355130342, 0.00104478500629445, 0.00105948558565242, 
            0.00107431489521157, 0.00108927250481963, 0.00110820668427579, 0.00112733999914018, 0.00114667133101383, 0.00116619946857302, 
            0.00118592310648978, 0.00120580752405231, 0.00122588439220916, 0.00124615213938142, 0.00126660909647681, 0.00128725349600398, 
            0.00131647371491511, 0.00134605221384327, 0.00137598314323063, 0.0014062602615839, 0.00143687693232203, 0.00146775864704409, 
            0.00149896556099908, 0.00153048993476666, 0.00156232362655702, 0.00159445809106562, 0.00162688437879775, 0.00165959313587545, 
            0.0016925746043378, 0.00172581862294513, 0.00175931462849777, 0.00179788558106521, 0.00183675439021941, 0.00187590339166582, 
            0.00191531425529554, 0.00195496799337372, 0.00198483232291533, 0.00201481408166633, 0.00204490457735374, 0.00207509492143873, 
            0.00210537603232497, 0.0021357085366474, 0.00216611367801133, 0.00219658185021906, 0.00222710326838738, 0.00225766797322508, 
            0.00228826583553416, 0.00231888656093452, 0.00234951969480999, 0.00238015462747312, 0.00241078059954767, 0.00243628308445843, 
            0.00246176550412132, 0.00248722141379248, 0.00251264430680985, 0.00253802761713568, 0.00256336472196552, 0.0025886489444026, 
            0.00261387355619628, 0.0026390317805431, 0.0026641167949492, 0.00268412283809376, 0.00270407422255036, 0.00272396740114149, 
            0.00274379881230219, 0.00276356488109973, 0.00278324034652924, 0.00280284391822497, 0.002822371993775, 0.00284182096113017, 
            0.00286118719968074, 0.0028708179291336, 0.00288042693953264, 0.00289001377762604, 0.00289957798977025, 0.00290911912196473, 
            0.00291865614040649, 0.00292816884190367, 0.00293765677058655, 0.00294711947043271, 0.0029565564853031, 0.00296123720087854, 
            0.00296591157096069, 0.00297057953883195, 0.00297524104776178, 0.00297989604100817, 0.00298456273108837, 0.00298922262710898, 
            0.00299387567211503, 0.00299852180915236, 0.00300316098126906, 0.00300779313151636, 0.00301241820294988, 0.00301703613863087, 
            0.00302164688162708, 0.00302625037501424, 0.00303084656187692, 0.00303543538530979, 0.0030400167884189, 0.00304459071432254, 
            0.00304915710615273, 0.00305373292819446, 0.00305830093480785, 0.00306286106909954, 0.00306741327420276, 0.00307195749327888, 
            0.00308103826114286, 0.00309008606572709, 0.00309910045339211, 0.00310808097112891, 0.00311702716659747, 0.00312149512869489, 
            0.00312595425614792, 0.00313040449264318, 0.00313484578192055, 0.00313927806777465, 0.0031480849168487, 0.0031568557548866, 
            0.0031655901336157, 0.00317428760561043, 0.00318294772433087, 0.00318727812487594, 0.00319159885174243, 0.00319590984952186, 
            0.00320021106287707, 0.00320450243654365, 0.00321302747972373, 0.00322151317329684, 0.00322995907636808, 0.00323836474917751, 
            0.00324672975313872, 0.00325506680090284, 0.00326336197447852, 0.00327161484003566, 0.00327982496514206, 0.00328799191880194, 
            0.00329610294890765, 0.00330417027813735, 0.0033121934787609, 0.00332017212456603, 0.00332810579089659, 0.00333599405469044, 
            0.00334383649451745, 0.00335163269061745, 0.00335938222493793, 0.00336708468117194, 0.00337091812539718, 0.00337473964479572, 
            0.00337854918783694, 0.00338234670310624, 0.00338613213930645, 0.00339365625965399, 0.00340113176528554, 0.00340855824827396, 
            0.00341593530261142, 0.00342326252424689, 0.00342691212687742, 0.00343054904357415, 0.00343417322465997, 0.00343778462059115, 
            0.00344138318195876, 0.00344138318195876, 0.00344138318195876, 0.00344138318195876, 0.00344138318195876, 0.00344138318195876, 
            0.00344495963426598, 0.00344852330588317, 0.00345207414726039, 0.00345561210897827, 0.00345913714174941, 0.00345913714174941, 
            0.00345913714174941, 0.00345913714174941, 0.00345913714174941, 0.00345913714174941, 0.00346264919641934, 0.00346614822396777, 
            0.00346963417550976, 0.00347310700229673, 0.0034765666557178, 0.00348002156157842, 0.00348346304882356, 0.00348689106987726, 
            0.00349030557731387, 0.00349370652385953, 0.00350047557653484, 0.00350718952975492, 0.00351384801359032, 0.00352045066070799, 
            0.00352699710640585, 0.00353348698864689, 0.00353991994809319, 0.00354629562813973, 0.00355261367494787, 0.00355887373747886, 
            0.0035712120472275, 0.00358331481872974, 0.00359517933473885, 0.00360680292544537, 0.0036181829694963, 0.003632065453303, 
            0.00364555800889545, 0.00365865586782268, 0.0036713543912651, 0.0036836490728265, 0.00369785843387885, 0.0037114735664388, 
            0.00372448741767335, 0.00373689323115631, 0.00374868455282595, 0.00375985739293411, 0.00377040326647341, 0.00378031670233075, 
            0.00378959255395377, 0.00379822600389347, 0.00380621044782044, 0.00381354455783005, 0.00382022443638223, 0.00382624652893039, 
            0.00383160762713414, 0.00383702302331185, 0.00384153092042384, 0.00384512803986439, 0.00384781176346765, 0.00384958013674487, 
            0.00385028209621982, 0.003850516119229, 0.00385028208495335, 0.00384958004662991, 0.0038484102315387, 0.00384677295081223, 
            0.00384466876821572, 0.00384209839846082, 0.00383906272932547, 0.00383556282113426, 0.00383160036048115, 0.00382717650835133, 
            0.0038222928711307, 0.00381695122425371, 0.00381115351110624, 0.00380618817306842, 0.00380093340662251, 0.0037953904317693, 
            0.00378956053538445, 0.00378344507071063, 0.003777047209024, 0.00377036699774346, 0.00376340600487305, 0.00375616586218771, 
            0.00374864826458402, 0.00374085496940642, 0.00373278779574995, 0.00372444862373952, 0.00371583939378606, 0.00370696210582043, 
            0.00369549533701828, 0.00368361764357348, 0.00367133333734388, 0.00365864686560404, 0.0036455628083179, 0.00363208587533848, 
            0.0036182209035371, 0.00360397285386453, 0.00358934680834672, 0.00357434796701758, 0.00355587020669027, 0.00353687334578865, 
            0.00351736702437123, 0.00349736109639966, 0.00347686562133927, 0.00345235523508838, 0.00342720981187341, 0.00340144630801049, 
            0.00337508198856073, 0.00334813440788682, 0.00331266090606195, 0.00327629141710836, 0.0032390650396038, 0.00320102141380559, 
            0.00316220065116079, 0.00311375856418732, 0.00306429093317297, 0.00301387292477309, 0.00296258006194288, 0.00291048803745044, 
            0.00285282853743626, 0.00279440513727126, 0.00273531529814918, 0.00267565568006283, 0.00261552188802785, 0.0025498904357196, 
            0.00248392666443046, 0.00241774628542939, 0.00235146228851737, 0.00228518464928718, 0.00221899084836164, 0.00215301190458421, 
            0.00208734736689205, 0.00202209282499882, 0.0019573397274371, 0.00188819718413165, 0.00181983845570116, 0.00175236093254112, 
            0.00168585575534689, 0.0016204077206045, 0.00156061620177277, 0.0015018614614039, 0.00144419668452793, 0.0013876702934149, 
            0.00133232598685484, 0.00128225239387094, 0.0012332471724069, 0.00118533453021449, 0.00113853545560992, 0.00109286779301525, 
            0.00105563783604508, 0.00101921170904639, 0.000983595100779559, 0.000948792340389057, 0.000914806439553709, 0.000884906676046733, 
            0.00085567068248194, 0.000827098112752524, 0.000799187868560537, 0.000771938127769399, 0.000751144072463029, 
            0.000730747805833353, 0.000710747667434973, 0.00069114176683793, 0.000671927992031033, 0.000653131415149097, 
            0.000634721412716662, 0.000616695243435188, 0.000599049979589748, 0.000581782515395367, 0.000569700151704454, 
            0.000557807179902275, 0.000546102310539276, 0.000534584215603148, 0.000523251530015723, 0.00050992913623227, 
            0.000496868319682862, 0.000484066522308348, 0.000471521123699407, 0.000459229444611406, 0.000447211446764694, 
            0.00043544098826065, 0.000423915232702834, 0.000412631299163533, 0.000401586265414965, 0.000390798218147356, 
            0.000380242455851319, 0.000369915952691941, 0.000359815654515947, 0.000349938481752645, 0.000338689754169742, 
            0.000327735668480127, 0.000317071233094826, 0.000306691431048569, 0.000296591225489805, 0.000286765564996288, 
            0.000277209388715025, 0.000267917631325965, 0.000258885227829097, 0.000250107118154729, 0.000242783837668848, 
            0.000235640415095894, 0.000228673687994506, 0.000221880505050649, 0.000215257727831144, 0.000207711631614256, 
            0.000200389748623421, 0.000193287152629523, 0.00018639895299463, 0.000179720297762536, 0.000175071846060075, 
            0.000170526239511583, 0.00016608174886737, 0.000161736657357387, 0.00015748926114088, 0.000153326343060129, 0.000149258182058652, 
            0.000145283108262006, 0.000141399466250186, 0.000137605615416694, 0.000135363280433315, 0.000133152532240413, 
            0.000130973022269436, 0.000128824403996042, 0.000126706332963093, 0.000125314418823221, 0.000123935775489489, 
            0.000122570302864602, 0.000121217901274259, 0.000119878471469619, 0.000118551914629755, 0.000117238132364019, 
            0.000115937026714322, 0.00011464850015739, 0.000113372455606884, 0.000112108796415516, 0.000110857426377067, 
            0.000109618249728339, 0.000108391171151073, 0.000107176095773738, 0.000105990639410283, 0.000104816708139617, 
            0.000103654210889755, 0.000102503057041584, 0.000101363156430025, 9.9108327749226e-05, 9.68977195841994e-05, 
            9.47306221968161e-05, 9.26063332199538e-05, 9.0524157684818e-05, 8.89916945327278e-05, 8.74821965973607e-05, 
            8.59953796047835e-05, 8.45309616419419e-05, 8.30886631595874e-05, 8.07284122222635e-05, 7.84277742097331e-05, 
            7.61854938191296e-05, 7.40003340690194e-05, 7.18710762951061e-05, 6.97965201355563e-05, 6.77754835062926e-05, 
            6.58068025665973e-05, 6.38893316753612e-05, 6.20219433383176e-05, 6.05528832186499e-05, 5.91149879084332e-05, 
            5.77076969897626e-05, 5.63304574420884e-05, 5.49827236150847e-05, 5.33400469889698e-05, 5.17415356279967e-05, 
            5.01861736316506e-05, 4.86729627144959e-05, 4.72009220908092e-05, 4.63351687100977e-05, 4.54837387771043e-05, 
            4.46464284743593e-05, 4.38230362073024e-05, 4.30133625936153e-05, 4.22128201042866e-05, 4.14257328003454e-05, 
            4.06519056066793e-05, 3.98911456359932e-05, 3.91432621771844e-05, 3.86490031730509e-05, 3.81603823185927e-05, 
            3.76773440497483e-05, 3.71998332285544e-05, 3.67277951415091e-05, 3.62650699490708e-05, 3.58076310028913e-05, 
            3.53554258086137e-05, 3.49084022832779e-05, 3.44665087535732e-05, 3.40333965686399e-05, 3.36052375333633e-05, 
            3.31819821165375e-05, 3.2763581183037e-05, 3.23499859919869e-05, 3.19446678592296e-05, 3.15439879275602e-05, 
            3.11478995192126e-05, 3.07563563367342e-05, 3.03693124610965e-05, 2.97987474194506e-05, 2.92380006204865e-05, 
            2.86869227826162e-05, 2.81453664807511e-05, 2.76131861316938e-05, 2.69189707988567e-05, 2.62407908086695e-05, 
            2.55783171607372e-05, 2.49312264402526e-05, 2.42992007551297e-05, 2.33746275750829e-05, 2.24824732269583e-05, 
            2.1621722601395e-05, 2.07913872087457e-05, 1.99905046947947e-05, 1.90932763450814e-05, 1.82333321473202e-05, 
            1.74092776119988e-05, 1.66197626522864e-05, 1.58634805481732e-05, 1.49338705621733e-05, 1.40549206332415e-05, 
            1.32241272264654e-05, 1.2439093765669e-05, 1.1697527126323e-05, 1.09972341759801e-05, 1.0336118366436e-05))), 
        class = "BchronCalibratedDates"))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11256.5901456377, 22.5220027036034)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11257, 
        ageSds = 23, calCurves = "intcal13", ageGrid = c(13058, 13059, 13060, 13061, 13062, 13063, 13064, 13065, 13066, 13067, 
            13068, 13069, 13070, 13071, 13072, 13073, 13074, 13075, 13076, 13077, 13078, 13079, 13080, 13081, 13082, 13083, 
            13084, 13085, 13086, 13087, 13088, 13089, 13090, 13091, 13092, 13093, 13094, 13095, 13096, 13097, 13098, 13099, 
            13100, 13101, 13102, 13103, 13104, 13105, 13106, 13107, 13108, 13109, 13110, 13111, 13112, 13113, 13114, 13115, 
            13116, 13117, 13118, 13119, 13120, 13121, 13122, 13123, 13124, 13125, 13126, 13127, 13128, 13129, 13130, 13131, 
            13132, 13133, 13134, 13135, 13136, 13137, 13138, 13139, 13140, 13141, 13142, 13143, 13144, 13145, 13146, 13147, 
            13148, 13149, 13150, 13151, 13152, 13153, 13154, 13155, 13156, 13157, 13158, 13159, 13160, 13161, 13162, 13163, 
            13164, 13165, 13166, 13167, 13168, 13169, 13170, 13171, 13172, 13173, 13174, 13175, 13176, 13177, 13178, 13179, 
            13180, 13181, 13182, 13183, 13184, 13185, 13186, 13187, 13188, 13189, 13190, 13191, 13192, 13193, 13194, 13195, 
            13196), densities = c(1.09183642490024e-05, 1.52956361473681e-05, 2.12910332036536e-05, 3.02845639948112e-05, 
            4.27442715308644e-05, 5.98567769380245e-05, 8.31525078459158e-05, 0.000114581067890425, 0.000160004071477213, 
            0.000221367351337368, 0.000303383370780749, 0.000411811516221436, 0.000553564482434334, 0.000735888024281648, 
            0.000968659244717717, 0.00126235769987142, 0.0016284869080107, 0.00207929906759119, 0.0026694056219069, 0.00338643067929868, 
            0.00424447446282979, 0.00525517224636278, 0.00642631044220471, 0.00765638800075625, 0.00902362528579092, 0.010519157888311, 
            0.0121275855826599, 0.0138265766549879, 0.0154437309122704, 0.017086298355528, 0.0187224859338039, 0.0203171373833214, 
            0.0218328744078526, 0.0230060545470844, 0.0240770250261282, 0.0250248980814714, 0.0258303973798417, 0.026476509004095, 
            0.0269099093024653, 0.0271947867859865, 0.0273255527142078, 0.0272992595825308, 0.027115707140703, 0.0268654600738215, 
            0.0265234862364683, 0.0260929322828371, 0.0255778701242702, 0.0249832316420811, 0.0243157431790757, 0.0235812449347555, 
            0.0227867443461369, 0.0219396971979999, 0.0210478877669891, 0.0203897330051837, 0.0197160470394178, 0.0190297593938466, 
            0.0183337723908313, 0.0176309407398671, 0.016786539599178, 0.0159413602659556, 0.0150997689881472, 0.0142658729105544, 
            0.0134434915394549, 0.0126396271201771, 0.0118540741247064, 0.011089613111357, 0.0103486778611752, 0.0096333545169365, 
            0.00894895233332403, 0.00829323119120763, 0.00766722542800754, 0.00707166459894903, 0.00650699149078451, 0.00588693144446758, 
            0.00530904550706905, 0.00477279595759986, 0.00427728968501289, 0.00382132926903741, 0.00340346331435855, 0.00302203511149813, 
            0.00267522885027105, 0.0023611127660405, 0.002077678750207, 0.00185785263479147, 0.00165773131608203, 0.00147602826885297, 
            0.0013114766931619, 0.00116283911606831, 0.00100544511145437, 0.000866748950911453, 0.000744963358398015, 0.000638401219338782, 
            0.000545482040302513, 0.000486451935405693, 0.000433162013530726, 0.000385137356211113, 0.000341931981767853, 
            0.000303128369708748, 0.000267910374180776, 0.000236421622358793, 0.00020831623023735, 0.00018327399934294, 0.000160999329290768, 
            0.000148635881123236, 0.000137142156771768, 0.000126463917958352, 0.000116549728742911, 0.000107350857671066, 
            0.000101657820202176, 9.62433371162368e-05, 9.10951775328527e-05, 8.62015672674299e-05, 8.15511762354566e-05, 
            7.71331059576228e-05, 7.29368771803791e-05, 6.89524176259185e-05, 6.51700498844728e-05, 6.15804794604546e-05, 
            5.81747829835974e-05, 5.49443965946871e-05, 5.18811045149099e-05, 4.89770278069326e-05, 4.62246133347217e-05, 
            4.38091423990206e-05, 4.15131383537757e-05, 3.93310996568416e-05, 3.72577542353536e-05, 3.52880512801924e-05, 
            3.15677282837699e-05, 2.82198963734331e-05, 2.52096392231405e-05, 2.25050340600355e-05, 2.00769270459896e-05, 
            1.84325736152926e-05, 1.69167468500143e-05, 1.5519974752956e-05, 1.42334311491057e-05, 1.30488962901504e-05, 
            1.126116820128e-05))), class = "BchronCalibratedDates"))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11258.4596825598, 24.6776298712008)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11258, 
        ageSds = 25, calCurves = "intcal13", ageGrid = c(13055, 13056, 13057, 13058, 13059, 13060, 13061, 13062, 13063, 13064, 
            13065, 13066, 13067, 13068, 13069, 13070, 13071, 13072, 13073, 13074, 13075, 13076, 13077, 13078, 13079, 13080, 
            13081, 13082, 13083, 13084, 13085, 13086, 13087, 13088, 13089, 13090, 13091, 13092, 13093, 13094, 13095, 13096, 
            13097, 13098, 13099, 13100, 13101, 13102, 13103, 13104, 13105, 13106, 13107, 13108, 13109, 13110, 13111, 13112, 
            13113, 13114, 13115, 13116, 13117, 13118, 13119, 13120, 13121, 13122, 13123, 13124, 13125, 13126, 13127, 13128, 
            13129, 13130, 13131, 13132, 13133, 13134, 13135, 13136, 13137, 13138, 13139, 13140, 13141, 13142, 13143, 13144, 
            13145, 13146, 13147, 13148, 13149, 13150, 13151, 13152, 13153, 13154, 13155, 13156, 13157, 13158, 13159, 13160, 
            13161, 13162, 13163, 13164, 13165, 13166, 13167, 13168, 13169, 13170, 13171, 13172, 13173, 13174, 13175, 13176, 
            13177, 13178, 13179, 13180, 13181, 13182, 13183, 13184, 13185, 13186, 13187, 13188, 13189, 13190, 13191, 13192, 
            13193, 13194, 13195, 13196, 13197, 13198, 13199, 13200, 13201, 13202, 13203, 13204, 13205), densities = c(1.0126516476868e-05, 
            1.38287013390165e-05, 1.8782096061013e-05, 2.53696465279492e-05, 3.40768368195991e-05, 4.5514094359446e-05, 6.19557017473616e-05, 
            8.37615411920816e-05, 0.000112459146329901, 0.000149930924813267, 0.000198469797675523, 0.000265920131843939, 
            0.00035338820303541, 0.000465740475334723, 0.000608660827431966, 0.000788670936444174, 0.00101217413534444, 0.00128785407374164, 
            0.00162435655016774, 0.00203073002234507, 0.00251613307734002, 0.00313336296924623, 0.00386176662231441, 0.00470979230600403, 
            0.00568332479002697, 0.00678477192305504, 0.00791776347847584, 0.00915376699885032, 0.0104830505473971, 0.0118912773932544, 
            0.0133594011157664, 0.0147426142566141, 0.0161359159560683, 0.0175152049947765, 0.0188543594868209, 0.0201259980035457, 
            0.0211124905691211, 0.0220177281880369, 0.0228265837543369, 0.0235250149695285, 0.0241004696960416, 0.0245042980487136, 
            0.0247936237454235, 0.0249637356846166, 0.0250116532525259, 0.024936212289079, 0.024792503401176, 0.0245754089938197, 
            0.0242865780688701, 0.0239283101949765, 0.0235035247027213, 0.023016303447493, 0.022470395117026, 0.0218703339815035, 
            0.0212210532431315, 0.0205278156147959, 0.0200099534352602, 0.0194747635010748, 0.0189243476639016, 0.0183608233742722, 
            0.0177863099480656, 0.0170881458423272, 0.0163811487738001, 0.0156687956141357, 0.014954447404402, 0.0142413245572765, 
            0.0135350273094212, 0.0128360411039122, 0.0121470059380763, 0.0114703495947517, 0.0108082785112807, 0.0101655625288996, 
            0.00954118062505128, 0.00893661268601936, 0.00835311136785975, 0.0077917071238747, 0.00716528706344986, 0.00657100495441653, 
            0.00600944912075038, 0.00548087380984976, 0.00498522748737292, 0.00452218282480711, 0.00409116768551261, 0.00369139646638362, 
            0.00332190121332821, 0.00298156199680213, 0.00271236708864084, 0.00246281444277911, 0.00223202571103922, 0.0020190947798025, 
            0.00182309806177861, 0.00161174340890746, 0.00142113917576155, 0.0012497980863897, 0.00109625976684905, 0.000959103445621092, 
            0.00087015542548127, 0.000788417059386092, 0.000713421016205886, 0.000644717458936102, 0.000581874846225413, 
            0.000523881928053293, 0.000471035205159476, 0.000422952958221457, 0.000379273224864463, 0.00033965375894437, 
            0.000317368837531748, 0.000296396217944581, 0.000276669968398349, 0.000258126647132564, 0.000240705266875101, 
            0.00022979119269003, 0.000219325215622057, 0.000209291369967171, 0.00019967413786653, 0.000190458442608249, 0.000181629641729078, 
            0.00017317351993494, 0.000165076281859543, 0.000157324544679564, 0.000149905330603484, 0.000142806059251801, 
            0.00013601453994438, 0.00012951896391076, 0.00012330789643857, 0.000117370268973917, 0.000112051289690345, 0.000106956936776522, 
            0.00010207859183998, 9.74079226923685e-05, 9.29368760693159e-05, 8.44220796145703e-05, 7.6637576360617e-05, 6.95260126960026e-05, 
            6.30339956536551e-05, 5.71118740348963e-05, 5.30401497740396e-05, 4.92418372448712e-05, 4.5699961823179e-05, 
            4.23984923966955e-05, 3.93222974917106e-05, 3.46135540801833e-05, 3.04393087394536e-05, 2.67429133755897e-05, 
            2.34731864545649e-05, 2.05839555080217e-05, 1.80336289197364e-05, 1.57847963035725e-05, 1.38038566181691e-05, 
            1.20606730309693e-05, 1.05282534411795e-05))), class = "BchronCalibratedDates"))
})

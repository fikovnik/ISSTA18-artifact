library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11264.8904571533, 61.6975051879883)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11265, 
        ageSds = 62, calCurves = "intcal13", ageGrid = c(12854, 12855, 12856, 12857, 12858, 12859, 12860, 12861, 12862, 12863, 
            12864, 12865, 12866, 12867, 12868, 12869, 12870, 12871, 12872, 12873, 12874, 12875, 12876, 12877, 12878, 12879, 
            12880, 12881, 12882, 12883, 12884, 12885, 12886, 12887, 12888, 12889, 12890, 12891, 12892, 12893, 12894, 12895, 
            12896, 12897, 12898, 12899, 12900, 12901, 12902, 12903, 12904, 12905, 12906, 12907, 12908, 12909, 12910, 12911, 
            12912, 12913, 12914, 12915, 12916, 12917, 12918, 12919, 12920, 12921, 12922, 12923, 12924, 12925, 12926, 12927, 
            12928, 12929, 12930, 12931, 12932, 12933, 12934, 12935, 12936, 12937, 12938, 12939, 12940, 12941, 12942, 12943, 
            12944, 12945, 12946, 12947, 12948, 12949, 12950, 12951, 12952, 12953, 12954, 12955, 12956, 12957, 12958, 12959, 
            12960, 12961, 12962, 12963, 12964, 12965, 12966, 12967, 12968, 12969, 12970, 12971, 12972, 12973, 12974, 12975, 
            12976, 12977, 12978, 12979, 12980, 12981, 12982, 12983, 12984, 12985, 12986, 12987, 12988, 12989, 12990, 12991, 
            12992, 12993, 12994, 12995, 12996, 12997, 12998, 12999, 13000, 13001, 13002, 13003, 13004, 13005, 13006, 13007, 
            13008, 13009, 13010, 13011, 13012, 13013, 13014, 13015, 13016, 13017, 13018, 13019, 13020, 13021, 13022, 13023, 
            13024, 13025, 13026, 13027, 13028, 13029, 13030, 13031, 13032, 13033, 13034, 13035, 13036, 13037, 13038, 13039, 
            13040, 13041, 13042, 13043, 13044, 13045, 13046, 13047, 13048, 13049, 13050, 13051, 13052, 13053, 13054, 13055, 
            13056, 13057, 13058, 13059, 13060, 13061, 13062, 13063, 13064, 13065, 13066, 13067, 13068, 13069, 13070, 13071, 
            13072, 13073, 13074, 13075, 13076, 13077, 13078, 13079, 13080, 13081, 13082, 13083, 13084, 13085, 13086, 13087, 
            13088, 13089, 13090, 13091, 13092, 13093, 13094, 13095, 13096, 13097, 13098, 13099, 13100, 13101, 13102, 13103, 
            13104, 13105, 13106, 13107, 13108, 13109, 13110, 13111, 13112, 13113, 13114, 13115, 13116, 13117, 13118, 13119, 
            13120, 13121, 13122, 13123, 13124, 13125, 13126, 13127, 13128, 13129, 13130, 13131, 13132, 13133, 13134, 13135, 
            13136, 13137, 13138, 13139, 13140, 13141, 13142, 13143, 13144, 13145, 13146, 13147, 13148, 13149, 13150, 13151, 
            13152, 13153, 13154, 13155, 13156, 13157, 13158, 13159, 13160, 13161, 13162, 13163, 13164, 13165, 13166, 13167, 
            13168, 13169, 13170, 13171, 13172, 13173, 13174, 13175, 13176, 13177, 13178, 13179, 13180, 13181, 13182, 13183, 
            13184, 13185, 13186, 13187, 13188, 13189, 13190, 13191, 13192, 13193, 13194, 13195, 13196, 13197, 13198, 13199, 
            13200, 13201, 13202, 13203, 13204, 13205, 13206, 13207, 13208, 13209, 13210, 13211, 13212, 13213, 13214, 13215, 
            13216, 13217, 13218, 13219, 13220, 13221, 13222, 13223, 13224, 13225, 13226, 13227, 13228, 13229, 13230, 13231, 
            13232, 13233, 13234, 13235, 13236, 13237, 13238, 13239, 13240, 13241, 13242, 13243, 13244, 13245, 13246, 13247, 
            13248, 13249, 13250, 13251, 13252, 13253, 13254, 13255, 13256, 13257, 13258, 13259, 13260, 13261, 13262, 13263, 
            13264, 13265, 13266, 13267, 13268, 13269, 13270, 13271, 13272, 13273, 13274, 13275, 13276, 13277, 13278, 13279, 
            13280, 13281, 13282, 13283, 13284, 13285, 13286, 13287, 13288, 13289, 13290, 13291, 13292, 13293, 13294, 13295, 
            13296, 13297, 13298, 13299, 13300, 13301, 13302, 13303, 13304, 13305, 13306, 13307, 13308, 13309, 13310, 13311, 
            13312, 13313, 13314, 13315, 13316, 13317, 13318, 13319, 13320, 13321, 13322, 13323, 13324), densities = c(1.00268434607902e-05, 
            1.02413227389226e-05, 1.03451210905785e-05, 1.04499187499238e-05, 1.05557247181921e-05, 1.066254807061e-05, 1.07703979569355e-05, 
            1.08828055698681e-05, 1.09963209370275e-05, 1.11109541959636e-05, 1.12267155680066e-05, 1.13436153588677e-05, 
            1.14616639592263e-05, 1.15808718453314e-05, 1.17012495796064e-05, 1.1822807811245e-05, 1.19455572768281e-05, 
            1.2069508800926e-05, 1.21946732967152e-05, 1.2321061766599e-05, 1.2448685302819e-05, 1.2577555088087e-05, 1.27117095466532e-05, 
            1.28472054618942e-05, 1.29840551725151e-05, 1.31222711182579e-05, 1.32618658405994e-05, 1.35494952777023e-05, 
            1.38429487096035e-05, 1.41423340113035e-05, 1.44477608216642e-05, 1.4759340567007e-05, 1.49197814173922e-05, 
            1.50818453335463e-05, 1.52455472696378e-05, 1.54109023005987e-05, 1.55779256229218e-05, 1.59072867210536e-05, 
            1.62431525417634e-05, 1.65856406068474e-05, 1.69348703102837e-05, 1.72909629425117e-05, 1.74769011869626e-05, 
            1.76646960722094e-05, 1.78543644234166e-05, 1.80459231985126e-05, 1.82393894890331e-05, 1.86209696256508e-05, 
            1.90099901891542e-05, 1.94065834394786e-05, 1.98108836962273e-05, 2.02230273643738e-05, 2.06492318419975e-05, 
            2.10837725901501e-05, 2.15267973640154e-05, 2.19784561903624e-05, 2.24389013948978e-05, 2.29016546775234e-05, 
            2.33732753576741e-05, 2.38539175738585e-05, 2.43437377899008e-05, 2.48428948223766e-05, 2.53515498681858e-05, 
            2.58698665322946e-05, 2.63980108556312e-05, 2.69361513431208e-05, 2.74844589918928e-05, 2.77624796267939e-05, 
            2.80431073196082e-05, 2.83263641585542e-05, 2.86122723929409e-05, 2.89008544340857e-05, 2.94779354704476e-05, 
            3.00657104926397e-05, 3.06643587470102e-05, 3.1274062068598e-05, 3.18950049097048e-05, 3.22141614943496e-05, 
            3.25362711790747e-05, 3.28613585493097e-05, 3.31894483652001e-05, 3.35205655625571e-05, 3.35205655625571e-05, 
            3.35205655625571e-05, 3.35205655625571e-05, 3.35205655625571e-05, 3.35205655625571e-05, 3.38455402185042e-05, 
            3.41734424851527e-05, 3.45042962406689e-05, 3.48381255310076e-05, 3.51749545708338e-05, 3.51749545708338e-05, 
            3.51749545708338e-05, 3.51749545708338e-05, 3.51749545708338e-05, 3.51749545708338e-05, 3.55148077443991e-05, 
            3.58577096064517e-05, 3.62036848831481e-05, 3.65527584729342e-05, 3.69049554474771e-05, 3.72702627308945e-05, 
            3.76389050114554e-05, 3.80109095634552e-05, 3.8386303849872e-05, 3.87651155233389e-05, 3.95435625148461e-05, 
            4.03363577326265e-05, 4.1143736449432e-05, 4.19659371610818e-05, 4.28032016173389e-05, 4.3655774852766e-05, 4.45239052176076e-05, 
            4.54078444086745e-05, 4.63078475002019e-05, 4.72241729747334e-05, 4.90943555205694e-05, 5.10322141553075e-05, 
            5.30399103775366e-05, 5.51196623641547e-05, 5.72737459444045e-05, 6.00854720434495e-05, 6.30225471453433e-05, 
            6.60898518707627e-05, 6.92924192826348e-05, 7.26354377218382e-05, 7.68149193159183e-05, 8.12116261329925e-05, 
            8.5835318679298e-05, 9.06961002744097e-05, 9.58044232933331e-05, 0.000101193362985492, 0.000106853752714558, 
            0.000112797224815755, 0.000119035785087034, 0.000125581817339499, 0.000132393209882343, 0.000139533455909704, 
            0.000147015884502296, 0.000154854212734701, 0.000163062548050565, 0.00017312595294533, 0.000183736431839195, 
            0.000194918415878376, 0.000206697064972423, 0.000219098265063996, 0.000228310760284687, 0.000237861832457304, 
            0.000247761506931388, 0.000258019991468849, 0.00026864767410392, 0.000279607172108879, 0.000290954387583667, 
            0.000302700155055638, 0.000314855477938017, 0.000327431524791145, 0.000340494792182137, 0.000354004643302176, 
            0.000367972790698337, 0.000382411091862198, 0.000397331543277559, 0.000409610657738282, 0.000422211853009306, 
            0.000435141437752494, 0.000448405767487689, 0.00046201124198682, 0.000476033702563825, 0.00049041299307131, 0.000505155668742886, 
            0.000520268315919648, 0.000535757548706247, 0.000551630005493933, 0.000567892345348774, 0.000584551244264531, 
            0.000601613391279906, 0.000619085484458622, 0.000641596453866381, 0.000664775280011678, 0.000688635080990852, 
            0.000713188944023761, 0.00073844991058217, 0.000764430960998824, 0.00079114499856134, 0.000818604833096155, 0.000846823164048974, 
            0.000875812563069331, 0.000911718125484784, 0.000948776804525256, 0.000987009363468311, 0.00102643612074325, 
            0.00106707689993329, 0.00111612838041299, 0.00116689162932588, 0.00121939494488783, 0.00127366526853776, 0.00132972806409695, 
            0.00140449934490542, 0.0014823203740874, 0.00156323244118196, 0.00164727122736706, 0.00173446635779805, 0.00184537383914706, 
            0.00196105917354574, 0.00208153360859871, 0.00220679052304992, 0.00233680430374094, 0.0024839367799539, 0.00263658602319018, 
            0.00279463337952376, 0.00295792768978341, 0.00312628417906421, 0.0033137359475692, 0.00350654823052385, 0.00370435054238166, 
            0.00390672300996633, 0.00411319648451893, 0.00432309989745288, 0.00453602804274455, 0.00475137103525662, 0.00496847488568586, 
            0.00518664405097921, 0.00542166470673105, 0.00565613554542751, 0.0058890565644843, 0.00611939277466002, 0.00634608142136732, 
            0.00655227231247886, 0.00675352381224514, 0.00694895764455106, 0.00713769907374022, 0.00731888339415462, 0.00747857256632436, 
            0.0076304779692525, 0.00777396989100113, 0.0079084438549625, 0.00803332490162366, 0.00812963351282168, 0.0082186232599045, 
            0.00830001888091221, 0.00837356604329402, 0.00843903268591506, 0.00849086756422427, 0.00853585478683908, 0.00857387568939507, 
            0.00860482887454891, 0.00862863066881089, 0.00864215495928, 0.00865129168318054, 0.00865602320061216, 0.00865633871801927, 
            0.00865223432546805, 0.00864371368777825, 0.00863078736111515, 0.00861347280217632, 0.00859179430788448, 0.00856578295787572, 
            0.00854457625601163, 0.00852119593813416, 0.00849565982094419, 0.00846798739397855, 0.00843819979431059, 0.00839971311565262, 
            0.00835826158881488, 0.00831389133829786, 0.0082666515945496, 0.00821659460117491, 0.00816380024574924, 0.00810830714724397, 
            0.00805017629958446, 0.00798947126333335, 0.00792625804797277, 0.00786064415254511, 0.00779266725997195, 0.00772240020390746, 
            0.00764991773338661, 0.0075752963788228, 0.00748562984204891, 0.0073932838837714, 0.00729838768580625, 0.00720107262638366, 
            0.00710147197544701, 0.00699972058947622, 0.00689595460681173, 0.00679031114444016, 0.00668292799718156, 0.00657394334019024, 
            0.00647937186908785, 0.00638381330819184, 0.00628735436220112, 0.00619008136436449, 0.00609208015119006, 0.00597669184796409, 
            0.00586054642973277, 0.00574377697771242, 0.0056265147899021, 0.0055088891473475, 0.00542468152926144, 0.00534039759245271, 
            0.00525608225959083, 0.00517177974322949, 0.00508753351096912, 0.00500324528691795, 0.00491909411064499, 0.00483512125711437, 
            0.00475136713958677, 0.00466787128226402, 0.00461779456062567, 0.00456783141215109, 0.00451798996455782, 0.00446827822120729, 
            0.00441870405943386, 0.00438578595626605, 0.00435293506652592, 0.00432015361498222, 0.00428744380045533, 0.00425480779564572, 
            0.00422224774697081, 0.00418976577440806, 0.00415736397134491, 0.00412504440443645, 0.00409280911346845, 0.00406066011122876, 
            0.00402859938338474, 0.00399662888836762, 0.00396475055726428, 0.00393296629371439, 0.00390159733334039, 0.00387032739854455, 
            0.00383915822499993, 0.00380809152064164, 0.00377712896562871, 0.00371536162989408, 0.00365402951911336, 0.00359314523992748, 
            0.00353272095207607, 0.00347276836842877, 0.003428160974892, 0.0033838299121189, 0.00333977960479224, 0.00329601433733525, 
            0.00325253825431314, 0.00318062284668069, 0.00310953960784985, 0.00303930532312694, 0.00296993571964347, 0.00290144547611247, 
            0.00283384823371097, 0.00276715660804222, 0.00270138220213041, 0.00263653562039988, 0.00257262648359061, 0.00252189407477691, 
            0.00247177352239305, 0.0024222686658039, 0.0023733829594501, 0.00232511947874507, 0.00226570795937414, 0.00220727679519195, 
            0.00214982954071688, 0.0020933688973405, 0.00203789673421258, 0.00200502857598859, 0.00197251739618621, 0.00194036320757389, 
            0.00190856592338165, 0.0018771253590538, 0.0018458958820945, 0.00181502423306394, 0.00178450999293403, 0.0017543526501673, 
            0.0017245516025306, 0.00170478776697003, 0.0016851825959628, 0.00166573585895081, 0.0016464473082958, 0.00162731667952269, 
            0.00160848158368048, 0.00158980250508758, 0.00157127911332101, 0.00155291106265879, 0.00153469799232476, 0.0015167740423149, 
            0.00149900292444338, 0.00148138421994838, 0.00146391749653989, 0.00144660230864233, 0.00142956920613382, 0.00141268527982537, 
            0.00139595003397949, 0.00137936296106788, 0.00136292354200836, 0.00133860361528972, 0.00131461177376726, 0.00129094611628807, 
            0.00126760469000357, 0.00124458549211953, 0.00121443127738823, 0.00118484026278687, 0.00115580731136217, 0.00112732715478446, 
            0.00109939440033738, 0.00105834057446393, 0.00101849388222457, 0.000979834782192484, 0.000942343255449306, 0.000905998854376534, 
            0.000865069404347743, 0.000825636602794151, 0.000787666296408522, 0.000751123907387776, 0.000715974521990544, 
            0.000672587350465498, 0.000631383991972544, 0.000592288814797045, 0.000555226193204321, 0.000520120746546778, 
            0.000486897560836776, 0.000455482392961709, 0.000425801857802098, 0.000397783598591245, 0.000371356440925624, 
            0.000346339192619251, 0.000322785526599246, 0.000300628089473878, 0.000279801163835536, 0.000260240752094763, 
            0.000241841598671744, 0.000224590936955917, 0.000208430049511998, 0.000193302151336375, 0.000179152416291701, 
            0.00016589547102344, 0.000153516684335762, 0.000141966929456073, 0.000131199059655131, 0.00012116789373424, 0.000111830195083459, 
            0.000103144644949468, 9.50718105284756e-05, 8.75741084749514e-05, 8.06157643909515e-05, 7.41627688328467e-05, 
            6.81828303442802e-05, 6.26453259948075e-05, 5.75212498742677e-05, 5.27831599635468e-05, 4.88607854964661e-05, 
            4.52073237877363e-05, 4.18062720715359e-05, 3.86419804368136e-05, 3.56996206386323e-05, 3.33028407837712e-05, 
            3.10555269646763e-05, 2.89492393157486e-05, 2.69759490658808e-05, 2.51280232446334e-05, 2.33982096152677e-05, 
            2.17796218592042e-05, 2.02657250338173e-05, 1.88503213228926e-05, 1.75275360965801e-05, 1.64574877020177e-05, 
            1.54486587211966e-05, 1.44978305633656e-05, 1.36019348885604e-05, 1.2758047821423e-05, 1.209124070938e-05, 1.14571891105423e-05, 
            1.08544073792481e-05, 1.02814702288919e-05))), class = "BchronCalibratedDates"))
})

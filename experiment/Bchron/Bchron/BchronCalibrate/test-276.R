library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11269.995228529, 31.5073878049851)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11270, 
        ageSds = 32, calCurves = "intcal13", ageGrid = c(13048, 13049, 13050, 13051, 13052, 13053, 13054, 13055, 13056, 13057, 
            13058, 13059, 13060, 13061, 13062, 13063, 13064, 13065, 13066, 13067, 13068, 13069, 13070, 13071, 13072, 13073, 
            13074, 13075, 13076, 13077, 13078, 13079, 13080, 13081, 13082, 13083, 13084, 13085, 13086, 13087, 13088, 13089, 
            13090, 13091, 13092, 13093, 13094, 13095, 13096, 13097, 13098, 13099, 13100, 13101, 13102, 13103, 13104, 13105, 
            13106, 13107, 13108, 13109, 13110, 13111, 13112, 13113, 13114, 13115, 13116, 13117, 13118, 13119, 13120, 13121, 
            13122, 13123, 13124, 13125, 13126, 13127, 13128, 13129, 13130, 13131, 13132, 13133, 13134, 13135, 13136, 13137, 
            13138, 13139, 13140, 13141, 13142, 13143, 13144, 13145, 13146, 13147, 13148, 13149, 13150, 13151, 13152, 13153, 
            13154, 13155, 13156, 13157, 13158, 13159, 13160, 13161, 13162, 13163, 13164, 13165, 13166, 13167, 13168, 13169, 
            13170, 13171, 13172, 13173, 13174, 13175, 13176, 13177, 13178, 13179, 13180, 13181, 13182, 13183, 13184, 13185, 
            13186, 13187, 13188, 13189, 13190, 13191, 13192, 13193, 13194, 13195, 13196, 13197, 13198, 13199, 13200, 13201, 
            13202, 13203, 13204, 13205, 13206, 13207, 13208, 13209, 13210, 13211, 13212, 13213, 13214, 13215, 13216, 13217, 
            13218, 13219, 13220, 13221, 13222, 13223, 13224, 13225, 13226, 13227, 13228, 13229, 13230, 13231, 13232, 13233, 
            13234, 13235, 13236, 13237, 13238, 13239, 13240, 13241, 13242, 13243, 13244, 13245, 13246, 13247, 13248, 13249, 
            13250, 13251, 13252, 13253, 13254, 13255, 13256, 13257, 13258, 13259, 13260, 13261), densities = c(1.08665561129433e-05, 
            1.26591505927841e-05, 1.47276535139288e-05, 1.78588373313277e-05, 2.16066259167236e-05, 2.60810726104361e-05, 
            3.14093766242418e-05, 3.77380353713753e-05, 4.70842269002667e-05, 5.85360017445855e-05, 7.25113170063037e-05, 
            8.94968081851033e-05, 0.000110055672220338, 0.000137268251010168, 0.000170452638479048, 0.000210713954234821, 
            0.000259309938428917, 0.000317659660508678, 0.000393071618524344, 0.000483822137058697, 0.000592350439438337, 
            0.00072131619083881, 0.000873579160412593, 0.00105162914852756, 0.0012590227026682, 0.00149896480978103, 0.00177465207966359, 
            0.00208918339960429, 0.00247275635266906, 0.00290762441009771, 0.00339640319926501, 0.00394091276291409, 0.00454197485540863, 
            0.00514926889087657, 0.00580360679989807, 0.0065025243041201, 0.00724233171245675, 0.00801805300592258, 0.00875821275807436, 
            0.00951790165461574, 0.0102903734416134, 0.0110680451413481, 0.011842594635809, 0.0124780381018827, 0.0130999336336955, 
            0.0137027281823556, 0.0142807913999572, 0.0148285004944308, 0.0152907543385344, 0.0157200980811664, 0.0161128044568243, 
            0.0164653764197749, 0.0167745991265575, 0.0169830638436727, 0.017162475528781, 0.0173117528934406, 0.0174299719317789, 
            0.017516375436213, 0.0175703851133977, 0.0175915877437335, 0.0175797870008474, 0.0175349755528355, 0.0174573358374256, 
            0.0173820121655377, 0.0172903478256862, 0.01718259135107, 0.0170590373921861, 0.0169200253470859, 0.016733571003474, 
            0.016526253930596, 0.0162989070347583, 0.0160524366555276, 0.0157878164292009, 0.0155064534141285, 0.0152091611176003, 
            0.0148970783435924, 0.0145713818217495, 0.0142332787511751, 0.0138846243051097, 0.013526141079214, 0.0131590807671643, 
            0.0127846945168648, 0.0124042259728033, 0.0119541517694062, 0.0114993706842757, 0.0110417495225284, 0.0105830925672844, 
            0.0101251307982547, 0.00966951229761261, 0.00921779389581898, 0.00877143409080328, 0.00833178725511979, 0.00790009912768423, 
            0.00753744980304364, 0.00718213229881281, 0.00683473070130373, 0.00649576722880249, 0.00616570269136633, 0.00578978631256914, 
            0.00542710391484084, 0.00507810809491115, 0.00474314693348756, 0.00442246856806755, 0.00420192341879091, 0.00398878397342214, 
            0.00378305713162767, 0.00358472875070461, 0.0033937648444617, 0.00320909072510702, 0.00303170734475596, 0.00286153109613634, 
            0.00269846306395075, 0.00254239028790094, 0.00245132957701109, 0.00236273910218961, 0.00227658860451357, 0.00219284644655456, 
            0.00211147970695317, 0.00205881348781481, 0.00200716999691884, 0.0019565386238406, 0.00190690857274827, 0.00185826887382527, 
            0.00181060839452759, 0.00176391585066654, 0.00171817981731252, 0.0016733887395153, 0.00162953094283302, 0.00158659464366914, 
            0.00154456795941006, 0.00150343891836059, 0.0014631954694744, 0.00142382549187343, 0.00138663277167656, 0.00135024540905272, 
            0.0013146514766045, 0.00127983904297119, 0.00124579617994467, 0.0011793776260454, 0.0011159362453675, 0.00105537640584332, 
            0.000997603051625266, 0.00094252188899539, 0.000903046024254434, 0.000864985803414643, 0.000828302791497464, 
            0.000792958972927146, 0.000758916781332697, 0.000704692091370124, 0.000653840381200776, 0.000606195834232451, 
            0.000561597024812264, 0.000519887140756405, 0.000480914167191943, 0.000444531033948661, 0.00041059572877847, 
            0.000378971378699493, 0.000349526301762925, 0.000327023873129702, 0.000305815158609735, 0.000285837557982591, 
            0.000267030638151428, 0.000249336121037452, 0.00022874238391572, 0.000209688242857775, 0.000192074237051229, 
            0.000175805868321032, 0.000160793488634854, 0.000152300650893524, 0.000144216242728759, 0.000136523069672208, 
            0.000129204517813914, 0.000122244542389653, 0.000115521921587897, 0.000109136853070439, 0.000103074403705184, 
            9.73201798393294e-05, 9.18603148733426e-05, 8.83205962332722e-05, 8.49054795416782e-05, 8.16110898647787e-05, 
            7.84336516257754e-05, 7.53694868999692e-05, 7.24874044875768e-05, 6.97068919773821e-05, 6.7024744104891e-05, 
            6.44378411979994e-05, 6.19431475161902e-05, 5.95992802220178e-05, 5.73378435797059e-05, 5.51562092023182e-05, 
            5.30518212308546e-05, 5.10221947888741e-05, 4.91172726688387e-05, 4.72789904322162e-05, 4.55052098521809e-05, 
            4.3793853251994e-05, 4.21429021176022e-05, 3.97973662395847e-05, 3.75748600738058e-05, 3.54694145839839e-05, 
            3.34753200106264e-05, 3.15871164610741e-05, 2.92364578596531e-05, 2.70516085412324e-05, 2.50216585973809e-05, 
            2.31363500026063e-05, 2.13860430733918e-05, 1.89593382538932e-05, 1.67948047090066e-05, 1.48658358447843e-05, 
            1.31483070201682e-05, 1.16203711340911e-05, 1.00577908906338e-05))), class = "BchronCalibratedDates"))
})

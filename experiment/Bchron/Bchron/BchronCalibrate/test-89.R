library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11685.3625, -54.39375)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11685, 
        ageSds = -54, calCurves = "intcal13", ageGrid = c(13308, 13309, 13310, 13311, 13312, 13313, 13314, 13315, 13316, 
            13317, 13318, 13319, 13320, 13321, 13322, 13323, 13324, 13325, 13326, 13327, 13328, 13329, 13330, 13331, 13332, 
            13333, 13334, 13335, 13336, 13337, 13338, 13339, 13340, 13341, 13342, 13343, 13344, 13345, 13346, 13347, 13348, 
            13349, 13350, 13351, 13352, 13353, 13354, 13355, 13356, 13357, 13358, 13359, 13360, 13361, 13362, 13363, 13364, 
            13365, 13366, 13367, 13368, 13369, 13370, 13371, 13372, 13373, 13374, 13375, 13376, 13377, 13378, 13379, 13380, 
            13381, 13382, 13383, 13384, 13385, 13386, 13387, 13388, 13389, 13390, 13391, 13392, 13393, 13394, 13395, 13396, 
            13397, 13398, 13399, 13400, 13401, 13402, 13403, 13404, 13405, 13406, 13407, 13408, 13409, 13410, 13411, 13412, 
            13413, 13414, 13415, 13416, 13417, 13418, 13419, 13420, 13421, 13422, 13423, 13424, 13425, 13426, 13427, 13428, 
            13429, 13430, 13431, 13432, 13433, 13434, 13435, 13436, 13437, 13438, 13439, 13440, 13441, 13442, 13443, 13444, 
            13445, 13446, 13447, 13448, 13449, 13450, 13451, 13452, 13453, 13454, 13455, 13456, 13457, 13458, 13459, 13460, 
            13461, 13462, 13463, 13464, 13465, 13466, 13467, 13468, 13469, 13470, 13471, 13472, 13473, 13474, 13475, 13476, 
            13477, 13478, 13479, 13480, 13481, 13482, 13483, 13484, 13485, 13486, 13487, 13488, 13489, 13490, 13491, 13492, 
            13493, 13494, 13495, 13496, 13497, 13498, 13499, 13500, 13501, 13502, 13503, 13504, 13505, 13506, 13507, 13508, 
            13509, 13510, 13511, 13512, 13513, 13514, 13515, 13516, 13517, 13518, 13519, 13520, 13521, 13522, 13523, 13524, 
            13525, 13526, 13527, 13528, 13529, 13530, 13531, 13532, 13533, 13534, 13535, 13536, 13537, 13538, 13539, 13540, 
            13541, 13542, 13543, 13544, 13545, 13546, 13547, 13548, 13549, 13550, 13551, 13552, 13553, 13554, 13555, 13556, 
            13557, 13558, 13559, 13560, 13561, 13562, 13563, 13564, 13565, 13566, 13567, 13568, 13569, 13570, 13571, 13572, 
            13573, 13574, 13575, 13576, 13577, 13578, 13579, 13580, 13581, 13582, 13583, 13584, 13585, 13586, 13587, 13588, 
            13589, 13590, 13591, 13592, 13593, 13594, 13595, 13596, 13597, 13598, 13599, 13600, 13601, 13602, 13603, 13604, 
            13605, 13606, 13607, 13608, 13609, 13610, 13611, 13612, 13613, 13614, 13615, 13616, 13617, 13618, 13619, 13620, 
            13621, 13622, 13623, 13624, 13625, 13626, 13627, 13628, 13629, 13630, 13631, 13632, 13633, 13634, 13635, 13636, 
            13637, 13638, 13639, 13640, 13641, 13642, 13643, 13644, 13645, 13646, 13647, 13648, 13649, 13650, 13651, 13652, 
            13653, 13654, 13655, 13656, 13657, 13658, 13659, 13660, 13661, 13662, 13663, 13664, 13665, 13666, 13667, 13668, 
            13669, 13670, 13671, 13672, 13673, 13674, 13675, 13676, 13677, 13678, 13679, 13680, 13681, 13682, 13683, 13684, 
            13685, 13686, 13687, 13688, 13689, 13690, 13691, 13692, 13693, 13694, 13695, 13696, 13697, 13698, 13699, 13700, 
            13701, 13702, 13703, 13704, 13705, 13706, 13707, 13708, 13709, 13710, 13711, 13712, 13713, 13714, 13715, 13716, 
            13717, 13718, 13719, 13720, 13721, 13722, 13723, 13724, 13725, 13726, 13727, 13728, 13729, 13730, 13731, 13732, 
            13733, 13734, 13735, 13736, 13737, 13738, 13739, 13740), densities = c(1.04544263862334e-05, 1.13861113131715e-05, 
            1.23954476579373e-05, 1.34883700313647e-05, 1.46712151010729e-05, 1.59507440891007e-05, 1.7334166104523e-05, 
            1.88291623032288e-05, 2.01966252375496e-05, 2.16564245922316e-05, 2.32142222247273e-05, 2.48759820013988e-05, 
            2.66479824835639e-05, 2.82101582294368e-05, 2.98571383411247e-05, 3.15930746495784e-05, 3.34222933408721e-05, 
            3.53493004960833e-05, 3.69592616929134e-05, 3.86369062647324e-05, 4.03847855213438e-05, 4.22055322279041e-05, 
            4.41018624943383e-05, 4.60921703404856e-05, 4.81648929210237e-05, 5.03230606658159e-05, 5.25697965546524e-05, 
            5.49083180430174e-05, 5.60855663696593e-05, 5.72860442643852e-05, 5.85101599052146e-05, 5.97583274363548e-05, 
            6.10309670272399e-05, 6.23484589913395e-05, 6.36919728269392e-05, 6.50619621052291e-05, 6.64588868564847e-05, 
            6.78832136284097e-05, 6.93571618867112e-05, 7.08602154484753e-05, 7.23928767149379e-05, 7.39556550329636e-05, 
            7.55490667511227e-05, 7.63574234223802e-05, 7.71736352751868e-05, 7.7997768846988e-05, 7.88298911231166e-05, 
            7.9670069538539e-05, 8.13748667851083e-05, 8.31127091218422e-05, 8.48841523838072e-05, 8.6689759758116e-05, 8.85301018354152e-05, 
            9.04057566605442e-05, 9.23173097824495e-05, 9.42653543032806e-05, 9.62504909265861e-05, 9.82733280047116e-05, 
            0.000101409022122881, 0.000104634494716989, 0.000107951939413792, 0.000111363590270958, 0.000114871722074053, 
            0.000118445463856592, 0.00012211876284352, 0.000125893973293169, 0.00012977349070539, 0.000133759752057485, 0.000137892550379808, 
            0.00014213883861518, 0.000146501225613893, 0.000150982362912583, 0.000155584944854374, 0.000160269858824274, 
            0.000165079831870237, 0.000170017639555671, 0.000175086100164434, 0.000180288074731496, 0.000187436754256609, 
            0.000194834960380448, 0.000202489829177333, 0.000210408631196996, 0.000218598770932687, 0.000227067786121359, 
            0.000235823346869049, 0.000244873254595157, 0.000254225440789339, 0.000263887965574054, 0.000273869016066913, 
            0.000284176904535895, 0.000294820066341225, 0.000305807057657862, 0.000317146552971708, 0.000331901377218616, 
            0.000347242722742566, 0.000363188399286722, 0.000379756467953805, 0.000396965228886404, 0.000414833207920206, 
            0.000433379142186193, 0.000452621964639177, 0.000472580787491591, 0.00049327488453305, 0.000514627567561849, 
            0.000536749121369623, 0.000559659090450933, 0.000583377105462278, 0.000607922860302069, 0.000638608526536943, 
            0.000670555465571557, 0.000703797853781148, 0.000738369744156093, 0.000774304991828905, 0.000811637176090635, 
            0.000850399518944867, 0.000890624800260741, 0.000932345269601976, 0.000975592554827067, 0.00102814013215678, 
            0.00108286238540361, 0.00113980518758304, 0.00119901242901885, 0.0012605257857854, 0.0013336532533183, 0.00140989566242912, 
            0.00148930225255271, 0.00157191672285859, 0.00165777674203481, 0.00174710024798698, 0.00183973180938926, 0.0019356874541306, 
            0.00203497515400546, 0.00213759435195797, 0.00225673176015148, 0.00238003794456841, 0.00250747062993695, 0.0026389710721416, 
            0.00277446338884908, 0.00294546638691591, 0.00312208414778409, 0.00330406535014131, 0.00349111564569483, 0.00368289703607957, 
            0.00387902759173831, 0.00407908153679897, 0.00428258972089487, 0.00448904049530986, 0.00469788100681304, 0.00490833168122282, 
            0.00511996292295137, 0.00533211214810433, 0.00554408484364348, 0.00575515794881592, 0.00598348717721094, 0.00620886041846282, 
            0.00643025704808493, 0.00664664162997529, 0.00685697184081863, 0.00707667822517857, 0.00728677474855018, 0.00748597767862991, 
            0.00767304253750939, 0.00784677717709999, 0.00799430058913367, 0.0081286919866808, 0.00824918529978194, 0.00835508562798224, 
            0.0084457760299461, 0.00852070553973403, 0.00857946437991027, 0.00862169633247689, 0.00864714225389378, 0.00865564276858709, 
            0.00864973673543845, 0.00863203850313756, 0.0086026147372902, 0.00856158087138624, 0.00850910033837727, 0.00845900622238047, 
            0.0084018441686805, 0.00833776019059354, 0.00826691777808743, 0.00818949718825431, 0.00813778319974182, 0.00808361233832032, 
            0.00802703697230012, 0.00796811166635444, 0.00790689309171887, 0.00788165659358813, 0.00785605883249451, 0.00783010358143463, 
            0.00780379466516286, 0.00777713595922141, 0.00777702305219733, 0.00777691011617681, 0.00777679715114866, 0.00777668415710174, 
            0.00777657113402487, 0.00780302655372398, 0.00782914485073847, 0.00785492195705837, 0.00788035384764746, 0.00790543654150644, 
            0.00794235087708774, 0.00797846207465259, 0.00801375716833377, 0.00804822343498991, 0.00808184840193472, 0.00811465542487793, 
            0.00814659292459897, 0.00817764936740763, 0.00820781350555545, 0.00823707438413975, 0.00826539544630553, 0.00829279579968526, 
            0.00831926524442145, 0.00834479389433392, 0.00836937218316017, 0.00837733974398913, 0.00838520103423563, 0.00839295571096452, 
            0.00840060343526787, 0.00840814387229032, 0.00840058635469301, 0.00839292054189975, 0.0083851467491081, 0.00837726529574196, 
            0.00836927650542867, 0.00833629719947694, 0.00830163651660189, 0.00826531772104365, 0.0082273650671687, 0.00818780377215987, 
            0.00812557281708594, 0.00805989011839161, 0.00799085310335035, 0.00791856321351293, 0.00784312565536498, 0.00772421680413308, 
            0.00759882916869064, 0.00746735658857254, 0.00733020552939298, 0.00718779299245752, 0.00699025962143234, 0.00678511216984849, 
            0.006573387579962, 0.00635612633481646, 0.00613436413190173, 0.00588999968559818, 0.00564279721291491, 0.00539399489043725, 
            0.00514478364672254, 0.00489629862235049, 0.00463008243062808, 0.00436715878032396, 0.0041086866298502, 0.00385571861420437, 
            0.00360919689116079, 0.00336973844430596, 0.00313827081247522, 0.00291539995913981, 0.0027016209158035, 0.00249732118597233, 
            0.00232938909963437, 0.00216877585523398, 0.00201555839376938, 0.0018697664075968, 0.00173138567041954, 0.00160000318059743, 
            0.00147591014325084, 0.00135898358883046, 0.00124907059426084, 0.00114599193643734, 0.00107275083818384, 0.00100316923928244, 
            0.000937149585199695, 0.00087458966492466, 0.000815383366124533, 0.000765414502327337, 0.000717935775749548, 
            0.00067286749129649, 0.000630129085653922, 0.000589639454464599, 0.000565350204470069, 0.00054189251024901, 0.000519246468342322, 
            0.00049739222856709, 0.000476310018028928, 0.000455980163947231, 0.000436383115300129, 0.000417499463298447, 
            0.000399309960700335, 0.000381795539980454, 0.000371556832894914, 0.000361552031253138, 0.000351777096515546, 
            0.000342228019601664, 0.000332900821997155, 0.000326804006129587, 0.000320802887010679, 0.000314896309782005, 
            0.000309083126282252, 0.000303362195166054, 0.000297732382018939, 0.000292192559468055, 0.000286741607288846, 
            0.000281378412507851, 0.00027610186950129, 0.0002734957489391, 0.000270910880089982, 0.000268347126859631, 0.000265804353630275, 
            0.000263282425263134, 0.000260841321727897, 0.000258419978491274, 0.00025601826737087, 0.000253636060678196, 
            0.000251273231220261, 0.000246547485015656, 0.000241899311751972, 0.000237327689852208, 0.000232831605815526, 
            0.00022841005427015, 0.00022625401912124, 0.000224115864959073, 0.000221995471174624, 0.00021989271767456, 0.000217807484882122, 
            0.000213689105702469, 0.000209639387391493, 0.000205657392030334, 0.000201742190050968, 0.000197892860258831, 
            0.00019594387611802, 0.000194011724094799, 0.000192096285937236, 0.00019019744392743, 0.000188315080882208, 0.000188315080882208, 
            0.000188315080882208, 0.000188315080882208, 0.000188315080882208, 0.000188315080882208, 0.000186496055648822, 
            0.000184692589147677, 0.000182904571242051, 0.000181131892323947, 0.000179374443314172, 0.000181131892323947, 
            0.000182904571242051, 0.000184692589147677, 0.000186496055648822, 0.000188315080882208, 0.000192000250734182, 
            0.000195748990360023, 0.000199562199855024, 0.000203440787739848, 0.000207385670944655, 0.000211449352784006, 
            0.000215582663823997, 0.000219786568107335, 0.000224062038023217, 0.00022841005427015, 0.000232831605815526, 
            0.000237327689852208, 0.000241899311751972, 0.000246547485015656, 0.000251273231220261, 0.000258419978491274, 
            0.000265743417771317, 0.000273247023217472, 0.000280934308526571, 0.000288808826442705, 0.000294098750726606, 
            0.000299472839137951, 0.000304932150932489, 0.000310477752783408, 0.000316110718704573, 0.000316110718704573, 
            0.000316110718704573, 0.000316110718704573, 0.000316110718704573, 0.000316110718704573, 0.000316179732641538, 
            0.000316248752536689, 0.000316317778389152, 0.000316386810198056, 0.00031645584796253, 0.000310818491187046, 
            0.000305268534325113, 0.000299804903469326, 0.00029442653204307, 0.000289132360877437, 0.000281378412507851, 
            0.000273806790005811, 0.000266414039122805, 0.000259196744847298, 0.000252151531808452, 0.000238507788467637, 
            0.000225517416546476, 0.000213154677103035, 0.000201394493660138, 0.000190212457849473, 0.000179539303756818, 
            0.000169401407117089, 0.000159776190181964, 0.000150641751233378, 0.000141976862304865, 0.000131094780768951, 
            0.000120966972927621, 0.000111548414041754, 0.000102796128766301, 9.46691536373108e-05, 8.71284948050861e-05, 
            8.01370816371204e-05, 7.36597167811936e-05, 6.76630232452043e-05, 6.2115389016176e-05, 5.57396989628189e-05, 
            4.99688890555577e-05, 4.4751495098653e-05, 4.00397455753823e-05, 3.57893745282648e-05, 3.23373727634266e-05, 
            2.91961188140592e-05, 2.63401125576156e-05, 2.37456793482411e-05, 2.13908674806822e-05, 1.88053785956984e-05, 
            1.65142122040932e-05, 1.44863853642407e-05, 1.26938366251834e-05, 1.11111953001011e-05))), class = "BchronCalibratedDates"))
})

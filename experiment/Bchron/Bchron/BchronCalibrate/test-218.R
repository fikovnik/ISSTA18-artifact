library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11255.3219131854, 24.6428023738286)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11255, 
        ageSds = 25, calCurves = "intcal13", ageGrid = c(13054, 13055, 13056, 13057, 13058, 13059, 13060, 13061, 13062, 13063, 
            13064, 13065, 13066, 13067, 13068, 13069, 13070, 13071, 13072, 13073, 13074, 13075, 13076, 13077, 13078, 13079, 
            13080, 13081, 13082, 13083, 13084, 13085, 13086, 13087, 13088, 13089, 13090, 13091, 13092, 13093, 13094, 13095, 
            13096, 13097, 13098, 13099, 13100, 13101, 13102, 13103, 13104, 13105, 13106, 13107, 13108, 13109, 13110, 13111, 
            13112, 13113, 13114, 13115, 13116, 13117, 13118, 13119, 13120, 13121, 13122, 13123, 13124, 13125, 13126, 13127, 
            13128, 13129, 13130, 13131, 13132, 13133, 13134, 13135, 13136, 13137, 13138, 13139, 13140, 13141, 13142, 13143, 
            13144, 13145, 13146, 13147, 13148, 13149, 13150, 13151, 13152, 13153, 13154, 13155, 13156, 13157, 13158, 13159, 
            13160, 13161, 13162, 13163, 13164, 13165, 13166, 13167, 13168, 13169, 13170, 13171, 13172, 13173, 13174, 13175, 
            13176, 13177, 13178, 13179, 13180, 13181, 13182, 13183, 13184, 13185, 13186, 13187, 13188, 13189, 13190, 13191, 
            13192, 13193, 13194, 13195, 13196, 13197, 13198, 13199, 13200, 13201, 13202), densities = c(1.22097767439667e-05, 
            1.57278842009294e-05, 2.13310722840022e-05, 2.87704725397655e-05, 3.85869171558992e-05, 5.14587571325572e-05, 
            6.82295467960768e-05, 9.2132218886399e-05, 0.000123544282009369, 0.000164499848183304, 0.000217470645136291, 
            0.000285423404912154, 0.000378928215762876, 0.000498889502696012, 0.000651298810043541, 0.000843013448187476, 
            0.00108172848189953, 0.00137472703766473, 0.0017318424293063, 0.00216245454423629, 0.00267600540764582, 0.00328159353403576, 
            0.004041441623679, 0.00492520381112397, 0.00593872516710233, 0.00708419688826703, 0.00835922961847966, 0.0096496821364971, 
            0.0110343223617034, 0.0124976135225612, 0.0140191692770005, 0.0155739383578473, 0.0170089976612817, 0.0184229124114662, 
            0.0197883732491491, 0.0210769973348935, 0.0222602751176573, 0.0231447753382471, 0.0239225680999129, 0.0245799323489767, 
            0.0251048786154568, 0.0254875146102167, 0.0257039617625924, 0.0257954409988912, 0.0257601273524137, 0.0255980950066391, 
            0.0253113266017269, 0.0250040017917641, 0.024625660498711, 0.0241793824002624, 0.0236688346281992, 0.0230982203695917, 
            0.0224731638587299, 0.0217981627395386, 0.0210786626122428, 0.020320362340502, 0.0195291368728996, 0.0189486564317503, 
            0.018356822797177, 0.0177558043995696, 0.0171477448376571, 0.0165347502344137, 0.0157988523678414, 0.0150625508629379, 
            0.0143290837604627, 0.013601511476876, 0.0128826986047922, 0.0121780914674755, 0.0114874191284487, 0.0108128406638182, 
            0.010156278494987, 0.00951941649899671, 0.00890658450807764, 0.00831607085274819, 0.00774882478502388, 0.00720557782597328, 
            0.00668685381250531, 0.00611265271295639, 0.00557250273280291, 0.00506630497239862, 0.00459368055577244, 0.00415400274147912, 
            0.00374642930416485, 0.00336993459579706, 0.00302334076675759, 0.00270534770236177, 0.00241456130737463, 0.00218609374646863, 
            0.00197556682372183, 0.00178202134386128, 0.001604494416049, 0.00144202770487641, 0.0012677973367329, 0.00111172712561408, 
            0.000972359126345843, 0.000848288215485128, 0.000738170473984905, 0.000667141961068816, 0.000602166919593733, 
            0.000542819675072034, 0.000488694388537026, 0.000439405281713914, 0.000394101106743705, 0.000353000290063178, 
            0.000315769535205485, 0.000282095343631851, 0.000251683608325812, 0.000234627844369577, 0.000218618882466489, 
            0.000203600940051474, 0.000189520577641761, 0.00017632664602934, 0.000168081766906665, 0.000160188797071637, 
            0.000152634507205586, 0.000145406073915064, 0.00013849107179854, 0.00013187746543872, 0.000125553601335135, 0.000119508199791662, 
            0.000113730346772914, 0.000108209485742267, 0.000102935409494576, 9.78982519950477e-05, 9.30884802356719e-05, 
            8.84968861199385e-05, 8.41145783855592e-05, 8.02039510260107e-05, 7.6463754706021e-05, 7.28871757935804e-05, 
            6.94676409139713e-05, 6.61988101187362e-05, 5.99828843099567e-05, 5.43162749495804e-05, 4.91541502820287e-05, 
            4.44549474003143e-05, 4.0180173877207e-05, 3.72487499659349e-05, 3.45197143834217e-05, 3.19800537784269e-05, 
            2.96175135175685e-05, 2.74205596312935e-05, 2.40654906035058e-05, 2.11011633357852e-05, 1.84848279077218e-05, 
            1.61780365729918e-05, 1.41462606076594e-05, 1.23585347751652e-05, 1.07871282752729e-05))), class = "BchronCalibratedDates"))
})

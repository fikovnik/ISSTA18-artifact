library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11251.4923791409, 34.7630557775498)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11251, 
        ageSds = 35, calCurves = "intcal13", ageGrid = c(13016, 13017, 13018, 13019, 13020, 13021, 13022, 13023, 13024, 13025, 
            13026, 13027, 13028, 13029, 13030, 13031, 13032, 13033, 13034, 13035, 13036, 13037, 13038, 13039, 13040, 13041, 
            13042, 13043, 13044, 13045, 13046, 13047, 13048, 13049, 13050, 13051, 13052, 13053, 13054, 13055, 13056, 13057, 
            13058, 13059, 13060, 13061, 13062, 13063, 13064, 13065, 13066, 13067, 13068, 13069, 13070, 13071, 13072, 13073, 
            13074, 13075, 13076, 13077, 13078, 13079, 13080, 13081, 13082, 13083, 13084, 13085, 13086, 13087, 13088, 13089, 
            13090, 13091, 13092, 13093, 13094, 13095, 13096, 13097, 13098, 13099, 13100, 13101, 13102, 13103, 13104, 13105, 
            13106, 13107, 13108, 13109, 13110, 13111, 13112, 13113, 13114, 13115, 13116, 13117, 13118, 13119, 13120, 13121, 
            13122, 13123, 13124, 13125, 13126, 13127, 13128, 13129, 13130, 13131, 13132, 13133, 13134, 13135, 13136, 13137, 
            13138, 13139, 13140, 13141, 13142, 13143, 13144, 13145, 13146, 13147, 13148, 13149, 13150, 13151, 13152, 13153, 
            13154, 13155, 13156, 13157, 13158, 13159, 13160, 13161, 13162, 13163, 13164, 13165, 13166, 13167, 13168, 13169, 
            13170, 13171, 13172, 13173, 13174, 13175, 13176, 13177, 13178, 13179, 13180, 13181, 13182, 13183, 13184, 13185, 
            13186, 13187, 13188, 13189, 13190, 13191, 13192, 13193, 13194, 13195, 13196, 13197, 13198, 13199, 13200, 13201, 
            13202, 13203, 13204, 13205, 13206, 13207, 13208, 13209, 13210, 13211, 13212, 13213, 13214, 13215, 13216, 13217, 
            13218, 13219, 13220, 13221, 13222, 13223, 13224, 13225, 13226, 13227, 13228, 13229, 13230, 13231, 13232, 13233, 
            13234, 13235, 13236, 13237, 13238, 13239, 13240, 13241, 13242, 13243, 13244, 13245, 13246, 13247, 13248, 13249, 
            13250, 13251, 13252, 13253, 13254, 13255), densities = c(1.06957691989946e-05, 1.15578534428358e-05, 1.24856283238252e-05, 
            1.34837566963243e-05, 1.45572025124521e-05, 1.57279238570341e-05, 1.69871549066221e-05, 1.83410811299445e-05, 
            1.97962766056552e-05, 2.13597248171699e-05, 2.30388402697279e-05, 2.48414909387288e-05, 2.67760215564221e-05, 
            2.88512777417432e-05, 3.10766309754004e-05, 3.41170330780071e-05, 3.74334645320207e-05, 4.1048649932558e-05, 
            4.49869416153486e-05, 4.92744120466992e-05, 5.39389491134917e-05, 5.90103541650569e-05, 6.45204426272694e-05, 
            7.05031469754474e-05, 7.69946218166171e-05, 8.55663919994482e-05, 9.50075117963972e-05, 0.000105395583398367, 
            0.000116813889653843, 0.000129351669555368, 0.000145593619309835, 0.000163666375254091, 0.000183746993265898, 
            0.000206025767491114, 0.000230706728013443, 0.000266346773143643, 0.000306824825306378, 0.000352681860459215, 
            0.000404500544920575, 0.000462905504166587, 0.000544241812949827, 0.000637721727892064, 0.000744731627560353, 
            0.000866737172225015, 0.00100527319660541, 0.00117689790804385, 0.00137215918891433, 0.00159319515232354, 0.00184213035441196, 
            0.00212103176492181, 0.00245738660570946, 0.00283320310068413, 0.00325045837282177, 0.00371073132882277, 0.00421510410802686, 
            0.00476304256978727, 0.00535529886430999, 0.00599090935434646, 0.0066680503208673, 0.0073839710743907, 0.00819173133559739, 
            0.00903429248024588, 0.00990444606307246, 0.0107936804658115, 0.0116922701122687, 0.0125248136691684, 0.0133469384194836, 
            0.0141488225582377, 0.0149203219601543, 0.0156511776434212, 0.0162801491442974, 0.016858432385489, 0.0173786726716322, 
            0.0178340625860154, 0.0182184914659821, 0.0184806970394683, 0.0186874886027909, 0.0188367806729418, 0.0189270228588635, 
            0.0189572269006003, 0.0189327269243072, 0.018859358838947, 0.0187376098114042, 0.0185683479099129, 0.0183528116518659, 
            0.0181539528995839, 0.0179288210098618, 0.0176784041375258, 0.0174038011801821, 0.0171062135437063, 0.0167872607238318, 
            0.0164480910801674, 0.0160901614327357, 0.0157149899902862, 0.0153241453727402, 0.0150367400138697, 0.0147428142325329, 
            0.0144429678278962, 0.0141378032219928, 0.0138279234294374, 0.0134517202795522, 0.0130707356717886, 0.0126859849190425, 
            0.0122984661319313, 0.0119091560722511, 0.0115199199658016, 0.0111308264343752, 0.0107427591881869, 0.0103565663034875, 
            0.00997305762017675, 0.00959404082212246, 0.0092192390911935, 0.00884932728835064, 0.00848493481525077, 0.00812664472527854, 
            0.00771688184013443, 0.0073169215740523, 0.00692744842195546, 0.00654906017963263, 0.00618226929484557, 0.00582750480133662, 
            0.00548511478128532, 0.00515536929942526, 0.00483846375056226, 0.00453452256159648, 0.00428450854588552, 0.00404405613782643, 
            0.00381313225859325, 0.00359167417361761, 0.0033795916216814, 0.00314193866710665, 0.00291679488557676, 0.002703904135706, 
            0.00250297467228125, 0.00231368366953179, 0.00218519792656898, 0.00206235096775976, 0.00194500318149697, 0.00183301055026472, 
            0.0017262253623514, 0.00162387448027297, 0.00152647273637528, 0.00143386462657365, 0.00134589331960434, 0.00126240122673685, 
            0.00121397454605446, 0.00116709018108392, 0.00112171382027621, 0.00107781123925489, 0.00103534833616163, 0.00100797629683823, 
            0.000981213561036609, 0.000955050230237587, 0.000929476453180159, 0.000904482429512389, 0.000880058413308313, 
            0.000856194716450196, 0.000832881711877962, 0.000810109836707664, 0.000787869595218816, 0.000766151561714143, 
            0.000744946383251753, 0.000724244782251879, 0.000704037558980309, 0.000684315593908905, 0.00066576270826542, 
            0.000647649611859695, 0.000629967966677237, 0.000612709526011151, 0.000595866135677652, 0.000563085352992807, 
            0.000531894243235313, 0.000502229941362256, 0.00047403115115804, 0.000447238166688193, 0.000428093648401682, 
            0.000409679191708689, 0.000391971543262639, 0.000374947963050911, 0.000358586224404883, 0.000332590620534947, 
            0.00030829155898233, 0.000285594556955928, 0.000264409036556726, 0.000244648276571819, 0.000226229354035407, 
            0.000209073076675116, 0.000193103907313652, 0.000178249881245305, 0.000164442517554628, 0.000153902754007527, 
            0.00014398034141212, 0.000134643434601411, 0.000125861522992781, 0.000117605396145233, 0.000108003407176137, 
            9.91246184390966e-05, 9.09202807939167e-05, 8.33444113086818e-05, 7.63536823499123e-05, 7.23985715112893e-05, 
            6.86331101707754e-05, 6.50491022969861e-05, 6.16386551070405e-05, 5.83941706487146e-05, 5.52594461751288e-05, 
            5.22807249360714e-05, 4.94509858855613e-05, 4.67634807877948e-05, 4.42117260407794e-05, 4.25566895231525e-05, 
            4.09590729423737e-05, 3.94170732917124e-05, 3.79289366232615e-05, 3.64929570031992e-05, 3.51409121325659e-05, 
            3.38356211180988e-05, 3.25756060163624e-05, 3.13594300486164e-05, 3.01856966687072e-05, 2.90815179976263e-05, 
            2.80152955665663e-05, 2.69858253891223e-05, 2.59919376372459e-05, 2.50324958284211e-05, 2.41306509421319e-05, 
            2.32595415112052e-05, 2.24181923201926e-05, 2.16056562079901e-05, 2.08210133730211e-05, 1.97045783650279e-05, 
            1.86450348993158e-05, 1.76396666357439e-05, 1.66858759897654e-05, 1.57811795787327e-05, 1.46524373767613e-05, 
            1.36007658576492e-05, 1.26212031039486e-05, 1.17090825961352e-05, 1.08600175076577e-05))), class = "BchronCalibratedDates"))
})

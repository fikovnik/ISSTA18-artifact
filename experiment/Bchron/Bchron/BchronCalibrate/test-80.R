library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11387.2889648437, 71.545068359375)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11387, 
        ageSds = 72, calCurves = "intcal13", ageGrid = c(13033, 13034, 13035, 13036, 13037, 13038, 13039, 13040, 13041, 13042, 
            13043, 13044, 13045, 13046, 13047, 13048, 13049, 13050, 13051, 13052, 13053, 13054, 13055, 13056, 13057, 13058, 
            13059, 13060, 13061, 13062, 13063, 13064, 13065, 13066, 13067, 13068, 13069, 13070, 13071, 13072, 13073, 13074, 
            13075, 13076, 13077, 13078, 13079, 13080, 13081, 13082, 13083, 13084, 13085, 13086, 13087, 13088, 13089, 13090, 
            13091, 13092, 13093, 13094, 13095, 13096, 13097, 13098, 13099, 13100, 13101, 13102, 13103, 13104, 13105, 13106, 
            13107, 13108, 13109, 13110, 13111, 13112, 13113, 13114, 13115, 13116, 13117, 13118, 13119, 13120, 13121, 13122, 
            13123, 13124, 13125, 13126, 13127, 13128, 13129, 13130, 13131, 13132, 13133, 13134, 13135, 13136, 13137, 13138, 
            13139, 13140, 13141, 13142, 13143, 13144, 13145, 13146, 13147, 13148, 13149, 13150, 13151, 13152, 13153, 13154, 
            13155, 13156, 13157, 13158, 13159, 13160, 13161, 13162, 13163, 13164, 13165, 13166, 13167, 13168, 13169, 13170, 
            13171, 13172, 13173, 13174, 13175, 13176, 13177, 13178, 13179, 13180, 13181, 13182, 13183, 13184, 13185, 13186, 
            13187, 13188, 13189, 13190, 13191, 13192, 13193, 13194, 13195, 13196, 13197, 13198, 13199, 13200, 13201, 13202, 
            13203, 13204, 13205, 13206, 13207, 13208, 13209, 13210, 13211, 13212, 13213, 13214, 13215, 13216, 13217, 13218, 
            13219, 13220, 13221, 13222, 13223, 13224, 13225, 13226, 13227, 13228, 13229, 13230, 13231, 13232, 13233, 13234, 
            13235, 13236, 13237, 13238, 13239, 13240, 13241, 13242, 13243, 13244, 13245, 13246, 13247, 13248, 13249, 13250, 
            13251, 13252, 13253, 13254, 13255, 13256, 13257, 13258, 13259, 13260, 13261, 13262, 13263, 13264, 13265, 13266, 
            13267, 13268, 13269, 13270, 13271, 13272, 13273, 13274, 13275, 13276, 13277, 13278, 13279, 13280, 13281, 13282, 
            13283, 13284, 13285, 13286, 13287, 13288, 13289, 13290, 13291, 13292, 13293, 13294, 13295, 13296, 13297, 13298, 
            13299, 13300, 13301, 13302, 13303, 13304, 13305, 13306, 13307, 13308, 13309, 13310, 13311, 13312, 13313, 13314, 
            13315, 13316, 13317, 13318, 13319, 13320, 13321, 13322, 13323, 13324, 13325, 13326, 13327, 13328, 13329, 13330, 
            13331, 13332, 13333, 13334, 13335, 13336, 13337, 13338, 13339, 13340, 13341, 13342, 13343, 13344, 13345, 13346, 
            13347, 13348, 13349, 13350, 13351, 13352, 13353, 13354, 13355, 13356, 13357, 13358, 13359, 13360, 13361, 13362, 
            13363, 13364, 13365, 13366, 13367, 13368, 13369, 13370, 13371, 13372, 13373, 13374, 13375, 13376, 13377, 13378, 
            13379, 13380, 13381, 13382, 13383, 13384, 13385, 13386, 13387, 13388, 13389, 13390, 13391, 13392, 13393, 13394, 
            13395, 13396, 13397, 13398, 13399, 13400, 13401, 13402, 13403, 13404, 13405, 13406, 13407, 13408, 13409, 13410, 
            13411, 13412, 13413, 13414, 13415, 13416, 13417, 13418, 13419, 13420, 13421, 13422, 13423, 13424, 13425, 13426, 
            13427, 13428, 13429, 13430, 13431, 13432, 13433, 13434, 13435, 13436, 13437, 13438, 13439, 13440, 13441, 13442, 
            13443, 13444, 13445, 13446, 13447, 13448, 13449, 13450, 13451, 13452, 13453, 13454, 13455, 13456, 13457, 13458, 
            13459, 13460, 13461, 13462, 13463, 13464, 13465, 13466), densities = c(1.00825021416843e-05, 1.05485582117391e-05, 
            1.10346730521173e-05, 1.15416329256952e-05, 1.20702510773612e-05, 1.26213684761858e-05, 1.31958545694018e-05, 
            1.37946080479564e-05, 1.45489554948451e-05, 1.53414777381318e-05, 1.61739176343729e-05, 1.70480864943458e-05, 
            1.79658661442357e-05, 1.90969553780686e-05, 2.02935698689297e-05, 2.15591030154591e-05, 2.28970967451364e-05, 
            2.43112462513076e-05, 2.62482894990266e-05, 2.83262878058328e-05, 3.05542974654366e-05, 3.29418541109518e-05, 
            3.54989896927731e-05, 3.8870874292839e-05, 4.25323148094763e-05, 4.65048813372293e-05, 5.08114156806819e-05, 
            5.54760736105993e-05, 6.09986743811942e-05, 6.70121701024289e-05, 7.35535362221542e-05, 8.06618206829926e-05, 
            8.83781864183432e-05, 9.74391847540115e-05, 0.000107317355585987, 0.0001180732390126, 0.000129770396832642, 0.000142475403844595, 
            0.000156237300014868, 0.000171146291171387, 0.000187277534334239, 0.000204708936988292, 0.000223521024797942, 
            0.00024535865991997, 0.000268992500918102, 0.000294531406334317, 0.000322086573694276, 0.000351771094149497, 
            0.000381304146313386, 0.000412860345164503, 0.000446532076086926, 0.000482411445576305, 0.000520589766363435, 
            0.000557850668054079, 0.000597208618113347, 0.000638731097439328, 0.00068248336050757, 0.000728527970508006, 
            0.000768607562731054, 0.000810348284542076, 0.000853780701861042, 0.000898933212402692, 0.000945831828815024, 
            0.000989527406748932, 0.00103467047188049, 0.00108127419517229, 0.0011293496318431, 0.00117890558820775, 0.00121834626332334, 
            0.00125868554336736, 0.00129992463968126, 0.00134206378324072, 0.00138510218844085, 0.00142911070535447, 0.00147401490674274, 
            0.00151981062099424, 0.00156649251593396, 0.00161405406698855, 0.00164862529351723, 0.00168363865623318, 0.00171909054644125, 
            0.00175497701744895, 0.00179129377982331, 0.00183554206406449, 0.00188039504504503, 0.00192584313630938, 0.00197187599955903, 
            0.00201848253662243, 0.00206572751700154, 0.00211352157467856, 0.00216185116452383, 0.00221070195685234, 0.00226005883441803, 
            0.00230998185052559, 0.00236037781373143, 0.00241122910383877, 0.00246251731150841, 0.00251422324116982, 0.00257503573584482, 
            0.00263635670890967, 0.00269815170677003, 0.0027603848687316, 0.00282301894776737, 0.00288601533454465, 0.00294933408473894, 
            0.00301293394965108, 0.00307677241013558, 0.00314080571384047, 0.00319582184005605, 0.00325091885740789, 0.00330606717419118, 
            0.00336123662374128, 0.0034163964886938, 0.00348056512285399, 0.00354463354958617, 0.00360855071079886, 0.00367226472923245, 
            0.00373572297348151, 0.00378084885791946, 0.00382579804797987, 0.00387055078401411, 0.003915087172229, 0.00395938719881237, 
            0.00400338265941785, 0.00404710372823142, 0.004090530150773, 0.00413364160750605, 0.00417641772924545, 0.00420187977403519, 
            0.00422721047996486, 0.004252405440252, 0.0042774602474488, 0.00430237049469845, 0.00431890797237275, 0.00433537761974071, 
            0.00435177813267195, 0.00436810820809572, 0.00438436654417173, 0.00440055184046075, 0.00441666279809623, 0.00443269811995624, 
            0.0044486565108357, 0.0044645366776196, 0.00448033732945603, 0.00449605717792982, 0.00451169493723662, 0.00452724932435689, 
            0.00454271905923081, 0.00455816726012246, 0.00457352633955309, 0.00458879503225062, 0.00460397207725264, 0.00461905621808265, 
            0.00464891146486791, 0.00467838203411587, 0.00470745803630157, 0.00473612966788497, 0.0047643872168864, 0.00478530906806347, 
            0.00480598822506275, 0.00482642070663969, 0.00484660256689818, 0.00486652989658007, 0.00489915195993908, 0.00493104003177655, 
            0.00496217671636924, 0.00499254494945534, 0.00502212801407204, 0.00505090955614616, 0.00507887359981688, 0.00510600456247056, 
            0.00513228726946711, 0.00515770696853836, 0.00517739143397397, 0.00519650977636909, 0.00521505496336339, 0.00523302015202173, 
            0.00525039869310635, 0.00527128904876775, 0.00529124017798928, 0.00531024045434436, 0.00532827876866876, 0.00534534454006674, 
            0.00535511109039754, 0.0053645221075658, 0.00537357557349659, 0.00538226954248268, 0.00539060214189244, 0.00539856848001672, 
            0.00540617050067457, 0.00541340651411589, 0.0054202749057611, 0.00542677413680864, 0.00543089989856589, 0.00543486072412294, 
            0.00543865620203957, 0.00544228593612743, 0.00544574954551934, 0.00544904783944506, 0.00545217905384834, 0.0054551428731735, 
            0.00545793899753331, 0.00546056714276017, 0.00546302768011243, 0.00546531954162968, 0.00546744250989387, 0.00546939638345096, 
            0.0054711809768434, 0.00547279638545005, 0.00547424208002525, 0.00547551794280242, 0.00547662387214987, 0.00547755978258412, 
            0.00547864473558296, 0.00547934680108935, 0.0054796659173057, 0.00547960210432085, 0.0054791554640719, 0.00547796478602558, 
            0.00547609457138619, 0.00547354576505665, 0.00547031956868629, 0.00546641743975165, 0.0054592995154309, 0.00545067051247507, 
            0.00544053829487048, 0.00542891199022848, 0.00541580197590864, 0.00539864881718941, 0.00537951326954147, 0.00535841818032932, 
            0.00533538855989985, 0.00531045153149215, 0.00527561766259477, 0.00523774005980455, 0.00519689021560084, 0.00515314468963198, 
            0.00510658486611367, 0.00505729669797163, 0.00500537043887035, 0.00495090036431208, 0.00489398448302592, 0.00483472423989887, 
            0.00477317379786594, 0.00470948265969086, 0.00464376054649286, 0.00457611942697988, 0.00450667319740594, 0.00443550151650419, 
            0.00436275269118934, 0.00428854449135137, 0.00421299536408062, 0.00413622411984574, 0.00405830307947554, 0.00397939326258294, 
            0.00389961285686223, 0.00381907924144375, 0.00373790870631707, 0.00365621618142762, 0.00357411497627844, 0.00349171653079864, 
            0.00340913017817048, 0.003326462920238, 0.00324381921604295, 0.00316130078396371, 0.00307900641785611, 0.00299703181752005, 
            0.00291546943374476, 0.0028433087378179, 0.00277160240840267, 0.00270040866955818, 0.00262978343845847, 0.00255978027702545, 
            0.00249913407636675, 0.00243903678409245, 0.0023795195770541, 0.00232061218283267, 0.00226234287237355, 0.00220473845561008, 
            0.00214782428000309, 0.00209162423191939, 0.0020361607407665, 0.00198145478579454, 0.00193509435278007, 0.00188931656404512, 
            0.0018441322604494, 0.00179955152223462, 0.00175558367706739, 0.00171939300057181, 0.00168363865623318, 0.0016483248975114, 
            0.00161345563183251, 0.00157903442523497, 0.00155179255203639, 0.00152484123748373, 0.00149818186584521, 0.00147181568867885, 
            0.00144574382665439, 0.0014200399386499, 0.00139463151144435, 0.0013695192447139, 0.00134470371623957, 0.00132018538396185, 
            0.00130793133236945, 0.00129575230995643, 0.00128364835479428, 0.0012716194976189, 0.00125966576189693, 0.00124785708343913, 
            0.00123612311510151, 0.00122446385045136, 0.00121287927622374, 0.00120136937239081, 0.00119000290773182, 0.00117871058697496, 
            0.0011674923625231, 0.00115634818046439, 0.0011452779806435, 0.00113977060358414, 0.00113428169673345, 0.00112881125084793, 
            0.00112335925630757, 0.00111792570311768, 0.00110711387895235, 0.00109637569099182, 0.00108571104602931, 0.00107511984508425, 
            0.00106460198347476, 0.00105415735089077, 0.00104378583146695, 0.0010334873038557, 0.00102326164130048, 0.00101310871170871, 
            0.000998079621321581, 0.000983212563020605, 0.000968507013858736, 0.00095396242627975, 0.00093957822867144, 0.000925291687301921, 
            0.000911165180677527, 0.000897198078122175, 0.000883389726565939, 0.000869739451095331, 0.000856306518714651, 
            0.000843029361121191, 0.000829907233351492, 0.00081693937130056, 0.000804124992256853, 0.000791405577610737, 
            0.000778838938225185, 0.000766424244628165, 0.000754160650349283, 0.000742047292444429, 0.000726128328283157, 
            0.000710472760985939, 0.000695078418167194, 0.000679943082954935, 0.000665064496106055, 0.000650440358096596, 
            0.000636068331186904, 0.000621946041460427, 0.000608071080834966, 0.000594441009046366, 0.000581053355602931, 
            0.000567905621710616, 0.000554995282167988, 0.000542319787230045, 0.000529876564441013, 0.000514690903400989, 
            0.000499857441094507, 0.000485371036585636, 0.000471226514233508, 0.00045741866865286, 0.000443942269543051, 
            0.000430792066384373, 0.000417962793000706, 0.000405449171987708, 0.000393245919006048, 0.000381309731420617, 
            0.000369674823434867, 0.000358335896795388, 0.000347287661047486, 0.000336524837215175, 0.000324013001716702, 
            0.000311893819336335, 0.000300158306865369, 0.000288797536555181, 0.000277802643328543, 0.000267164831606898, 
            0.000256875381758475, 0.000246925656173195, 0.000237307104970803, 0.000228011271348483, 0.000217584617185924, 
            0.000207571329032744, 0.000197958553958079, 0.000188733647594553, 0.000179884181617201, 0.000170208321648956, 
            0.000160989541034999, 0.000152210366841247, 0.000143853734940043, 0.000135902997203719, 0.000128359737641787, 
            0.000121188846585551, 0.000114375022818694, 0.000107903395821182, 0.000101759526498533, 9.52024783990497e-05, 
            8.90251931919961e-05, 8.32089469204537e-05, 7.7735697110483e-05, 7.2588075765694e-05, 6.67204370266962e-05, 6.12843806569225e-05, 
            5.62522366282281e-05, 5.15977331817648e-05, 4.72959604032296e-05, 4.33233313721989e-05, 3.96575413089659e-05, 
            3.62775251141841e-05, 3.3163413668354e-05, 3.02964892300955e-05, 2.76538249875057e-05, 2.52249594314222e-05, 
            2.29942837009771e-05, 2.09471634533082e-05, 1.90698937771369e-05, 1.71999837903945e-05, 1.55015729401484e-05, 
            1.39602693503937e-05, 1.25627426356035e-05, 1.12966612023924e-05, 1.00575539986241e-05))), class = "BchronCalibratedDates"))
})

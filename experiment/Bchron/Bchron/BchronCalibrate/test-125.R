library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11254.0369169639, 24.977335801598)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11254, 
        ageSds = 25, calCurves = "intcal13", ageGrid = c(13053, 13054, 13055, 13056, 13057, 13058, 13059, 13060, 13061, 13062, 
            13063, 13064, 13065, 13066, 13067, 13068, 13069, 13070, 13071, 13072, 13073, 13074, 13075, 13076, 13077, 13078, 
            13079, 13080, 13081, 13082, 13083, 13084, 13085, 13086, 13087, 13088, 13089, 13090, 13091, 13092, 13093, 13094, 
            13095, 13096, 13097, 13098, 13099, 13100, 13101, 13102, 13103, 13104, 13105, 13106, 13107, 13108, 13109, 13110, 
            13111, 13112, 13113, 13114, 13115, 13116, 13117, 13118, 13119, 13120, 13121, 13122, 13123, 13124, 13125, 13126, 
            13127, 13128, 13129, 13130, 13131, 13132, 13133, 13134, 13135, 13136, 13137, 13138, 13139, 13140, 13141, 13142, 
            13143, 13144, 13145, 13146, 13147, 13148, 13149, 13150, 13151, 13152, 13153, 13154, 13155, 13156, 13157, 13158, 
            13159, 13160, 13161, 13162, 13163, 13164, 13165, 13166, 13167, 13168, 13169, 13170, 13171, 13172, 13173, 13174, 
            13175, 13176, 13177, 13178, 13179, 13180, 13181, 13182, 13183, 13184, 13185, 13186, 13187, 13188, 13189, 13190, 
            13191, 13192, 13193, 13194, 13195, 13196, 13197, 13198, 13199, 13200, 13201), densities = c(1.0959101490604e-05, 
            1.41417249606891e-05, 1.8182484524518e-05, 2.46029254739614e-05, 3.31051712929018e-05, 4.42942678449119e-05, 
            5.8926324440775e-05, 7.79380233273345e-05, 0.000104955779048224, 0.00014035147175642, 0.00018635507034946, 0.000245663134484014, 
            0.000321495705640347, 0.000425496067436738, 0.000558438020765075, 0.00072671208816536, 0.000937579455509749, 
            0.0011991233630901, 0.00151888920349539, 0.00190705405480186, 0.00237316654158592, 0.00292669221785656, 0.00357656888584249, 
            0.0043882841937862, 0.00532769382628344, 0.00639949587976087, 0.00760435585498718, 0.00893799450330106, 0.0102802159179113, 
            0.0117121385625834, 0.0132161713757024, 0.0147698631059086, 0.0163461965984036, 0.0177904360240786, 0.0192019608596402, 
            0.0205526265036225, 0.0218135908767925, 0.0229563118248413, 0.0237976079650435, 0.0245239896097301, 0.0251224313547253, 
            0.0255818463751405, 0.0258934301790029, 0.0260422428746428, 0.0260635948978781, 0.0259567052014752, 0.0257227206540125, 
            0.0253646980681889, 0.0250029583041309, 0.0245716795070732, 0.0240743954215528, 0.0235151961547523, 0.0228986706691117, 
            0.0222309204196209, 0.0215166160895188, 0.0207614429557258, 0.0199712866523778, 0.0191521548430122, 0.0185543259331365, 
            0.017947207232104, 0.0173329631717719, 0.0167137204401498, 0.0160915559295135, 0.0153474167080172, 0.0146055988228312, 
            0.0138692255833622, 0.0131412254053309, 0.0124243160643097, 0.0117238529305636, 0.0110393063173486, 0.0103726589946626, 
            0.00972565279172748, 0.00909978902039742, 0.00849922988075306, 0.00792204906467155, 0.00736902121246999, 0.00684070922364479, 
            0.00633747567748108, 0.00578185066475748, 0.00526060183635667, 0.00477342279015699, 0.00431974732046976, 0.00389878214546197, 
            0.00350953947214369, 0.00315086885237147, 0.00282148785864553, 0.00252001118614404, 0.00224497786511951, 0.00202935785956059, 
            0.00183105885301765, 0.00164910743534345, 0.00148253353028963, 0.00133037792794809, 0.00116749919809935, 0.00102191832484271, 
            0.000892199344104017, 0.00077696586653478, 0.000674908106365502, 0.000609194668781253, 0.000549171177131135, 
            0.000494427480287745, 0.000444573685592496, 0.0003992402197105, 0.000357626219501702, 0.000319928163308882, 0.000285829080497482, 
            0.000255031583401103, 0.000227257365849342, 0.000211695710537945, 0.000197101833435229, 0.0001834232070234, 0.000170609580479349, 
            0.000158612922886232, 0.000151122425050496, 0.000143955624485735, 0.00013710014617106, 0.000130544005158804, 
            0.000124275598416234, 0.000118283696628079, 0.000112557435973058, 0.000107086309887586, 0.000101860160829077, 
            9.68691720502173e-05, 9.21038593957532e-05, 8.75550631318994e-05, 8.32139398183466e-05, 7.90719542322348e-05, 
            7.51208713524931e-05, 7.15995427468867e-05, 6.82332290135891e-05, 6.50156519413965e-05, 6.19407588163803e-05, 
            5.90027158013287e-05, 5.34185189718636e-05, 4.83325533595764e-05, 4.37036593236564e-05, 3.9493729176036e-05, 
            3.56675168137492e-05, 3.30459362864202e-05, 3.06069689639643e-05, 2.83387418533246e-05, 2.62300845653451e-05, 
            2.42704932667988e-05, 2.12801767632566e-05, 1.86409968804986e-05, 1.63141468990591e-05, 1.42647770754071e-05, 
            1.24616355081728e-05, 1.08767357738929e-05))), class = "BchronCalibratedDates"))
})

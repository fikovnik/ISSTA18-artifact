library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11236.4304840088, 29.0441543579102)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11236, 
        ageSds = 29, calCurves = "intcal13", ageGrid = c(13023, 13024, 13025, 13026, 13027, 13028, 13029, 13030, 13031, 13032, 
            13033, 13034, 13035, 13036, 13037, 13038, 13039, 13040, 13041, 13042, 13043, 13044, 13045, 13046, 13047, 13048, 
            13049, 13050, 13051, 13052, 13053, 13054, 13055, 13056, 13057, 13058, 13059, 13060, 13061, 13062, 13063, 13064, 
            13065, 13066, 13067, 13068, 13069, 13070, 13071, 13072, 13073, 13074, 13075, 13076, 13077, 13078, 13079, 13080, 
            13081, 13082, 13083, 13084, 13085, 13086, 13087, 13088, 13089, 13090, 13091, 13092, 13093, 13094, 13095, 13096, 
            13097, 13098, 13099, 13100, 13101, 13102, 13103, 13104, 13105, 13106, 13107, 13108, 13109, 13110, 13111, 13112, 
            13113, 13114, 13115, 13116, 13117, 13118, 13119, 13120, 13121, 13122, 13123, 13124, 13125, 13126, 13127, 13128, 
            13129, 13130, 13131, 13132, 13133, 13134, 13135, 13136, 13137, 13138, 13139, 13140, 13141, 13142, 13143, 13144, 
            13145, 13146, 13147, 13148, 13149, 13150, 13151, 13152, 13153, 13154, 13155, 13156, 13157, 13158, 13159, 13160, 
            13161, 13162, 13163, 13164, 13165, 13166, 13167, 13168, 13169, 13170, 13171, 13172, 13173, 13174, 13175, 13176, 
            13177, 13178, 13179, 13180, 13181, 13182, 13183, 13184, 13185, 13186, 13187, 13188, 13189, 13190, 13191, 13192, 
            13193, 13194, 13195, 13196, 13197, 13198, 13199), densities = c(1.03414304172098e-05, 1.13868931478575e-05, 1.25322954820374e-05, 
            1.37865457998944e-05, 1.51592768147834e-05, 1.66608972176045e-05, 1.83026462760039e-05, 2.00966514856442e-05, 
            2.2607805801824e-05, 2.54124620289917e-05, 2.85421262814855e-05, 3.20313171842499e-05, 3.59178072692635e-05, 
            4.024287804283e-05, 4.50515888062847e-05, 5.0393059211603e-05, 5.63207654185005e-05, 6.28928495901662e-05, 7.17932168640365e-05, 
            8.1849032144213e-05, 9.31939999156085e-05, 0.00010597487799568, 0.000120352410738953, 0.000139486286729658, 0.000161366430241765, 
            0.000186334995988784, 0.000214768153610633, 0.000247078115549607, 0.000295086758493403, 0.000351317883942705, 
            0.000416941648525942, 0.000493246908578621, 0.000581644101705915, 0.000708415193963309, 0.000858610219570601, 
            0.00103553484528353, 0.00124273122103539, 0.00148394366582969, 0.00178997752081556, 0.00214620057265754, 0.002557797974358, 
            0.00302982010309939, 0.00356701091771229, 0.00422323860296463, 0.00496474030271965, 0.00579473289862726, 0.00671480974451726, 
            0.00772460132002688, 0.00881928310671668, 0.0099958063872335, 0.0112463138927275, 0.012560073128868, 0.0139234502398781, 
            0.0154241946154997, 0.0169402117883666, 0.0184448387166913, 0.0199090902447176, 0.0213025321627376, 0.0225051910054266, 
            0.0235963945838411, 0.0245532254719572, 0.025354868148733, 0.0259833707691651, 0.026397175527975, 0.0266431132509138, 
            0.0267159551171965, 0.0266138945794576, 0.0263386199023592, 0.0259802679417182, 0.0255095577718359, 0.0249326063094709, 
            0.0242568922115542, 0.0234910908179893, 0.022732497167014, 0.0219162625753175, 0.0210503979839981, 0.0201431796573234, 
            0.0192030152161142, 0.0184514540691043, 0.0176885591363496, 0.0169181961734932, 0.0161441270634779, 0.0153699796715787, 
            0.0146012316115838, 0.0138392830065404, 0.0130871771255275, 0.0123477314167178, 0.011623523994631, 0.0111187699424147, 
            0.0106237728272007, 0.0101392202756997, 0.00966573254803524, 0.00920386279785958, 0.00866875286855805, 0.00815173387498175, 
            0.0076533630450579, 0.00717407173667301, 0.00671417073079509, 0.00627592602742635, 0.00585726116661222, 0.00545815031851727, 
            0.00507847560497066, 0.00471803460613073, 0.0043783440576572, 0.00405713261928062, 0.00375398483674309, 0.00346843289856183, 
            0.00319996387415073, 0.00290736142994542, 0.00263635752117375, 0.0023859791022012, 0.00215522097178601, 0.00194305757860793, 
            0.00174845378864896, 0.00157037458974392, 0.00140779372740002, 0.00125970128269441, 0.00112511021762, 0.00101987094351754, 
            0.000923247234493479, 0.000834675151181395, 0.000753611779092621, 0.000679536319031331, 0.000600190112658991, 
            0.000529124351153634, 0.000465613028086423, 0.000408974975586899, 0.000358573687018947, 0.000325970822616208, 
            0.000296057526808575, 0.00026864123116079, 0.000243540137596525, 0.000220582922546134, 0.00019939379666425, 0.00018006962560569, 
            0.000162465187029067, 0.00014644454220919, 0.000131880654289496, 0.000123675312218058, 0.000115939322796303, 
            0.000108648741041275, 0.00010178064725404, 9.53131159639005e-05, 9.12513985724746e-05, 8.73496921078844e-05, 
            8.36023222602455e-05, 8.00037868658441e-05, 7.65487519816536e-05, 7.32320479919597e-05, 7.0048665749473e-05, 
            6.6993752753486e-05, 6.40626093674445e-05, 6.12506850778808e-05, 5.85535747969748e-05, 5.59670152103885e-05, 
            5.34868811721489e-05, 5.11091821481978e-05, 4.88300587098729e-05, 4.67752483502571e-05, 4.48020316802185e-05, 
            4.29074045581555e-05, 4.10884623718669e-05, 3.93423972475226e-05, 3.60063653378024e-05, 3.29380486260397e-05, 
            3.01174312398564e-05, 2.75258555884475e-05, 2.51459428649595e-05, 2.34990768419264e-05, 2.19547143612429e-05, 
            2.05068745484093e-05, 1.914989655257e-05, 1.78784244673964e-05, 1.59187184831618e-05, 1.41640944454366e-05, 1.25942989113086e-05, 
            1.11909322366548e-05))), class = "BchronCalibratedDates"))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11252.7160698775, 26.1438897786022)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11253, 
        ageSds = 26, calCurves = "intcal13", ageGrid = c(13051, 13052, 13053, 13054, 13055, 13056, 13057, 13058, 13059, 13060, 
            13061, 13062, 13063, 13064, 13065, 13066, 13067, 13068, 13069, 13070, 13071, 13072, 13073, 13074, 13075, 13076, 
            13077, 13078, 13079, 13080, 13081, 13082, 13083, 13084, 13085, 13086, 13087, 13088, 13089, 13090, 13091, 13092, 
            13093, 13094, 13095, 13096, 13097, 13098, 13099, 13100, 13101, 13102, 13103, 13104, 13105, 13106, 13107, 13108, 
            13109, 13110, 13111, 13112, 13113, 13114, 13115, 13116, 13117, 13118, 13119, 13120, 13121, 13122, 13123, 13124, 
            13125, 13126, 13127, 13128, 13129, 13130, 13131, 13132, 13133, 13134, 13135, 13136, 13137, 13138, 13139, 13140, 
            13141, 13142, 13143, 13144, 13145, 13146, 13147, 13148, 13149, 13150, 13151, 13152, 13153, 13154, 13155, 13156, 
            13157, 13158, 13159, 13160, 13161, 13162, 13163, 13164, 13165, 13166, 13167, 13168, 13169, 13170, 13171, 13172, 
            13173, 13174, 13175, 13176, 13177, 13178, 13179, 13180, 13181, 13182, 13183, 13184, 13185, 13186, 13187, 13188, 
            13189, 13190, 13191, 13192, 13193, 13194, 13195, 13196, 13197, 13198, 13199, 13200, 13201, 13202, 13203, 13204), 
        densities = c(1.2588548326637e-05, 1.60590804145283e-05, 2.04171513059958e-05, 2.58691594531379e-05, 3.26637162764187e-05, 
            4.32385678203807e-05, 5.69337180042368e-05, 7.45643724048676e-05, 9.71243850540671e-05, 0.000125814971068064, 
            0.000165702723146363, 0.00021679009413622, 0.000281725898079459, 0.00036362824218623, 0.000466121128822934, 0.000603763648993234, 
            0.000775868088765746, 0.000989047646659342, 0.00125058111600752, 0.00156830359685081, 0.00194908814281722, 0.0024022910085021, 
            0.00293611178301186, 0.00355822955774051, 0.00427536223889101, 0.00515511085528654, 0.00615449807812511, 0.00727428397241029, 
            0.00851111704462416, 0.00985688453338799, 0.0111899663609346, 0.0125907302708923, 0.0140402646833402, 0.0155157594674756, 
            0.0169909342104344, 0.0183238220841312, 0.0196083264670317, 0.0208194112338609, 0.0219320426000046, 0.0229220373745547, 
            0.0236363866877527, 0.0242387296782435, 0.0247188287641002, 0.0250682660687013, 0.0252806907668975, 0.0253512973144462, 
            0.0253062408860938, 0.0251457637865352, 0.0248717206994982, 0.0244875434925069, 0.0241150667997016, 0.0236814034122246, 
            0.0231898671970188, 0.0226442150425603, 0.0220485977233972, 0.0214085279488135, 0.0207280714400501, 0.0200122259458344, 
            0.0192661376250716, 0.018495037961061, 0.0179333587292962, 0.0173636839074744, 0.0167878877181941, 0.0162078110562053, 
            0.0156252518815138, 0.0149284969372901, 0.0142338266117364, 0.0135439560516653, 0.012861437933621, 0.0121886496521736, 
            0.0115303551854104, 0.0108860455394337, 0.0102574861896907, 0.00964624138078013, 0.00905367392209722, 0.00848356782863981, 
            0.00793422580538931, 0.00740639690153236, 0.00690064944788032, 0.0064173797346499, 0.00588187600646517, 0.0053774162994625, 
            0.00490386021863026, 0.00446083571573554, 0.00404776531285065, 0.00366389246574397, 0.00330830762732908, 0.00297997362363653, 
            0.00267775000976064, 0.00240041612928481, 0.00218175491138255, 0.00197958710819708, 0.00179307181976753, 0.00162136354579692, 
            0.00146361907698979, 0.00129382054333788, 0.00114096588262704, 0.00100376266520215, 0.000880960480942168, 0.000771358341743107, 
            0.000700318754149297, 0.000635056168594392, 0.000575185598987449, 0.000520338614935771, 0.000470163627242391, 
            0.000423851746680531, 0.000381632365809294, 0.000343198309416661, 0.000308259359926182, 0.0002765420007958, 0.000258691288059846, 
            0.000241881151858942, 0.00022605921572343, 0.000211175151466028, 0.000197180639845011, 0.00018840614949769, 0.00017998706315736, 
            0.000171910767656565, 0.000164165010707089, 0.00015673789467472, 0.000149617870260784, 0.000142793730102744, 
            0.000136254602306399, 0.000129989943921664, 0.000123989534372852, 0.000118243468854912, 0.000112742151705572, 
            0.000107476289763456, 0.000102436885721716, 9.76152314858214e-05, 9.3286963948997e-05, 8.91380626477277e-05, 
            8.5161741221854e-05, 8.13514377643509e-05, 7.77008089720348e-05, 7.07415346082286e-05, 6.4367210104186e-05, 5.85326308200534e-05, 
            5.31956880464125e-05, 4.83171958691229e-05, 4.49563355625299e-05, 4.18160934359098e-05, 3.88830378401557e-05, 
            3.61444733858745e-05, 3.35884067425244e-05, 2.96676147102598e-05, 2.61813121485387e-05, 2.3084440696681e-05, 
            2.03362134017915e-05, 1.78997606736718e-05, 1.57417992342103e-05, 1.38323233736444e-05, 1.21443177305021e-05, 
            1.06534907375071e-05))), class = "BchronCalibratedDates"))
})

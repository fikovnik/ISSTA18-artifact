library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11260.7966037124, 27.3721638306975)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11261, 
        ageSds = 27, calCurves = "intcal13", ageGrid = c(13053, 13054, 13055, 13056, 13057, 13058, 13059, 13060, 13061, 13062, 
            13063, 13064, 13065, 13066, 13067, 13068, 13069, 13070, 13071, 13072, 13073, 13074, 13075, 13076, 13077, 13078, 
            13079, 13080, 13081, 13082, 13083, 13084, 13085, 13086, 13087, 13088, 13089, 13090, 13091, 13092, 13093, 13094, 
            13095, 13096, 13097, 13098, 13099, 13100, 13101, 13102, 13103, 13104, 13105, 13106, 13107, 13108, 13109, 13110, 
            13111, 13112, 13113, 13114, 13115, 13116, 13117, 13118, 13119, 13120, 13121, 13122, 13123, 13124, 13125, 13126, 
            13127, 13128, 13129, 13130, 13131, 13132, 13133, 13134, 13135, 13136, 13137, 13138, 13139, 13140, 13141, 13142, 
            13143, 13144, 13145, 13146, 13147, 13148, 13149, 13150, 13151, 13152, 13153, 13154, 13155, 13156, 13157, 13158, 
            13159, 13160, 13161, 13162, 13163, 13164, 13165, 13166, 13167, 13168, 13169, 13170, 13171, 13172, 13173, 13174, 
            13175, 13176, 13177, 13178, 13179, 13180, 13181, 13182, 13183, 13184, 13185, 13186, 13187, 13188, 13189, 13190, 
            13191, 13192, 13193, 13194, 13195, 13196, 13197, 13198, 13199, 13200, 13201, 13202, 13203, 13204, 13205, 13206, 
            13207, 13208, 13209, 13210, 13211, 13212, 13213, 13214, 13215, 13216, 13217), densities = c(1.07394796974742e-05, 
            1.35833728378569e-05, 1.7126857178983e-05, 2.26432679829652e-05, 2.97934774005776e-05, 3.90118963796686e-05, 
            5.08323495690025e-05, 6.59059196497319e-05, 8.69358925183187e-05, 0.000113990024133512, 0.000148557536588784, 
            0.000192420077824879, 0.000247686518885733, 0.000322478115740956, 0.000416851949345907, 0.000534939950614427, 
            0.000681441732044285, 0.000861614216864405, 0.00108040988820111, 0.00134460456443091, 0.00166070366590459, 0.00203537125481112, 
            0.00247521376885418, 0.00302566969867579, 0.00366533896246997, 0.00439991733585632, 0.00523321247139211, 0.00616656497573699, 
            0.00711932849433462, 0.00815281449224798, 0.00926013012409433, 0.0104312742464978, 0.011653053159686, 0.0128078577092204, 
            0.013977440895548, 0.0151450151442493, 0.0162922215845875, 0.0173995635516059, 0.018275896174728, 0.0190994075628945, 
            0.0198586310560329, 0.0205425727937455, 0.0211409752490116, 0.021598620244312, 0.0219736242577832, 0.0222609905326093, 
            0.0224567663536615, 0.0225581340524066, 0.0225706266818669, 0.0225247206077473, 0.0224205505768101, 0.0222587138249748, 
            0.0220402649893151, 0.021766913051184, 0.0214405442115139, 0.0210635277568198, 0.0206386048316345, 0.020168854422158, 
            0.0198083196971399, 0.0194280948297768, 0.0190295582646425, 0.0186141368174645, 0.0181832969809522, 0.0176496543475336, 
            0.0170988962456847, 0.0165336657178215, 0.0159566025592681, 0.0153703229354152, 0.014779053717911, 0.0141838270541244, 
            0.0135870569246648, 0.0129910610122133, 0.0123980472693172, 0.0118121181920512, 0.0112333102275489, 0.0106634130314135, 
            0.0101040696923625, 0.00955677251798489, 0.00893489978826735, 0.00833309910274524, 0.00775295296934058, 0.00719576458200141, 
            0.00666256595888797, 0.00615412888617711, 0.00567097826898192, 0.00521340748134144, 0.00478149530698577, 0.0043751240707908, 
            0.00404717306486895, 0.00373747539649762, 0.00344567448777346, 0.00317134669770399, 0.00291401011695685, 0.00263138122245408, 
            0.00237059404926956, 0.00213067361499232, 0.00191059537008796, 0.00170930050794295, 0.0015761126325206, 0.00145159314362416, 
            0.00133534515418489, 0.0012269738218995, 0.00112608815659448, 0.00103148527085952, 0.000943700250964955, 0.000862357685694878, 
            0.000787091266203945, 0.000717544806187123, 0.000677930909433602, 0.000640218215938543, 0.000604334150095816, 
            0.00057020773640923, 0.000537769639350172, 0.000517215570055055, 0.000497352576457134, 0.00047816166054645, 0.000459624164676589, 
            0.000441721773303126, 0.000424436514297187, 0.000407750759848621, 0.000391647226975, 0.000376108977652452, 0.000361119418582832, 
            0.000346662300614135, 0.000332721717828381, 0.000319282106312501, 0.000306328242627502, 0.000293845241989778, 
            0.000282450986693407, 0.000271459050079135, 0.000260857044942406, 0.000250632884550057, 0.000240774778909241, 
            0.000221849690097772, 0.000204287726851117, 0.000188002223554266, 0.000172910992238999, 0.000158936182378546, 
            0.000149190704392911, 0.0001399973170189, 0.000131328002112997, 0.00012315593744302, 0.00011545546098302, 0.000103509414381277, 
            9.27149665747197e-05, 8.29712559869632e-05, 7.4185070131149e-05, 6.62704007776796e-05, 5.91480094019723e-05, 
            5.27450047249518e-05, 4.69944338376189e-05, 4.18348881057587e-05, 3.72101247815166e-05, 3.37621233004621e-05, 
            3.06147225644739e-05, 2.77436943558618e-05, 2.51265626795117e-05, 2.27424967686312e-05, 2.00696593054655e-05, 
            1.76946234498383e-05, 1.55863712266701e-05, 1.37168370518432e-05, 1.20606615651334e-05, 1.11513644785357e-05, 
            1.03071633642987e-05))), class = "BchronCalibratedDates"))
})

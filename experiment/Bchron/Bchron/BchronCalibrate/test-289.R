library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11250.6849404544, 31.243640165031)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11251, 
        ageSds = 31, calCurves = "intcal13", ageGrid = c(13033, 13034, 13035, 13036, 13037, 13038, 13039, 13040, 13041, 13042, 
            13043, 13044, 13045, 13046, 13047, 13048, 13049, 13050, 13051, 13052, 13053, 13054, 13055, 13056, 13057, 13058, 
            13059, 13060, 13061, 13062, 13063, 13064, 13065, 13066, 13067, 13068, 13069, 13070, 13071, 13072, 13073, 13074, 
            13075, 13076, 13077, 13078, 13079, 13080, 13081, 13082, 13083, 13084, 13085, 13086, 13087, 13088, 13089, 13090, 
            13091, 13092, 13093, 13094, 13095, 13096, 13097, 13098, 13099, 13100, 13101, 13102, 13103, 13104, 13105, 13106, 
            13107, 13108, 13109, 13110, 13111, 13112, 13113, 13114, 13115, 13116, 13117, 13118, 13119, 13120, 13121, 13122, 
            13123, 13124, 13125, 13126, 13127, 13128, 13129, 13130, 13131, 13132, 13133, 13134, 13135, 13136, 13137, 13138, 
            13139, 13140, 13141, 13142, 13143, 13144, 13145, 13146, 13147, 13148, 13149, 13150, 13151, 13152, 13153, 13154, 
            13155, 13156, 13157, 13158, 13159, 13160, 13161, 13162, 13163, 13164, 13165, 13166, 13167, 13168, 13169, 13170, 
            13171, 13172, 13173, 13174, 13175, 13176, 13177, 13178, 13179, 13180, 13181, 13182, 13183, 13184, 13185, 13186, 
            13187, 13188, 13189, 13190, 13191, 13192, 13193, 13194, 13195, 13196, 13197, 13198, 13199, 13200, 13201, 13202, 
            13203, 13204, 13205, 13206, 13207, 13208, 13209, 13210, 13211, 13212, 13213, 13214, 13215, 13216, 13217, 13218, 
            13219, 13220, 13221, 13222, 13223, 13224, 13225, 13226, 13227), densities = c(1.01776085210729e-05, 1.13956979363534e-05, 
            1.27509313611689e-05, 1.42576093990856e-05, 1.59313794096127e-05, 1.77893448129567e-05, 1.98501812200452e-05, 
            2.21342595782812e-05, 2.52270790388563e-05, 2.87216105259033e-05, 3.26653464457944e-05, 3.71107071180859e-05, 
            4.21154561568028e-05, 4.87842116861448e-05, 5.64225996535638e-05, 6.51565638612349e-05, 7.51259251758193e-05, 
            8.64855222135648e-05, 0.000103425843194458, 0.000123359441348782, 0.00014674518558012, 0.00017409811857509, 0.000205993623123652, 
            0.000252108419695747, 0.000307283158084154, 0.0003729855749535, 0.000450849467625857, 0.000542677805616107, 0.000660899295326903, 
            0.000800810349226692, 0.000965398000259073, 0.00115783631714299, 0.00138144721326587, 0.00166083695788527, 0.0019847490922371, 
            0.00235747210010337, 0.00278308899100404, 0.00326531654575801, 0.00380603755454928, 0.00440881581754612, 0.00507517699367512, 
            0.00580551738670592, 0.00659891072417473, 0.00751768231526858, 0.00850157527958636, 0.00954321710490995, 0.010632801826989, 
            0.0117580971797441, 0.0128209883242101, 0.0138890913190789, 0.0149478498047613, 0.0159816616652633, 0.0169742377623338, 
            0.0178381287073182, 0.0186404084887461, 0.0193685817012276, 0.020010890456847, 0.0205566316340999, 0.0209306563661372, 
            0.0212267112817333, 0.0214410454242617, 0.0215708561322797, 0.0216143505220792, 0.0215790569273759, 0.0214734161234556, 
            0.0212983142365135, 0.0210553275199344, 0.0207466983874817, 0.0204626650805885, 0.0201420199546634, 0.0197865307942953, 
            0.0193981528779883, 0.0189790105857134, 0.0185319514927867, 0.0180589629293479, 0.0175625566303735, 0.0170453241218543, 
            0.016509913675847, 0.0161186510341147, 0.015720559974956, 0.0153166178104056, 0.0149077955525112, 0.0144950540464245, 
            0.0139976415555739, 0.013497705532936, 0.0129967887809924, 0.0124963803298418, 0.01199790873275, 0.0115041987477944, 
            0.0110151457744561, 0.010531949713474, 0.0100557301997944, 0.00958752385170728, 0.00912986456392107, 0.00868205383669685, 
            0.0082448557805871, 0.00781894813595832, 0.00740492314389772, 0.00693732249928333, 0.00648725545178122, 0.00605524405471813, 
            0.00564166983448316, 0.00524678106619869, 0.00487070079784585, 0.00451343547042886, 0.00417488398576486, 0.00385484707950264, 
            0.00355303686472877, 0.00330874923019439, 0.00307729979408518, 0.00285838290377031, 0.00265166409426387, 0.00245678418370124, 
            0.00224170448993775, 0.00204181602426666, 0.00185646023171138, 0.00168495947863788, 0.00152662397206048, 0.00142098465949057, 
            0.00132147354530301, 0.00122783724547214, 0.00113982418944435, 0.00105718545300739, 0.000979080310277808, 0.000905924095601206, 
            0.000837477240664252, 0.000773505299340368, 0.000713779445975493, 0.000679520208173443, 0.000646687786001978, 
            0.000615235135814725, 0.000585116088705402, 0.000556285372218925, 0.000537888504118958, 0.000520025207003641, 
            0.000502682917436505, 0.000485849259255031, 0.000469512044859319, 0.000453659276306308, 0.000438279146214293, 
            0.000423360038484036, 0.000408890528842701, 0.000394859385215489, 0.000381255567932186, 0.000368068229773441, 
            0.000355286715862935, 0.000342900563411458, 0.000330899501317783, 0.000319800237968801, 0.000309037901687604, 
            0.000298603674925846, 0.000288488916585617, 0.000278685160560913, 0.000259753692321648, 0.000241993161395815, 
            0.000225340375677381, 0.000209734837289218, 0.000195118682550869, 0.000184815198736283, 0.000175011020014133, 
            0.000165684721426192, 0.000156815631608763, 0.000148383816006324, 0.000135162218147454, 0.000123030568851389, 
            0.000111908174023336, 0.000101719391960824, 9.23934078688837e-05, 8.38640092771503e-05, 7.60693634905421e-05, 
            6.89517980731396e-05, 6.24575852396484e-05, 5.65367309107459e-05, 5.2073390450421e-05, 4.79393627096421e-05, 
            4.41124169728672e-05, 4.05716441913914e-05, 3.72973934570532e-05, 3.35617147161077e-05, 3.01783646633389e-05, 
            2.71165912627099e-05, 2.43480540123883e-05, 2.18466639730039e-05, 2.04531779993244e-05, 1.91435500144506e-05, 
            1.79130926033897e-05, 1.67573555462933e-05, 1.56721154766244e-05, 1.46331170949162e-05, 1.36591388244657e-05, 
            1.27463956247881e-05, 1.18913026294573e-05, 1.10904659437134e-05, 1.05749469288957e-05, 1.00820235640471e-05))), 
        class = "BchronCalibratedDates"))
})

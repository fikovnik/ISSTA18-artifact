library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11215.0855041504, 4.55414123535157)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11215, 
        ageSds = 5, calCurves = "intcal13", ageGrid = c(13066, 13067, 13068, 13069, 13070, 13071, 13072, 13073, 13074, 13075, 
            13076, 13077, 13078, 13079, 13080, 13081, 13082, 13083, 13084, 13085, 13086, 13087, 13088, 13089, 13090, 13091, 
            13092, 13093, 13094, 13095), densities = c(1.88039460312865e-05, 6.15548771240071e-05, 0.000186537361825535, 
            0.000521698547588923, 0.00134276881118789, 0.00314177446343758, 0.00676127352956911, 0.0133506016801456, 0.0241377932655795, 
            0.0398938301605628, 0.0616517857292125, 0.0859904265301401, 0.10802508035593, 0.122052843271838, 0.123932393227374, 
            0.114200413075552, 0.0959180062849953, 0.0734463653165326, 0.0513078690305359, 0.0327385285289464, 0.0197772797635967, 
            0.01102223041571, 0.00567111773317416, 0.00269656703914054, 0.00118654342471274, 0.00055250260455754, 0.000242696227059432, 
            0.0001006268252195, 3.9408615515422e-05, 1.4590043758881e-05))), class = "BchronCalibratedDates"))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11255.605518383, 24.7941085407272)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11256, 
        ageSds = 25, calCurves = "intcal13", ageGrid = c(13054, 13055, 13056, 13057, 13058, 13059, 13060, 13061, 13062, 13063, 
            13064, 13065, 13066, 13067, 13068, 13069, 13070, 13071, 13072, 13073, 13074, 13075, 13076, 13077, 13078, 13079, 
            13080, 13081, 13082, 13083, 13084, 13085, 13086, 13087, 13088, 13089, 13090, 13091, 13092, 13093, 13094, 13095, 
            13096, 13097, 13098, 13099, 13100, 13101, 13102, 13103, 13104, 13105, 13106, 13107, 13108, 13109, 13110, 13111, 
            13112, 13113, 13114, 13115, 13116, 13117, 13118, 13119, 13120, 13121, 13122, 13123, 13124, 13125, 13126, 13127, 
            13128, 13129, 13130, 13131, 13132, 13133, 13134, 13135, 13136, 13137, 13138, 13139, 13140, 13141, 13142, 13143, 
            13144, 13145, 13146, 13147, 13148, 13149, 13150, 13151, 13152, 13153, 13154, 13155, 13156, 13157, 13158, 13159, 
            13160, 13161, 13162, 13163, 13164, 13165, 13166, 13167, 13168, 13169, 13170, 13171, 13172, 13173, 13174, 13175, 
            13176, 13177, 13178, 13179, 13180, 13181, 13182, 13183, 13184, 13185, 13186, 13187, 13188, 13189, 13190, 13191, 
            13192, 13193, 13194, 13195, 13196, 13197, 13198, 13199, 13200, 13201, 13202, 13203), densities = c(1.05326467298822e-05, 
            1.35926866537939e-05, 1.8477730124587e-05, 2.49804509848231e-05, 3.35835772919683e-05, 4.48947766411076e-05, 
            5.9672538565708e-05, 8.07955309846742e-05, 0.0001086402557391, 0.00014505883166466, 0.000192312602968741, 0.000253129429290748, 
            0.000337091993259526, 0.000445200313954083, 0.000583057898360847, 0.000757122929249585, 0.000974698550987664, 
            0.00124278719203211, 0.001570855152414, 0.00196807143793967, 0.00244379612348029, 0.00300721331053369, 0.00371733564424849, 
            0.00454732514276497, 0.00550403028773371, 0.00659101866615771, 0.00780764583370406, 0.00904577934716386, 0.010381788810955, 
            0.0118021395643027, 0.0132884956696488, 0.0148178010521607, 0.0162394201118755, 0.0176509079047113, 0.019025917177954, 
            0.020336680334597, 0.0215548992991406, 0.0224779865842813, 0.0233027506222416, 0.0240148883723284, 0.024601615623271, 
            0.0250520501502026, 0.0253336933237054, 0.0254933803088108, 0.0255282786915377, 0.0254374122102346, 0.0252216966593061, 
            0.0249690089769309, 0.0246441696718949, 0.0242497904597899, 0.0237890966951774, 0.0232658825104792, 0.0226852739433835, 
            0.0220515560320493, 0.02136990126249, 0.0206457864300891, 0.0198849173419386, 0.019323588521307, 0.0187488708408842, 
            0.0181629236859898, 0.0175678948837176, 0.0169659075767425, 0.0162404192529105, 0.0155117497814275, 0.0147832351022747, 
            0.0140580525556051, 0.0133392003371884, 0.0126321965762905, 0.0119370271365461, 0.0112560203930377, 0.0105912742775183, 
            0.00994465200961941, 0.00932064151066672, 0.00871775450826664, 0.00813711681298496, 0.00757963185806805, 0.00704598921657172, 
            0.0064537294459892, 0.0058950429417096, 0.00537004974597595, 0.00487857067241486, 0.00442015847829651, 0.00399412976393799, 
            0.0035995969681836, 0.00323549989479587, 0.00290063627643645, 0.00259369095812519, 0.00235199538885543, 0.00212883722042521, 
            0.00192327761976308, 0.00173436651505956, 0.00156115155178962, 0.0013750556324605, 0.00120798565159942, 0.00105846738106318, 
            0.000925071729029147, 0.000806424525789256, 0.000729757726138195, 0.00065951945513879, 0.000595269220483094, 
            0.000536585771561571, 0.000483067503106396, 0.000433811228098608, 0.000389059281567382, 0.000348462058723593, 
            0.000311689861478221, 0.000278432600289766, 0.00025976293522116, 0.000242223780825013, 0.000225756026021344, 
            0.000210302961403565, 0.000195810231267154, 0.000186746177784601, 0.000178064130544892, 0.000169749975427168, 
            0.000161790019293513, 0.000154170982369056, 0.000146879990509123, 0.00013990456736953, 0.000133232626496223, 
            0.000126852463349705, 0.000120752747278466, 0.000114922513455996, 0.000109351154794261, 0.000104028413846505, 
            9.89443747115184e-05, 9.40894549504609e-05, 8.97515421608784e-05, 8.5600751188581e-05, 8.16297001776372e-05, 
            7.78312626213838e-05, 7.41985603477059e-05, 6.72873009172538e-05, 6.09808715384155e-05, 5.52305217629258e-05, 
            4.99909942968683e-05, 4.52203191198899e-05, 4.19460053478393e-05, 3.88957112622083e-05, 3.60551957422293e-05, 
            3.34110352981448e-05, 3.09505840296788e-05, 2.71902350938817e-05, 2.38641709386589e-05, 2.09253665411931e-05, 
            1.83314656117254e-05, 1.60443729347041e-05, 1.40298750456944e-05, 1.22572882302162e-05, 1.06991327261657e-05))), 
        class = "BchronCalibratedDates"))
})

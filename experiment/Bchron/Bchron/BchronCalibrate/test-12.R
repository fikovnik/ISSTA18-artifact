library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11254.9333333969, 25.7884863853455)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11255, 
        ageSds = 26, calCurves = "intcal13", ageGrid = c(13052, 13053, 13054, 13055, 13056, 13057, 13058, 13059, 13060, 13061, 
            13062, 13063, 13064, 13065, 13066, 13067, 13068, 13069, 13070, 13071, 13072, 13073, 13074, 13075, 13076, 13077, 
            13078, 13079, 13080, 13081, 13082, 13083, 13084, 13085, 13086, 13087, 13088, 13089, 13090, 13091, 13092, 13093, 
            13094, 13095, 13096, 13097, 13098, 13099, 13100, 13101, 13102, 13103, 13104, 13105, 13106, 13107, 13108, 13109, 
            13110, 13111, 13112, 13113, 13114, 13115, 13116, 13117, 13118, 13119, 13120, 13121, 13122, 13123, 13124, 13125, 
            13126, 13127, 13128, 13129, 13130, 13131, 13132, 13133, 13134, 13135, 13136, 13137, 13138, 13139, 13140, 13141, 
            13142, 13143, 13144, 13145, 13146, 13147, 13148, 13149, 13150, 13151, 13152, 13153, 13154, 13155, 13156, 13157, 
            13158, 13159, 13160, 13161, 13162, 13163, 13164, 13165, 13166, 13167, 13168, 13169, 13170, 13171, 13172, 13173, 
            13174, 13175, 13176, 13177, 13178, 13179, 13180, 13181, 13182, 13183, 13184, 13185, 13186, 13187, 13188, 13189, 
            13190, 13191, 13192, 13193, 13194, 13195, 13196, 13197, 13198, 13199, 13200, 13201, 13202, 13203, 13204, 13205, 
            13206), densities = c(1.21082085495158e-05, 1.54478612444484e-05, 1.96421699879608e-05, 2.4890090038489e-05, 
            3.3094875780208e-05, 4.3774026630031e-05, 5.75922941917006e-05, 7.53660127533636e-05, 9.80892930773261e-05, 0.000129857384527808, 
            0.000170787685009818, 0.000223128875949424, 0.000289554037383592, 0.000373202253409451, 0.000486255258966117, 
            0.000628599266180934, 0.000806171936688292, 0.00102560874097638, 0.00129417579191721, 0.00161845979106141, 0.00200741151917296, 
            0.00246919676277827, 0.0030117588384702, 0.00364243543356754, 0.00442288989793633, 0.00531795356304127, 0.00633080537045622, 
            0.00746111054895239, 0.00870431240728626, 0.00994919865049952, 0.0112719475576375, 0.0126571169425684, 0.0140852719585965, 
            0.0155332332689096, 0.0168608282130503, 0.0181609672291948, 0.019409691865742, 0.0205823951890269, 0.021654605740586, 
            0.0224534060543812, 0.0231539367406601, 0.0237446474928233, 0.0242154878580309, 0.0245581934200259, 0.0247518651095482, 
            0.0248336731128302, 0.0248021010947474, 0.024657210574916, 0.0244006481115626, 0.0241255182906397, 0.0237865259162162, 
            0.0233862356139272, 0.0229277063450825, 0.0224144515568292, 0.0218511837175005, 0.0212416888228125, 0.0205905621331613, 
            0.019902631966866, 0.0191828984857761, 0.0186534574856581, 0.0181124615356371, 0.0175617847727905, 0.017003288942008, 
            0.0164388129274309, 0.0157589361008345, 0.0150763695920335, 0.0143940056545992, 0.0137146033818395, 0.0130407721820749, 
            0.0123774005676128, 0.0117244161445412, 0.0110838706659817, 0.0104576239551543, 0.00984734002707527, 0.00925706635850069, 
            0.00868548164790019, 0.00813363089094219, 0.00760237087983102, 0.00709237649510639, 0.00652451048328511, 0.00598679589682192, 
            0.00547946426566574, 0.00500248472639317, 0.00455558864549029, 0.00413829507727681, 0.0037499365610336, 0.0033896848061022, 
            0.00305657586312974, 0.00274953443245002, 0.0025064516614314, 0.00228086987794941, 0.00207199060757058, 0.0018789979071484, 
            0.00170106633557847, 0.00150888272367615, 0.00133515599019374, 0.00117857651430403, 0.00103786267302043, 0.000911770507095816, 
            0.000829769449739682, 0.000754224485671746, 0.000684727423666367, 0.000620885296853274, 0.000562320954859384, 
            0.000508131904387163, 0.00045859531031983, 0.000413376792316214, 0.000372158830229384, 0.000334640707476018, 
            0.000313486960532438, 0.000293533672875214, 0.000274722696550971, 0.000256998003337932, 0.000240305655223312, 
            0.000229823288008793, 0.000219754920909497, 0.000210086367244903, 0.000200803822822111, 0.000191893860458137, 
            0.000183343424342284, 0.000175139824252955, 0.000167270729643637, 0.00015972416361227, 0.000152488496767023, 
            0.000145552441002217, 0.000138905043196444, 0.000132535678845142, 0.000126434045639351, 0.000120590157001333, 
            0.000115331729175418, 0.000110286766960976, 0.00010544740975321, 0.000100806046742346, 9.6355310883255e-05, 8.78627695916852e-05, 
            8.00701809282393e-05, 7.29248078404962e-05, 6.63773964547223e-05, 6.03819933888959e-05, 5.62449250969305e-05, 
            5.23745114808068e-05, 4.87548899093938e-05, 4.53710399624895e-05, 4.22087462803574e-05, 3.73509594214141e-05, 
            3.30224659547628e-05, 2.9169520273329e-05, 2.57433306288234e-05, 2.26996655868659e-05, 1.99984839505644e-05, 
            1.76035877424097e-05, 1.54822976923028e-05, 1.36051505625861e-05, 1.19456175468724e-05, 1.07189530561005e-05))), 
        class = "BchronCalibratedDates"))
})

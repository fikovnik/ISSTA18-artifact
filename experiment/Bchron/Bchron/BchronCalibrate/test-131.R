library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11251.406984234, 26.8993428994902)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11251, 
        ageSds = 27, calCurves = "intcal13", ageGrid = c(13047, 13048, 13049, 13050, 13051, 13052, 13053, 13054, 13055, 13056, 
            13057, 13058, 13059, 13060, 13061, 13062, 13063, 13064, 13065, 13066, 13067, 13068, 13069, 13070, 13071, 13072, 
            13073, 13074, 13075, 13076, 13077, 13078, 13079, 13080, 13081, 13082, 13083, 13084, 13085, 13086, 13087, 13088, 
            13089, 13090, 13091, 13092, 13093, 13094, 13095, 13096, 13097, 13098, 13099, 13100, 13101, 13102, 13103, 13104, 
            13105, 13106, 13107, 13108, 13109, 13110, 13111, 13112, 13113, 13114, 13115, 13116, 13117, 13118, 13119, 13120, 
            13121, 13122, 13123, 13124, 13125, 13126, 13127, 13128, 13129, 13130, 13131, 13132, 13133, 13134, 13135, 13136, 
            13137, 13138, 13139, 13140, 13141, 13142, 13143, 13144, 13145, 13146, 13147, 13148, 13149, 13150, 13151, 13152, 
            13153, 13154, 13155, 13156, 13157, 13158, 13159, 13160, 13161, 13162, 13163, 13164, 13165, 13166, 13167, 13168, 
            13169, 13170, 13171, 13172, 13173, 13174, 13175, 13176, 13177, 13178, 13179, 13180, 13181, 13182, 13183, 13184, 
            13185, 13186, 13187, 13188, 13189, 13190, 13191, 13192, 13193, 13194, 13195, 13196, 13197, 13198, 13199, 13200, 
            13201, 13202, 13203, 13204, 13205, 13206), densities = c(1.19960313315777e-05, 1.44076806360487e-05, 1.7271580040517e-05, 
            2.0665424672726e-05, 2.59595528502347e-05, 3.25050919584548e-05, 4.05687851270617e-05, 5.04666262296376e-05, 
            6.25710773805132e-05, 8.10176540315595e-05, 0.000104370302369307, 0.000133764281255795, 0.00017054715690817, 
            0.00021630450886795, 0.000278495167445567, 0.000356301605755924, 0.000452934809944941, 0.000572060574668961, 
            0.000717807817264881, 0.000909247418284133, 0.00114307593883628, 0.00142609685784821, 0.00176549677875745, 0.00216866816587157, 
            0.00264148193857043, 0.00319215530783034, 0.00382708577513857, 0.00455163675950429, 0.00536971303600743, 0.00635281681409877, 
            0.00744576523931455, 0.00864451895620179, 0.00994085225711714, 0.0113219872279777, 0.0126629846755461, 0.014044686893805, 
            0.0154463215338479, 0.0168442353821901, 0.0182124641099116, 0.0194227155156349, 0.0205629566949357, 0.0216111225905625, 
            0.0225459396492516, 0.0233476421587731, 0.0239009055321028, 0.0243411375619339, 0.0246611395077229, 0.0248554931641633, 
            0.0249207145401283, 0.0248677620186904, 0.0247093730222866, 0.0244472760158477, 0.0240845379839008, 0.0236255037944606, 
            0.0232045888706628, 0.0227313771497587, 0.0222092344702166, 0.0216418541979025, 0.0210332124520166, 0.0203885951102234, 
            0.0197116039651237, 0.0190067670404661, 0.0182786865837806, 0.0175319880236086, 0.0169912522325029, 0.0164451695729246, 
            0.0158953563898971, 0.015343391629223, 0.0147908095533534, 0.0141319380020444, 0.0134769596775973, 0.0128281556752794, 
            0.0121876605639234, 0.011557453421185, 0.0109417207777157, 0.010339786876684, 0.00975310134494017, 0.00918294248913648, 
            0.00863041810225045, 0.00809885537852317, 0.00758659628012728, 0.00709423364616917, 0.00662220949871629, 0.0061708225092336, 
            0.00567013341748577, 0.00519781755788149, 0.00475370860642908, 0.00433744726814028, 0.00394850282368182, 0.00358619473489631, 
            0.00324971397851697, 0.00293814381611707, 0.00265047974887243, 0.00238564844694914, 0.00217616735150413, 0.00198188510109858, 
            0.00180206154191367, 0.00163595140095054, 0.00148281006939278, 0.00131739914088176, 0.00116781521896619, 0.00103290927944593, 
            0.000911565770634433, 0.000802709135619125, 0.000731838464116942, 0.000666476434926501, 0.000606274501228046, 
            0.000550897962581125, 0.000500026282429481, 0.000452891300051675, 0.000409730592979335, 0.000370261256334544, 
            0.000334214920291622, 0.000301337603763962, 0.00028277461999012, 0.000265241427609524, 0.000248688966725791, 
            0.000233069966708203, 0.000218338917353356, 0.000209074392156654, 0.000200166690475703, 0.000191603832525739, 
            0.000183374158695142, 0.000175466324699053, 0.000167869296630778, 0.000160572345921169, 0.000153565044216605, 
            0.000146837258185773, 0.000140379144264487, 0.000134181143348459, 0.000128233975442558, 0.000122528634275283, 
            0.00011705638188684, 0.00011180874319833, 0.000107072573942561, 0.000102523362050425, 9.81544011947554e-05, 9.39591934298244e-05, 
            8.9931444216022e-05, 8.22356334979761e-05, 7.51561256317274e-05, 6.86477437133012e-05, 6.26682215632327e-05, 
            5.71780537167633e-05, 5.33798378030509e-05, 4.9819085231163e-05, 4.64820834746592e-05, 4.33558278072825e-05, 
            4.04279908369716e-05, 3.5918668761295e-05, 3.18855984173964e-05, 2.82818890423178e-05, 2.50648432885343e-05, 
            2.21956335141811e-05, 1.96389969289871e-05, 1.73629492489269e-05, 1.53385164103107e-05, 1.35394838095582e-05, 
            1.19421624667086e-05, 1.07581463322273e-05))), class = "BchronCalibratedDates"))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("BchronCalibrate", {
    pars <- c(11117.812890625, 110.5916015625)
    calCurve <- "intcal13"
    expect_equal(Bchron:::BchronCalibrate(ages = round(pars[1]), ageSds = round(pars[2]), calCurves = calCurve), structure(list(Date1 = list(ages = 11118, 
        ageSds = 111, calCurves = "intcal13", ageGrid = c(12693, 12694, 12695, 12696, 12697, 12698, 12699, 12700, 12701, 
            12702, 12703, 12704, 12705, 12706, 12707, 12708, 12709, 12710, 12711, 12712, 12713, 12714, 12715, 12716, 12717, 
            12718, 12719, 12720, 12721, 12722, 12723, 12724, 12725, 12726, 12727, 12728, 12729, 12730, 12731, 12732, 12733, 
            12734, 12735, 12736, 12737, 12738, 12739, 12740, 12741, 12742, 12743, 12744, 12745, 12746, 12747, 12748, 12749, 
            12750, 12751, 12752, 12753, 12754, 12755, 12756, 12757, 12758, 12759, 12760, 12761, 12762, 12763, 12764, 12765, 
            12766, 12767, 12768, 12769, 12770, 12771, 12772, 12773, 12774, 12775, 12776, 12777, 12778, 12779, 12780, 12781, 
            12782, 12783, 12784, 12785, 12786, 12787, 12788, 12789, 12790, 12791, 12792, 12793, 12794, 12795, 12796, 12797, 
            12798, 12799, 12800, 12801, 12802, 12803, 12804, 12805, 12806, 12807, 12808, 12809, 12810, 12811, 12812, 12813, 
            12814, 12815, 12816, 12817, 12818, 12819, 12820, 12821, 12822, 12823, 12824, 12825, 12826, 12827, 12828, 12829, 
            12830, 12831, 12832, 12833, 12834, 12835, 12836, 12837, 12838, 12839, 12840, 12841, 12842, 12843, 12844, 12845, 
            12846, 12847, 12848, 12849, 12850, 12851, 12852, 12853, 12854, 12855, 12856, 12857, 12858, 12859, 12860, 12861, 
            12862, 12863, 12864, 12865, 12866, 12867, 12868, 12869, 12870, 12871, 12872, 12873, 12874, 12875, 12876, 12877, 
            12878, 12879, 12880, 12881, 12882, 12883, 12884, 12885, 12886, 12887, 12888, 12889, 12890, 12891, 12892, 12893, 
            12894, 12895, 12896, 12897, 12898, 12899, 12900, 12901, 12902, 12903, 12904, 12905, 12906, 12907, 12908, 12909, 
            12910, 12911, 12912, 12913, 12914, 12915, 12916, 12917, 12918, 12919, 12920, 12921, 12922, 12923, 12924, 12925, 
            12926, 12927, 12928, 12929, 12930, 12931, 12932, 12933, 12934, 12935, 12936, 12937, 12938, 12939, 12940, 12941, 
            12942, 12943, 12944, 12945, 12946, 12947, 12948, 12949, 12950, 12951, 12952, 12953, 12954, 12955, 12956, 12957, 
            12958, 12959, 12960, 12961, 12962, 12963, 12964, 12965, 12966, 12967, 12968, 12969, 12970, 12971, 12972, 12973, 
            12974, 12975, 12976, 12977, 12978, 12979, 12980, 12981, 12982, 12983, 12984, 12985, 12986, 12987, 12988, 12989, 
            12990, 12991, 12992, 12993, 12994, 12995, 12996, 12997, 12998, 12999, 13000, 13001, 13002, 13003, 13004, 13005, 
            13006, 13007, 13008, 13009, 13010, 13011, 13012, 13013, 13014, 13015, 13016, 13017, 13018, 13019, 13020, 13021, 
            13022, 13023, 13024, 13025, 13026, 13027, 13028, 13029, 13030, 13031, 13032, 13033, 13034, 13035, 13036, 13037, 
            13038, 13039, 13040, 13041, 13042, 13043, 13044, 13045, 13046, 13047, 13048, 13049, 13050, 13051, 13052, 13053, 
            13054, 13055, 13056, 13057, 13058, 13059, 13060, 13061, 13062, 13063, 13064, 13065, 13066, 13067, 13068, 13069, 
            13070, 13071, 13072, 13073, 13074, 13075, 13076, 13077, 13078, 13079, 13080, 13081, 13082, 13083, 13084, 13085, 
            13086, 13087, 13088, 13089, 13090, 13091, 13092, 13093, 13094, 13095, 13096, 13097, 13098, 13099, 13100, 13101, 
            13102, 13103, 13104, 13105, 13106, 13107, 13108, 13109, 13110, 13111, 13112, 13113, 13114, 13115, 13116, 13117, 
            13118, 13119, 13120, 13121, 13122, 13123, 13124, 13125, 13126, 13127, 13128, 13129, 13130, 13131, 13132, 13133, 
            13134, 13135, 13136, 13137, 13138, 13139, 13140, 13141, 13142, 13143, 13144, 13145, 13146, 13147, 13148, 13149, 
            13150, 13151, 13152, 13153, 13154, 13155, 13156, 13157, 13158, 13159, 13160, 13161, 13162, 13163, 13164, 13165, 
            13166, 13167, 13168, 13169, 13170, 13171, 13172, 13173, 13174, 13175, 13176, 13177, 13178, 13179, 13180, 13181, 
            13182, 13183, 13184, 13185, 13186, 13187, 13188, 13189, 13190, 13191, 13192, 13193, 13194, 13195, 13196, 13197, 
            13198, 13199, 13200, 13201, 13202, 13203, 13204, 13205, 13206, 13207, 13208, 13209, 13210, 13211, 13212, 13213, 
            13214, 13215, 13216, 13217, 13218, 13219, 13220, 13221, 13222, 13223, 13224, 13225, 13226, 13227, 13228, 13229, 
            13230, 13231, 13232, 13233, 13234, 13235, 13236, 13237, 13238, 13239, 13240, 13241, 13242, 13243, 13244, 13245, 
            13246, 13247, 13248, 13249, 13250, 13251, 13252, 13253, 13254, 13255, 13256, 13257, 13258, 13259, 13260, 13261, 
            13262, 13263, 13264, 13265, 13266, 13267, 13268, 13269, 13270, 13271, 13272, 13273, 13274, 13275, 13276, 13277, 
            13278, 13279, 13280, 13281, 13282, 13283, 13284, 13285, 13286, 13287, 13288, 13289, 13290, 13291, 13292, 13293, 
            13294, 13295, 13296, 13297, 13298, 13299, 13300, 13301, 13302, 13303, 13304, 13305, 13306, 13307, 13308, 13309, 
            13310, 13311, 13312, 13313, 13314, 13315, 13316, 13317, 13318, 13319, 13320, 13321, 13322, 13323, 13324, 13325, 
            13326, 13327, 13328, 13329, 13330, 13331, 13332, 13333), densities = c(1.02535575328889e-05, 1.11668762315668e-05, 
            1.21550503663571e-05, 1.34433021086085e-05, 1.48566834564245e-05, 1.64059908266662e-05, 1.8102798420427e-05, 
            1.99594975976028e-05, 2.22250165373664e-05, 2.47235765606709e-05, 2.74760612505518e-05, 3.05048505461972e-05, 
            3.38338842951771e-05, 3.76744436323816e-05, 4.19047460491916e-05, 4.65583764705429e-05, 5.16710849972583e-05, 
            5.72808405334428e-05, 6.34160530032907e-05, 7.01291997814538e-05, 7.74649639560424e-05, 8.54703463500307e-05, 
            9.41946557616837e-05, 0.000103683802697154, 0.000113996483298345, 0.000125188628305576, 0.000137318239994857, 
            0.000150445274672406, 0.000163217433469648, 0.000176901766466128, 0.000191546079081074, 0.000207199017644002, 
            0.00022390991302281, 0.000241708337106141, 0.000260662739901479, 0.00028082333549751, 0.000302240220821816, 0.000324963125967565, 
            0.000346423437252908, 0.000369001835817707, 0.000392732105020634, 0.000417647086391453, 0.000443778487768472, 
            0.000466205413223175, 0.00048949273181094, 0.00051365586879966, 0.0005387093837713, 0.000564666886147788, 0.000587614415687036, 
            0.000611241531404324, 0.000635554887992801, 0.000660560456648476, 0.000686263483844816, 0.00070596982232882, 
            0.000726071937431434, 0.000746571186179837, 0.000767468652575924, 0.00078876513792262, 0.000805594831529429, 
            0.000822666191453247, 0.000839979224907764, 0.000857533823606212, 0.000875329761137826, 0.000885557339611684, 
            0.000895863202282815, 0.000906247264328513, 0.000916709427710096, 0.000927249581020088, 0.000937906906853025, 
            0.000948642183345783, 0.00095945524868845, 0.000970345926932889, 0.000981314027849978, 0.000989610694063737, 
            0.000997950776329962, 0.00100633417547508, 0.00101476078761902, 0.00102323050414375, 0.00103176328652871, 0.00104033900390838, 
            0.00104895753029134, 0.00105761873479412, 0.00106632248161239, 0.00107804060889513, 0.00108983392522114, 0.00110170205431738, 
            0.00111364460378647, 0.00112566116500178, 0.0011408209627605, 0.00115609497206697, 0.00117148227025161, 0.00118698189375291, 
            0.001202592837863, 0.00121829356620498, 0.00123410345613272, 0.00125002138778413, 0.00126604619937566, 0.00128217668701372, 
            0.00130493862882012, 0.00132790168402163, 0.00135106212553493, 0.0013744160618254, 0.00139795943640889, 0.00142164719655597, 
            0.00144551594920269, 0.00146956118193635, 0.00149377821690482, 0.00151816221092529, 0.00154270815573149, 0.00156741087836192, 
            0.00159226504169127, 0.00161726514510681, 0.00164240552533216, 0.00167129886351985, 0.00170035889119796, 0.00172957638909147, 
            0.00175894186934151, 0.00178844557869063, 0.00181064379756741, 0.00183291000807521, 0.00185523981978044, 0.00187762876253732, 
            0.00190007228759387, 0.00192254742212505, 0.00194506810527333, 0.00196762957334405, 0.00199022698884782, 0.00201285544190113, 
            0.00203550995168835, 0.00205818546798585, 0.00208087687274751, 0.00210357898175078, 0.00212628654630399, 0.00214520706927243, 
            0.00216412463970799, 0.00218303612423682, 0.0022019383616218, 0.00222082816355583, 0.00223970231547424, 0.00225855757738608, 
            0.00227739068472407, 0.002296198349213, 0.00231497725975621, 0.00232997443404853, 0.0023449494146137, 0.00235990047774004, 
            0.00237482589170733, 0.002389723917102, 0.00240457848040319, 0.00241940245545592, 0.00243419408519087, 0.00244895160600238, 
            0.00246367324808187, 0.00247100641804282, 0.00247833010662615, 0.00248564409177795, 0.00249294815110131, 0.00250024206186724, 
            0.00250753885473617, 0.00251482489555114, 0.00252209995995897, 0.00252936382333757, 0.00253661626080729, 0.00254021877781186, 
            0.00254381847260243, 0.00254741531724232, 0.00255100928377696, 0.0025546003442345, 0.00255820117142742, 0.00256179895705704, 
            0.00256539367294911, 0.00256898529091576, 0.00257257378275608, 0.0025761591202563, 0.00257974127519018, 0.00258332021931953, 
            0.0025868959243943, 0.00259046836215321, 0.00259403750432388, 0.0025976033226233, 0.00260116578875826, 0.00260472487442552, 
            0.00260828055131242, 0.00261184488782767, 0.00261540567737686, 0.00261896289150287, 0.00262251650174307, 0.00262606647962988, 
            0.00263316727468604, 0.00264025303359761, 0.00264732352808124, 0.00265437852983088, 0.00266141781053019, 0.00266493722263129, 
            0.00266845257717889, 0.00267196384559588, 0.00267547099930804, 0.00267897400974476, 0.00268594503388754, 0.00269289947623183, 
            0.00269983710891198, 0.00270675770410962, 0.00271366103406618, 0.00271711700481081, 0.00272056849000655, 0.00272401546115597, 
            0.00272745788977046, 0.0027308957473708, 0.00273773643804157, 0.00274455883934874, 0.00275136272411338, 0.0027581478652974, 
            0.00276491403601631, 0.00277167118931623, 0.00277840875071411, 0.0027851264938029, 0.00279182419240282, 0.00279850162057428, 
            0.00280514879415492, 0.00281177541444713, 0.00281838125627929, 0.00282496609474743, 0.00283152970522816, 0.00283807186339134, 
            0.00284459234521293, 0.00285109092698778, 0.00285756738534237, 0.00286402149724781, 0.00286724010368294, 0.00287045304003255, 
            0.0028736602785207, 0.00287686179139527, 0.00288005755092862, 0.00288642298822921, 0.00289276524674057, 0.00289908410532046, 
            0.00290537934323085, 0.00291165074015101, 0.00291478159810643, 0.00291790637190534, 0.00292102503416943, 0.00292413755755023, 
            0.00292724391472977, 0.00292724391472977, 0.00292724391472977, 0.00292724391472977, 0.00292724391472977, 0.00292724391472977, 
            0.00293033594861776, 0.00293342184433505, 0.00293650157457033, 0.00293957511204121, 0.0029426424294948, 0.0029426424294948, 
            0.0029426424294948, 0.0029426424294948, 0.0029426424294948, 0.0029426424294948, 0.00294570349970795, 0.00294875829548772, 
            0.00295180678967188, 0.0029548489551291, 0.00295788476475956, 0.00296092191096905, 0.0029639525653091, 0.00296697670088574, 
            0.00296999429084088, 0.00297300530835296, 0.00297901499227136, 0.00298499790196223, 0.00299095382472267, 0.00299688254849428, 
            0.0030027838618761, 0.00300865755413723, 0.00301450341522957, 0.00302032123580054, 0.00302611080720565, 0.0030318719215213, 
            0.00304330136752433, 0.00305461482646455, 0.00306581065924802, 0.00307688723933275, 0.00308784295312777, 0.00310136951140093, 
            0.0031147013345567, 0.00312783536650976, 0.00314076858738035, 0.00315349801467044, 0.00316849347443975, 0.0031831868278969, 
            0.00319757313426932, 0.00321164753993141, 0.00322540528117832, 0.00323884543069852, 0.00325195927412628, 0.00326474234616892, 
            0.00327719028264251, 0.00328929882300104, 0.00330105821468371, 0.0033124707113853, 0.00332353234942234, 0.00333423927735763, 
            0.00334458775827473, 0.00335620312569197, 0.00336732014038101, 0.00337793348316024, 0.00338803806389188, 0.00339762902562523, 
            0.00340416149120959, 0.0034104281344192, 0.00341642739795857, 0.00342215778838118, 0.00342761787672013, 0.00343280556249643, 
            0.00343772044124443, 0.00344236126813749, 0.00344672686493604, 0.00345081612049452, 0.00345462837806922, 0.00345816216155744, 
            0.00346141657717958, 0.00346439080010551, 0.00346708407480928, 0.00346903591766606, 0.00347080720582391, 0.00347239764729882, 
            0.00347380697891156, 0.00347503496636146, 0.00347608144493663, 0.00347694616963601, 0.00347762900198642, 0.00347812983262478, 
            0.00347844858132786, 0.00347858519703405, 0.00347853965785735, 0.00347831197109326, 0.00347790217321682, 0.00347731032987268, 
            0.00347631470831044, 0.00347503508152522, 0.00347347178339994, 0.00347162521863045, 0.00346949586254809, 0.00346708426091214, 
            0.00346439102967268, 0.00346141685470368, 0.0034581624915067, 0.00345462876488527, 0.00345002116514394, 0.00344501437590819, 
            0.00343961022793953, 0.00343381069181729, 0.00342761787672013, 0.00341989949769386, 0.00341165286121424, 0.00340288203275573, 
            0.00339359132267855, 0.00338378528263965, 0.00337042827780469, 0.0033562381467819, 0.00334122626275055, 0.00332540460678358, 
            0.00330878575166141, 0.00328741075820172, 0.00326488976843125, 0.00324124911137668, 0.00321651625700155, 0.00319071976228041, 
            0.0031613976275513, 0.00313088423350716, 0.00309922058542065, 0.00306644888661223, 0.00303261244375017, 0.00299478867845985, 
            0.00295582232249594, 0.00291577197971808, 0.00287469722779118, 0.00283265846979457, 0.00278970685224766, 0.00274591283187823, 
            0.00270133840625647, 0.00265604581569271, 0.00261009739949261, 0.00255992525094048, 0.00250913991577707, 0.00245781859334741, 
            0.00240603786796897, 0.0023538735242357, 0.00230514184164095, 0.00225620200802044, 0.0022071121180543, 0.00215792919707443, 
            0.00210870909905946, 0.00206325338717426, 0.0020178530315996, 0.00197254900662281, 0.00192738119547535, 0.00188238834086793, 
            0.00184502686661713, 0.00180783344810162, 0.00177082862292113, 0.00173403230839273, 0.00169746378879508, 0.001664754422858, 
            0.00163225770927601, 0.00159998636230837, 0.00156795265702197, 0.00153616842541517, 0.00151158893693958, 0.0014871722035923, 
            0.00146292326871785, 0.00143884701029032, 0.00141494814059295, 0.00139125166373578, 0.00136774155527334, 0.00134442200986177, 
            0.00132129705675446, 0.00129837056018488, 0.0012821356421639, 0.00126600516060088, 0.00124998036162586, 0.00123406244908304, 
            0.00121825258470434, 0.00119945360459736, 0.00118081361188315, 0.00116233435750357, 0.00114401750732188, 0.00112586464276529, 
            0.00110789756560591, 0.00109009729336591, 0.00107246514583142, 0.0010550023615541, 0.00103771009868601, 0.0010206094652466, 
            0.00100368129773001, 0.000986926506868975, 0.000970345926932889, 0.000953940316720659, 0.000935019215715306, 
            0.000916338190655036, 0.000897898070802597, 0.000879699554028418, 0.000861743209230612, 0.000844029478804629, 
            0.000826558681158682, 0.000809331013271563, 0.000792346553289499, 0.000775605263158302, 0.000761451653828988, 
            0.000747476395238468, 0.000733679267325115, 0.00072005999276668, 0.000706618238254284, 0.000691121466931905, 
            0.000675865758779881, 0.000660850328629132, 0.000646074296812397, 0.000631536691974728, 0.000621293211501341, 
            0.00061117049363798, 0.00060116810414716, 0.000591285587384277, 0.000581522466820616, 0.000571861817310211, 0.000562319801897087, 
            0.000552895887446886, 0.000543589521840232, 0.000534400134490611, 0.000528929733844705, 0.000523501228176385, 
            0.000518114485796673, 0.000512769372805514, 0.000507465753131636, 0.00050395814925182, 0.000500468848875863, 
            0.000496997810019439, 0.000493544990299097, 0.00049011034693732, 0.000486693836767721, 0.000483295416240149, 
            0.000479915041425788, 0.000476552668022308, 0.000473208251358857, 0.000469881746401192, 0.000466573107756711, 
            0.000463282289679482, 0.000460009246075317, 0.000456753930506699, 0.00045354564867226, 0.000450354784931812, 
            0.000447181291459986, 0.000444025120128733, 0.000440886222512039, 0.000434645701905218, 0.000428473905255092, 
            0.000422370435449004, 0.000416334890983075, 0.000410366866112451, 0.000405938369149924, 0.000401547406117719, 
            0.000397193801400471, 0.000392877378211912, 0.000388597958629119, 0.000381538424241221, 0.000374580527340014, 
            0.000367723424770058, 0.000360966265885889, 0.000354308192971597, 0.000347748341654746, 0.000341285841314547, 
            0.000334919815484216, 0.000328649382247435, 0.000322473654628846, 0.000317579012067272, 0.000312744343408067, 
            0.000307969187485762, 0.000303253081510077, 0.000298595561187182, 0.000292858201923241, 0.000287210675481837, 
            0.000281652067156386, 0.000276181459877398, 0.000270797934553135, 0.00026760489841411, 0.000264442744815012, 
            0.000261311274246383, 0.000258210287064037, 0.000255139583513768, 0.000252088516426495, 0.000249067490475503, 
            0.000246076305090447, 0.000243114759666906, 0.00024018265358997, 0.000238237451056744, 0.000236305253202554, 
            0.000234386000404172, 0.000232479633047726, 0.000230586091531639, 0.000228715139878081, 0.000226856792322167, 
            0.000225010989642888, 0.000223177672648404, 0.000221356782178773, 0.000219557827748466, 0.00021777108038923, 
            0.000215996481401608, 0.000214233972133642, 0.000212483493983382, 0.000210754305525578, 0.000209036931326736, 
            0.000207331313318928, 0.000205637393498578, 0.000203955113928774, 0.00020145791577354, 0.000198986509340192, 
            0.000196540700444268, 0.000194120295303128, 0.000191725100552513, 0.000188573275453522, 0.000185465405864665, 
            0.00018240103776468, 0.000179379718694915, 0.000176400997821639, 0.000171999604147347, 0.000167691955108035, 
            0.000163476545573394, 0.000159351879988435, 0.000155316472781493, 0.000150723057775062, 0.000146246647782878, 
            0.000141884942334478, 0.000137635662408205, 0.000133496551114742, 0.000128318901519465, 0.000123315776183498, 
            0.000118482528427932, 0.000113814579052896, 0.000109307418026678, 0.000104956606014599, 0.000100757775752556, 
            9.6706633270012e-05, 9.27989589673052e-05, 8.90306085523077e-05, 8.53876340648015e-05, 8.18765294212416e-05, 
            7.84933605087723e-05, 7.52342710833543e-05, 7.20954831063148e-05, 6.90690816139135e-05, 6.61559310042801e-05, 
            6.33524790546956e-05, 6.06552521279411e-05, 5.80608550047865e-05, 5.55623988641421e-05, 5.3160454779558e-05, 
            5.08518516669142e-05, 4.86334954919837e-05, 4.65023687087689e-05, 4.44555296299276e-05, 4.24901117335829e-05, 
            4.06033229106331e-05, 3.87924446565802e-05, 3.70548312118615e-05, 3.53879086544546e-05, 3.37891739485196e-05, 
            3.22561939526686e-05, 3.07866043913422e-05, 2.93781087927133e-05, 2.81732695949475e-05, 2.70135712605532e-05, 
            2.58975252686387e-05, 2.48236829262582e-05, 2.37906347150818e-05, 2.29204332912078e-05, 2.20794404551397e-05, 
            2.12667863666895e-05, 2.04816226034311e-05, 1.97231218105089e-05, 1.89904773490067e-05, 1.82829029432339e-05, 
            1.7599632327293e-05, 1.69399188912817e-05, 1.63030353274425e-05, 1.57732743932942e-05, 1.52594108602248e-05, 
            1.47610166270276e-05, 1.42776733695608e-05, 1.38089723781913e-05, 1.34289034551619e-05, 1.30585167126758e-05, 
            1.26975899317378e-05, 1.23459052558747e-05, 1.2003249127058e-05, 1.17350746750244e-05, 1.14724544760687e-05, 
            1.12152845977285e-05, 1.09634627811181e-05, 1.07168884203926e-05, 1.04763933145757e-05, 1.02409141868348e-05, 
            1.00103561379264e-05))), class = "BchronCalibratedDates"))
})

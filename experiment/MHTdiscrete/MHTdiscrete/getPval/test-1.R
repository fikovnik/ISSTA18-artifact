library(testthat)

.Random.seed <<- .ext.seed

test_that("getPval", {
    df <- structure(list(X1 = c(4, 2, 2, 13, 6, 8, 4, 0, 1), N1 = c(148, 148, 148, 148, 148, 148, 148, 148, 148), X2 = c(0, 
        0, 1, 3, 2, 1, 2, 2, 2), N2 = c(132, 132, 132, 132, 132, 132, 132, 132, 132)), row.names = c(NA, -9L), class = "data.frame")
    expect_equal(MHTdiscrete:::getPval(raw.data = df, test.type = "FET", alternative = "two.sided"), list(available.pvalue = c(0.124766905269975, 
        0.499846390168971, 1, 0.020893303873687, 0.288492981095148, 0.0387817374374913, 0.687232293648223, 0.221351766513057, 
        0.60329542817359), attainable.pvalue = list(c(0.048204933698984, 0.124766905269975, 0.345986445966087, 0.624777625203901, 
        1), c(0.221351766513057, 0.499846390168971, 1), c(0.103509818873012, 0.249769585253456, 0.60329542817359, 1), c(3.57331269171371e-06, 
        2.83593962851402e-05, 0.000100680801874696, 0.000494276354877076, 0.00116999118252526, 0.00405586902450166, 0.00792466764554616, 
        0.020893303873687, 0.0360863984584138, 0.0760650803602378, 0.119459572000582, 0.209105200323504, 0.302355931676319, 
        0.453605862554486, 0.607399170941243, 0.803262390783474, 1), c(0.00217385590269568, 0.00773371914717815, 0.0283244822575117, 
        0.0699643091098059, 0.154043258477001, 0.288492981095148, 0.481808360742558, 0.726262401866462, 1), c(0.000991022543875974, 
        0.00385271686088901, 0.0144982170902664, 0.0387817374374913, 0.0888581705164826, 0.179103309962907, 0.314495147546846, 
        0.507272323359631, 0.739144171190393, 1), c(0.010324366300536, 0.031095962065883, 0.103285231946796, 0.218327916185641, 
        0.425590077757795, 0.687232293648223, 1), c(0.221351766513057, 0.499846390168971, 1), c(0.103509818873012, 0.249769585253456, 
        0.60329542817359, 1))))
})

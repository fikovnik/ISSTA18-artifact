library(testthat)

.Random.seed <<- .ext.seed

test_that("adjust.range", {
    x <- structure(c(0.829612086992711, 0.874150826595724, -0.427720930427313, 0.660895252134651, 0.283491037786007, 0.0381918982602656, 
        0.473176629282534, -0.730666805524379, 0.313984580803663, 0.410129568073899, -0.0845164475031197, 0.438224503304809, 
        0.869344494305551, -0.489142351318151, -0.0754143549129367, 0.880029045511037, 0.956452856771648, -0.765025276690722, 
        -0.0500058368779719, 0.120665492489934, 0.808062774594873, -0.722579664550722, 0.977783457841724, 0.89333646511659, 
        -0.835124883800745, 0.0284235686995089, -0.219593065790832, 0.811476261820644, -0.10606074379757, 0.672008519992232, 
        0.475191235542297, 0.622110282536596, -0.22378343436867, 0.370339458808303, -0.992103322409093, 0.665832160506397, 
        -0.985331706237048, -0.584682054352015, 0.813202815596014, 0.223557286895812, -0.240881518926471, -0.128456830047071, 
        -0.925137934274971, 0.947079827543348, -0.136497502215207, 0.915153193287551, 0.775509811006486, 0.279957538936287, 
        0.941933220718056, 0.237676414661109, -0.333145577460527, -0.306503503583372, -0.20302917715162, 0.569385551381856, 
        -0.922127017751336, 0.497590772341937, 0.35455366037786, -0.657471339218318, -0.477824072353542, 0.0288258693180978, 
        0.351214549038559, 0.965634395834059, 0.519088535103947, 0.132976848166436, 0.699379437137395, -0.62105212919414, 
        -0.457426770590246, 0.656316970475018, 0.386409640777856, -0.518910520710051, -0.914022407960147, -0.719041811767966, 
        -0.567229169886559, -0.041202871594578, -0.605179315432906, 0.438711675349623, -0.984230522532016, -0.249020070768893, 
        0.0288154166191816, -0.996858891565353, 0.163208005018532, -0.684189583640546, -0.281943388283253, 0.291263756807894, 
        0.551646725274622, 0.127293683122844, -0.532593202777207, -0.820038967300206, -0.828775870148093, -0.389563261065632, 
        0.334853029344231, -0.999522206839174, -0.582860086113214, 0.866068254690617, 0.851289497222751, 0.468188602011651, 
        -0.333856033161283, 0.0301266596652567, 0.487949292641133, 0.238318480085582, 0.720448741404796, 0.685755773549949, 
        0.340517946304804, 0.501072464865855, 0.0893432331649478, 0.0291136958218688, 0.291825004104708, 0.542857269353109, 
        -0.200722691332842, 0.196694557961549, -0.0295804343755499, 0.210563771783308, 0.813942222515925, 0.379233922582317, 
        -0.0670418810205121, 0.904705384147481, 0.948386879201854, 0.689114283845477, 0.094573440550931, 0.0866479773645246, 
        0.548653553829179, 0.513102732961163, 1.01841230662887, 0.70269770412977, 0.643150690085822, 0.058907549025784, 0.125038988326876, 
        0.704870482352423, -0.0773287483660741, 0.341617361077365, 0.377077411316708, 0.412813347390966, 0.0589230484137955, 
        0.125061660996518, 0.864836112819109, 0.504532155768656, 0.94916458674136, 0.323577434048101, 0.754633452150401, 
        0.132155171575041, 0.197235543753751, -0.0311162351197253, 0.920915053507192, 1.03607124537854, -0.0924473198337996, 
        0.751426108496618, 0.488241598881939, -0.0675451763429768, 0.895236447616406, 0.121810512051079, 0.231082513341358, 
        0.198419506425654, -0.0591000179091208, 0.509048096289695, 0.783640895991191, 0.258147957965452, 0.0834827099004533, 
        0.420033544698032, 0.247135147570673, 0.0127470265416447, 0.120842404369618, 0.94325705921201, 0.220909383691695, 
        -0.032738870920511, 0.323021689099138, 0.347472374489193, 0.157974224664841, 0.700941065767986, 0.0131007873670999, 
        0.282993750359437, 0.686074455521636, 0.369977552926879, 0.334219169789896, -0.0979662368607645, 0.36605974239737, 
        0.149642045945491, 0.907342560838696, -0.140456788896166, -0.121644466801062, 1.0116792938047, 0.0833989123444828, 
        0.418827651006876, 0.0794983626031761, 0.197123540367844, 0.448299683803834, -0.0935076950776033, 0.271923563619465, 
        0.792613747982759, 0.639896484883098, 0.14651258587819, 0.103515821437299, 0.910276740174009, 0.29525747949543, 0.747129733874028, 
        0.683306923175973, 0.330539169390444, 0.0633605667127892, -0.0424092876374867, 0.307780769844192, -0.0488411433667891), 
        .Dim = c(100L, 2L), .Dimnames = list(NULL, c("x", "")))
    expect_equal(princurve:::adjust.range(x = x[, 1], fact = 1.4), c(-1.39498333977535, 1.3732445907779))
})

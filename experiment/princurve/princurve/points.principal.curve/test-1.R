library(testthat)

.Random.seed <<- .ext.seed

test_that("points.principal.curve", {
    principal.curve <- princurve::principal.curve
    x <- structure(c(0.829612086992711, 0.874150826595724, -0.427720930427313, 0.660895252134651, 0.283491037786007, 0.0381918982602656, 
        0.473176629282534, -0.730666805524379, 0.313984580803663, 0.410129568073899, -0.0845164475031197, 0.438224503304809, 
        0.869344494305551, -0.489142351318151, -0.0754143549129367, 0.880029045511037, 0.956452856771648, -0.765025276690722, 
        -0.0500058368779719, 0.120665492489934, 0.808062774594873, -0.722579664550722, 0.977783457841724, 0.89333646511659, 
        -0.835124883800745, 0.0284235686995089, -0.219593065790832, 0.811476261820644, -0.10606074379757, 0.672008519992232, 
        0.475191235542297, 0.622110282536596, -0.22378343436867, 0.370339458808303, -0.992103322409093, 0.665832160506397, 
        -0.985331706237048, -0.584682054352015, 0.813202815596014, 0.223557286895812, -0.240881518926471, -0.128456830047071, 
        -0.925137934274971, 0.947079827543348, -0.136497502215207, 0.915153193287551, 0.775509811006486, 0.279957538936287, 
        0.941933220718056, 0.237676414661109, -0.333145577460527, -0.306503503583372, -0.20302917715162, 0.569385551381856, 
        -0.922127017751336, 0.497590772341937, 0.35455366037786, -0.657471339218318, -0.477824072353542, 0.0288258693180978, 
        0.351214549038559, 0.965634395834059, 0.519088535103947, 0.132976848166436, 0.699379437137395, -0.62105212919414, 
        -0.457426770590246, 0.656316970475018, 0.386409640777856, -0.518910520710051, -0.914022407960147, -0.719041811767966, 
        -0.567229169886559, -0.041202871594578, -0.605179315432906, 0.438711675349623, -0.984230522532016, -0.249020070768893, 
        0.0288154166191816, -0.996858891565353, 0.163208005018532, -0.684189583640546, -0.281943388283253, 0.291263756807894, 
        0.551646725274622, 0.127293683122844, -0.532593202777207, -0.820038967300206, -0.828775870148093, -0.389563261065632, 
        0.334853029344231, -0.999522206839174, -0.582860086113214, 0.866068254690617, 0.851289497222751, 0.468188602011651, 
        -0.333856033161283, 0.0301266596652567, 0.487949292641133, 0.238318480085582, 0.720448741404796, 0.685755773549949, 
        0.340517946304804, 0.501072464865855, 0.0893432331649478, 0.0291136958218688, 0.291825004104708, 0.542857269353109, 
        -0.200722691332842, 0.196694557961549, -0.0295804343755499, 0.210563771783308, 0.813942222515925, 0.379233922582317, 
        -0.0670418810205121, 0.904705384147481, 0.948386879201854, 0.689114283845477, 0.094573440550931, 0.0866479773645246, 
        0.548653553829179, 0.513102732961163, 1.01841230662887, 0.70269770412977, 0.643150690085822, 0.058907549025784, 0.125038988326876, 
        0.704870482352423, -0.0773287483660741, 0.341617361077365, 0.377077411316708, 0.412813347390966, 0.0589230484137955, 
        0.125061660996518, 0.864836112819109, 0.504532155768656, 0.94916458674136, 0.323577434048101, 0.754633452150401, 
        0.132155171575041, 0.197235543753751, -0.0311162351197253, 0.920915053507192, 1.03607124537854, -0.0924473198337996, 
        0.751426108496618, 0.488241598881939, -0.0675451763429768, 0.895236447616406, 0.121810512051079, 0.231082513341358, 
        0.198419506425654, -0.0591000179091208, 0.509048096289695, 0.783640895991191, 0.258147957965452, 0.0834827099004533, 
        0.420033544698032, 0.247135147570673, 0.0127470265416447, 0.120842404369618, 0.94325705921201, 0.220909383691695, 
        -0.032738870920511, 0.323021689099138, 0.347472374489193, 0.157974224664841, 0.700941065767986, 0.0131007873670999, 
        0.282993750359437, 0.686074455521636, 0.369977552926879, 0.334219169789896, -0.0979662368607645, 0.36605974239737, 
        0.149642045945491, 0.907342560838696, -0.140456788896166, -0.121644466801062, 1.0116792938047, 0.0833989123444828, 
        0.418827651006876, 0.0794983626031761, 0.197123540367844, 0.448299683803834, -0.0935076950776033, 0.271923563619465, 
        0.792613747982759, 0.639896484883098, 0.14651258587819, 0.103515821437299, 0.910276740174009, 0.29525747949543, 0.747129733874028, 
        0.683306923175973, 0.330539169390444, 0.0633605667127892, -0.0424092876374867, 0.307780769844192, -0.0488411433667891), 
        .Dim = c(100L, 2L), .Dimnames = list(NULL, c("x", "")))
    fit1 <- structure(list(s = structure(c(0.835509759283527, 0.832091338501987, -0.502797078186295, 0.683759366026209, 0.287104326495805, 
        0.0396362869984418, 0.503350971467541, -0.741752267221996, 0.212085932672766, 0.42184007770674, -0.0776861448929986, 
        0.444207418003869, 0.886805061024653, -0.556466994026714, -0.0642191945741602, 0.928452848510326, 0.965525301016238, 
        -0.823063677991432, -0.0630881095060513, 0.140448993793862, 0.752410494141848, -0.724553999664647, 1.00032892539739, 
        0.844454073270256, -0.823330248889937, 0.0308787051078837, -0.247866542807686, 0.823696322511503, -0.088138909540829, 
        0.611806528018051, 0.549422007631219, 0.627181513609752, -0.22381165708319, 0.362603745456984, -0.969823673072441, 
        0.687035998482411, -1.00575023377362, -0.574746292879734, 0.846326279162014, 0.258646388148363, -0.301724080631773, 
        -0.114301854332743, -0.976280022267883, 1.0005748352658, -0.105492515927473, 0.871138063586687, 0.714897539612707, 
        0.224954274235065, 0.939427800808551, 0.265262555149637, -0.386753258538206, -0.351058102765273, -0.165233961028709, 
        0.65515520300178, -0.913456376302911, 0.498146964330796, 0.333486428717213, -0.654352225279748, -0.482588651767813, 
        0.0292545502145563, 0.348740598517386, 0.965527157407583, 0.490055255922732, 0.121668426196376, 0.613264186447111, 
        -0.602833361549276, -0.426991107991441, 0.778111825045739, 0.323408638440634, -0.52228822663842, -0.866872805854011, 
        -0.655044533929503, -0.571884844874999, -0.0306844461473585, -0.60514353627567, 0.414518190346996, -0.986692666382041, 
        -0.176343738087721, 0.0280092331159153, -1.03696369028962, 0.181385440896753, -0.664053994149054, -0.277383383973806, 
        0.345288334019398, 0.617509097226551, 0.105944724396558, -0.523701748325974, -0.887936594269288, -0.819938555289812, 
        -0.38123646024884, 0.329966173381283, -0.992272721915346, -0.560115414191216, 0.856806267535844, 0.824889974985889, 
        0.521083661740311, -0.306747724265999, 0.0283720518312601, 0.518717372460399, 0.201351068573864, 0.71689917130176, 
        0.71123157331902, 0.260700007775021, 0.484904632467305, 0.0833438416635418, 0.00285261479807879, 0.263081136977719, 
        0.535023079013025, 0.0446266494996466, 0.183461076220904, 0.00978808731762073, 0.204323230083021, 0.803998264467219, 
        0.313663470144594, 0.00756273439243979, 0.877127608569149, 0.943313711773625, 0.650580372605832, 0.00739300378896426, 
        0.0198690656383159, 0.584944775785746, 0.511624002849475, 1.00587050431135, 0.731779978660152, 0.650981869108513, 
        0.0023752253759031, 0.071126204465925, 0.697427227498384, 0.0118609624784211, 0.389111562105548, 0.314458553706887, 
        0.408922786227198, 0.0588637282482437, 0.1348938479675, 0.878723578966491, 0.489538341952834, 0.936482059907561, 
        0.332900120834935, 0.734926839897395, 0.0670897181123467, 0.102393898154692, 0.0182847887753014, 0.889081571963086, 
        1.00631255847123, 0.0157606374705918, 0.776979002423574, 0.52930230087015, 0.0505936016986596, 0.896645096060211, 
        0.0706577453587042, 0.1615650375521, 0.135134432542166, 0.0339449642107875, 0.445805686858216, 0.789093740170881, 
        0.257618145631921, 0.113001964180571, 0.422640543609391, 0.241895429195177, 0.002305845680331, 0.123986772360832, 
        0.943317031585018, 0.24912450877709, 0.0149642402618903, 0.390959238947858, 0.363458010160284, 0.193830084859802, 
        0.624594890787515, 0.106112026850362, 0.279563148404561, 0.7166485808096, 0.423468826134237, 0.32985056788887, 0.0036982102151871, 
        0.366090952626929, 0.176981787643668, 0.905809971550191, 0.0384578199757058, 0.00225639195606736, 0.986803241246319, 
        0.0326264614032497, 0.43476901307835, 0.0874562338907069, 0.121424729579433, 0.396339939383896, 0.0115492090647069, 
        0.28095481386357, 0.749171718918669, 0.645873659219425, 0.157310808881964, 0.110554764534748, 0.914784201343147, 
        0.317409492343649, 0.752575861484426, 0.699386920963886, 0.282342746852384, 0.105616664773525, 0.00227064006675237, 
        0.279745768964425, 0.0401682398502145), .Dim = c(100L, 2L), .Dimnames = list(NULL, c("x", ""))), tag = c(44L, 23L, 
        62L, 17L, 49L, 16L, 13L, 46L, 94L, 39L, 24L, 1L, 2L, 95L, 28L, 68L, 21L, 47L, 36L, 4L, 54L, 32L, 85L, 65L, 30L, 31L, 
        96L, 99L, 7L, 56L, 63L, 12L, 10L, 76L, 34L, 61L, 84L, 57L, 91L, 69L, 5L, 50L, 40L, 48L, 9L, 100L, 81L, 20L, 64L, 
        86L, 6L, 26L, 60L, 98L, 79L, 74L, 19L, 15L, 11L, 29L, 45L, 42L, 53L, 78L, 33L, 27L, 83L, 41L, 97L, 52L, 90L, 51L, 
        67L, 59L, 3L, 70L, 87L, 14L, 93L, 73L, 38L, 66L, 75L, 58L, 72L, 82L, 22L, 8L, 89L, 18L, 25L, 71L, 88L, 55L, 35L, 
        43L, 77L, 92L, 37L, 80L), lambda = c(0.333194300249411, 0.339813006129991, 2.05926668074543, 0.610477732121209, 1.17866510538575, 
        1.44136066324441, 0.896591786748362, 2.42356061713645, 1.26313890406252, 1.01055703860978, 1.55912152412725, 0.979970646607223, 
        0.232111243780095, 2.13467157839182, 1.54547194733778, 0.147954014909188, 0.0720924721292416, 2.56486044490403, 1.54432819827917, 
        1.33898359077133, 0.489142423435935, 2.39452103772693, 0.000505849329001566, 0.315832296323286, 2.56534237797572, 
        1.45013124710355, 1.74067301737892, 0.355969623293257, 1.5697778415125, 0.730291853432851, 0.827579571295208, 0.705214016197719, 
        1.71367290904196, 1.08716602505313, 2.83614477045912, 0.604802559537991, 2.90416507225867, 2.16120851840589, 0.312170617671684, 
        1.2114407140323, 1.80296476462678, 1.59672804620962, 2.84835019809813, 0, 1.58756421606346, 0.263344164394479, 0.556249105459695, 
        1.24895445013897, 0.125562456323148, 1.20392376756319, 1.90659216215363, 1.86217526204252, 1.65001332172884, 0.658922811232205, 
        2.73026379885595, 0.90413671648452, 1.12360383348649, 2.28117864229802, 2.03166246596078, 1.45175688318204, 1.10480550184124, 
        0.0720886685340338, 0.915867769803932, 1.35839407843282, 0.727938413862898, 2.20271355456378, 1.95816849205786, 0.441891073932615, 
        1.13581194537988, 2.08639089395784, 2.64413369280549, 2.28225815293136, 2.15702669370193, 1.51171456771439, 2.206216309665, 
        1.02033411460293, 2.86805457604299, 1.66200469418807, 1.45300318189058, 2.96338078942063, 1.29610534630971, 2.29671030150587, 
        1.77440599491486, 1.10910459399864, 0.72108485969679, 1.37448436234478, 2.08837452101729, 2.68288208238319, 2.55921070660903, 
        1.89962556148018, 1.12789113843677, 2.87862215950051, 2.13990069418826, 0.291644582513985, 0.353675019905232, 0.870410481835943, 
        1.8089332837097, 1.45264008351704, 0.873923830538646, 1.27476278998006), dist = 0.464718274977039, converged = TRUE, 
        nbrOfIterations = 6L, call = principal.curve(x = x, plot.true = TRUE)), class = "principal.curve")
    expect_equal(princurve:::points.principal.curve(x = fit1), NULL)
})

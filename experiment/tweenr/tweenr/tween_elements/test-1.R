library(testthat)

.Random.seed <<- .ext.seed

test_that("tween_elements", {
    data <- structure(list(x = c(1, 2, 2, 1, 2, 2), y = c(1, 2, 2, 2, 1, 1), time = c(1, 4, 10, 4, 8, 10), group = c(1, 1, 
        1, 2, 2, 2), ease = structure(c(1L, 1L, 1L, 1L, 1L, 1L), .Label = "cubic-in-out", class = "factor")), row.names = c(NA, 
        -6L), class = "data.frame")
    expect_equal(tweenr:::tween_elements(data = data, time = "time", group = "group", ease = "ease", nframes = 100), structure(list(x = c(1, 
        1.00011130589643, 1.00089044717144, 1.00300525920361, 1.00712357737151, 1.01391323705373, 1.02404207362885, 1.03817792247544, 
        1.05698861897209, 1.08114199849737, 1.11130589642986, 1.14814814814815, 1.1923365890308, 1.24453905445641, 1.30542337980355, 
        1.37565740045079, 1.45590895177672, 1.54409104822328, 1.62434259954921, 1.69457662019645, 1.75546094554359, 1.8076634109692, 
        1.85185185185185, 1.88869410357014, 1.91885800150263, 1.94301138102791, 1.96182207752456, 1.97595792637115, 1.98608676294627, 
        1.99287642262849, 1.99699474079639, 1.99910955282856, 1.99988869410357, 2, 1, 2, 1.0000438957476, 2, 1.0003511659808, 
        2, 1.00118518518519, 2, 1.00280932784636, 2, 1.00548696844993, 2, 1.00948148148148, 2, 1.01505624142661, 2, 1.02247462277092, 
        2, 1.032, 2, 1.04389574759945, 2, 1.05842524005487, 2, 1.07585185185185, 2, 1.09643895747599, 2, 1.12044993141289, 
        2, 1.14814814814815, 2, 1.17979698216735, 2, 1.2156598079561, 2, 1.256, 2, 1.30108093278464, 2, 1.35116598079561, 
        2, 1.40651851851852, 2, 1.46740192043896, 2, 1.53259807956104, 2, 1.59348148148148, 2, 1.64883401920439, 2, 1.69891906721536, 
        2, 1.744, 2, 1.7843401920439, 2, 1.82020301783265, 2, 1.85185185185185, 2, 1.87955006858711, 2, 1.90356104252401, 
        2, 1.92414814814815, 2, 1.94157475994513, 2, 1.95610425240055, 2, 1.968, 2, 1.97752537722908, 2, 1.98494375857339, 
        2, 1.99051851851852, 2, 1.99451303155007, 2, 1.99719067215364, 2, 1.99881481481481, 2, 1.9996488340192, 2, 1.9999561042524, 
        2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 
        2, 2, 2, 2, 2, 2, 2, 2), y = c(1, 1.00011130589643, 1.00089044717144, 1.00300525920361, 1.00712357737151, 1.01391323705373, 
        1.02404207362885, 1.03817792247544, 1.05698861897209, 1.08114199849737, 1.11130589642986, 1.14814814814815, 1.1923365890308, 
        1.24453905445641, 1.30542337980355, 1.37565740045079, 1.45590895177672, 1.54409104822328, 1.62434259954921, 1.69457662019645, 
        1.75546094554359, 1.8076634109692, 1.85185185185185, 1.88869410357014, 1.91885800150263, 1.94301138102791, 1.96182207752456, 
        1.97595792637115, 1.98608676294627, 1.99287642262849, 1.99699474079639, 1.99910955282856, 1.99988869410357, 2, 2, 
        2, 1.9999561042524, 2, 1.9996488340192, 2, 1.99881481481481, 2, 1.99719067215364, 2, 1.99451303155007, 2, 1.99051851851852, 
        2, 1.98494375857339, 2, 1.97752537722908, 2, 1.968, 2, 1.95610425240055, 2, 1.94157475994513, 2, 1.92414814814815, 
        2, 1.90356104252401, 2, 1.87955006858711, 2, 1.85185185185185, 2, 1.82020301783265, 2, 1.7843401920439, 2, 1.744, 
        2, 1.69891906721536, 2, 1.64883401920439, 2, 1.59348148148148, 2, 1.53259807956104, 2, 1.46740192043896, 2, 1.40651851851852, 
        2, 1.35116598079561, 2, 1.30108093278464, 2, 1.256, 2, 1.2156598079561, 2, 1.17979698216735, 2, 1.14814814814815, 
        2, 1.12044993141289, 2, 1.09643895747599, 2, 1.07585185185185, 2, 1.05842524005487, 2, 1.04389574759945, 2, 1.032, 
        2, 1.02247462277092, 2, 1.01505624142661, 2, 1.00948148148148, 2, 1.00548696844993, 2, 1.00280932784636, 2, 1.00118518518519, 
        2, 1.0003511659808, 2, 1.0000438957476, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 
        1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1), time = c(1, 1.00033391768929, 1.00267134151432, 1.00901577761082, 
        1.02137073211453, 1.0417397111612, 1.07212622088655, 1.11453376742633, 1.17096585691627, 1.24342599549211, 1.33391768928959, 
        1.44444444444444, 1.57700976709241, 1.73361716336923, 1.91627013941064, 2.12697220135237, 2.36772685533016, 2.63227314466984, 
        2.87302779864763, 3.08372986058937, 3.26638283663077, 3.42299023290759, 3.55555555555556, 3.66608231071041, 3.75657400450789, 
        3.82903414308373, 3.88546623257367, 3.92787377911345, 3.9582602888388, 3.97862926788547, 3.99098422238918, 3.99732865848568, 
        3.99966608231071, 4, 4, 4.0000797970495, 4.0001755829904, 4.00063837639603, 4.00140466392318, 4.00215452033661, 4.00474074074074, 
        4.00510701116826, 4.01123731138546, 4.00997463118801, 4.02194787379973, 4.01723616269288, 4.03792592592593, 4.0273703879799, 
        4.06022496570645, 4.0408560893461, 4.08989849108368, 4.05817204908849, 4.128, 4.07979704950409, 4.17558299039781, 
        4.10620987288995, 4.23370096021948, 4.13788930154308, 4.30340740740741, 4.1753141177605, 4.38575582990398, 4.21896310383924, 
        4.48179972565158, 4.26931504207632, 4.59259259259259, 4.32684871476877, 4.71918792866941, 4.39204290421362, 4.86263923182442, 
        4.46537639270788, 5.024, 4.54732796254858, 5.20432373113855, 4.63837639603276, 5.40466392318244, 4.73900047545742, 
        5.62607407407407, 4.8496789831196, 5.86960768175583, 4.97089070131632, 6.13039231824417, 5.1031144123446, 6.37392592592593, 
        5.24682889850148, 6.59533607681756, 5.40251294208397, 6.79567626886145, 5.57064532538909, 6.976, 5.75170483071388, 
        7.13736076817558, 5.94617024035536, 7.28081207133059, 6.15452033661055, 7.40740740740741, 6.37723390177648, 7.51820027434842, 
        6.61478971815017, 7.61424417009602, 6.86766656802865, 7.69659259259259, 7.13233343197135, 7.76629903978052, 7.38521028184983, 
        7.82441700960219, 7.62276609822352, 7.872, 7.84547966338945, 7.91010150891632, 8.05382975964464, 7.93977503429355, 
        8.24829516928612, 7.96207407407407, 8.42935467461091, 7.97805212620027, 8.59748705791603, 7.98876268861454, 8.75317110149852, 
        7.99525925925926, 8.8968855876554, 7.99859533607682, 9.02910929868368, 7.9998244170096, 9.1503210168804, 8, 9.26099952454258, 
        8.0007513148009, 9.36162360396724, 8.00601051840721, 9.45267203745141, 8.02028549962434, 9.53462360729212, 8.0480841472577, 
        9.60795709578638, 8.0939143501127, 9.67315128523123, 8.16228399699474, 9.73068495792368, 8.25770097670924, 9.78103689616076, 
        8.38467317806161, 9.8246858822395, 8.54770848985725, 9.86211069845692, 8.75131480090158, 9.89379012711005, 9, 9.92020295049591, 
        9.24868519909842, 9.94182795091151, 9.45229151014275, 9.9591439106539, 9.61532682193839, 9.9726296120201, 9.74229902329076, 
        9.98276383730711, 9.83771600300526, 9.99002536881199, 9.9060856498873, 9.99489298883174, 9.9519158527423, 9.99784547966339, 
        9.97971450037566, 9.99936162360397, 9.99398948159279, 9.99992020295049, 9.9992486851991, 10, 10), .frame = c(0L, 
        1L, 2L, 3L, 4L, 5L, 6L, 7L, 8L, 9L, 10L, 11L, 12L, 13L, 14L, 15L, 16L, 17L, 18L, 19L, 20L, 21L, 22L, 23L, 24L, 25L, 
        26L, 27L, 28L, 29L, 30L, 31L, 32L, 33L, 33L, 34L, 34L, 35L, 35L, 36L, 36L, 37L, 37L, 38L, 38L, 39L, 39L, 40L, 40L, 
        41L, 41L, 42L, 42L, 43L, 43L, 44L, 44L, 45L, 45L, 46L, 46L, 47L, 47L, 48L, 48L, 49L, 49L, 50L, 50L, 51L, 51L, 52L, 
        52L, 53L, 53L, 54L, 54L, 55L, 55L, 56L, 56L, 57L, 57L, 58L, 58L, 59L, 59L, 60L, 60L, 61L, 61L, 62L, 62L, 63L, 63L, 
        64L, 64L, 65L, 65L, 66L, 66L, 67L, 67L, 68L, 68L, 69L, 69L, 70L, 70L, 71L, 71L, 72L, 72L, 73L, 73L, 74L, 74L, 75L, 
        75L, 76L, 76L, 77L, 77L, 78L, 78L, 79L, 79L, 80L, 80L, 81L, 81L, 82L, 82L, 83L, 83L, 84L, 84L, 85L, 85L, 86L, 86L, 
        87L, 87L, 88L, 88L, 89L, 89L, 90L, 90L, 91L, 91L, 92L, 92L, 93L, 93L, 94L, 94L, 95L, 95L, 96L, 96L, 97L, 97L, 98L, 
        98L, 99L, 99L, 100L, 100L), .group = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
        1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 
        1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 
        2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 
        1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 
        2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 
        1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L), .Label = c("1", "2"), class = "factor")), framelength = 0.09, row.names = c(1L, 
        2L, 3L, 4L, 5L, 6L, 7L, 8L, 9L, 10L, 11L, 12L, 13L, 14L, 15L, 16L, 17L, 18L, 19L, 20L, 21L, 22L, 23L, 24L, 25L, 26L, 
        27L, 28L, 29L, 30L, 31L, 32L, 33L, 34L, 102L, 35L, 103L, 36L, 104L, 37L, 105L, 38L, 106L, 39L, 107L, 40L, 108L, 41L, 
        109L, 42L, 110L, 43L, 111L, 44L, 112L, 45L, 113L, 46L, 114L, 47L, 115L, 48L, 116L, 49L, 117L, 50L, 118L, 51L, 119L, 
        52L, 120L, 53L, 121L, 54L, 122L, 55L, 123L, 56L, 124L, 57L, 125L, 58L, 126L, 59L, 127L, 60L, 128L, 61L, 129L, 62L, 
        130L, 63L, 131L, 64L, 132L, 65L, 133L, 66L, 134L, 67L, 135L, 68L, 136L, 69L, 137L, 70L, 138L, 71L, 139L, 72L, 140L, 
        73L, 141L, 74L, 142L, 75L, 143L, 76L, 144L, 77L, 145L, 78L, 146L, 79L, 147L, 80L, 148L, 81L, 149L, 82L, 150L, 83L, 
        151L, 84L, 152L, 85L, 153L, 86L, 154L, 87L, 155L, 88L, 156L, 89L, 157L, 90L, 158L, 91L, 159L, 92L, 160L, 93L, 161L, 
        94L, 162L, 95L, 163L, 96L, 164L, 97L, 165L, 98L, 166L, 99L, 167L, 100L, 168L, 101L, 169L), class = "data.frame"))
})

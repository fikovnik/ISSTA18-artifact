library(testthat)

.Random.seed <<- .ext.seed

test_that("summary.MIresult", {
    vars <- list(structure(c(0.0699402684940178, -0.015199020222879, -0.0699402684940177, 0.015199020222879, -0.015199020222879, 
        0.00390962793936289, 0.015199020222879, -0.00390962793936289, -0.0699402684940177, 0.015199020222879, 0.121518135774347, 
        -0.0266612051737956, 0.015199020222879, -0.00390962793936289, -0.0266612051737956, 0.00696909030845147), .Dim = c(4L, 
        4L), .Dimnames = list(c("(Intercept)", "wave", "sex", "wave:sex"), c("(Intercept)", "wave", "sex", "wave:sex"))), 
        structure(c(0.0678529256118354, -0.0147413112597355, -0.0678529256118354, 0.0147413112597355, -0.0147413112597355, 
            0.00378786793683506, 0.0147413112597356, -0.00378786793683506, -0.0678529256118354, 0.0147413112597356, 0.11803627818082, 
            -0.0259374915259236, 0.0147413112597355, -0.00378786793683506, -0.0259374915259236, 0.00679948076526904), .Dim = c(4L, 
            4L), .Dimnames = list(c("(Intercept)", "wave", "sex", "wave:sex"), c("(Intercept)", "wave", "sex", "wave:sex"))), 
        structure(c(0.0688733512788814, -0.0149645273187124, -0.0688733512788815, 0.0149645273187124, -0.0149645273187124, 
            0.00384703360916432, 0.0149645273187124, -0.00384703360916432, -0.0688733512788815, 0.0149645273187124, 0.119585856154986, 
            -0.026272809747017, 0.0149645273187124, -0.00384703360916432, -0.026272809747017, 0.00688662140968688), .Dim = c(4L, 
            4L), .Dimnames = list(c("(Intercept)", "wave", "sex", "wave:sex"), c("(Intercept)", "wave", "sex", "wave:sex"))), 
        structure(c(0.0690080088146176, -0.0148961431458811, -0.0690080088146177, 0.0148961431458811, -0.0148961431458811, 
            0.00377844754198377, 0.0148961431458811, -0.00377844754198377, -0.0690080088146177, 0.0148961431458811, 0.122340413072584, 
            -0.0267212338610573, 0.0148961431458811, -0.00377844754198377, -0.0267212338610573, 0.00692369009416468), .Dim = c(4L, 
            4L), .Dimnames = list(c("(Intercept)", "wave", "sex", "wave:sex"), c("(Intercept)", "wave", "sex", "wave:sex"))), 
        structure(c(0.0705190417066769, -0.0152479967547336, -0.0705190417066769, 0.0152479967547336, -0.0152479967547336, 
            0.00388358160705992, 0.0152479967547336, -0.00388358160705992, -0.0705190417066769, 0.0152479967547336, 0.122342675737298, 
            -0.0267476546257151, 0.0152479967547336, -0.00388358160705992, -0.0267476546257151, 0.00694231685715342), .Dim = c(4L, 
            4L), .Dimnames = list(c("(Intercept)", "wave", "sex", "wave:sex"), c("(Intercept)", "wave", "sex", "wave:sex"))))
    MIcombine <- mitools::MIcombine
    beta <- list(structure(c(-2.23752830576171, 0.221803996306467, 0.611376185272804, -0.0115158899004625), names = c("(Intercept)", 
        "wave", "sex", "wave:sex")), structure(c(-2.21336829914334, 0.232043311397303, 0.683393740805985, -0.0452223680655128), 
        names = c("(Intercept)", "wave", "sex", "wave:sex")), structure(c(-2.22537030144372, 0.226976051862508, 0.679079085756646, 
        -0.0427054321296021), names = c("(Intercept)", "wave", "sex", "wave:sex")), structure(c(-2.31572490418833, 0.271419352625445, 
        0.630906279617909, -0.0641552180695838), names = c("(Intercept)", "wave", "sex", "wave:sex")), structure(c(-2.30672606808375, 
        0.250519766924962, 0.64050580735107, -0.0226721694888271), names = c("(Intercept)", "wave", "sex", "wave:sex")))
    expect_equal(mitools:::summary.MIresult(object = MIcombine(beta, vars)), structure(list(results = c(-2.25974357572417, 
        0.240552495823337, 0.649052219760883, -0.0372542155307976), se = c(0.268307305609349, 0.0658742302786401, 0.349192636769194, 
        0.0860919884501264), `(lower` = c(-2.78584855308465, 0.110924605069497, -0.0353718663545267, -0.206231212335907), 
        `upper)` = c(-1.7336385983637, 0.370180386577177, 1.33347630587629, 0.131722781274312), missInfo = c("4 %", "12 %", 
            "1 %", "7 %")), row.names = c("(Intercept)", "wave", "sex", "wave:sex"), class = "data.frame"))
})

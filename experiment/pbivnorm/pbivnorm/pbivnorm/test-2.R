library(testthat)

.Random.seed <<- .ext.seed

test_that("pbivnorm", {
    y <- c(1.30486965422349, 2.28664539270111, -1.38886070111234, -0.278788766817371, -0.133321336393658, 0.635950398070074, 
        -0.284252921416072, -2.65645542090478, -2.44046692857552, 1.32011334573019)
    x <- c(1.37095844714667, -0.564698171396089, 0.363128411337339, 0.63286260496104, 0.404268323140999, -0.106124516091484, 
        1.51152199743894, -0.0946590384130976, 2.01842371387704, -0.062714099052421)
    rho <- 0.333427211269736
    expect_equal(pbivnorm:::pbivnorm(x = x, y = y, rho = rho), c(0.838660048516454, 0.285425805854088, 0.0698994691857158, 
        0.328313213283213, 0.342421734127443, 0.380692805143105, 0.377449870845498, 0.00326654585063415, 0.0073271626832339, 
        0.452139236602768))
})

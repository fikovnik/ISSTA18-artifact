library(testthat)

.Random.seed <<- .ext.seed

test_that("pbivnorm", {
    X <- structure(c(1.37095844714667, -0.564698171396089, 0.363128411337339, 0.63286260496104, 0.404268323140999, -0.106124516091484, 
        1.51152199743894, -0.0946590384130976, 2.01842371387704, -0.062714099052421, 1.30486965422349, 2.28664539270111, 
        -1.38886070111234, -0.278788766817371, -0.133321336393658, 0.635950398070074, -0.284252921416072, -2.65645542090478, 
        -2.44046692857552, 1.32011334573019), .Dim = c(10L, 2L), .Dimnames = list(NULL, c("x", "y")))
    rho <- c(0.379559240536764, 0.435771584976465, 0.0374310328625143, 0.973539913771674, 0.431751248892397, 0.957576596643776, 
        0.887754905503243, 0.639978769468144, 0.970966610359028, 0.618838207330555)
    expect_equal(pbivnorm:::pbivnorm(x = X, rho = rho), c(0.840756981999438, 0.285806457368272, 0.0550094207966833, 0.390202703026835, 
        0.357296056461997, 0.457546317597672, 0.388105456378074, 0.00390544714146169, 0.00733414447053502, 0.467789183982877))
})

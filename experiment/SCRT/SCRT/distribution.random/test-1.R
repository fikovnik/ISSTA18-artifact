library(testthat)

.Random.seed <<- .ext.seed

test_that("distribution.random", {
    ABAB <- structure(list(V1 = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 3L, 3L, 3L, 3L, 3L, 3L, 2L, 2L, 2L, 2L, 2L, 2L, 4L, 4L, 
        4L, 4L, 4L, 4L), .Label = c("A1", "A2", "B1", "B2"), class = "factor"), V2 = c(6L, 2L, 5L, 3L, 4L, 4L, 1L, 2L, 3L, 
        1L, 3L, 2L, 2L, 3L, 4L, 2L, 4L, 3L, 0L, 1L, 2L, 0L, 2L, 1L)), class = "data.frame", row.names = c(NA, -24L))
    expect_equal(SCRT:::distribution.random(design = "ABAB", statistic = "AA-BB", save = "no", number = 100, limit = 4, data = ABAB), 
        c(1.09090909090909, 1.18333333333333, 1.18333333333333, 1.24090909090909, 1.35, 1.39090909090909, 1.45, 1.45, 1.5, 
            1.5, 1.5, 1.58333333333333, 1.65476190476191, 1.65476190476191, 1.82142857142857, 1.87698412698413, 1.88333333333333, 
            2, 2.11363636363636, 2.16666666666667, 2.25, 2.29642857142857, 2.33333333333333, 2.40476190476191, 2.41363636363636, 
            2.44166666666667, 2.45, 2.49642857142857, 2.50454545454545, 2.53333333333333, 2.53928571428571, 2.54166666666667, 
            2.55, 2.58333333333333, 2.62142857142857, 2.625, 2.625, 2.64166666666667, 2.64166666666667, 2.64166666666667, 
            2.64166666666667, 2.65, 2.68571428571429, 2.71666666666667, 2.72857142857143, 2.73412698412698, 2.74285714285714, 
            2.74285714285714, 2.75, 2.84166666666667, 2.85, 2.85555555555556, 2.85555555555556, 2.86666666666667, 2.86666666666667, 
            2.86904761904762, 2.86904761904762, 2.87142857142857, 2.93333333333333, 2.95, 2.95, 2.95, 2.95833333333333, 2.95833333333333, 
            2.96666666666667, 2.96666666666667, 2.97619047619048, 3.06666666666667, 3.08333333333333, 3.08333333333333, 3.08571428571429, 
            3.16666666666667, 3.17857142857143, 3.21428571428571, 3.21428571428571, 3.21666666666667, 3.3, 3.375, 3.38333333333333, 
            3.38333333333333, 3.38333333333333, 3.5, 3.51984126984127, 3.53333333333333, 3.60476190476191, 3.60476190476191, 
            3.60476190476191, 3.675, 3.71428571428571, 3.71428571428571, 3.71428571428571, 3.75, 3.82142857142857, 3.82142857142857, 
            3.82142857142857, 3.82142857142857, 3.91666666666667, 4, 4.125, 4.2))
})

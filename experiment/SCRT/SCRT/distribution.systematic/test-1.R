library(testthat)

.Random.seed <<- .ext.seed

test_that("distribution.systematic", {
    ABAB <- structure(list(V1 = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 3L, 3L, 3L, 3L, 3L, 3L, 2L, 2L, 2L, 2L, 2L, 2L, 4L, 4L, 
        4L, 4L, 4L, 4L), .Label = c("A1", "A2", "B1", "B2"), class = "factor"), V2 = c(6L, 2L, 5L, 3L, 4L, 4L, 1L, 2L, 3L, 
        1L, 3L, 2L, 2L, 3L, 4L, 2L, 4L, 3L, 0L, 1L, 2L, 0L, 2L, 1L)), class = "data.frame", row.names = c(NA, -24L))
    expect_equal(SCRT:::distribution.systematic(design = "ABAB", statistic = "AA-BB", save = "no", limit = 4, data = ABAB), 
        c(1, 1.05, 1.09090909090909, 1.18333333333333, 1.2, 1.24090909090909, 1.35, 1.39090909090909, 1.45, 1.5, 1.5, 1.5, 
            1.55357142857143, 1.58333333333333, 1.625, 1.65476190476191, 1.68333333333333, 1.68333333333333, 1.8, 1.82142857142857, 
            1.85357142857143, 1.87698412698413, 1.88333333333333, 2, 2.00357142857143, 2.03333333333333, 2.1, 2.11363636363636, 
            2.12142857142857, 2.125, 2.125, 2.1547619047619, 2.16666666666667, 2.21666666666667, 2.22272727272727, 2.25, 
            2.25, 2.25, 2.29545454545455, 2.29642857142857, 2.30357142857143, 2.33333333333333, 2.33333333333333, 2.35357142857143, 
            2.36904761904762, 2.4, 2.4, 2.40357142857143, 2.4047619047619, 2.40476190476191, 2.41363636363636, 2.41666666666667, 
            2.44166666666667, 2.45, 2.49642857142857, 2.49642857142857, 2.49642857142857, 2.50454545454545, 2.51190476190476, 
            2.51190476190476, 2.51190476190476, 2.52272727272727, 2.53333333333333, 2.53928571428571, 2.54166666666667, 2.55, 
            2.58333333333333, 2.58333333333333, 2.62142857142857, 2.625, 2.625, 2.63095238095238, 2.63333333333333, 2.64166666666667, 
            2.64166666666667, 2.65, 2.68571428571429, 2.7, 2.71666666666667, 2.72857142857143, 2.73412698412698, 2.74285714285714, 
            2.75, 2.75, 2.75, 2.8, 2.83928571428571, 2.83928571428571, 2.83928571428571, 2.83928571428571, 2.84166666666667, 
            2.85, 2.85, 2.85555555555556, 2.86666666666667, 2.86904761904762, 2.87142857142857, 2.87142857142857, 2.9, 2.92857142857143, 
            2.93333333333333, 2.95, 2.95, 2.95833333333333, 2.96666666666667, 2.975, 2.97619047619048, 3.02222222222222, 
            3.06666666666667, 3.07142857142857, 3.08333333333333, 3.08333333333333, 3.08571428571429, 3.08571428571429, 3.125, 
            3.125, 3.125, 3.13928571428571, 3.15555555555556, 3.16666666666667, 3.17857142857143, 3.17857142857143, 3.21428571428571, 
            3.21428571428571, 3.21666666666667, 3.275, 3.28571428571429, 3.29166666666667, 3.29166666666667, 3.29761904761905, 
            3.3, 3.36904761904762, 3.37142857142857, 3.37142857142857, 3.37142857142857, 3.375, 3.375, 3.38333333333333, 
            3.38333333333333, 3.4, 3.42857142857143, 3.46666666666667, 3.5, 3.51984126984127, 3.52380952380952, 3.53333333333333, 
            3.53571428571429, 3.54761904761905, 3.60476190476191, 3.60555555555556, 3.675, 3.71428571428571, 3.71428571428571, 
            3.71428571428571, 3.75, 3.75555555555556, 3.82142857142857, 3.85714285714286, 3.91666666666667, 3.95, 3.96428571428571, 
            4, 4.125, 4.125, 4.2))
})

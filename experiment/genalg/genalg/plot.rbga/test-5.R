library(testthat)

.Random.seed <<- .ext.seed

test_that("plot.rbga", {
    rbga.results <- structure(list(type = "floats chromosome", stringMin = c(1, 1), stringMax = c(5, 10), popSize = 200, 
        iters = 100, suggestions = NULL, population = structure(c(3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.09764644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 3.14094644226134, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 6.98457619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 6.98457619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004, 
            7.07787619601004, 7.07787619601004, 7.07787619601004, 7.07787619601004), .Dim = c(200L, 2L)), elitism = 40, mutationChance = 0.01, 
        evaluations = c(0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.0871378271838923, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.0507545954730175, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.0871378271838923, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763), best = c(0.258860410945136, 0.0209032920565271, 
            0.0209032920565271, 0.0209032920565271, 0.0209032920565271, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 0.00745459547301763, 
            0.00745459547301763, 0.00745459547301763), mean = c(3.77104679582555, 2.17394969355992, 1.34878433294467, 0.862238814812601, 
            0.501479138416463, 0.251362390394156, 0.108823142662685, 0.0433855857899994, 0.0806000275087318, 0.0527687462439895, 
            0.0398900736344977, 0.0291681219298242, 0.0172135536818067, 0.132255107116547, 0.0128036170054985, 0.0135825261418475, 
            0.0121685866956367, 0.0231589698666987, 0.00986951532687531, 0.0431959157085291, 0.0147072043244041, 0.0273811240893091, 
            0.0654663131890144, 0.0209141781381005, 0.0109856234494411, 0.0457759758839163, 0.0795375006701553, 0.0836969587246283, 
            0.0230296091779893, 0.0146842696217541, 0.0213010356264469, 0.0796262549548165, 0.0397377601491125, 0.0479419803337928, 
            0.0407890754377296, 0.0205600610052469, 0.00745459547301763, 0.00745459547301763, 0.0583512022844295, 0.0254663004950388, 
            0.0194660966130684, 0.123587571707965, 0.0245373525537795, 0.0400079576533283, 0.0462225131489534, 0.0356878996142758, 
            0.100085907631132, 0.0436096919488808, 0.00745459547301763, 0.0358255920975714, 0.0903469484680182, 0.0763674989693256, 
            0.044109579176087, 0.0273809889224137, 0.0392437716123169, 0.00745459547301763, 0.0465229378368932, 0.0474374277901264, 
            0.083038380670537, 0.0536025495182875, 0.0197682223146596, 0.025580011631572, 0.0268581149073144, 0.024647011631572, 
            0.0152421333597331, 0.0464335874050029, 0.0453240495182875, 0.0665864148755277, 0.00745459547301763, 0.0419695874050029, 
            0.021381511631572, 0.041188511631572, 0.020448511631572, 0.019982011631572, 0.0364641333597331, 0.0415916712464485, 
            0.028974511631572, 0.0124340954730176, 0.0224741333597331, 0.0503280414502727, 0.0211081333597331, 0.0593496712464485, 
            0.0357969656768418, 0.0347839656768418, 0.0217720495182875, 0.0278700495182875, 0.0170101333597331, 0.0222554656768418, 
            0.0452855035635573, 0.0172745495182875, 0.0166484277901264, 0.0218559656768418, 0.0239038818353962, 0.0242698818353962, 
            0.012783511631572, 0.0106956333597331, 0.0101801333597331, 0.00809763335973309, 0.00961204951828746, 0.00846792779012638)), 
        class = "rbga")
    expect_equal(genalg:::plot.rbga(x = rbga.results, type = "vars"), list(mfcol = c(2L, 1L)))
})

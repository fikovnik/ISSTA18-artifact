library(testthat)

.Random.seed <<- .ext.seed

test_that("TransMatrix", {
    seq <- c(4, 4, 2, 4, 3, 3, 3, 1, 3, 3, 2, 3, 4, 2, 2, 4, 4, 1, 2, 3, 4, 1, 4, 4, 1, 3, 2, 4, 2, 4, 3, 4, 2, 3, 1, 4, 
        1, 1, 4, 3, 2, 2, 1, 4, 2, 4, 4, 3, 4, 3, 2, 2, 2, 4, 1, 3, 3, 1, 2, 3, 3, 4, 4, 3, 4, 1, 2, 4, 3, 1, 1, 1, 1, 2, 
        1, 3, 1, 2, 3, 1, 3, 1, 2, 3, 4, 3, 1, 1, 1, 2, 3, 1, 1, 4, 4, 3, 2, 3, 3, 3, 3, 1, 1, 2, 4, 4, 3, 3, 3, 1, 3, 4, 
        4, 2, 3, 3, 1, 2, 3, 4, 2, 2, 3, 3, 3, 2, 4, 4, 1, 3, 4, 3, 3, 4, 4, 3, 4, 1, 4, 3, 1, 1, 2, 4, 3, 4, 1, 4, 2, 1, 
        3, 2, 4, 2, 3, 4, 1, 1, 1, 3, 4, 3, 3, 1, 3, 1, 2, 2, 1, 1, 3, 2, 2, 2, 2, 1, 4, 3, 4, 4, 4, 4, 2, 2, 3, 3, 4, 4, 
        1, 2, 1, 4, 1, 1, 1, 1, 3, 1, 3, 3, 4, 3, 4, 2, 1, 2, 4, 2, 2, 2, 3, 3, 2, 1, 2, 4, 3, 2, 3, 4, 2, 1, 3, 4, 2, 4, 
        2, 1, 1, 1, 2, 1, 2, 1, 4, 4, 1, 4, 3, 2, 1, 3, 1, 1, 3, 2, 1, 1, 2, 4, 2, 1, 2, 3, 1, 4, 1, 3, 3, 3, 3, 1, 2, 4, 
        3, 1, 4, 1, 4, 4, 1, 4, 2, 1, 4, 2, 2, 2, 2, 2, 2, 1, 1, 4, 2, 1, 2, 1, 2, 1, 4, 3, 2, 2, 2, 1, 4, 3, 1, 1, 2, 2, 
        1, 2, 4, 4, 2, 1, 2, 2, 1, 4, 2, 1, 1, 4, 2, 3, 4, 4, 2, 2, 1, 2, 3, 4, 2, 4, 3, 4, 4, 1, 1, 2, 3, 2, 3, 2, 4, 2, 
        2, 1, 4, 2, 1, 1, 4, 2, 4, 4, 2, 3, 1, 1, 3, 2, 3, 4, 2, 2, 3, 3, 2, 4, 3, 3, 3, 4, 2, 2, 1, 2, 4, 1, 3, 4, 1, 1, 
        1, 4, 3, 2, 2, 2, 3, 4, 1, 4, 1, 1, 4, 3, 3, 1, 3, 2, 4, 4, 3, 1, 1, 3, 3, 2, 4, 1, 4, 2, 1, 2, 1, 3, 1, 3, 1, 1, 
        2, 4, 2, 1, 1, 2, 4, 4, 3, 1, 2, 2, 3, 3, 3, 3, 2, 1, 4, 1, 2, 1, 1, 2, 3, 4, 2, 4, 2, 2, 1, 4, 3, 1, 2, 2, 3, 3, 
        2, 2, 2, 3, 4, 4, 2, 1, 4, 1, 1, 3, 2, 1, 2, 4, 2, 1, 4, 4, 2, 2, 3, 4, 1, 4, 1, 3, 4, 1, 4, 2, 4, 1, 1, 1, 4, 2, 
        4, 2, 2, 1, 4, 2, 1, 1, 1, 1, 3, 4, 1, 4, 3, 1, 4, 2, 1, 4, 1, 2, 3, 2, 1, 2, 2, 3, 4, 4, 4, 1, 3, 3, 1, 4, 2, 2, 
        4, 1, 4, 3, 2, 1, 1, 3, 3, 1, 3, 4, 3, 1, 3, 4, 3, 1, 2, 2, 4, 1, 3, 1, 1, 1, 4, 2, 4, 4, 4, 1, 1, 1, 2, 2, 3, 2, 
        3, 4, 3, 1, 4, 1, 1, 3, 1, 1, 3, 3, 1, 4, 3, 3, 1, 2, 4, 4, 2, 3, 2, 4, 2, 4, 4, 2, 3, 2, 1, 2, 2, 2, 4, 2, 3, 2, 
        4, 1, 2, 3, 2, 3, 3, 2, 4, 4, 1, 1, 2, 2, 2, 3, 1, 3, 1, 3, 2, 2, 3, 2, 2, 1, 1, 1, 3, 3, 1, 3, 4, 3, 2, 1, 3, 4, 
        3, 3, 2, 2, 4, 4, 1, 4, 4, 3, 3, 2, 1, 1, 2, 2, 4, 4, 2, 4, 1, 4, 3, 2, 4, 2, 2, 4, 1, 2, 1, 1, 1, 2, 2, 2, 2, 4, 
        3, 4, 2, 4, 1, 1, 3, 3, 3, 1, 4, 4, 1, 3, 3, 4, 4, 2, 4, 3, 1, 3, 4, 3, 1, 2, 2, 3, 4, 4, 2, 3, 4, 3, 2, 2, 1, 3, 
        1, 3, 1, 2, 2, 4, 2, 2, 2, 3, 2, 4, 4, 4, 1, 2, 2, 3, 3, 4, 4, 3, 3, 4, 4, 2, 1, 4, 4, 2, 1, 1, 2, 1, 1, 2, 3, 1, 
        4, 4, 4, 3, 1, 1, 3, 3, 4, 2, 2, 3, 2, 1, 2, 1, 3, 1, 4, 4, 4, 4, 3, 3, 2, 1, 3, 1, 2, 3, 2, 1, 4, 2, 3, 1, 3, 2, 
        2, 1, 4, 1, 4, 4, 1, 3, 3, 1, 3, 1, 2, 3, 1, 4, 2, 3, 3, 3, 4, 1, 1, 3, 1, 3, 2, 1, 1, 4, 1, 1, 1, 1, 1, 2, 1, 2, 
        3, 3, 2, 3, 4, 1, 4, 4, 1, 3, 3, 1, 2, 2, 4, 1, 3, 4, 2, 2, 3, 1, 3, 4, 2, 4, 4, 3, 2, 1, 2, 4, 1, 1, 2, 2, 4, 4, 
        1, 4, 2, 3, 1, 2, 4, 3, 4, 4, 3, 4, 4, 1, 1, 1, 4, 4, 2, 2, 3, 2, 2, 4, 2, 1, 3, 3, 1, 1, 2, 1, 3, 4, 2, 1, 3, 1, 
        2, 2, 4, 4, 4, 4, 4, 3, 1, 1, 4, 4, 4, 1, 3, 4, 1, 2, 1, 2, 2, 4, 4, 4, 4, 1, 1, 2, 1, 4, 2, 3, 1, 2, 4, 2, 1, 3, 
        3, 1, 2, 2, 2, 3, 2, 3, 3, 4, 3, 3, 2, 3, 1, 4, 1, 4, 1, 1, 4, 1, 2, 2, 3, 3, 1, 1, 2, 2, 3, 1, 2, 1, 2, 4, 2, 1, 
        4, 1, 2, 4, 4, 1, 4, 4, 1, 1, 3, 1, 2, 1)
    expect_equal(MCTM:::TransMatrix(sequence = seq, order = 2, probs = FALSE), list(structure(c(19, 17, 18, 16, 22, 22, 10, 
        20, 16, 16, 16, 13, 13, 18, 16, 15), .Dim = c(4L, 4L), .Dimnames = list(c("1", "2", "3", "4"), c("1", "2", "3", "4"))), 
        structure(c(16, 15, 14, 12, 19, 17, 14, 17, 13, 22, 15, 11, 20, 15, 18, 20), .Dim = c(4L, 4L), .Dimnames = list(c("1", 
            "2", "3", "4"), c("1", "2", "3", "4"))), structure(c(16, 15, 19, 13, 21, 12, 13, 15, 18, 10, 12, 13, 12, 12, 
            11, 15), .Dim = c(4L, 4L), .Dimnames = list(c("1", "2", "3", "4"), c("1", "2", "3", "4"))), structure(c(19, 22, 
            16, 21, 11, 18, 12, 16, 13, 13, 12, 14, 19, 15, 11, 14), .Dim = c(4L, 4L), .Dimnames = list(c("1", "2", "3", 
            "4"), c("1", "2", "3", "4")))))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("TransMatrix", {
    seq <- c(4, 4, 2, 4, 3, 3, 3, 1, 3, 3, 2, 3, 4, 2, 2, 4, 4, 1, 2, 3, 4, 1, 4, 4, 1, 3, 2, 4, 2, 4, 3, 4, 2, 3, 1, 4, 
        1, 1, 4, 3, 2, 2, 1, 4, 2, 4, 4, 3, 4, 3, 2, 2, 2, 4, 1, 3, 3, 1, 2, 3, 3, 4, 4, 3, 4, 1, 2, 4, 3, 1, 1, 1, 1, 2, 
        1, 3, 1, 2, 3, 1, 3, 1, 2, 3, 4, 3, 1, 1, 1, 2, 3, 1, 1, 4, 4, 3, 2, 3, 3, 3, 3, 1, 1, 2, 4, 4, 3, 3, 3, 1, 3, 4, 
        4, 2, 3, 3, 1, 2, 3, 4, 2, 2, 3, 3, 3, 2, 4, 4, 1, 3, 4, 3, 3, 4, 4, 3, 4, 1, 4, 3, 1, 1, 2, 4, 3, 4, 1, 4, 2, 1, 
        3, 2, 4, 2, 3, 4, 1, 1, 1, 3, 4, 3, 3, 1, 3, 1, 2, 2, 1, 1, 3, 2, 2, 2, 2, 1, 4, 3, 4, 4, 4, 4, 2, 2, 3, 3, 4, 4, 
        1, 2, 1, 4, 1, 1, 1, 1, 3, 1, 3, 3, 4, 3, 4, 2, 1, 2, 4, 2, 2, 2, 3, 3, 2, 1, 2, 4, 3, 2, 3, 4, 2, 1, 3, 4, 2, 4, 
        2, 1, 1, 1, 2, 1, 2, 1, 4, 4, 1, 4, 3, 2, 1, 3, 1, 1, 3, 2, 1, 1, 2, 4, 2, 1, 2, 3, 1, 4, 1, 3, 3, 3, 3, 1, 2, 4, 
        3, 1, 4, 1, 4, 4, 1, 4, 2, 1, 4, 2, 2, 2, 2, 2, 2, 1, 1, 4, 2, 1, 2, 1, 2, 1, 4, 3, 2, 2, 2, 1, 4, 3, 1, 1, 2, 2, 
        1, 2, 4, 4, 2, 1, 2, 2, 1, 4, 2, 1, 1, 4, 2, 3, 4, 4, 2, 2, 1, 2, 3, 4, 2, 4, 3, 4, 4, 1, 1, 2, 3, 2, 3, 2, 4, 2, 
        2, 1, 4, 2, 1, 1, 4, 2, 4, 4, 2, 3, 1, 1, 3, 2, 3, 4, 2, 2, 3, 3, 2, 4, 3, 3, 3, 4, 2, 2, 1, 2, 4, 1, 3, 4, 1, 1, 
        1, 4, 3, 2, 2, 2, 3, 4, 1, 4, 1, 1, 4, 3, 3, 1, 3, 2, 4, 4, 3, 1, 1, 3, 3, 2, 4, 1, 4, 2, 1, 2, 1, 3, 1, 3, 1, 1, 
        2, 4, 2, 1, 1, 2, 4, 4, 3, 1, 2, 2, 3, 3, 3, 3, 2, 1, 4, 1, 2, 1, 1, 2, 3, 4, 2, 4, 2, 2, 1, 4, 3, 1, 2, 2, 3, 3, 
        2, 2, 2, 3, 4, 4, 2, 1, 4, 1, 1, 3, 2, 1, 2, 4, 2, 1, 4, 4, 2, 2, 3, 4, 1, 4, 1, 3, 4, 1, 4, 2, 4, 1, 1, 1, 4, 2, 
        4, 2, 2, 1, 4, 2, 1, 1, 1, 1, 3, 4, 1, 4, 3, 1, 4, 2, 1, 4, 1, 2, 3, 2, 1, 2, 2, 3, 4, 4, 4, 1, 3, 3, 1, 4, 2, 2, 
        4, 1, 4, 3, 2, 1, 1, 3, 3, 1, 3, 4, 3, 1, 3, 4, 3, 1, 2, 2, 4, 1, 3, 1, 1, 1, 4, 2, 4, 4, 4, 1, 1, 1, 2, 2, 3, 2, 
        3, 4, 3, 1, 4, 1, 1, 3, 1, 1, 3, 3, 1, 4, 3, 3, 1, 2, 4, 4, 2, 3, 2, 4, 2, 4, 4, 2, 3, 2, 1, 2, 2, 2, 4, 2, 3, 2, 
        4, 1, 2, 3, 2, 3, 3, 2, 4, 4, 1, 1, 2, 2, 2, 3, 1, 3, 1, 3, 2, 2, 3, 2, 2, 1, 1, 1, 3, 3, 1, 3, 4, 3, 2, 1, 3, 4, 
        3, 3, 2, 2, 4, 4, 1, 4, 4, 3, 3, 2, 1, 1, 2, 2, 4, 4, 2, 4, 1, 4, 3, 2, 4, 2, 2, 4, 1, 2, 1, 1, 1, 2, 2, 2, 2, 4, 
        3, 4, 2, 4, 1, 1, 3, 3, 3, 1, 4, 4, 1, 3, 3, 4, 4, 2, 4, 3, 1, 3, 4, 3, 1, 2, 2, 3, 4, 4, 2, 3, 4, 3, 2, 2, 1, 3, 
        1, 3, 1, 2, 2, 4, 2, 2, 2, 3, 2, 4, 4, 4, 1, 2, 2, 3, 3, 4, 4, 3, 3, 4, 4, 2, 1, 4, 4, 2, 1, 1, 2, 1, 1, 2, 3, 1, 
        4, 4, 4, 3, 1, 1, 3, 3, 4, 2, 2, 3, 2, 1, 2, 1, 3, 1, 4, 4, 4, 4, 3, 3, 2, 1, 3, 1, 2, 3, 2, 1, 4, 2, 3, 1, 3, 2, 
        2, 1, 4, 1, 4, 4, 1, 3, 3, 1, 3, 1, 2, 3, 1, 4, 2, 3, 3, 3, 4, 1, 1, 3, 1, 3, 2, 1, 1, 4, 1, 1, 1, 1, 1, 2, 1, 2, 
        3, 3, 2, 3, 4, 1, 4, 4, 1, 3, 3, 1, 2, 2, 4, 1, 3, 4, 2, 2, 3, 1, 3, 4, 2, 4, 4, 3, 2, 1, 2, 4, 1, 1, 2, 2, 4, 4, 
        1, 4, 2, 3, 1, 2, 4, 3, 4, 4, 3, 4, 4, 1, 1, 1, 4, 4, 2, 2, 3, 2, 2, 4, 2, 1, 3, 3, 1, 1, 2, 1, 3, 4, 2, 1, 3, 1, 
        2, 2, 4, 4, 4, 4, 4, 3, 1, 1, 4, 4, 4, 1, 3, 4, 1, 2, 1, 2, 2, 4, 4, 4, 4, 1, 1, 2, 1, 4, 2, 3, 1, 2, 4, 2, 1, 3, 
        3, 1, 2, 2, 2, 3, 2, 3, 3, 4, 3, 3, 2, 3, 1, 4, 1, 4, 1, 1, 4, 1, 2, 2, 3, 3, 1, 1, 2, 2, 3, 1, 2, 1, 2, 4, 2, 1, 
        4, 1, 2, 4, 4, 1, 4, 4, 1, 1, 3, 1, 2, 1)
    expect_equal(MCTM:::TransMatrix(sequence = seq, order = 1, probs = TRUE), structure(c(0.262172284644195, 0.266409266409266, 
        0.295154185022026, 0.252032520325203, 0.273408239700375, 0.266409266409266, 0.215859030837004, 0.276422764227642, 
        0.224719101123595, 0.235521235521236, 0.242290748898678, 0.207317073170732, 0.239700374531835, 0.231660231660232, 
        0.246696035242291, 0.264227642276423), .Dim = c(4L, 4L), .Dimnames = list(c("1", "2", "3", "4"), c("1", "2", "3", 
        "4"))))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("index.rp", {
    x <- c(91.4806043496355, 93.7075413297862, 28.6139534786344, 83.0447626067325, 64.1745518893003, 51.9095949130133, 73.6588314641267, 
        13.466659723781, 65.6992290401831, 70.5064784036949, 45.774177624844, 71.9112251652405, 93.4672247152776, 25.5428824340925, 
        46.2292822543532, 94.0014522755519, 97.8226428385824, 11.7487361654639, 47.4997081561014, 56.0332746244967, 90.4031387297437, 
        13.8710167724639, 98.8891728920862, 94.6668232558295, 8.24375580996275, 51.4211784349754, 39.0203467104584, 90.5738130910322, 
        44.6969628101215, 83.6004259996116, 73.7595617771149, 81.1055141268298, 38.8108282815665, 68.5169729404151, 0.394833879545331, 
        83.2916080253199, 0.733414688147604, 20.7658972823992, 90.6601407798007, 61.1778643447906, 37.9559240536764, 43.5771584976465, 
        3.74310328625143, 97.3539913771674, 43.1751248892397, 95.7576596643776, 88.7754905503243, 63.9978769468144, 97.0966610359028, 
        61.8838207330555, 33.3427211269736, 34.6748248208314, 39.848541142419, 78.4692775690928, 3.8936491124332, 74.8795386170968, 
        67.727683018893, 17.1264330390841, 26.1087963823229, 51.4412934659049, 67.560727451928, 98.2817197917029, 75.9544267551973, 
        56.6488424083218, 84.9689718568698, 18.947393540293, 27.1286614704877, 82.8158485237509, 69.3204820388928, 24.0544739644974, 
        4.29887960199267, 14.0479094116017, 21.638541505672, 47.9398564202711, 19.7410342283547, 71.9355837674811, 0.788473873399198, 
        37.5489964615554, 51.4407708309591, 0.157055421732366, 58.1604002509266, 15.7905208179727, 35.9028305858374, 64.5631878403947, 
        77.5823362637311, 56.3646841561422, 23.3703398611397, 8.99805163498968, 8.56120649259537, 30.5218369467184, 66.7426514672115, 
        0.0238896580412984, 20.8569956943393, 93.3034127345309, 92.5644748611376, 73.4094301005825, 33.3071983419359, 51.5063329832628, 
        74.3974646320567, 61.9159240042791)
    expect_equal(agop:::index.rp(x = floor(x), p = 1), 95)
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("dNormScore", {
    x <- c(0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1, 
        1.05, 1.1, 1.15, 1.2, 1.25, 1.3, 1.35, 1.4, 1.45, 1.5, 1.55, 1.6, 1.65, 1.7, 1.75, 1.8, 1.85, 1.9, 1.95, 2, 2.05, 
        2.1, 2.15, 2.2, 2.25, 2.3, 2.35, 2.4, 2.45, 2.5, 2.55, 2.6, 2.65, 2.7, 2.75, 2.8, 2.85, 2.9, 2.95, 3, 3.05, 3.1, 
        3.15, 3.2, 3.25, 3.3, 3.35, 3.4, 3.45, 3.5, 3.55, 3.6, 3.65, 3.7, 3.75, 3.8, 3.85, 3.9, 3.95, 4, 4.05, 4.1, 4.15, 
        4.2, 4.25, 4.3, 4.35, 4.4, 4.45, 4.5, 4.55, 4.6, 4.65, 4.7, 4.75, 4.8, 4.85, 4.9, 4.95, 5)
    expect_equal(SuppDists:::dNormScore(x = x, c = 5, N = 15, U = 0.6), c(0.000474669675456823, 0.0164635613910524, 0.0274905962442582, 
        0.0369504185374087, 0.0454247102271441, 0.0531711505481298, 0.0603354362475744, 0.067011377453078, 0.0732645648589166, 
        0.0791435671841124, 0.0846859066059094, 0.089921533911623, 0.0948749850372757, 0.0995667891381807, 0.104014426441361, 
        0.10823300223791, 0.112235734787226, 0.116034317154116, 0.119639191205043, 0.123059758894067, 0.126304547815648, 
        0.129381342775972, 0.132297291689079, 0.135058991782996, 0.137672560502289, 0.140143694370209, 0.142477718273082, 
        0.144679627048033, 0.146754120828624, 0.148705635286767, 0.150538367662739, 0.152256299301851, 0.153863215267891, 
        0.15536272149777, 0.156758259874684, 0.158053121531304, 0.159250458636989, 0.160353294883064, 0.161364534842279, 
        0.162286972356485, 0.163123298070222, 0.163876106224953, 0.164547900801643, 0.165141101087618, 0.165658046739348, 
        0.166101002395003, 0.166472161887254, 0.166773652101715, 0.167007536516828, 0.167175818457932, 0.167280444098417, 
        0.167323305226397, 0.167306241805609, 0.167231044349292, 0.16709945611959, 0.166913175177419, 0.166673856286215, 
        0.166383112689739, 0.166042517773746, 0.165653606616689, 0.165217877444113, 0.164736792994169, 0.164211781795098, 
        0.163644239372929, 0.163035529381128, 0.162386984672691, 0.161699908304336, 0.160975574492239, 0.160215229508931, 
        0.159420092539275, 0.158591356483662, 0.157730188729222, 0.156837731872361, 0.155915104412596, 0.154963401410191, 
        0.153983695109994, 0.152977035541069, 0.151944451081021, 0.150886949005113, 0.149805515997303, 0.148701118654948, 
        0.147574703952436, 0.146427199707477, 0.145259515005769, 0.144072540624762, 0.14286714943168, 0.141644196767876, 
        0.140404520818871, 0.139148942969958, 0.13787826814704, 0.136593285145814, 0.135294766949512, 0.133983471033772, 
        0.132660139661067, 0.131325500166146, 0.129980265229368, 0.128625133143268, 0.127260788068018, 0.125887900279675, 
        0.124507126411877, 0.123119109685765))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("dKruskalWallis", {
    x <- c(0.5, 0.575, 0.65, 0.725, 0.8, 0.875, 0.95, 1.025, 1.1, 1.175, 1.25, 1.325, 1.4, 1.475, 1.55, 1.625, 1.7, 1.775, 
        1.85, 1.925, 2, 2.075, 2.15, 2.225, 2.3, 2.375, 2.45, 2.525, 2.6, 2.675, 2.75, 2.825, 2.9, 2.975, 3.05, 3.125, 3.2, 
        3.275, 3.35, 3.425, 3.5, 3.575, 3.65, 3.725, 3.8, 3.875, 3.95, 4.025, 4.1, 4.175, 4.25, 4.325, 4.4, 4.475, 4.55, 
        4.625, 4.7, 4.775, 4.85, 4.925, 5, 5.075, 5.15, 5.225, 5.3, 5.375, 5.45, 5.525, 5.6, 5.675, 5.75, 5.825, 5.9, 5.975, 
        6.05, 6.125, 6.2, 6.275, 6.35, 6.425, 6.5, 6.575, 6.65, 6.725, 6.8, 6.875, 6.95, 7.025, 7.1, 7.175, 7.25, 7.325, 
        7.4, 7.475, 7.55, 7.625, 7.7, 7.775, 7.85, 7.925, 8)
    expect_equal(SuppDists:::dKruskalWallis(x = x, c = 3, N = 15, U = 0.6), c(0.359383453012729, 0.346382218751412, 0.334288926270243, 
        0.322937754897279, 0.312211142725782, 0.302022394991219, 0.292305501312207, 0.283008847021815, 0.274091156358736, 
        0.265518778588381, 0.25726381576846, 0.249302796569151, 0.241615715101839, 0.234185320139857, 0.226996580087402, 
        0.22003627380851, 0.213292673240773, 0.20675529403269, 0.200414697341333, 0.194262330615924, 0.188290398461577, 0.182491756962833, 
        0.176859826496401, 0.171388519247362, 0.166072178529264, 0.160905527652022, 0.155883626567266, 0.151001834902798, 
        0.146255780273052, 0.141641330975717, 0.137154572359077, 0.132791786268016, 0.128549433100256, 0.124424136070833, 
        0.120412667369174, 0.116511935927099, 0.112718976583603, 0.109030940447008, 0.105445086299283, 0.101958772908639, 
        0.0985694521299374, 0.0952746626998735, 0.0920720246397888, 0.0889592341937195, 0.0859340592421765, 0.0829943351335904, 
        0.0801379608885711, 0.0773628957374539, 0.0746671559526124, 0.0720488119463347, 0.0695059856067326, 0.0670368478468131, 
        0.0646396163451746, 0.0623125534612301, 0.0600539643074161, 0.0578621949625102, 0.0557356308130696, 0.0536726950153277, 
        0.0516718470586763, 0.0497315814318444, 0.0478504263725643, 0.046026942702837, 0.0442597227356956, 0.0425473892511352, 
        0.0408885945353266, 0.0392820194758947, 0.0377263727123767, 0.036220389833197, 0.03476283262005, 0.0333524883330272, 
        0.0319881690336032, 0.0306687109448145, 0.029392973844411, 0.0281598404880956, 0.0269682160616291, 0.0258170276601355, 
        0.0247052237920542, 0.0236317739050751, 0.0225956679356099, 0.0215959158774703, 0.0206315473679775, 0.0197016112946091, 
        0.018805175415415, 0.0179413259964178, 0.017109167462781, 0.0163078220644097, 0.0155364295526539, 0.014794146870889, 
        0.0140801478550889, 0.0133936229451681, 0.0127337789068704, 0.0120998385625404, 0.0114910405306645, 0.01090663897374, 
        0.0103459033545805, 0.00980811819917271, 0.00929258286763712, 0.0087986113300742, 0.00832553195084795, 0.00787268727675539, 
        0.0074394338318573))
})

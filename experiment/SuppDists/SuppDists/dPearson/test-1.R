library(testthat)

.Random.seed <<- .ext.seed

test_that("dPearson", {
    x <- c(-1, -0.98, -0.96, -0.94, -0.92, -0.9, -0.88, -0.86, -0.84, -0.82, -0.8, -0.78, -0.76, -0.74, -0.72, -0.7, -0.68, 
        -0.66, -0.64, -0.62, -0.6, -0.58, -0.56, -0.54, -0.52, -0.5, -0.48, -0.46, -0.44, -0.42, -0.4, -0.38, -0.36, -0.34, 
        -0.32, -0.3, -0.28, -0.26, -0.24, -0.22, -0.2, -0.18, -0.16, -0.14, -0.12, -0.1, -0.08, -0.0599999999999999, -0.04, 
        -0.02, 0, 0.02, 0.04, 0.0600000000000001, 0.0800000000000001, 0.1, 0.12, 0.14, 0.16, 0.18, 0.2, 0.22, 0.24, 0.26, 
        0.28, 0.3, 0.32, 0.34, 0.36, 0.38, 0.4, 0.42, 0.44, 0.46, 0.48, 0.5, 0.52, 0.54, 0.56, 0.58, 0.6, 0.62, 0.64, 0.66, 
        0.68, 0.7, 0.72, 0.74, 0.76, 0.78, 0.8, 0.82, 0.84, 0.86, 0.88, 0.9, 0.92, 0.94, 0.96, 0.98, 1)
    expect_equal(SuppDists:::dPearson(x = x, N = 10, rho = 0.7), c(0, 3.83367316528732e-08, 3.19404673467091e-07, 1.12298642974434e-06, 
        2.7737992809759e-06, 5.64697460121267e-06, 1.01741565187703e-05, 1.68502890337751e-05, 2.6241168653648e-05, 3.89918483657169e-05, 
        5.58359885427567e-05, 7.7606261293399e-05, 0.000105245926960576, 0.000139821715089283, 0.000182538157399987, 0.000234753537306265, 
        0.000297997639517788, 0.000373991504510765, 0.000464669416393945, 0.000572203379246764, 0.000699030366689722, 0.000847882662636139, 
        0.00102182164828215, 0.00122427543187777, 0.00145908076419652, 0.00173052973445098, 0.00204342179931265, 0.00240312176237834, 
        0.00281562439364311, 0.00328762645912344, 0.00382660702063607, 0.00444091696586195, 0.00513987884027809, 0.0059338981764574, 
        0.00683458765382321, 0.00785490557445582, 0.0090093103092698, 0.0103139325550993, 0.0117867674481856, 0.0134478888043854, 
        0.0153196880020428, 0.0174271402905054, 0.0197981015958449, 0.0224636392048944, 0.0254584000376874, 0.0288210205638341, 
        0.0325945827755105, 0.0368271209912089, 0.0415721846194829, 0.0468894623453458, 0.0528454734925071, 0.059514332533137, 
        0.0669785928238494, 0.0753301755891054, 0.0846713898806177, 0.0951160486200172, 0.1067906847587, 0.119835869901537, 
        0.134407635228417, 0.150678990933571, 0.168841535329109, 0.189107137761975, 0.211709669973186, 0.236906747712562, 
        0.264981427319847, 0.296243779325842, 0.331032231298509, 0.369714533109112, 0.412688146937677, 0.460379798439976, 
        0.513243840548054, 0.571758972458917, 0.636422717562226, 0.707742888403881, 0.786225046366171, 0.872354690066227, 
        0.966572571276616, 1.06924113410724, 1.18059960088495, 1.30070469565159, 1.42935343217014, 1.56598386168089, 1.70954930103334, 
        1.85836157097456, 2.00989956201138, 2.16058167710481, 2.30550547069314, 2.43816686739885, 2.55018744259036, 2.63110551786441, 
        2.66833119965688, 2.64743474279236, 2.55304007410695, 2.37073456977012, 2.09056521653787, 1.71278916961976, 1.25632651696585, 
        0.769107752049641, 0.335325931071046, 0.0626219853836074, 0))
})

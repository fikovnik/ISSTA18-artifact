library(testthat)

.Random.seed <<- .ext.seed

test_that("dFriedman", {
    x <- c(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2, 2.1, 2.2, 2.3, 
        2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3, 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8, 3.9, 4, 4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7, 
        4.8, 4.9, 5, 5.1, 5.2, 5.3, 5.4, 5.5, 5.6, 5.7, 5.8, 5.9, 6, 6.1, 6.2, 6.3, 6.4, 6.5, 6.6, 6.7, 6.8, 6.9, 7, 7.1, 
        7.2, 7.3, 7.4, 7.5, 7.6, 7.7, 7.8, 7.9, 8, 8.1, 8.2, 8.3, 8.4, 8.5, 8.6, 8.7, 8.8, 8.9, 9, 9.1, 9.2, 9.3, 9.4, 9.5, 
        9.6, 9.7, 9.8, 9.9, 10)
    expect_equal(SuppDists:::dFriedman(x = x, r = 5, N = 10), c(0.000918719392614786, 0.000918719392614786, 0.00171546223874652, 
        0.00311252708813536, 0.00545168033950139, 0.00645291244655755, 0.00736143615652596, 0.00818675638437771, 0.00961662539298092, 
        0.0102327847176926, 0.0107895799414417, 0.0112912010208976, 0.0121437132245197, 0.0125012140767272, 0.0128168532409437, 
        0.0130933397088447, 0.0135387757393655, 0.0137122850563699, 0.0138557915219225, 0.0139712383333253, 0.0141251607032427, 
        0.0141669828189098, 0.0141874529110358, 0.0141880182279166, 0.0141348288271413, 0.0140835882956324, 0.0140174799738122, 
        0.0139375967489624, 0.0137405848205119, 0.0136253590174499, 0.0135001698969487, 0.0133658448715428, 0.0130728737701218, 
        0.0129156662613114, 0.0127522041592466, 0.0125831111724741, 0.0122303547204036, 0.0120477710449499, 0.0118617192137552, 
        0.0116726647681824, 0.0112872756050433, 0.0110917412493888, 0.0108948074396326, 0.0106968163131537, 0.0102989255713681, 
        0.0100996081772121, 0.00990039982293583, 0.00970154634015019, 0.00930580543652554, 0.00910933020152099, 0.00891403572711008, 
        0.0087200929232838, 0.00833688249684378, 0.00814789513454606, 0.00796082117170366, 0.00777577358590004, 0.00741216064572758, 
        0.00723377395992611, 0.00705777195165266, 0.00688422320388332, 0.00654472269971634, 0.0063788722011543, 0.00621567824608241, 
        0.00605517581281179, 0.00574235760920541, 0.00559008494461008, 0.00544059062262392, 0.00529388459986399, 0.00500885684883631, 
        0.00487053536761628, 0.00473500316125647, 0.0046022519657673, 0.00434504495424895, 0.00422055861341591, 0.00409879261186152, 
        0.0039797258236024, 0.00374959535974183, 0.00363847987714175, 0.00352996028801619, 0.00342400679452225, 0.00321967243463012, 
        0.00312122586551933, 0.00302521421301485, 0.00293160225197267, 0.00275143276661352, 0.00266480133013286, 0.00258042193256383, 
        0.00249825640265146, 0.00234041259169273, 0.00226465650502445, 0.00219095880271807, 0.00211928023461019, 0.00198182336736244, 
        0.00191596658557509, 0.00185197206567322, 0.00178980085441253, 0.00167077352398686, 0.00161384058423653, 0.00155857737724178, 
        0.00150494623175586, 0.00140243119610648))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("dinvGauss", {
    x <- c(0.25, 0.265, 0.28, 0.295, 0.31, 0.325, 0.34, 0.355, 0.37, 0.385, 0.4, 0.415, 0.43, 0.445, 0.46, 0.475, 0.49, 0.505, 
        0.52, 0.535, 0.55, 0.565, 0.58, 0.595, 0.61, 0.625, 0.64, 0.655, 0.67, 0.685, 0.7, 0.715, 0.73, 0.745, 0.76, 0.775, 
        0.79, 0.805, 0.82, 0.835, 0.85, 0.865, 0.88, 0.895, 0.91, 0.925, 0.94, 0.955, 0.97, 0.985, 1, 1.015, 1.03, 1.045, 
        1.06, 1.075, 1.09, 1.105, 1.12, 1.135, 1.15, 1.165, 1.18, 1.195, 1.21, 1.225, 1.24, 1.255, 1.27, 1.285, 1.3, 1.315, 
        1.33, 1.345, 1.36, 1.375, 1.39, 1.405, 1.42, 1.435, 1.45, 1.465, 1.48, 1.495, 1.51, 1.525, 1.54, 1.555, 1.57, 1.585, 
        1.6, 1.615, 1.63, 1.645, 1.66, 1.675, 1.69, 1.705, 1.72, 1.735, 1.75)
    expect_equal(SuppDists:::dinvGauss(x = x, nu = 1, lambda = 16), c(1.94428251194345e-07, 9.66789317154105e-07, 3.97842625653945e-06, 
        1.39487821313813e-05, 4.26569086351315e-05, 0.000115975262664614, 0.000284766376700889, 0.000639771673493932, 0.00132958637189918, 
        0.00257966164431309, 0.00470933733398478, 0.00814348166296045, 0.0134155576150634, 0.0211598287156449, 0.0320917806656762, 
        0.0469773962963217, 0.0665933902062459, 0.0916816475113018, 0.12290177061093, 0.16078577308469, 0.205698614803859, 
        0.257807554359008, 0.31706234351609, 0.383187247199298, 0.455684867816351, 0.533850880928845, 0.616798111725736, 
        0.703487926177908, 0.792766676394559, 0.883404904673804, 0.974137139689873, 1.06370036938131, 1.15086960581531, 1.23448932836019, 
        1.31349996959342, 1.38695896741091, 1.4540562281461, 1.51412411748945, 1.56664231298731, 1.61123801313021, 1.64768210640186, 
        1.67588196454242, 1.69587154456938, 1.70779947135273, 1.71191573434155, 1.70855757553722, 1.69813507741947, 1.68111688475919, 
        1.65801641762515, 1.62937885796887, 1.59576912160573, 1.5577609630432, 1.51592730358606, 1.47083182404474, 1.42302182230034, 
        1.37302230270389, 1.32133123832083, 1.2684159277206, 1.2147103546006, 1.16061345022615, 1.10648815466342, 1.0526611723124, 
        0.999423319593805, 0.947030367159336, 0.895704285101164, 0.845634806837054, 0.796981235219269, 0.749874422608924, 
        0.704418864890696, 0.660694857454032, 0.618760668868474, 0.578654695210961, 0.540397564679839, 0.503994168204738, 
        0.469435597210639, 0.436700974517321, 0.405759168566724, 0.376570384798126, 0.349087631070329, 0.323258056603009, 
        0.299024166021262, 0.276324911784493, 0.255096669609646, 0.235274102504441, 0.216790919751643, 0.199580537670814, 
        0.183576649266536, 0.168713709985605, 0.154927346780615, 0.142154697540801, 0.130334687726769, 0.119408250754599, 
        0.109318498334689, 0.100010846596679, 0.0914331034368944, 0.0835355221193557, 0.0762708257544268, 0.0695942068774773, 
        0.0634633059590754, 0.0578381723024076, 0.0526812104259649))
})

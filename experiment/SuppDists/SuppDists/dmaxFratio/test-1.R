library(testthat)

.Random.seed <<- .ext.seed

test_that("dmaxFratio", {
    x <- c(1, 1.09, 1.18, 1.27, 1.36, 1.45, 1.54, 1.63, 1.72, 1.81, 1.9, 1.99, 2.08, 2.17, 2.26, 2.35, 2.44, 2.53, 2.62, 
        2.71, 2.8, 2.89, 2.98, 3.07, 3.16, 3.25, 3.34, 3.43, 3.52, 3.61, 3.7, 3.79, 3.88, 3.97, 4.06, 4.15, 4.24, 4.33, 4.42, 
        4.51, 4.6, 4.69, 4.78, 4.87, 4.96, 5.05, 5.14, 5.23, 5.32, 5.41, 5.5, 5.59, 5.68, 5.77, 5.86, 5.95, 6.04, 6.13, 6.22, 
        6.31, 6.4, 6.49, 6.58, 6.67, 6.76, 6.85, 6.94, 7.03, 7.12, 7.21, 7.3, 7.39, 7.48, 7.57, 7.66, 7.75, 7.84, 7.93, 8.02, 
        8.11, 8.2, 8.29, 8.38, 8.47, 8.56, 8.65, 8.74, 8.83, 8.92, 9.01, 9.1, 9.19, 9.28, 9.37, 9.46, 9.55, 9.64, 9.73, 9.82, 
        9.91, 10)
    expect_equal(SuppDists:::dmaxFratio(x = x, df = 10, k = 10), c(0, 2.36103185826642e-08, 3.82275323063656e-06, 6.19250547559491e-05, 
        0.000391751629735768, 0.00148463016391267, 0.00408006074190241, 0.00900568231516377, 0.0169700844065236, 0.028397291528481, 
        0.0433476335872296, 0.0615253250722455, 0.0823477251973146, 0.105044750405596, 0.128761868829276, 0.152649333803208, 
        0.175929279519788, 0.19793901764412, 0.218152988576106, 0.236187772827174, 0.251795027434488, 0.264846799832202, 
        0.275316853130679, 0.283260715214587, 0.288796310007232, 0.292088084943601, 0.293322891249928, 0.292714887011623, 
        0.290477672275642, 0.286825211598285, 0.28196421380049, 0.276090008282236, 0.269383844305477, 0.262011325796565, 
        0.254121726633034, 0.245847967964571, 0.237307075747056, 0.228600970886166, 0.219817474902063, 0.211031440324529, 
        0.202305937086611, 0.19369369056322, 0.185237375113864, 0.176971831549874, 0.168924486830265, 0.161116434238994, 
        0.153563303736238, 0.14627604746313, 0.139261642611907, 0.132523715616501, 0.126063092719246, 0.119877969723387, 
        0.113965714242933, 0.108321014998515, 0.102937497927103, 0.0978082581323698, 0.0929254891758798, 0.0882808606723829, 
        0.083865682619208, 0.0796710430509211, 0.0756879225303718, 0.071907288607791, 0.0683201730255251, 0.0649177341197995, 
        0.0616913065734608, 0.0586324404047109, 0.0557329308354063, 0.0529848404670491, 0.0503805150013471, 0.0479125935732175, 
        0.0455740146153854, 0.0433580180433011, 0.0412581444351182, 0.0392682317821466, 0.0373824102988912, 0.0355950957069936, 
        0.0339011950275382, 0.0322950293820806, 0.0307724614290267, 0.0293287486723793, 0.0279596017802024, 0.0266609606716045, 
        0.0254289842796387, 0.0242600403973851, 0.0231506956808271, 0.0220977058665468, 0.0210980062491494, 0.0201487024523212, 
        0.0192470615182352, 0.0183905033323792, 0.017576575049122, 0.0168030122583246, 0.0160676287231833, 0.0153683769363233, 
        0.0147033245955457, 0.0140706481160376, 0.0134686264731052, 0.012895635365431, 0.0123501416879175, 0.0118306983025283, 
        0.0113359463661544))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("dSpearman", {
    x <- c(-0.9, -0.882, -0.864, -0.846, -0.828, -0.81, -0.792, -0.774, -0.756, -0.738, -0.72, -0.702, -0.684, -0.666, -0.648, 
        -0.63, -0.612, -0.594, -0.576, -0.558, -0.54, -0.522, -0.504, -0.486, -0.468, -0.45, -0.432, -0.414, -0.396, -0.378, 
        -0.36, -0.342, -0.324, -0.306, -0.288, -0.27, -0.252, -0.234, -0.216, -0.198, -0.18, -0.162, -0.144, -0.126, -0.108, 
        -0.09, -0.072, -0.0539999999999999, -0.0359999999999999, -0.0179999999999999, 1.11022302462516e-16, 0.0180000000000001, 
        0.0360000000000001, 0.054, 0.0720000000000001, 0.0900000000000001, 0.108, 0.126, 0.144, 0.162, 0.18, 0.198, 0.216, 
        0.234, 0.252, 0.27, 0.288, 0.306, 0.324, 0.342, 0.36, 0.378, 0.396, 0.414, 0.432, 0.45, 0.468, 0.486, 0.504, 0.522, 
        0.54, 0.558, 0.576, 0.594, 0.612, 0.63, 0.648, 0.666, 0.684, 0.702, 0.72, 0.738, 0.756, 0.774, 0.792, 0.81, 0.828, 
        0.846, 0.864, 0.882, 0.9)
    expect_equal(SuppDists:::dSpearman(x = x, r = 10), c(0.000137235449735429, 0.00017057980599644, 0.000286596119929428, 
        0.000345017636684264, 0.000502645502645449, 0.000553902116402161, 0.000781801146384487, 0.000876322751322767, 0.00118634259259254, 
        0.00123815035273367, 0.00156305114638444, 0.0016964285714286, 0.00204585537918867, 0.00215773809523812, 0.00258818342151679, 
        0.00272597001763664, 0.00320960097001766, 0.00334573412698413, 0.00383542768959433, 0.00400104717813055, 0.00448578042328041, 
        0.00462411816578479, 0.00531305114638447, 0.00539737654320982, 0.00616870590828922, 0.00630952380952376, 0.00688106261022925, 
        0.00716820987654321, 0.00784474206349206, 0.00783371913580244, 0.00861772486772483, 0.00875606261022921, 0.00957561728395062, 
        0.00950699955908285, 0.0100030313051146, 0.010597442680776, 0.0107269620811287, 0.010853725749559, 0.0115928130511463, 
        0.0116909171075837, 0.0118289792768959, 0.0122861552028218, 0.012687389770723, 0.0129216269841269, 0.012961860670194, 
        0.0131299603174603, 0.01347194664903, 0.0132396384479717, 0.0133763227513227, 0.0134948192239859, 0.0135201719576719, 
        0.0134948192239858, 0.0137968474426807, 0.0132396384479717, 0.0134589947089946, 0.0131299603174603, 0.0130459104938271, 
        0.0129216269841269, 0.0125374779541446, 0.0122861552028218, 0.0124129188712522, 0.0116909171075837, 0.0118077601410934, 
        0.0108537257495591, 0.0110185185185185, 0.010597442680776, 0.0100848765432098, 0.0100030313051146, 0.00957561728395057, 
        0.00916666666666663, 0.00861772486772483, 0.00841600529100525, 0.00784474206349203, 0.00746693121693119, 0.00688106261022925, 
        0.00659942680776011, 0.00616870590828922, 0.00573054453262785, 0.00531305114638446, 0.00514936067019398, 0.00448578042328041, 
        0.00430197310405642, 0.00383542768959434, 0.00358961640211639, 0.00320960097001763, 0.0029425705467372, 0.00258818342151675, 
        0.00241760361552027, 0.00204585537918871, 0.00190393518518518, 0.00156305114638447, 0.00141369047619047, 0.00118634259259259, 
        0.00101300705467372, 0.000781801146384477, 0.00069802689594356, 0.0005026455026455, 0.000421075837742503, 0.000286596119929452, 
        0.000225694444444444, 0.000137235449735449))
})

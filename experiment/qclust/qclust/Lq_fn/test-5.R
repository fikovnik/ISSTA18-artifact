library(testthat)

.Random.seed <<- .ext.seed

test_that("Lq_fn", {
    q <- 0.9
    overall_pdf <- c(0.0115379066734176, 0.0087883945287766, 0.0217494286674039, 0.00516750592886613, 0.0195608027093416, 
        0.00312500810704532, 0.00399534463177322, 0.0213913876798588, 0.018477648867325, 0.00766576979825549, 0.00266725579439908, 
        0.00639852050925257, 0.00932154470745322, 0.00165741574734671, 0.000753112839742014, 0.00501266135499964, 0.0106674811338461, 
        0.0130725650326589, 0.00981893167852822, 0.0231420780303875, 0.00372368671030192, 0.00459299819000747, 0.0200455955117308, 
        0.00405514809840575, 0.0204994716385313, 0.00468703578917271, 0.0175521801424736, 0.0237205226247467, 0.0140995530289558, 
        0.0199277928735564, 0.019267076137856, 0.0205281348614958, 0.0127007419384808, 0.00950128145684194, 0.0142609448439818, 
        0.00886025845418458, 0.0156086113248936, 0.00424109127206421, 0.00165528602190185, 0.00338916932965496, 0.014546047474218, 
        0.0091692718550522, 0.0211767384873402, 0.0146440437993045, 0.0208418172481408, 0.0209662088257982, 0.0207434971608253, 
        0.0100534936504377, 0.018730317020927, 0.0211400475351353, 0.00565909667000404, 0.0127660653065139, 0.021016499127447, 
        0.00354021956190584, 0.0252312211415761, 0.0125583405869246, 0.00221121382351445, 0.0176631601726374, 0.00390513941307567, 
        0.00204894110378552, 0.000862604619123086, 0.0233123275636143, 0.00535780132440624, 0.0236194788997392, 0.016379377377317, 
        0.017856956906451, 0.0236902727438121, 0.0180552805921965, 0.0175250726776998, 0.021980922444421, 0.0144933809184534, 
        0.0116373322246987, 0.015991779761732, 0.00140539018205134, 0.0172655579546371, 0.00832071562603654, 0.00725012070612816, 
        0.0172169060460285, 0.0190708462818331, 0.00690637612711086, 0.00853074972891834, 0.0208743153483247, 0.0160235696103727, 
        0.0209359337989541, 0.00327303394080523, 0.00700833534639375, 0.000701687035132732, 0.010482930425912, 0.0154986350478679, 
        0.010455860130504, 0.00920876553560782, 0.0146925324668343, 0.0151184584979101, 0.011536291400951, 0.00905100076549759, 
        0.00847336749054762, 0.0169924156299167, 0.00872587674752538, 0.00415856805067086, 0.0114734069292603, 0.0164883178139443, 
        0.0123184907673704, 0.0173778783607366, 0.00850055113161859, 0.012033007852897, 0.00823643377664101, 0.00138702902865027, 
        0.00116596046588421, 0.00239119335636716, 0.000652586322655291, 0.0158523605703983, 0.0101651626315066, 0.0055518774163048, 
        0.0165816060633539, 0.013645068894948, 0.00564814808844437, 0.0134931170897534, 0.017197864122592, 0.00547405476011579, 
        0.0160153361877711, 0.00145915544639609, 0.0106935143017531, 0.0164774058491625, 0.0122913373807846, 0.00229112167377619, 
        0.0173757576154009, 0.000971945057010811, 0.00921800529657843, 0.0176659353267443, 0.00834592787957831, 0.0011592136961162, 
        0.016698586933054, 0.016310689212797, 0.0055437606626551, 0.013672636207047, 0.0098078092873816, 0.0154165193074382, 
        0.00908606460779021, 0.000687850981088271, 0.00191542284513804, 0.0133777281513781, 0.0130755983316127, 0.0158742092342782, 
        0.000566401973011679, 0.0172775125463881, 0.0259592602820173, 0.0396355064721981, 0.0397587328939278, 0.0326427459156846, 
        0.0100956076847641, 0.0345799253087885, 0.01795431254575, 0.0148634796438741, 0.0389571816180355, 0.0107673374714889, 
        0.0238571459347421, 0.0179249898649512, 0.0257681955082441, 0.0196058633330762, 0.00419136394454855, 0.0355594100028659, 
        0.0319530340580759, 0.012872212684882, 0.00687525461213236, 0.014712308906516, 0.0278089196547605, 0.0126706730928105, 
        0.0332771502426459, 0.00154251132832613, 0.00166850489059195, 0.0291335785526782, 0.0173306088700916, 0.0161895133831918, 
        0.00102459677776645, 0.0152411634572305, 0.0149809629967596, 0.0332268278677196, 0.00890422825181372, 0.00985560760568164, 
        0.0188990716525049, 0.0152646017138125, 0.0232460425409398, 0.0259015809730629, 0.0154956700925858, 0.00266771820833382, 
        0.0150190069253617, 0.000792519314989485, 0.0214215468664885, 0.0312408706793049, 0.0438496578793004, 0.0437070933027545, 
        0.034157311668806, 0.00991834947273209, 0.0311305409548078, 0.0410662588884032, 0.00641588855681164, 0.00185584262706958, 
        0.0388816686182571, 0.0213176884789652, 0.0414485275056165)
    expect_equal(qclust:::Lq_fn(x = overall_pdf, q = q), c(-3.59951768136151, -3.77139264149245, -3.18062166825005, -4.09352869559472, 
        -3.25256565694953, -4.38324973025932, -4.24354088199077, -3.19193182815486, -3.29089373029147, -3.85593817256384, 
        -4.4715107847293, -3.9659631702813, -3.73460020281813, -4.72839154239373, -5.12823865489745, -4.11147075139345, -3.64952532647339, 
        -3.51908864758846, -3.70194536445912, -3.13816555963656, -4.2839329629553, -4.1627320755459, -3.23602651821676, -4.23498194222375, 
        -3.22086524668025, -4.15088948730727, -3.32527915939381, -3.12120407455293, -3.46988943644571, -3.24001207701596, 
        -3.26276678070389, -3.21991795545355, -3.53776258883725, -3.72262290586522, -3.4624529114059, -3.76631806764701, 
        -3.4031527725386, -4.20907737874563, -4.72906931897863, -4.33748550469886, -3.44949925959723, -3.74491112222026, 
        -3.19879434340467, -3.44509952709099, -3.20962813659302, -3.20558623839485, -3.21283827644482, -3.68705943149572, 
        -3.28177549331382, -3.19997364439702, -4.03960953525835, -3.53444655214061, -3.20395826234575, -4.31274082836488, 
        -3.0786019381579, -3.54504489991471, -4.57420883471668, -3.3210707850606, -4.25667153927003, -4.61540619147282, -5.06165783322214, 
        -3.13313414195396, -4.07213014112621, -3.12413990836129, -3.37127901873735, -3.31377872588754, -3.1220818050716, 
        -3.3063897008553, -3.32631071574292, -3.17339787816122, -3.45187485821419, -3.59402346846238, -3.38713464634632, 
        -4.8146307069911, -3.33625972452037, -3.80536006522148, -3.8900940706857, -3.33813985791094, -3.26966011923556, -3.91969979108205, 
        -3.78989819097446, -3.20857007388165, -3.38582125800347, -3.20656798405454, -4.3571948909056, -3.91078249148028, 
        -5.16257388057207, -3.66059832380537, -3.4078156300544, -3.66223726648387, -3.74222215220732, -3.44293232655773, 
        -3.42416736510793, -3.59960729184742, -3.75302655015271, -3.79408812524205, -3.34687761797024, -3.77583771825036, 
        -4.22044526217484, -3.60310474176978, -3.36688334812025, -3.5574803738813, -3.33193729326436, -3.79210005815, -3.57256904547415, 
        -3.81166349979184, -4.82144545421191, -4.91057894086664, -4.53158495432342, -5.19753955271124, -3.39292260409078, 
        -3.68008214967803, -4.05099975450525, -3.36313995835342, -3.49125026083517, -4.04076368951144, -3.49853500002133, 
        -3.3388770275878, -4.05939175357552, -3.38616119427255, -4.79512677286055, -3.6479772412656, -3.36732245840873, -3.55890189536168, 
        -4.5549130978516, -3.33201867281623, -5.00236917612861, -3.74159455145963, -3.32096585622949, -3.80348560765367, 
        -4.91353160459423, -3.35847254656607, -3.37406408305541, -4.05187006129797, -3.48993648353416, -3.70265914027363, 
        -3.41131669369547, -3.75061066298791, -5.17219815789066, -4.65156815098889, -3.50411636292207, -3.51893828314804, 
        -3.39201254177672, -5.26508185257755, -3.33579847395085, -3.0588851364078, -2.75883503980888, -2.7565869117881, -2.89803269779868, 
        -3.68441991566751, -2.85697113541532, -3.31014232898513, -3.43534285010437, -2.77132410745416, -3.64360565664173, 
        -3.11725231985117, -3.31123570907177, -3.06401092042829, -3.25101291454165, -4.21590340227808, -2.8369916955369, 
        -2.91318313160592, -3.52909057859614, -3.92244526807627, -3.44205026640274, -3.01094574688436, -3.53929414774409, 
        -2.88434943293207, -4.76613114628519, -4.72487508247346, -2.9783466784001, -3.33375329404723, -3.37900317666168, 
        -4.97593443288168, -3.41884965803529, -3.43017240274129, -2.88542620884998, -3.76323143586135, -3.69959684364543, 
        -3.27574697284153, -3.41783829135203, -3.13508913251397, -3.06042893839678, -3.40794175222339, -4.47141494648849, 
        -3.42850590850587, -5.1033283218469, -3.19097258394796, -2.92913878824236, -2.68529828282542, -2.68767993468301, 
        -2.8657492717385, -3.69559738277689, -2.93163989886661, -2.73311120799048, -3.96432729760723, -4.66844228859038, 
        -2.77272650797573, -3.19428103892922, -2.72637493472778))
})

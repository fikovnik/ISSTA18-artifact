library(testthat)

.Random.seed <<- .ext.seed

test_that("as.radialNetwork", {
    dist <- stats::dist
    hclust <- stats::hclust
    USArrests <- datasets::USArrests
    hc <- structure(list(merge = structure(c(-15L, -17L, -14L, -13L, -35L, -36L, -7L, -19L, -49L, -50L, -48L, -21L, -27L, 
        -4L, -37L, -34L, -22L, 3L, -3L, -6L, -12L, 5L, -20L, -1L, -47L, -8L, 4L, -23L, -25L, 21L, -24L, -39L, -10L, 26L, 
        25L, 16L, -5L, -2L, 29L, 11L, -9L, 34L, -11L, 37L, 35L, 30L, 41L, 45L, 47L, -29L, -26L, -16L, -32L, -44L, -46L, -38L, 
        -41L, 1L, 6L, 8L, -30L, 2L, -42L, 10L, -45L, -28L, 7L, -31L, -43L, 13L, 18L, 19L, -18L, 15L, 24L, 17L, 9L, 14L, 22L, 
        -40L, 12L, 20L, 27L, 32L, 28L, 23L, 31L, 33L, 36L, -33L, 38L, 40L, 42L, 39L, 43L, 44L, 46L, 48L), .Dim = c(49L, 2L)), 
        height = c(2.29128784747792, 3.83405790253616, 3.9293765408777, 6.23698645180507, 6.63777071011044, 7.35527021937332, 
            8.02745289615579, 8.5375640553966, 10.1842178699022, 10.7367388186717, 10.7711752200225, 11.4564392373896, 12.4386917531679, 
            12.6142776249772, 12.8780996471237, 13.0449223838243, 13.2973681606549, 13.3522599960709, 13.8960426021224, 14.5010344458594, 
            15.0261072725121, 15.1228971665018, 15.4531200289137, 15.4544491975612, 16.425489079327, 16.8914988216046, 18.4173313943456, 
            18.993397505721, 20.1984786527384, 20.5985066190634, 21.1671915945408, 22.5959782848049, 23.9721425454471, 26.3634282396782, 
            26.7137768982926, 27.7799038518465, 28.0122112970931, 28.0958028692397, 29.0541950311957, 33.1178150270327, 38.5279119600323, 
            39.3946331306859, 41.0947650735165, 44.283921672634, 44.8379332309712, 54.7468308127929, 77.6050243110769, 89.232093175428, 
            152.313999380806), order = c(9L, 33L, 5L, 20L, 3L, 31L, 8L, 1L, 18L, 13L, 32L, 22L, 28L, 2L, 24L, 40L, 47L, 37L, 
            50L, 36L, 46L, 39L, 21L, 30L, 25L, 4L, 42L, 10L, 6L, 43L, 12L, 27L, 17L, 26L, 35L, 44L, 14L, 16L, 7L, 38L, 11L, 
            48L, 19L, 41L, 34L, 45L, 23L, 49L, 15L, 29L), labels = c("Alabama", "Alaska", "Arizona", "Arkansas", "California", 
            "Colorado", "Connecticut", "Delaware", "Florida", "Georgia", "Hawaii", "Idaho", "Illinois", "Indiana", "Iowa", 
            "Kansas", "Kentucky", "Louisiana", "Maine", "Maryland", "Massachusetts", "Michigan", "Minnesota", "Mississippi", 
            "Missouri", "Montana", "Nebraska", "Nevada", "New Hampshire", "New Jersey", "New Mexico", "New York", "North Carolina", 
            "North Dakota", "Ohio", "Oklahoma", "Oregon", "Pennsylvania", "Rhode Island", "South Carolina", "South Dakota", 
            "Tennessee", "Texas", "Utah", "Vermont", "Virginia", "Washington", "West Virginia", "Wisconsin", "Wyoming"), 
        method = "average", call = hclust(d = dist(USArrests), method = "ave"), dist.method = "euclidean"), class = "hclust")
    expect_equal(networkD3:::as.radialNetwork(d = hc), list(name = "hc", children = list(list(name = "", children = list(list(name = "", 
        children = list(list(name = "Florida", children = list(name = "Florida")), list(name = "North Carolina", children = list(name = "North Carolina")))), 
        list(name = "", children = list(list(name = "", children = list(list(name = "California", children = list(name = "California")), 
            list(name = "", children = list(list(name = "Maryland", children = list(name = "Maryland")), list(name = "", 
                children = list(list(name = "Arizona", children = list(name = "Arizona")), list(name = "New Mexico", children = list(name = "New Mexico")))))))), 
            list(name = "", children = list(list(name = "", children = list(list(name = "", children = list(list(name = "Delaware", 
                children = list(name = "Delaware")), list(name = "", children = list(list(name = "Alabama", children = list(name = "Alabama")), 
                list(name = "Louisiana", children = list(name = "Louisiana")))))), list(name = "", children = list(list(name = "", 
                children = list(list(name = "Illinois", children = list(name = "Illinois")), list(name = "New York", children = list(name = "New York")))), 
                list(name = "", children = list(list(name = "Michigan", children = list(name = "Michigan")), list(name = "Nevada", 
                  children = list(name = "Nevada")))))))), list(name = "", children = list(list(name = "Alaska", children = list(name = "Alaska")), 
                list(name = "", children = list(list(name = "Mississippi", children = list(name = "Mississippi")), list(name = "South Carolina", 
                  children = list(name = "South Carolina")))))))))))), list(name = "", children = list(list(name = "", children = list(list(name = "", 
        children = list(list(name = "", children = list(list(name = "Washington", children = list(name = "Washington")), 
            list(name = "", children = list(list(name = "Oregon", children = list(name = "Oregon")), list(name = "", children = list(list(name = "Wyoming", 
                children = list(name = "Wyoming")), list(name = "", children = list(list(name = "Oklahoma", children = list(name = "Oklahoma")), 
                list(name = "Virginia", children = list(name = "Virginia")))))))))), list(name = "", children = list(list(name = "Rhode Island", 
            children = list(name = "Rhode Island")), list(name = "", children = list(list(name = "Massachusetts", children = list(name = "Massachusetts")), 
            list(name = "New Jersey", children = list(name = "New Jersey")))))))), list(name = "", children = list(list(name = "", 
        children = list(list(name = "Missouri", children = list(name = "Missouri")), list(name = "", children = list(list(name = "Arkansas", 
            children = list(name = "Arkansas")), list(name = "Tennessee", children = list(name = "Tennessee")))))), list(name = "", 
        children = list(list(name = "Georgia", children = list(name = "Georgia")), list(name = "", children = list(list(name = "Colorado", 
            children = list(name = "Colorado")), list(name = "Texas", children = list(name = "Texas")))))))))), list(name = "", 
        children = list(list(name = "", children = list(list(name = "", children = list(list(name = "Idaho", children = list(name = "Idaho")), 
            list(name = "", children = list(list(name = "Nebraska", children = list(name = "Nebraska")), list(name = "", 
                children = list(list(name = "Kentucky", children = list(name = "Kentucky")), list(name = "Montana", children = list(name = "Montana")))))))), 
            list(name = "", children = list(list(name = "", children = list(list(name = "Ohio", children = list(name = "Ohio")), 
                list(name = "Utah", children = list(name = "Utah")))), list(name = "", children = list(list(name = "", children = list(list(name = "Indiana", 
                children = list(name = "Indiana")), list(name = "Kansas", children = list(name = "Kansas")))), list(name = "", 
                children = list(list(name = "Connecticut", children = list(name = "Connecticut")), list(name = "Pennsylvania", 
                  children = list(name = "Pennsylvania")))))))))), list(name = "", children = list(list(name = "Hawaii", 
            children = list(name = "Hawaii")), list(name = "", children = list(list(name = "", children = list(list(name = "West Virginia", 
            children = list(name = "West Virginia")), list(name = "", children = list(list(name = "Maine", children = list(name = "Maine")), 
            list(name = "South Dakota", children = list(name = "South Dakota")))))), list(name = "", children = list(list(name = "", 
            children = list(list(name = "North Dakota", children = list(name = "North Dakota")), list(name = "Vermont", children = list(name = "Vermont")))), 
            list(name = "", children = list(list(name = "Minnesota", children = list(name = "Minnesota")), list(name = "", 
                children = list(list(name = "Wisconsin", children = list(name = "Wisconsin")), list(name = "", children = list(list(name = "Iowa", 
                  children = list(name = "Iowa")), list(name = "New Hampshire", children = list(name = "New Hampshire")))))))))))))))))))))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("venn", {
    CVF <- structure(list(DEMOC = c(0.41, 0.06, 0.06, 0.1, 0.1, 0.13, 0.13, 0.13, 0.87, 0.87, 0.82, 0.35, 0.96, 0.96, 0.88, 
        0.56, 0.56, 0.56, 0.49, 0.49, 0.7, 0.96, 0.96, 0.96, 0.96, 0.49, 0.49, 0.12, 0.12), ETHFRACT = c(0.08, 0.14, 0.14, 
        0.32, 0.32, 0.86, 0.86, 0.86, 0.23, 0.23, 0.54, 0.49, 0.06, 0.06, 0.72, 0.59, 0.59, 0.59, 0.54, 0.54, 0.23, 0.51, 
        0.51, 0.26, 0.26, 0.39, 0.39, 0.95, 0.95), GEOCON = c(0.95, 0.35, 0.35, 0.78, 0.35, 0.78, 0.78, 0.78, 0.78, 0.05, 
        0.78, 0.35, 0.95, 0.95, 0.35, 0.95, 0.78, 0.35, 0.95, 0.35, 0.95, 0.95, 0.95, 0.95, 0.95, 0.95, 0.95, 0.95, 0.95), 
        POLDIS = c(0.88, 0.05, 0.24, 0.37, 0.05, 0.05, 0.05, 0.05, 0.05, 0.95, 0.8, 0.11, 0.05, 0.05, 0.92, 0.58, 0.05, 0.69, 
            0.65, 0.05, 0.83, 0.05, 0.05, 0.58, 0.05, 0.05, 0.05, 0.95, 0.92), NATPRIDE = c(0.77, 0.88, 0.91, 0.8, 0.6, 0.66, 
            0.96, 0.87, 0.7, 0.83, 0.54, 0.93, 0.86, 0.75, 0.29, 0.25, 0.87, 0.95, 0.6, 0.51, 0.62, 0.38, 0.86, 0.75, 0.88, 
            0.06, 0.34, 0.43, 0.41), PROTEST = c(0.47, 0.7, 0.03, 0.03, 0.03, 0.27, 0.15, 0.44, 0.47, 0.36, 0.79, 0.33, 0.02, 
            0.36, 0.85, 0.85, 0.57, 0.09, 0.73, 0.56, 0.59, 0.93, 0.56, 0.89, 0.36, 0.89, 0.52, 0.85, 0.98)), class = "data.frame", 
        row.names = c("GreeksAlbania", "LezginsAzerbaijan", "RussiansAzerbaijan", "PolesBelarus", "RussiansBelarus", "CroatsBosnia", 
            "MuslimsBosnia", "SerbsBosnia", "TurksBulgaria", "RomaBulgaria", "RussiansEstonia", "RussiansGeorgia", "SardiniansItaly", 
            "SouthTyrolians", "RussiansLatvia", "AlbaniansFYROM", "SerbsFYROM", "RomaFYROM", "GagauzMoldova", "SlavsMoldova", 
            "HungariansRom", "BasquesSpain", "CatalansSpain", "CatholicsNIreland", "ScotsUK", "CrimRussiansUkr", "RussiansUkraine", 
            "HungariansYugo", "KosovoAlbanians"))
    truthTable <- QCA::truthTable
    obj <- structure(list(tt = structure(list(DEMOC = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1), ETHFRACT = c(0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 
        0, 1, 1, 1, 1, 1, 1, 1, 1), GEOCON = c(0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 
        0, 0, 0, 1, 1, 1, 1), POLDIS = c(0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 
        1, 0, 0, 1, 1), NATPRIDE = c(0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 
        0, 1, 0, 1), OUT = c("?", "0", "?", "?", "1", "0", "?", "0", "?", "0", "?", "?", "?", "0", "1", "0", "?", "?", "?", 
        "0", "?", "0", "?", "1", "?", "?", "1", "0", "1", "1", "1", "1"), n = c(0, 4, 0, 0, 2, 1, 0, 1, 0, 1, 0, 0, 0, 3, 
        2, 1, 0, 0, 0, 1, 0, 4, 0, 2, 0, 0, 1, 1, 1, 2, 1, 1), incl = c("-", "0.6484375", "-", "-", "0.873893805309735", 
        "0.731663685152057", "-", "0.748704663212435", "-", "0.740831295843521", "-", "-", "-", "0.652631578947368", "0.928947368421053", 
        "0.821428571428572", "-", "-", "-", "0.711475409836066", "-", "0.725274725274725", "-", "0.903930131004367", "-", 
        "-", "0.937759336099585", "0.767790262172285", "0.956701030927835", "0.921739130434783", "0.958791208791209", "0.892105263157895"), 
        PRI = c("-", "0.181818181818181", "-", "-", "0.583941605839416", "0.147727272727273", "-", "0.248062015503875", "-", 
            "0.0862068965517235", "-", "-", "-", "0.0976562500000003", "0.839285714285715", "0.590643274853801", "-", "-", 
            "-", "0.161904761904761", "-", "0.281150159744409", "-", "0.754189944134078", "-", "-", "0.782608695652174", 
            "0.225000000000001", "0.858108108108108", "0.666666666666666", "0.891304347826087", "0.717241379310345"), cases = c("", 
            "LezginsAzerbaijan,RussiansAzerbaijan,RussiansBelarus,RussiansGeorgia", "", "", "CrimRussiansUkr,RussiansUkraine", 
            "PolesBelarus", "", "GreeksAlbania", "", "SlavsMoldova", "", "", "", "CroatsBosnia,MuslimsBosnia,SerbsBosnia", 
            "HungariansYugo,KosovoAlbanians", "GagauzMoldova", "", "", "", "RomaBulgaria", "", "TurksBulgaria,SardiniansItaly,SouthTyrolians,ScotsUK", 
            "", "HungariansRom,CatholicsNIreland", "", "", "RussiansLatvia", "RomaFYROM", "BasquesSpain", "SerbsFYROM,CatalansSpain", 
            "AlbaniansFYROM", "RussiansEstonia")), row.names = c(NA, -32L), class = "data.frame"), indexes = c(2, 5, 6, 8, 
        10, 14, 15, 16, 20, 22, 24, 27, 28, 29, 30, 31, 32), noflevels = c(2, 2, 2, 2, 2), initial.data = structure(list(DEMOC = c(0.41, 
        0.06, 0.06, 0.1, 0.1, 0.13, 0.13, 0.13, 0.87, 0.87, 0.82, 0.35, 0.96, 0.96, 0.88, 0.56, 0.56, 0.56, 0.49, 0.49, 0.7, 
        0.96, 0.96, 0.96, 0.96, 0.49, 0.49, 0.12, 0.12), ETHFRACT = c(0.08, 0.14, 0.14, 0.32, 0.32, 0.86, 0.86, 0.86, 0.23, 
        0.23, 0.54, 0.49, 0.06, 0.06, 0.72, 0.59, 0.59, 0.59, 0.54, 0.54, 0.23, 0.51, 0.51, 0.26, 0.26, 0.39, 0.39, 0.95, 
        0.95), GEOCON = c(0.95, 0.35, 0.35, 0.78, 0.35, 0.78, 0.78, 0.78, 0.78, 0.05, 0.78, 0.35, 0.95, 0.95, 0.35, 0.95, 
        0.78, 0.35, 0.95, 0.35, 0.95, 0.95, 0.95, 0.95, 0.95, 0.95, 0.95, 0.95, 0.95), POLDIS = c(0.88, 0.05, 0.24, 0.37, 
        0.05, 0.05, 0.05, 0.05, 0.05, 0.95, 0.8, 0.11, 0.05, 0.05, 0.92, 0.58, 0.05, 0.69, 0.65, 0.05, 0.83, 0.05, 0.05, 
        0.58, 0.05, 0.05, 0.05, 0.95, 0.92), NATPRIDE = c(0.77, 0.88, 0.91, 0.8, 0.6, 0.66, 0.96, 0.87, 0.7, 0.83, 0.54, 
        0.93, 0.86, 0.75, 0.29, 0.25, 0.87, 0.95, 0.6, 0.51, 0.62, 0.38, 0.86, 0.75, 0.88, 0.06, 0.34, 0.43, 0.41), PROTEST = c(0.47, 
        0.7, 0.03, 0.03, 0.03, 0.27, 0.15, 0.44, 0.47, 0.36, 0.79, 0.33, 0.02, 0.36, 0.85, 0.85, 0.57, 0.09, 0.73, 0.56, 
        0.59, 0.93, 0.56, 0.89, 0.36, 0.89, 0.52, 0.85, 0.98)), class = "data.frame", row.names = c("GreeksAlbania", "LezginsAzerbaijan", 
        "RussiansAzerbaijan", "PolesBelarus", "RussiansBelarus", "CroatsBosnia", "MuslimsBosnia", "SerbsBosnia", "TurksBulgaria", 
        "RomaBulgaria", "RussiansEstonia", "RussiansGeorgia", "SardiniansItaly", "SouthTyrolians", "RussiansLatvia", "AlbaniansFYROM", 
        "SerbsFYROM", "RomaFYROM", "GagauzMoldova", "SlavsMoldova", "HungariansRom", "BasquesSpain", "CatalansSpain", "CatholicsNIreland", 
        "ScotsUK", "CrimRussiansUkr", "RussiansUkraine", "HungariansYugo", "KosovoAlbanians")), recoded.data = structure(list(DEMOC = c(0.41, 
        0.06, 0.06, 0.1, 0.1, 0.13, 0.13, 0.13, 0.87, 0.87, 0.82, 0.35, 0.96, 0.96, 0.88, 0.56, 0.56, 0.56, 0.49, 0.49, 0.7, 
        0.96, 0.96, 0.96, 0.96, 0.49, 0.49, 0.12, 0.12), ETHFRACT = c(0.08, 0.14, 0.14, 0.32, 0.32, 0.86, 0.86, 0.86, 0.23, 
        0.23, 0.54, 0.49, 0.06, 0.06, 0.72, 0.59, 0.59, 0.59, 0.54, 0.54, 0.23, 0.51, 0.51, 0.26, 0.26, 0.39, 0.39, 0.95, 
        0.95), GEOCON = c(0.95, 0.35, 0.35, 0.78, 0.35, 0.78, 0.78, 0.78, 0.78, 0.05, 0.78, 0.35, 0.95, 0.95, 0.35, 0.95, 
        0.78, 0.35, 0.95, 0.35, 0.95, 0.95, 0.95, 0.95, 0.95, 0.95, 0.95, 0.95, 0.95), POLDIS = c(0.88, 0.05, 0.24, 0.37, 
        0.05, 0.05, 0.05, 0.05, 0.05, 0.95, 0.8, 0.11, 0.05, 0.05, 0.92, 0.58, 0.05, 0.69, 0.65, 0.05, 0.83, 0.05, 0.05, 
        0.58, 0.05, 0.05, 0.05, 0.95, 0.92), NATPRIDE = c(0.77, 0.88, 0.91, 0.8, 0.6, 0.66, 0.96, 0.87, 0.7, 0.83, 0.54, 
        0.93, 0.86, 0.75, 0.29, 0.25, 0.87, 0.95, 0.6, 0.51, 0.62, 0.38, 0.86, 0.75, 0.88, 0.06, 0.34, 0.43, 0.41), PROTEST = c(0.47, 
        0.7, 0.03, 0.03, 0.03, 0.27, 0.15, 0.44, 0.47, 0.36, 0.79, 0.33, 0.02, 0.36, 0.85, 0.85, 0.57, 0.09, 0.73, 0.56, 
        0.59, 0.93, 0.56, 0.89, 0.36, 0.89, 0.52, 0.85, 0.98)), row.names = c("GreeksAlbania", "LezginsAzerbaijan", "RussiansAzerbaijan", 
        "PolesBelarus", "RussiansBelarus", "CroatsBosnia", "MuslimsBosnia", "SerbsBosnia", "TurksBulgaria", "RomaBulgaria", 
        "RussiansEstonia", "RussiansGeorgia", "SardiniansItaly", "SouthTyrolians", "RussiansLatvia", "AlbaniansFYROM", "SerbsFYROM", 
        "RomaFYROM", "GagauzMoldova", "SlavsMoldova", "HungariansRom", "BasquesSpain", "CatalansSpain", "CatholicsNIreland", 
        "ScotsUK", "CrimRussiansUkr", "RussiansUkraine", "HungariansYugo", "KosovoAlbanians"), class = "data.frame"), cases = c("LezginsAzerbaijan,RussiansAzerbaijan,RussiansBelarus,RussiansGeorgia", 
        "CrimRussiansUkr,RussiansUkraine", "PolesBelarus", "GreeksAlbania", "SlavsMoldova", "CroatsBosnia,MuslimsBosnia,SerbsBosnia", 
        "HungariansYugo,KosovoAlbanians", "GagauzMoldova", "RomaBulgaria", "TurksBulgaria,SardiniansItaly,SouthTyrolians,ScotsUK", 
        "HungariansRom,CatholicsNIreland", "RussiansLatvia", "RomaFYROM", "BasquesSpain", "SerbsFYROM,CatalansSpain", "AlbaniansFYROM", 
        "RussiansEstonia"), DCC = structure(c("RussiansAzerbaijan,RussiansBelarus,RussiansGeorgia", "", "PolesBelarus", "GreeksAlbania", 
        "", "CroatsBosnia,MuslimsBosnia,SerbsBosnia", "", "", "RomaBulgaria", "TurksBulgaria,SardiniansItaly,SouthTyrolians,ScotsUK", 
        "", "", "RomaFYROM", "", "", "", ""), names = c("2", "5", "6", "8", "10", "14", "15", "16", "20", "22", "24", "27", 
        "28", "29", "30", "31", "32")), minmat = structure(c(0.05, 0.65, 0.65, 0.22, 0.6, 0.14, 0.14, 0.14, 0.13, 0.05, 0.18, 
        0.51, 0.04, 0.04, 0.08, 0.05, 0.22, 0.31, 0.05, 0.46, 0.05, 0.04, 0.04, 0.04, 0.04, 0.05, 0.05, 0.05, 0.05, 0.12, 
        0.12, 0.09, 0.2, 0.35, 0.14, 0.04, 0.13, 0.13, 0.05, 0.18, 0.07, 0.04, 0.04, 0.08, 0.41, 0.13, 0.05, 0.35, 0.35, 
        0.17, 0.04, 0.04, 0.04, 0.04, 0.51, 0.51, 0.05, 0.05, 0.12, 0.35, 0.35, 0.63, 0.35, 0.14, 0.14, 0.14, 0.13, 0.05, 
        0.18, 0.35, 0.04, 0.04, 0.08, 0.25, 0.41, 0.31, 0.35, 0.35, 0.17, 0.04, 0.04, 0.04, 0.04, 0.06, 0.34, 0.05, 0.05, 
        0.59, 0.05, 0.24, 0.37, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.18, 0.11, 0.04, 0.04, 0.12, 0.25, 0.05, 0.35, 0.46, 
        0.05, 0.3, 0.04, 0.04, 0.04, 0.04, 0.05, 0.05, 0.05, 0.05, 0.05, 0.14, 0.14, 0.22, 0.32, 0.22, 0.22, 0.22, 0.13, 
        0.05, 0.18, 0.49, 0.04, 0.04, 0.08, 0.05, 0.22, 0.31, 0.05, 0.51, 0.05, 0.04, 0.04, 0.04, 0.04, 0.05, 0.05, 0.05, 
        0.05, 0.08, 0.14, 0.14, 0.32, 0.32, 0.66, 0.78, 0.78, 0.13, 0.05, 0.18, 0.35, 0.04, 0.04, 0.08, 0.25, 0.44, 0.31, 
        0.35, 0.35, 0.17, 0.04, 0.04, 0.04, 0.04, 0.06, 0.34, 0.05, 0.08, 0.08, 0.05, 0.09, 0.2, 0.05, 0.05, 0.04, 0.05, 
        0.05, 0.05, 0.18, 0.07, 0.04, 0.04, 0.12, 0.44, 0.05, 0.05, 0.4, 0.05, 0.23, 0.04, 0.04, 0.04, 0.04, 0.05, 0.05, 
        0.57, 0.59, 0.08, 0.05, 0.14, 0.32, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.18, 0.11, 0.04, 0.04, 0.12, 0.25, 0.05, 
        0.35, 0.51, 0.05, 0.23, 0.04, 0.04, 0.04, 0.04, 0.05, 0.05, 0.43, 0.41, 0.05, 0.05, 0.06, 0.1, 0.05, 0.05, 0.05, 
        0.05, 0.05, 0.77, 0.22, 0.11, 0.05, 0.05, 0.28, 0.05, 0.05, 0.41, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 
        0.05, 0.05, 0.05, 0.12, 0.06, 0.06, 0.1, 0.1, 0.13, 0.13, 0.13, 0.7, 0.05, 0.2, 0.35, 0.86, 0.75, 0.08, 0.25, 0.41, 
        0.31, 0.35, 0.35, 0.17, 0.38, 0.49, 0.42, 0.74, 0.06, 0.34, 0.05, 0.05, 0.41, 0.05, 0.06, 0.1, 0.05, 0.05, 0.05, 
        0.05, 0.05, 0.05, 0.46, 0.11, 0.05, 0.05, 0.28, 0.25, 0.05, 0.35, 0.46, 0.05, 0.62, 0.05, 0.05, 0.58, 0.05, 0.05, 
        0.05, 0.05, 0.05, 0.05, 0.05, 0.06, 0.1, 0.05, 0.05, 0.04, 0.05, 0.05, 0.17, 0.22, 0.07, 0.05, 0.05, 0.65, 0.05, 
        0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.06, 0.1, 0.05, 0.05, 
        0.05, 0.05, 0.05, 0.23, 0.22, 0.11, 0.05, 0.05, 0.29, 0.05, 0.05, 0.56, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 
        0.05, 0.05, 0.05, 0.05, 0.08, 0.06, 0.06, 0.1, 0.1, 0.13, 0.04, 0.13, 0.23, 0.05, 0.2, 0.07, 0.06, 0.06, 0.08, 0.42, 
        0.13, 0.05, 0.35, 0.35, 0.17, 0.51, 0.14, 0.25, 0.12, 0.39, 0.39, 0.05, 0.08, 0.08, 0.06, 0.06, 0.1, 0.1, 0.13, 0.13, 
        0.13, 0.23, 0.05, 0.2, 0.35, 0.06, 0.06, 0.08, 0.25, 0.56, 0.31, 0.35, 0.35, 0.17, 0.38, 0.51, 0.26, 0.26, 0.06, 
        0.34, 0.05, 0.08, 0.08, 0.05, 0.06, 0.1, 0.05, 0.05, 0.04, 0.05, 0.05, 0.05, 0.46, 0.07, 0.05, 0.05, 0.35, 0.56, 
        0.05, 0.05, 0.4, 0.05, 0.23, 0.05, 0.05, 0.25, 0.05, 0.05, 0.05, 0.12, 0.12, 0.08, 0.05, 0.06, 0.1, 0.05, 0.05, 0.05, 
        0.05, 0.05, 0.05, 0.54, 0.11, 0.05, 0.05, 0.29, 0.25, 0.05, 0.35, 0.49, 0.05, 0.23, 0.05, 0.05, 0.26, 0.05, 0.05, 
        0.05, 0.12, 0.12), .Dim = c(29L, 17L), .Dimnames = list(c("GreeksAlbania", "LezginsAzerbaijan", "RussiansAzerbaijan", 
        "PolesBelarus", "RussiansBelarus", "CroatsBosnia", "MuslimsBosnia", "SerbsBosnia", "TurksBulgaria", "RomaBulgaria", 
        "RussiansEstonia", "RussiansGeorgia", "SardiniansItaly", "SouthTyrolians", "RussiansLatvia", "AlbaniansFYROM", "SerbsFYROM", 
        "RomaFYROM", "GagauzMoldova", "SlavsMoldova", "HungariansRom", "BasquesSpain", "CatalansSpain", "CatholicsNIreland", 
        "ScotsUK", "CrimRussiansUkr", "RussiansUkraine", "HungariansYugo", "KosovoAlbanians"), c("2", "5", "6", "8", "10", 
        "14", "15", "16", "20", "22", "24", "27", "28", "29", "30", "31", "32"))), options = list(outcome = "PROTEST", conditions = c("DEMOC", 
        "ETHFRACT", "GEOCON", "POLDIS", "NATPRIDE"), neg.out = FALSE, n.cut = 1, incl.cut = 0.85, complete = FALSE, show.cases = FALSE, 
        dcc = FALSE, use.letters = FALSE, inf.test = FALSE), fs = c(TRUE, TRUE, TRUE, TRUE, TRUE), call = truthTable(data = CVF, 
        outcome = "PROTEST", incl.cut = 0.85)), class = "tt")
    expect_equal(venn:::venn(x = obj, opacity = obj$tt$incl), NULL)
})

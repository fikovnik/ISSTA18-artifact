library(testthat)

.Random.seed <<- .ext.seed

test_that("RMA", {
    Y_pred <- c(2.30395991800546, 0.260081657641879, -0.312685738035616, -1.07802659855969, -0.955904657587428, -0.486161213251241, 
        -0.190897059303894, 1.56160067198237, -0.297921989400019, -0.507428284584385, 0.173383199703078, -0.469999906610509)
    Y <- c(2.3360053208177, 0.120649810879754, -0.297310363373044, -1.00956656465797, -0.851894823538156, -0.303363316374652, 
        -0.13635514430273, 1.60514868870224, -0.312368445286255, -0.622074169978785, 0.173544498055658, -0.702415490943764)
    expect_equal(DiceEval:::RMA(Y = Y, Ypred = Y_pred), list(max.value = 0.232415584333255, max.data = 12L, index = c(12L, 
        6L, 2L, 10L, 5L, 4L, 7L, 8L, 1L, 3L, 9L, 11L), error = c(0.232415584333255, 0.18279789687659, 0.139431846762125, 
        0.1146458853944, 0.104009834049272, 0.0684600339017265, 0.0545419150011638, 0.0435480167198759, 0.0320454028122414, 
        0.0153753746625714, 0.0144464558862354, 0.000161298352580497)))
})

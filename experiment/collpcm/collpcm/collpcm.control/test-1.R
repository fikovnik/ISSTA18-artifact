library(testthat)

.Random.seed <<- .ext.seed

test_that("collpcm.control", {
    n <- 18L
    d <- 2
    control <- list(verbose = TRUE, sample = 2500, interval = 1, burn = 500)
    expect_equal(collpcm:::collpcm.control(x = control, n = n, d = d), list(verbose = TRUE, sample = 2500, interval = 1, 
        burn = 500, G = 5L, Gmax = 9, Gprior = c(-1, -1, -1.69314718055995, -2.79175946922806, -4.17805383034795, -5.78749174278205, 
            -7.5792512120101, -9.52516136106541, -11.6046029027452, -13.8018274800815), xi = 0, psi = 1.4142135623731, gamma = 0.103, 
        delta = 2, alpha = 3, kappa = 0.1, betainit = numeric(0), Xinit = c(1.53067723363729, 0.955935648630651, 0.0478847360942517, 
            -1.10459944068306, 0.539023801893912, 0.580206320853481, -0.657502835154674, 1.55489554810057, -1.18764140164182, 
            0.151812914504533, -1.08613257605253, 1.61337280035418, 0.0356311982051355, 1.31495884897891, 0.978167526364279, 
            0.881791226863203, 0.482204688262918, 0.965752878105794, -0.814570938270238, 0.283957806364306, -0.161698647607024, 
            1.93557176599585, 1.72323079854894, 0.358402056802064, 0.3024309248682, -0.394114506412192, 0.788140622823556, 
            0.67070382675052, -0.949180809687611, 0.0361357384849679, 2.11575561323695, 0.167440904355584, -0.879836528531105, 
            0.946913174943256, -0.704551365955043, -1.07816936903306), model.search = TRUE, pilot = 0, sd.beta.prop = 0.707106781186548, 
        sd.X.prop = 1, gamma.update = TRUE, store.sparse = FALSE, adapt = TRUE, adapt.interval = 200, MKL = TRUE))
})

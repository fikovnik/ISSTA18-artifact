library(testthat)

.Random.seed <<- .ext.seed

test_that("leaps", {
    y <- c(1.20096537559849, 1.04475108716773, -1.00320864683985, 1.84848190167275, -0.666773408757817, 0.105513812456069, 
        -0.422255881868856, -0.122350171954971, 0.188193034501498, 0.119160957997006, -0.0250925508674029, 0.108072727942033, 
        -0.485435235846668, -0.504217130687904, -1.66109907991481, -0.382333726873818, -0.5126502578778, 2.7018910003448, 
        -1.36211623118972, 0.137256218558607, -1.49362506731629, -1.4704357414368, 0.124702386197007, -0.996639134884037, 
        -0.0018226143047082)
    x <- structure(c(1.37095844714667, -0.564698171396089, 0.363128411337339, 0.63286260496104, 0.404268323140999, -0.106124516091484, 
        1.51152199743894, -0.0946590384130976, 2.01842371387704, -0.062714099052421, 1.30486965422349, 2.28664539270111, 
        -1.38886070111234, -0.278788766817371, -0.133321336393658, 0.635950398070074, -0.284252921416072, -2.65645542090478, 
        -2.44046692857552, 1.32011334573019, -0.306638594078475, -1.78130843398, -0.171917355759621, 1.2146746991726, 1.89519346126497, 
        -0.4304691316062, -0.25726938276893, -1.76316308519478, 0.460097354831271, -0.639994875960119, 0.455450123241219, 
        0.704837337228819, 1.03510352196992, -0.608926375407211, 0.50495512329797, -1.71700867907334, -0.784459008379496, 
        -0.850907594176518, -2.41420764994663, 0.0361226068922556, 0.205998600200254, -0.361057298548666, 0.758163235699517, 
        -0.726704827076575, -1.36828104441929, 0.432818025888717, -0.811393176186672, 1.44410126172125, -0.431446202613345, 
        0.655647883402207, 0.321925265203947, -0.783838940880375, 1.57572751979198, 0.642899305717316, 0.0897606465996057, 
        0.276550747291463, 0.679288816055271, 0.0898328865790817, -2.99309008315293, 0.284882953530659, -0.367234642740975, 
        0.185230564865609, 0.581823727365507, 1.39973682729268, -0.727292059474465, 1.30254263204414, 0.335848119752074, 
        1.03850609869762, 0.920728568290646, 0.720878162866862, -1.04311893856785, -0.0901863866107067, 0.623518161999544, 
        -0.953523357772344, -0.542828814573857, 0.580996497681682, 0.768178737834591, 0.463767588540167, -0.885776297409679, 
        -1.09978089864786, 1.51270700980493, 0.257921437532031, 0.0884402291595864, -0.120896537539089, -1.19432889516053, 
        0.611996898040387, -0.217139845746521, -0.182756706331922, 0.93334632857116, 0.821773110508249, 1.39211637593427, 
        -0.476173923054674, 0.650348560726305, 1.39111045639, -1.1107888794479, -0.860792586877842, -1.13173868085377, -1.4592139995024, 
        0.0799825532411612, 0.65320433964919), .Dim = c(25L, 4L))
    expect_equal(leaps:::leaps(x = x, y = y), list(which = structure(c(FALSE, FALSE, TRUE, FALSE, FALSE, FALSE, TRUE, TRUE, 
        FALSE, TRUE, TRUE, FALSE, TRUE, TRUE, TRUE, TRUE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE, FALSE, FALSE, FALSE, TRUE, 
        TRUE, TRUE, FALSE, TRUE, FALSE, TRUE, FALSE, FALSE, TRUE, FALSE, FALSE, TRUE, TRUE, FALSE, TRUE, TRUE, FALSE, TRUE, 
        TRUE, FALSE, FALSE, FALSE, TRUE, FALSE, TRUE, FALSE, FALSE, TRUE, TRUE, FALSE, TRUE, TRUE, TRUE, TRUE), .Dim = c(15L, 
        4L), .Dimnames = list(c("1", "1", "1", "1", "2", "2", "2", "2", "2", "2", "3", "3", "3", "3", "4"), c("1", "2", "3", 
        "4"))), label = c("(Intercept)", "1", "2", "3", "4"), size = c(2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 5), Cp = c(-0.107866994362965, 
        1.37246549006332, 1.63766504371376, 1.66183392287793, 1.39847030400288, 1.80018517007081, 1.80067579386658, 3.21282997357213, 
        3.37084350933026, 3.6204370267973, 3.06161928756365, 3.35107770736997, 3.69030631911826, 5.20985954418705, 5)))
})

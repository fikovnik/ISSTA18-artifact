library(testthat)

.Random.seed <<- .ext.seed

test_that("leaps.backward", {
    nested <- TRUE
    a <- structure(list(np = 11L, nrbar = 55L, d = c(100, 79.8694468796771, 127.737951111988, 224.196380748418, 324.494095388944, 
        448.705997029814, 548.922419819485, 841.047809721976, 1180.4649892806, 1168.47525988511, 1250.29002316913), rbar = c(0.108887366914655, 
        0.810550927470377, 0.210635760792215, 1.95312308083003, 0.819145724391435, 7.04834086034746, 4.22035726989814, 30.4445674396818, 
        23.7625990227136, 144.04625509669, 0.153221299671818, 2.4166781953143, 0.75933328519636, 8.7131519137512, 4.32315751190775, 
        37.5425460179983, 25.6012418217383, 177.112542761396, 152.29710489191, 0.276087780921481, 4.20572755085896, 1.94938817335855, 
        18.9469714685477, 12.3279260872771, 90.9959635513639, 75.4578985766949, 455.715483477215, 0.383625675656852, 5.69434729784421, 
        3.23442092666163, 29.5925686084244, 22.0361795013823, 153.454211331503, 140.041777283991, 0.464757973359421, 7.11484050319622, 
        4.50883423297406, 41.515792332215, 33.2201766322475, 230.776870788053, 0.504177642529026, 8.3580604244176, 5.65215708129132, 
        53.9688807661244, 45.6688237814104, 0.665266627011383, 9.9974072883934, 8.43687455625362, 72.9150487072703, 0.76638873222255, 
        11.4784707977591, 10.6930769256094, 0.780495023251975, 12.4793239024505, 0.926784909375515), thetab = c(2.09226597861132, 
        3.5688391088142, 1.1571665822051, 1.01763857535732, 0.0697854208786409, 0.0698772892718455, 0.0050791326887997, -0.0113709105812828, 
        -0.00314182779576866, -0.00865463098215745, -0.0269017128624244), sserr = 84.0611912887941, tol = c(5e-09, 5.01292222896803e-09, 
        1.03884825427777e-08, 2.08988532144092e-08, 4.88044166958858e-08, 1.11455050788889e-07, 2.66981790090108e-07, 6.31500734866439e-07, 
        1.52501910782507e-06, 3.65209297632726e-06, 8.84387180511111e-06), lindep = c(FALSE, FALSE, FALSE, FALSE, FALSE, 
        FALSE, FALSE, FALSE, FALSE, FALSE, FALSE), ier = 0L, nn = 100L, rss = c(1509.44622272725, 492.18002047438, 321.134497107399, 
        88.9593550154925, 87.3790671591184, 85.1881095626392, 85.1739486877309, 85.0652032181849, 85.0535507515977, 84.966028872852, 
        84.0611912887941), bound = c(1509.44622272725, 492.18002047438, 321.134497107399, 88.9593550154925, 87.3790671591184, 
        85.1881095626392, 85.1739486877309, 85.0652032181849, 85.0535507515977, 84.966028872852, 84.0611912887941), ress = structure(c(1509.44622272725, 
        492.18002047438, 321.134497107399, 88.9593550154925, 87.3790671591184, 85.1881095626392, 85.1739486877309, 85.0652032181849, 
        85.0535507515977, 84.966028872852, 84.0611912887941), .Dim = c(11L, 1L)), lopt = structure(c(1L, 1L, 2L, 1L, 2L, 
        3L, 1L, 2L, 3L, 4L, 1L, 2L, 3L, 4L, 5L, 1L, 2L, 3L, 4L, 5L, 6L, 1L, 2L, 3L, 4L, 5L, 6L, 7L, 1L, 2L, 3L, 4L, 5L, 6L, 
        7L, 8L, 1L, 2L, 3L, 4L, 5L, 6L, 7L, 8L, 9L, 1L, 2L, 3L, 4L, 5L, 6L, 7L, 8L, 9L, 10L, 1L, 2L, 3L, 4L, 5L, 6L, 7L, 
        8L, 9L, 10L, 11L), .Dim = c(66L, 1L)), nvmax = 11, nbest = 1, nrbar = 55, il = 66, ir = 11, vorder = 1:11, first = 2, 
        last = 11, xnames = c("(Intercept)", "x1", "x2", "x3", "x4", "x5", "x6", "x7", "x8", "x9", "x10"), force.in = structure(c(TRUE, 
            FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE), names = c("", "x1", "x2", "x3", "x4", 
            "x5", "x6", "x7", "x8", "x9", "x10")), force.out = structure(c(FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, 
            FALSE, FALSE, FALSE, FALSE), names = c("", "x1", "x2", "x3", "x4", "x5", "x6", "x7", "x8", "x9", "x10")), intercept = TRUE, 
        nullrss = 1509.44622272725), class = "regsubsets")
    expect_equal(leaps:::leaps.backward(leaps.obj = a, nested = nested), structure(list(np = 11L, nrbar = 55L, d = c(100, 
        14337.5255378901, 46.0911521160764, 2272.62482967431, 2508.15266989298, 4726.18786098387, 3626.00142590541, 5932.16380343884, 
        3549.61121670833, 0.586873366167486, 0.332400896307352), rbar = c(0.819145724391435, 0.108887366914655, 1.95312308083003, 
        7.04834086034746, 4.22035726989814, 30.4445674396818, 144.04625509669, 23.7625990227136, 0.810550927470377, 0.210635760792215, 
        0.0485379867042466, 0.154578323458057, 0.917522721022312, 4.98035048767172, 5.39876972098504, 31.633361040527, 25.6096362764378, 
        0.0248048237742328, 0.211138428153619, -1.01810833959824, -6.36194294642764, -10.1406957799137, -37.1508564597399, 
        -213.712015665337, -79.7602013339754, -0.109008755972647, 0.999854176007419, 4.70644331008029, 0.613570153694784, 
        22.923688751335, 114.781204959082, 6.493385337646, 0.214040602947369, -0.0176557913123731, 0.746118881122407, 8.19769464987778, 
        53.320675966164, 7.51902758776491, -0.0695704546092051, -0.026991189432009, 0.491005356220843, 6.22480480503654, 
        9.02488841266928, 0.00925666100547073, -0.0461982939774424, 11.5360917277165, 1.01591658597645, 0.0243693150736697, 
        0.0115801459459057, 0.657725393379587, -0.0116290726238191, 0.0072427111284894, 0.00336175718880906, 0.0198318441036026, 
        -0.144335103272132), thetab = c(2.09226597861132, 0.28685588126541, 1.85315399961238, 0.175782198361595, -0.0637121168913656, 
        -0.0235897427457401, 0.0236586740179872, -0.0141680802353379, 0.0172012506584921, -0.141399685433199, 0.0688648495082143), 
        first = 2L, last = 11L, vorder = c(1L, 6L, 2L, 5L, 7L, 8L, 9L, 11L, 10L, 3L, 4L), tol = c(5e-09, 1.11455050788889e-07, 
            5.01292222896803e-09, 4.88044166958858e-08, 2.66981790090108e-07, 6.31500734866439e-07, 1.52501910782507e-06, 
            8.84387180511111e-06, 3.65209297632726e-06, 1.03884825427777e-08, 2.08988532144092e-08), rss = c(1509.44622272725, 
            329.664343568995, 171.379042489285, 101.156341414338, 90.9751632238844, 88.3451532835215, 86.3155611484901, 85.124771227993, 
            84.0745015264013, 84.062767656001, 84.0611912887941), bound = c(1509.44622272725, 492.18002047438, 321.134497107399, 
            88.9593550154925, 87.3790671591184, 85.1881095626392, 85.1739486877309, 85.0652032181849, 85.0535507515977, 84.966028872852, 
            84.0611912887941), nvmax = 11L, ress = structure(c(1509.44622272725, 329.664343568995, 171.379042489285, 101.156341414338, 
            90.9751632238844, 88.3451532835215, 86.3155611484901, 85.124771227993, 84.0745015264013, 84.062767656001, 84.0611912887941), 
            .Dim = c(11L, 1L)), ir = 11L, nbest = 1, lopt = structure(c(1L, 1L, 6L, 1L, 6L, 2L, 1L, 6L, 2L, 5L, 1L, 6L, 2L, 
            5L, 7L, 1L, 6L, 2L, 5L, 7L, 8L, 1L, 6L, 2L, 5L, 7L, 8L, 9L, 1L, 6L, 2L, 5L, 7L, 8L, 9L, 11L, 1L, 6L, 2L, 5L, 
            7L, 8L, 9L, 11L, 10L, 1L, 6L, 2L, 5L, 7L, 8L, 9L, 11L, 10L, 3L, 1L, 6L, 2L, 5L, 7L, 8L, 9L, 11L, 10L, 3L, 4L), 
            .Dim = c(66L, 1L)), il = 66L, ier = 0L, xnames = c("(Intercept)", "x1", "x2", "x3", "x4", "x5", "x6", "x7", "x8", 
            "x9", "x10"), method = "backward", force.in = structure(c(TRUE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, 
            FALSE, FALSE, FALSE), names = c("", "x1", "x2", "x3", "x4", "x5", "x6", "x7", "x8", "x9", "x10")), force.out = structure(c(FALSE, 
            FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE), names = c("", "x1", "x2", "x3", "x4", 
            "x5", "x6", "x7", "x8", "x9", "x10")), sserr = 84.0611912887941, intercept = TRUE, lindep = c(FALSE, FALSE, FALSE, 
            FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE), nullrss = 1509.44622272725, nn = 100L), class = "regsubsets"))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("diffLog.default", {
    z <- structure(c(101.370958447147, 99.4353018286039, 100.363128411337, 100.632862604961, 100.404268323141, 99.8938754839085, 
        101.511521997439, 99.9053409615869, 102.018423713877, 99.9372859009476, 101.304869654223, 102.286645392701, 98.6111392988877, 
        99.7212112331826, 99.8666786636063, 100.63595039807, 99.7157470785839, 97.3435445790952, 97.5595330714245, 101.32011334573, 
        99.6933614059215, 98.21869156602, 99.8280826442404, 101.214674699173, 101.895193461265, 99.5695308683938, 99.7427306172311, 
        98.2368369148052, 100.460097354831, 99.3600051240399, 100.455450123241, 100.704837337229, 101.03510352197, 99.3910736245928, 
        100.504955123298, 98.2829913209267, 99.2155409916205, 99.1490924058235, 97.5857923500534, 100.036122606892, 100.2059986002, 
        99.6389427014513, 100.7581632357, 99.2732951729234, 98.6317189555807, 100.432818025889, 99.1886068238133, 101.444101261721, 
        99.5685537973867, 100.655647883402, 100.321925265204, 99.2161610591196, 101.575727519792, 100.642899305717, 100.0897606466, 
        100.276550747291, 100.679288816055, 100.089832886579, 97.0069099168471, 100.284882953531, 99.632765357259, 100.185230564866, 
        100.581823727366, 101.399736827293, 99.2727079405255, 101.302542632044, 100.335848119752, 101.038506098698, 100.920728568291, 
        100.720878162867, 98.9568810614321, 99.9098136133893, 100.623518162, 99.0464766422277, 99.4571711854261, 100.580996497682, 
        100.768178737835, 100.46376758854, 99.1142237025903, 98.9002191013521, 101.512707009805, 100.257921437532, 100.08844022916, 
        99.8791034624609, 98.8056711048395, 100.61199689804, 99.7828601542535, 99.8172432936681, 100.933346328571, 100.821773110508, 
        101.392116375934, 99.5238260769453, 100.650348560726, 101.39111045639, 98.8892111205521, 99.1392074131222, 98.8682613191462, 
        98.5407860004976, 100.079982553241, 100.653204339649, 101.200965375598, 101.044751087168, 98.9967913531601, 101.848481901673, 
        99.3332265912422, 100.105513812456, 99.5777441181312, 99.877649828045, 100.188193034501, 100.119160957997, 99.9749074491326, 
        100.108072727942, 99.5145647641533, 99.4957828693121, 98.3389009200852, 99.6176662731262, 99.4873497421222, 102.701891000345, 
        98.6378837688103, 100.137256218559, 98.5063749326837, 98.5295642585632, 100.124702386197, 99.003360865116, 99.9981773856953, 
        99.5717411185742, 99.3863283935505, 97.9753221545809, 98.77525204964, 100.179516441118, 100.567620594424, 99.5071226464465, 
        100.000062884065, 101.12288964338, 101.439855742976, 98.9028862315942, 99.8826804397498, 101.20149840092, 99.5302704194337, 
        99.947530515061, 99.9138927017629, 99.1123209820936, 99.5553159951153, 99.9705551209118, 99.5861311509421, 101.113386023368, 
        99.519007158346, 99.5668309673993, 100.696862576552, 98.9436315868291, 99.9593015248488, 98.4484551776524, 101.167169549236, 
        99.7263542986259, 99.5321546753277, 98.7617476720138, 99.9922379662227, 99.1997178220483, 99.4665076700496, 101.287675245585, 
        99.8244741297579, 98.9282176158493, 100.163206882467, 99.6372615843721, 100.590013547987, 101.432421927731, 99.0073074888905, 
        100.45465029758, 100.084898058678, 100.895565582265, 99.7702218610537, 100.836619068461, 98.2549441386633, 101.689458921313, 
        100.864777978519, 99.8492240111143, 98.5509928698608, 100.643008700042, 100.483193863815, 99.9936443735786, 100.151455892862, 
        99.4158910296502, 100.36880673263, 100.29465433972, 99.7207406266574, 98.6637633451068, 100.70074881844, 100.554196622274, 
        99.1636934071986, 98.4054118379938, 100.204958580588, 99.6549120220271, 100.252611703364, 98.7059975345154, 99.0408295556196, 
        101.08577485368, 100.403774904716, 100.586487536719, 101.815228446154, 100.128821428602), .Dim = c(100L, 2L))
    expect_equal(tfplot:::diffLog.default(obj = z), structure(c(-0.0192794444953037, 0.00928769311382904, 0.00268397746824967, 
        -0.00227415084252591, -0.00509634222485733, 0.0160639319475901, -0.015949161951041, 0.0209302743151003, -0.0206105733570583, 
        0.0135916334481241, 0.00964463915464542, -0.0365948910039826, 0.0111941750619886, 0.00145767818134335, 0.00767347054507894, 
        -0.00918594453404342, -0.0240771909588586, 0.00221636911381218, 0.0378221565529282, -0.0161858547704465, -0.0149025499924411, 
        0.0162529938951952, 0.013794220293958, 0.00670101669341605, -0.0230885671300607, 0.00173797428359812, -0.0152129107446211, 
        0.0223793410598931, -0.0110109376563088, 0.0109646771090368, 0.00247948881861859, 0.00327418039659655, -0.0164057090193221, 
        0.0111447239325795, -0.0223560470824697, 0.00944368133175022, -0.000669964067125939, -0.0158927885364806, 0.0247994341917845, 
        0.00169670629772956, -0.00567497397638927, 0.0111701430645015, -0.0148466181199378, -0.00648370095861406, 0.0180961234763055, 
        -0.0124658694855819, 0.0224847631622067, -0.0186615304776971, 0.0108588747907774, -0.00332099666335317, -0.0110833530163177, 
        0.0235036893141993, -0.00922600301963428, -0.00551121137247179, 0.00186448663454541, 0.00400822995574401, -0.00587199483860434, 
        -0.0312858993756358, 0.0332327530766232, -0.00652388535662141, 0.00552969829178451, 0.0039507844527229, 0.00809893307525744, 
        -0.021199806993959, 0.0202408221916519, -0.00958847087668957, 0.00697865260334574, -0.00116634967401197, -0.00198223446145018, 
        -0.0176688981276403, 0.0095837047747187, 0.00711809409182784, -0.0157968082850779, 0.00413791014619314, 0.0112362270569477, 
        0.00185928046496198, -0.00302547768437655, -0.0135241811669253, -0.00216150581269581, 0.0260725288518335, -0.0124379029625272, 
        -0.00169188247183882, -0.00209370820189214, -0.0108054862714519, 0.0181165010620887, -0.00827507738842126, 0.000344520259866421, 
        0.0111194147592792, -0.00110602625348033, 0.00564100497031639, -0.0185982668039228, 0.0112555416181417, 0.00733280405413783, 
        -0.0249852753239788, 0.00252485403084357, -0.00273672770849398, -0.00331773668412794, 0.0154991582851984, 0.00571129620802147, 
        -0.00154479731119928, -0.0204760597460218, 0.0283987982901159, -0.0250061140734248, 0.00774464459377189, -0.0052860808535895, 
        0.00300724818715281, 0.00310441254154181, -0.000689261555919529, -0.00144185717251943, 0.00133110070985243, -0.00594631671085999, 
        -0.000188752947978266, -0.0116955744481837, 0.0129198354869269, -0.00130902327043891, 0.0318000318096621, -0.0403751250828659, 
        0.0150864025327904, -0.0164205408586948, 0.000235381688048264, 0.0160597850610005, -0.0112626352707546, 0.00999816198809711, 
        -0.00427355905467497, -0.00186383773378562, -0.0142989306797459, 0.00813145583886232, 0.0141166529678189, 0.00386660196075006, 
        -0.0106011169892666, 0.00494158883964246, 0.0111656915400653, 0.00312956222718075, -0.0253276470603518, 0.00985788011745559, 
        0.0131172614240542, -0.0166517398586015, 0.00418353021983986, -0.000336611368759954, -0.00805497968171398, 0.00445966694903532, 
        0.00416226450190127, -0.0038527844161198, 0.0152196116312551, -0.0158938684154748, 0.00048043407229148, 0.0112855563870617, 
        -0.0175643330310509, 0.010212808329193, -0.0152300048745939, 0.0272411791305176, -0.0143443146203008, -0.0019492235065508, 
        -0.0077703940520486, 0.0123822021648721, -0.00795739288672515, 0.00268581141778146, 0.018143756796368, -0.0145513529510017, 
        -0.00901887246063016, 0.0124064118822593, -0.00526471751486568, 0.00951677691057906, 0.00833979909578542, -0.024199122497615, 
        0.0145127244096184, -0.00368757844455647, 0.0080671713594942, -0.0112162171061465, 0.0106318134267473, -0.0259360025695177, 
        0.0343580774193519, -0.00814286101539263, -0.010119499623789, -0.0130871799545087, 0.0210055798424671, -0.00158919989364925, 
        -0.00488386057566537, 0.00157697142501156, -0.0073716287307608, 0.00953949867113391, -0.000739072234574145, -0.00573871114477775, 
        -0.0106559460234639, 0.0204354961616877, -0.00145638380958868, -0.0139248985990861, -0.0076761525202258, 0.0181218733590951, 
        -0.00550433606970913, 0.00597977956238438, -0.0155474078639424, 0.00338647497939615, 0.0204372275377995, -0.00676960720110831, 
        0.00181812472022358, 0.0121417548140741, -0.0167021134996617), .Dim = c(99L, 2L), .Dimnames = list(NULL, c("diff of log of  Series 1", 
        "diff of log of  Series 2"))))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("ytoypc.default", {
    z <- structure(c(101.370958447147, 99.4353018286039, 100.363128411337, 100.632862604961, 100.404268323141, 99.8938754839085, 
        101.511521997439, 99.9053409615869, 102.018423713877, 99.9372859009476, 101.304869654223, 102.286645392701, 98.6111392988877, 
        99.7212112331826, 99.8666786636063, 100.63595039807, 99.7157470785839, 97.3435445790952, 97.5595330714245, 101.32011334573, 
        99.6933614059215, 98.21869156602, 99.8280826442404, 101.214674699173, 101.895193461265, 99.5695308683938, 99.7427306172311, 
        98.2368369148052, 100.460097354831, 99.3600051240399, 100.455450123241, 100.704837337229, 101.03510352197, 99.3910736245928, 
        100.504955123298, 98.2829913209267, 99.2155409916205, 99.1490924058235, 97.5857923500534, 100.036122606892, 100.2059986002, 
        99.6389427014513, 100.7581632357, 99.2732951729234, 98.6317189555807, 100.432818025889, 99.1886068238133, 101.444101261721, 
        99.5685537973867, 100.655647883402, 100.321925265204, 99.2161610591196, 101.575727519792, 100.642899305717, 100.0897606466, 
        100.276550747291, 100.679288816055, 100.089832886579, 97.0069099168471, 100.284882953531, 99.632765357259, 100.185230564866, 
        100.581823727366, 101.399736827293, 99.2727079405255, 101.302542632044, 100.335848119752, 101.038506098698, 100.920728568291, 
        100.720878162867, 98.9568810614321, 99.9098136133893, 100.623518162, 99.0464766422277, 99.4571711854261, 100.580996497682, 
        100.768178737835, 100.46376758854, 99.1142237025903, 98.9002191013521, 101.512707009805, 100.257921437532, 100.08844022916, 
        99.8791034624609, 98.8056711048395, 100.61199689804, 99.7828601542535, 99.8172432936681, 100.933346328571, 100.821773110508, 
        101.392116375934, 99.5238260769453, 100.650348560726, 101.39111045639, 98.8892111205521, 99.1392074131222, 98.8682613191462, 
        98.5407860004976, 100.079982553241, 100.653204339649, 101.200965375598, 101.044751087168, 98.9967913531601, 101.848481901673, 
        99.3332265912422, 100.105513812456, 99.5777441181312, 99.877649828045, 100.188193034501, 100.119160957997, 99.9749074491326, 
        100.108072727942, 99.5145647641533, 99.4957828693121, 98.3389009200852, 99.6176662731262, 99.4873497421222, 102.701891000345, 
        98.6378837688103, 100.137256218559, 98.5063749326837, 98.5295642585632, 100.124702386197, 99.003360865116, 99.9981773856953, 
        99.5717411185742, 99.3863283935505, 97.9753221545809, 98.77525204964, 100.179516441118, 100.567620594424, 99.5071226464465, 
        100.000062884065, 101.12288964338, 101.439855742976, 98.9028862315942, 99.8826804397498, 101.20149840092, 99.5302704194337, 
        99.947530515061, 99.9138927017629, 99.1123209820936, 99.5553159951153, 99.9705551209118, 99.5861311509421, 101.113386023368, 
        99.519007158346, 99.5668309673993, 100.696862576552, 98.9436315868291, 99.9593015248488, 98.4484551776524, 101.167169549236, 
        99.7263542986259, 99.5321546753277, 98.7617476720138, 99.9922379662227, 99.1997178220483, 99.4665076700496, 101.287675245585, 
        99.8244741297579, 98.9282176158493, 100.163206882467, 99.6372615843721, 100.590013547987, 101.432421927731, 99.0073074888905, 
        100.45465029758, 100.084898058678, 100.895565582265, 99.7702218610537, 100.836619068461, 98.2549441386633, 101.689458921313, 
        100.864777978519, 99.8492240111143, 98.5509928698608, 100.643008700042, 100.483193863815, 99.9936443735786, 100.151455892862, 
        99.4158910296502, 100.36880673263, 100.29465433972, 99.7207406266574, 98.6637633451068, 100.70074881844, 100.554196622274, 
        99.1636934071986, 98.4054118379938, 100.204958580588, 99.6549120220271, 100.252611703364, 98.7059975345154, 99.0408295556196, 
        101.08577485368, 100.403774904716, 100.586487536719, 101.815228446154, 100.128821428602), .Dim = c(100L, 2L), .Dimnames = list(NULL, 
        c("Series 1", "Series 2")), .Tsp = c(1990, 1998.25, 12), class = c("mts", "ts", "matrix"))
    expect_equal(tfplot:::ytoypc.default(obj = z), structure(c(-2.7224948747998, 0.287533098729401, -0.494653520261257, 0.00306837451416552, 
        -0.68574897866008, -2.55304030648417, -3.89314321000345, 1.41611286296221, -2.27906119631532, -1.71967281223843, 
        -1.4577650758781, -1.04800650115464, 3.33030749439313, -0.152104414811158, -0.124113516173669, -2.38395272641144, 
        0.746472145127428, 2.07148871932254, 2.96835886831951, -0.607259494866423, 1.34586907004291, 1.19364454960668, 0.678038144306326, 
        -2.89650032167709, -2.62981243630802, -0.422256144930553, -2.16250172201029, 1.8315794243736, -0.252935007352744, 
        0.280734262305258, 0.301340656068851, -1.42152274126774, -2.37876191799674, 1.04812672134992, -1.30973472687965, 
        3.21633468651003, 0.35580394184009, 1.51948488989925, 2.80382302511384, -0.819665463239504, 1.36691309774441, 1.00759459810222, 
        -0.663373137853203, 1.01059965081292, 2.07597503334267, -0.341507035301171, -2.1995438557188, -1.14271632729031, 
        0.0644897986597525, -0.467353127647172, 0.259064468185304, 2.20082670490742, -2.26729321610589, 0.65542957414517, 
        0.245866781539588, 0.759853969574974, 0.239810744667143, 0.630478898893631, 2.01013633591315, -0.374003866879082, 
        0.994404602931499, -1.13664850219679, -1.11814689798011, -0.80743831811468, 1.50642692068498, -0.827990119212121, 
        -1.21753534758955, -2.11630899932025, 0.586577653483455, -0.459643257464681, 1.14348709820894, -0.030737872304738, 
        -1.80658268600131, 1.58059156558153, 0.327466551627662, -0.759341456744466, 0.163908480638798, 0.356352872843004, 
        2.29825002734134, 0.630541551130548, -0.849507883771963, 1.13027380042386, -1.19816944480478, -0.740791640782825, 
        0.06334678324318, -2.05861225440316, 0.297768974078677, 0.837491618078113, -1.66638787010207, -1.53295267808557, 
        -0.664557329669405, -2.19032781529356, 0.155157701173087, 2.59364053887476, -0.943845793700539, 0.259924408474303, 
        -1.67865898253961, -1.5877047752135, 0.149832533869176, -1.103519259459, 0.485971699407116, 0.0763431846773424, 1.0651201748904, 
        -1.6486474537984, -0.715767074234054, -2.45601569227035, 1.95638506411614, -0.629269860097587, 1.51633633092517, 
        2.6320276602577, 1.31351537176753, -0.101486083546874, -0.115499051047692, 1.63676688188543, 0.144830811450468, 2.01296440482069, 
        1.15275904489786, -1.06528310071414, -1.00659098159512, 0.465727942020641, -0.41393147282634, -0.00939808983433095, 
        -1.89358371082185, 0.671309767695125, 0.815138453651542, -2.23106065598539, 0.431055902497887, -1.4998623074361, 
        1.25435694034436, 0.619532779020777, -0.0232647745185757, -1.20916348562431, 0.407794549890748, -1.89259629865189, 
        -0.0527532275446791, 1.72833087230503, -0.866351169710995, -0.0155785377316096, 0.203988377777836, 1.20754196150099, 
        -0.570497330131839, 1.71074902026031, -0.527314201274236, 1.7141278536186, 0.0926672853218031, 1.70952881464676, 
        0.305343173414354, -0.445321877543685, -1.57228976638975, 2.79115642837749, 0.700427949431, 0.212734095028009, -2.02706074510446, 
        -0.778265186501664, 1.49068428619763, -0.458919445377619, 0.0665013758068847, -1.46654071868788, 0.599963456441088, 
        -0.537468167564343, 1.49182975049633, -2.97542695998392, -0.162622833625307, 0.706037145648026, 0.621709147209538, 
        -2.22330084419196, -0.276897332308352, -0.338753881482694, 0.101002835755312, -0.714064409404155, -1.32309750433536, 
        0.788796291456072, 0.684947056917162, 1.94876429443213, 1.10672427046524, -0.423030771425237), .Dim = c(88L, 2L), 
        .Dimnames = list(NULL, c("y to y %ch Series 1", "y to y %ch Series 2")), .Tsp = c(1991, 1998.25, 12), class = c("mts", 
            "ts", "matrix")))
})

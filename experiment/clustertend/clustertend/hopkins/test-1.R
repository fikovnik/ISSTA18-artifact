library(testthat)

.Random.seed <<- .ext.seed

test_that("hopkins", {
    x <- structure(c(91.5657983061392, 93.7704659164883, 29.327813943848, 83.2143149806652, 64.5328063704073, 52.3904989638831, 
        73.9222431494854, 14.3319931265432, 66.0422367497813, 70.801413619658, 46.3164358485956, 72.1921129135881, 93.5325524681248, 
        26.2874536097515, 46.7669894318096, 94.0614377527963, 97.8444164101966, 12.6312488038093, 48.0247110745404, 56.4729418782517, 
        90.4991073424462, 14.7323066047393, 98.9002811631653, 94.7201550232712, 9.16131825186312, 51.9069666506257, 39.6301432433538, 
        90.6680749601219, 45.2499931820203, 83.7644217396155, 74.0219661593437, 81.2944589855615, 39.4227199987508, 68.831803211011, 
        1.39088554074988, 83.4586919450667, 1.72608054126613, 21.5582383095752, 90.7535393720027, 61.5660857013427, 38.5763648131397, 
        44.14138691267, 4.70567225338891, 97.3804514633957, 43.7433736403473, 95.8000830677338, 88.8877356448211, 64.3578981773462, 
        97.1256944255438, 62.2649825257249, 34.0092939157039, 35.3280765726231, 40.4500557309948, 78.6845847934019, 4.85471262130886, 
        75.1307432309259, 68.0504061887041, 17.9551687086932, 26.8477084184997, 51.9268805312458, 67.8851201774087, 98.2989025937859, 
        76.1948824876454, 57.0823539842386, 85.1192821383011, 19.75791960489, 27.8573748557828, 82.9876900385134, 69.6272772185039, 
        24.8139292248525, 5.25589080597274, 14.9074303174857, 22.4221560906153, 48.4604578560684, 20.5436238860711, 72.2162279298063, 
        1.78058913466521, 38.1735064969398, 51.9263631226495, 1.15548486751504, 58.5787962484173, 16.632615609793, 36.543802279979, 
        64.9175559619907, 77.8065129010938, 56.8010373145808, 24.1366364625283, 9.90807111863978, 9.47559442766942, 31.2166185772512, 
        67.0752249525394, 1.02365076146089, 21.6484257373959, 93.3703786071856, 92.6388301125262, 73.6753357995767, 33.9741263585165, 
        51.9912696534302, 74.6534899857361, 62.2967647642363, 62.9982891078107, 22.4986121254042, 22.4401637860574, 39.5055578364991, 
        94.3031135064084, 96.2981933630072, 74.2456726422533, 73.5913446664345, 54.0403677097056, 1.22502364241518, 61.284807802178, 
        83.8433543837164, 75.4007337072399, 45.8204256831668, 54.0432093886193, 54.2002928359434, 1.13670351402834, 36.2109294291586, 
        61.6011759249959, 83.0652709247079, 36.3154779362958, 41.6528774565086, 57.7741139952559, 59.3781520535704, 72.2460719433147, 
        40.1023314762861, 92.0011889846064, 96.2944590637926, 24.1188290275168, 72.7252623992972, 90.4598179885652, 60.7439343906008, 
        63.5192225920036, 93.8011991158128, 85.1977923177183, 58.4022690069396, 82.318988467101, 12.258142300183, 76.6862681077328, 
        62.7377322623506, 15.6962140637916, 8.94618219160475, 46.9428855809383, 78.1574479842093, 73.6192679961678, 81.9058139957488, 
        17.8460856443271, 94.5273122270592, 30.0687602953985, 15.758133192081, 72.218480536947, 33.0845092956442, 78.1021403544582, 
        40.0496591797564, 68.1806939237285, 77.8066792315803, 19.5990353580564, 3.87949607218616, 14.4356659092009, 68.3362536353525, 
        93.5474724234082, 55.4989143523853, 60.5748573073652, 20.5024543246254, 53.9884244459681, 18.776018188335, 45.7367629467044, 
        32.3882818266284, 12.5012923697941, 19.4241135192569, 73.2432795679197, 41.775335050188, 41.9909184924327, 48.5507027711719, 
        43.3219520950224, 14.512545653386, 82.6432612296194, 59.6381200116593, 79.6453007862438, 77.1342101455666, 91.8875853084028, 
        86.4003479282837, 32.3805485423654, 26.6667970225681, 74.4843787420541, 74.9887505641673, 91.8724993683863, 79.5259297110606, 
        14.1996322073974, 29.487225464778, 20.2729382377584, 78.6268288830761, 13.7583440113813, 13.779839068884, 8.15305801713839, 
        6.25981886452064, 53.6555692055263, 12.1185159243178, 74.5755842525978, 73.4002322512679), .Dim = c(50L, 4L))
    expect_equal(clustertend:::hopkins(data = x, n = 10), list(H = 0.573543432957585))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("data.frame.description", {
    title <- "example_df"
    dfdescription <- structure(list(subject = 1:100, initial = c("je", "lf", "ik", "lg", "sf", "mi", "jl", "of", "ie", "nh", 
        "pe", "pm", "jg", "ih", "lh", "ng", "ig", "ok", "mi", "jh", "ic", "le", "lg", "og", "if", "pg", "le", "og", "pk", 
        "lf", "lf", "ld", "jh", "kh", "hd", "kk", "lf", "ng", "ji", "me", "ml", "kg", "he", "oj", "if", "lc", "mg", "ig", 
        "oi", "jf", "ig", "pf", "pg", "ng", "kh", "jh", "ni", "lf", "qi", "ie", "je", "oj", "ki", "ng", "jf", "md", "mh", 
        "ql", "kf", "nf", "ik", "li", "ii", "kh", "lk", "kj", "ge", "ni", "ie", "ig", "ki", "le", "rj", "jh", "ja", "md", 
        "jd", "mm", "lf", "ih", "kh", "jg", "jh", "nf", "kh", "lg", "je", "kk", "jh", "ph"), birth = structure(c(10957.031, 
        11001.495, 11779.44, 11279.291, 11350.595, 11266.097, 11783.368, 11686.424, 11274.649, 11556.793, 11604.603, 11504.048, 
        11486.873, 11865.04, 11792.195, 11025.696, 11941.329, 11902.783, 10974.137, 11729.506, 11450.08, 11876.386, 11921.342, 
        11821.672, 11743.249, 11080.862, 11947.535, 11412.714, 11302.516, 11439.433, 11020.1, 11451.563, 11343.052, 11113.384, 
        11956.85, 11542.455, 11318.887, 11307.248, 11083.752, 11769.634, 11326.723, 11394.286, 11728.568, 11654.878, 11783.174, 
        11487.293, 11925.455, 11372.824, 11750.458, 11579.709, 11705.484, 11349.119, 11285.51, NA, 11348.111, 11366.372, 
        11187.546, 10978.631, 10968.576, 11302.928, 11519.056, 11429.64, 11816.244, 11629.445, 11275.24, 11443.482, 11658.881, 
        11788.292, 11576.876, 11244.463, 11627.872, 11580.757, 11761.632, 11760.778, 11899.37, 11687.063, 11748.81, 11257.808, 
        11586.387, 11444.203, NA, 11541.738, 11216.822, 11006.581, 11818.351, 11858.482, 11172.425, 11014.474, 11258.331, 
        11612.918, 11463.7, 11895.298, 11859.52, 11033.441, 11215.743, 11922.69, 11740.897, NA, 11240.024, 11158.405), class = "Date"), 
        sex = structure(c(1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, NA, 1L, NA, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
            2L, 1L, 2L, 2L, 2L, 1L, 2L, 2L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 2L, 2L, NA, 2L, 2L, 2L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, 
            1L, 1L, 2L, 1L, 1L, 2L, 2L, NA, 1L, 1L, NA, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 1L, NA, 1L, 1L, 1L, 1L, NA, 1L, 1L, 2L, 
            2L, 2L, 2L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 2L), .Label = c("male", "female"), 
            class = "factor"), study_level = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 3L, 2L, 2L, 2L, 2L, 
            2L, 3L, 2L, 2L, 1L, 2L, 1L, 1L, 2L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 2L, 
            1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 3L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 2L, 1L, 
            1L, 2L, 2L, 1L, 2L, 2L, 1L, 1L, 1L, 2L, 1L, 3L, 2L, 2L, 2L, 2L, 1L, 2L, 1L, 1L, 1L, 2L, 2L, 1L, 2L, 1L, 2L, 1L), 
            .Label = c("primary", "secondary", "superior"), class = c("ordered", "factor")), heigh = c(NA, 1.68, 1.76, 1.67, 
            NA, 1.69, 1.74, 1.78, 1.78, 1.72, 1.92, 1.79, 1.61, NA, NA, 1.79, NA, NA, 1.74, 1.71, 1.71, 1.58, 1.46, 1.83, 
            1.68, 1.69, 1.56, 1.72, NA, 1.8, 1.65, 1.63, 1.62, 1.65, 1.72, NA, 1.86, 1.65, 1.62, 1.5, 1.54, NA, 1.66, 1.5, 
            1.62, 1.7, 1.63, 1.69, 1.56, 1.68, 1.6, 1.82, 1.59, 1.85, 1.63, 1.76, 1.59, 1.53, 1.64, NA, 1.54, 1.77, NA, 1.58, 
            1.72, 1.63, 1.83, 1.62, 1.55, 1.77, 1.52, NA, 1.63, NA, 1.9, 1.75, NA, 1.67, 1.78, 1.68, 1.72, 1.6, 1.77, 1.8, 
            1.74, 1.74, 1.6, 1.65, 1.7, 1.77, 1.62, 1.66, 1.65, 1.71, 1.78, 1.76, 1.78, 1.72, 1.69, NA), weight = c(62.6, 
            61.6, 67.3, 85.1, 78.8, 83.7, 77.1, NA, 62.3, 97.6, 67.7, 64.6, 65.1, 75.3, NA, 72.1, NA, 93.9, 65.1, 72, 73.1, 
            82.1, 61.4, 57.7, 70, 76.7, 66.1, 61.5, 82, 62.4, NA, 67.4, 70.4, 77.2, 73.6, 65, 75.7, 60.3, 81.4, 62, 51.6, 
            NA, 62.3, 66.4, 66.7, 70.7, 50.6, 89.6, 55.2, 70, 77.3, 43, 72.7, 50.6, 68.8, 60.4, 72.8, 63.2, 73.3, NA, 59.7, 
            82.2, NA, 76.9, 69, 74.7, 76.8, 64.8, 77.9, 69.4, 71.4, NA, 71.9, 56.4, 73.8, 65.5, NA, 84, 65.8, 67.2, 68.9, 
            72.2, 74.1, 76.4, 71.3, 59.4, 90.8, 66.2, 80.8, 65, 58.3, 60.4, 75, 67.9, 78.6, 81.6, 82.6, 71.5, 71.2, 70.3), 
        siblings = c(3L, 1L, 1L, NA, 3L, 6L, 4L, NA, 5L, 0L, NA, 7L, 5L, 1L, NA, NA, NA, 2L, NA, NA, 1L, 0L, 2L, 2L, 1L, 
            NA, 2L, NA, NA, 5L, 2L, 1L, 1L, 3L, NA, 1L, NA, 1L, 5L, 0L, 1L, NA, 3L, NA, NA, NA, 4L, 6L, NA, 1L, 4L, 2L, NA, 
            4L, 4L, NA, 2L, 1L, 6L, NA, 2L, 3L, NA, 6L, 6L, 3L, 2L, NA, 2L, 0L, 6L, NA, 1L, NA, NA, NA, NA, NA, 5L, 5L, 3L, 
            4L, 2L, 5L, 1L, 4L, 2L, 2L, 1L, 0L, 0L, 1L, NA, 4L, 1L, 6L, 6L, 2L, NA, 3L), Q1 = c(2L, 0L, 3L, 2L, 2L, 0L, 1L, 
            1L, 0L, 1L, 0L, 2L, 2L, 0L, NA, 2L, NA, 1L, 0L, 1L, 2L, 3L, 3L, 1L, 3L, 4L, 1L, 1L, 0L, 1L, 2L, 1L, NA, 0L, 4L, 
            2L, 0L, 1L, 1L, 1L, 0L, NA, 1L, 2L, 0L, 2L, 1L, 1L, 1L, 2L, 3L, 1L, 2L, 0L, 1L, 1L, 2L, NA, 0L, NA, 1L, NA, NA, 
            NA, 1L, 0L, NA, 4L, 2L, 2L, 1L, NA, 0L, 2L, 1L, 0L, NA, 1L, 3L, 0L, 4L, 1L, NA, 0L, 2L, NA, 2L, 0L, 1L, 1L, 2L, 
            1L, 1L, 2L, 0L, 1L, 2L, NA, 1L, 1L), Q2 = c(1L, NA, 1L, 2L, 3L, 2L, NA, 2L, NA, 1L, 1L, 3L, NA, 1L, NA, NA, NA, 
            2L, NA, 2L, 2L, 3L, 2L, 2L, 1L, 3L, 2L, 1L, 2L, NA, 2L, 3L, NA, 2L, 2L, 1L, 2L, 3L, NA, 0L, 1L, NA, NA, 1L, 1L, 
            1L, 2L, 0L, 1L, 1L, 1L, 2L, NA, 1L, 3L, 1L, 1L, 2L, 2L, NA, 2L, 0L, NA, 1L, 3L, NA, 0L, 3L, 1L, 2L, 3L, NA, 0L, 
            1L, 1L, 0L, NA, 0L, 4L, 3L, 3L, 3L, NA, NA, NA, 0L, NA, 3L, 0L, 2L, 1L, 3L, NA, 2L, 1L, 1L, 1L, 3L, 0L, 0L), 
        Q3 = c(NA, 2L, NA, 3L, 3L, NA, 2L, NA, 2L, 3L, 4L, NA, 1L, 3L, NA, 3L, NA, NA, NA, NA, 4L, 4L, 3L, 1L, 3L, NA, 3L, 
            1L, 0L, NA, 1L, NA, 2L, NA, 1L, 4L, NA, NA, 1L, 1L, NA, NA, 3L, 3L, NA, NA, NA, 4L, 3L, 3L, 4L, 4L, 2L, 2L, NA, 
            4L, 3L, NA, NA, NA, NA, NA, NA, NA, 2L, NA, 4L, 2L, 1L, NA, 2L, NA, 1L, 3L, 2L, 0L, NA, 2L, 1L, 0L, 2L, NA, NA, 
            2L, 3L, NA, NA, 2L, 1L, NA, 3L, 3L, 3L, NA, 2L, 4L, 2L, 2L, NA, NA), Q4 = c(2L, 2L, 3L, 1L, NA, 0L, 1L, NA, 4L, 
            2L, 2L, 3L, 1L, 2L, NA, NA, NA, 2L, 2L, 1L, 2L, 1L, 3L, NA, NA, 1L, 1L, 2L, 2L, 2L, 3L, 1L, NA, NA, NA, 1L, 2L, 
            3L, NA, 1L, 2L, NA, 1L, NA, NA, NA, NA, 1L, 2L, 1L, 2L, 3L, NA, 2L, 1L, 2L, 1L, 2L, 1L, NA, 0L, NA, NA, NA, NA, 
            2L, NA, 1L, NA, 1L, 3L, NA, NA, 1L, 2L, 1L, NA, NA, 2L, NA, 1L, NA, 1L, 3L, 1L, 1L, 3L, NA, 1L, 2L, NA, NA, NA, 
            2L, NA, 1L, 2L, 2L, 2L, 0L), Q5 = c(4L, 3L, NA, 3L, 3L, 3L, 2L, 1L, NA, 2L, 2L, NA, 3L, NA, NA, NA, NA, 3L, NA, 
            3L, 1L, NA, 2L, 2L, NA, NA, 3L, NA, NA, NA, 2L, NA, NA, NA, 3L, 3L, NA, 4L, 2L, 3L, NA, NA, 2L, 3L, 1L, NA, NA, 
            3L, 3L, NA, NA, 3L, 3L, NA, NA, 2L, 1L, 2L, NA, NA, NA, 3L, NA, 3L, NA, 2L, NA, NA, NA, NA, 1L, NA, 3L, NA, 3L, 
            NA, NA, 3L, NA, NA, NA, 1L, NA, 3L, 2L, 3L, 1L, NA, NA, 3L, NA, 3L, NA, 2L, NA, NA, NA, 2L, 3L, 0L), Q6 = c(NA, 
            3L, 3L, NA, NA, 4L, NA, 2L, 3L, NA, 2L, NA, NA, 3L, NA, 3L, NA, 3L, NA, 0L, NA, NA, 3L, NA, 2L, NA, NA, NA, NA, 
            3L, NA, NA, NA, 3L, NA, NA, 2L, NA, NA, 4L, NA, NA, 1L, NA, NA, NA, 3L, 4L, 3L, 3L, 2L, 2L, NA, 1L, NA, 4L, 3L, 
            NA, NA, NA, NA, NA, NA, 2L, 1L, NA, 3L, NA, 3L, NA, NA, NA, NA, 3L, 3L, NA, NA, NA, NA, NA, NA, NA, NA, 2L, NA, 
            NA, NA, NA, NA, NA, 2L, NA, 2L, NA, 3L, NA, 3L, NA, 4L, NA), Q7 = c(NA, NA, 0L, NA, 3L, 4L, 0L, 0L, 3L, 3L, NA, 
            2L, 3L, 1L, NA, 2L, NA, NA, 2L, NA, NA, NA, 2L, NA, NA, NA, 1L, NA, NA, NA, 1L, NA, NA, 2L, 1L, NA, 2L, NA, 3L, 
            2L, NA, NA, NA, NA, 0L, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 2L, NA, 1L, NA, NA, NA, 
            NA, 2L, NA, NA, NA, NA, 2L, NA, 2L, NA, NA, NA, NA, 1L, 1L, NA, 1L, NA, NA, NA, NA, 2L, 2L, NA, NA, NA, 0L, NA, 
            3L, 1L, NA, NA, NA), Q8 = c(1L, NA, NA, 2L, 2L, NA, NA, 3L, 2L, NA, NA, NA, 2L, NA, NA, 3L, NA, 2L, NA, NA, NA, 
            NA, NA, NA, NA, NA, NA, 3L, NA, 3L, NA, NA, 3L, NA, NA, NA, NA, NA, NA, NA, 3L, NA, NA, NA, NA, NA, NA, NA, NA, 
            NA, 2L, 2L, NA, NA, NA, 2L, NA, NA, NA, NA, 3L, 2L, NA, NA, NA, NA, 2L, 1L, 0L, 4L, NA, NA, NA, NA, 3L, NA, NA, 
            NA, NA, 3L, NA, 3L, 1L, NA, NA, NA, 2L, NA, NA, NA, 2L, NA, 2L, NA, NA, 3L, 1L, NA, NA, 3L), Q9 = c(2L, 2L, 1L, 
            NA, 3L, NA, 3L, 2L, 3L, 1L, NA, 3L, NA, NA, NA, NA, NA, NA, NA, 2L, NA, 2L, NA, NA, 3L, NA, 1L, 2L, NA, NA, NA, 
            3L, NA, NA, 2L, NA, NA, NA, 2L, NA, 0L, NA, 2L, NA, 2L, 3L, 3L, NA, 2L, NA, NA, 1L, 1L, 1L, NA, NA, NA, 0L, NA, 
            NA, 2L, 4L, NA, 2L, NA, NA, NA, 4L, NA, 2L, NA, NA, NA, 3L, NA, 3L, NA, 1L, 3L, NA, NA, NA, NA, 3L, NA, NA, NA, 
            0L, NA, NA, 1L, 3L, NA, NA, NA, 2L, NA, NA, NA, NA), Q10 = c(NA, NA, NA, NA, NA, NA, NA, 3L, NA, NA, NA, NA, 
            NA, NA, NA, 2L, 1L, 0L, 3L, NA, NA, NA, NA, NA, NA, NA, NA, NA, 3L, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
            NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
            NA, NA, NA, NA, NA, NA, NA, NA, 2L, NA, NA, 2L, NA, NA, NA, NA, NA, NA, 4L, NA, 2L, NA, NA, NA, NA, NA, NA, NA, 
            NA, NA, NA, NA)), class = "data.frame", row.names = c(NA, -100L))
    expect_equal(dfexplore:::data.frame.description(data_frame_source = dfdescription, data_frame_name = title), .ext.1)
})

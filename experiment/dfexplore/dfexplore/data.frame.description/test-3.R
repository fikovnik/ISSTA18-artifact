library(testthat)

.Random.seed <<- .ext.seed

test_that("data.frame.description", {
    title <- "df_with_matrix"
    dfdescription <- structure(list(subject = 1:100, initial = c("ph", "pf", "kf", "og", "mk", "ml", "ni", "ji", "nh", "nb", 
        "lh", "nj", "pi", "kg", "lh", "ph", "qa", "jg", "lh", "mj", "pg", "jg", "rh", "qh", "ii", "mg", "lk", "pl", "lf", 
        "oi", "nk", "oh", "lh", "nk", "fj", "oh", "gj", "je", "pi", "mh", "le", "ld", "hg", "qi", "li", "qj", "pe", "mk", 
        "qf", "me", "ki", "lf", "li", "ng", "hi", "ni", "ne", "jc", "ke", "mi", "nk", "rh", "nh", "mf", "oh", "je", "kg", 
        "of", "ne", "ke", "hi", "jg", "kg", "lg", "jg", "ne", "gj", "lh", "mi", "ei", "mk", "jj", "lf", "mf", "ni", "mi", 
        "kk", "ii", "ie", "kf", "nf", "di", "je", "pe", "pd", "nd", "kh", "me", "ni", "mi"), birth = structure(c(10957.031, 
        11001.495, 11779.44, 11279.291, 11350.595, 11266.097, 11783.368, NA, 11274.649, 11556.793, 11604.603, 11504.048, 
        11486.873, 11865.04, 11792.195, 11025.696, 11941.329, 11902.783, 10974.137, 11729.506, 11450.08, 11876.386, 11921.342, 
        11821.672, 11743.249, 11080.862, 11947.535, 11412.714, 11302.516, 11439.433, 11020.1, 11451.563, 11343.052, 11113.384, 
        11956.85, 11542.455, 11318.887, 11307.248, 11083.752, 11769.634, 11326.723, 11394.286, 11728.568, 11654.878, 11783.174, 
        11487.293, 11925.455, 11372.824, 11750.458, 11579.709, 11705.484, 11349.119, 11285.51, 11382.048, 11348.111, 11366.372, 
        11187.546, 10978.631, 10968.576, 11302.928, 11519.056, 11429.64, 11816.244, 11629.445, 11275.24, 11443.482, 11658.881, 
        11788.292, 11576.876, 11244.463, 11627.872, 11580.757, NA, 11760.778, 11899.37, 11687.063, 11748.81, 11257.808, 11586.387, 
        11444.203, 11052.53, 11541.738, 11216.822, 11006.581, 11818.351, 11858.482, 11172.425, 11014.474, 11258.331, NA, 
        11463.7, 11895.298, 11859.52, 11033.441, 11215.743, 11922.69, 11740.897, 11906.827, NA, 11158.405), class = "Date"), 
        sex = structure(c(2L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 
            1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 1L, 2L, 2L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 
            1L, 1L, 1L, 2L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 2L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 
            1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 2L, 1L, 1L), .Label = c("male", "female"), 
            class = "factor"), heigh = c(1.7, 1.54, 1.82, 1.67, 1.65, 1.58, 1.7, 1.62, 1.65, 1.83, 1.68, 1.59, 1.72, 1.66, 
            1.76, 1.84, 1.6, 1.75, 1.71, 1.79, 1.68, 1.78, 1.53, 1.87, 1.79, 1.68, 1.56, 1.76, 1.75, 1.7, 1.72, 1.64, 1.74, 
            1.73, 1.67, 1.57, 1.77, 1.76, 1.62, 1.54, 1.72, 1.67, 1.73, 1.57, NA, 1.81, 1.74, 1.76, 1.88, 1.71, 1.5, 1.73, 
            1.82, 1.91, 1.56, 1.58, 1.63, 1.59, 1.64, 1.68, 1.58, 1.9, 1.71, 1.69, 1.75, 1.7, 1.69, 1.85, 1.68, 1.57, 1.74, 
            1.66, 1.65, 1.59, 1.74, 1.68, 1.75, 1.68, 1.63, 1.83, 1.67, 1.79, 1.58, 1.65, 1.67, 1.66, 1.83, 1.7, 1.72, 1.61, 
            1.63, 1.8, 1.83, 1.82, 1.56, 1.9, 1.8, 1.7, 1.77, 1.6), weight = c(60.1, 70.4, 59.2, 71.7, 81.7, 60.7, 63.4, 
            70.4, 60.8, NA, 77.9, NA, NA, 53.3, 69.5, 79.6, 77.3, 68.3, 45.7, 70.5, 75.2, 70.4, 71.4, 73.9, 66.4, 81.8, 74.2, 
            58.8, 82.4, 80.8, 77.4, 55, 64.9, 75.7, 70.4, 73.1, 92.1, 62.6, 51, 72.5, 63.8, 74, 62.7, 89.9, 68.9, 65.7, 68.5, 
            77.8, 70.9, 55.4, 70, 76.8, 70.4, 76.6, 68.7, 69.5, 74.3, NA, 58.8, NA, 69.4, 63.2, 60.7, 64.3, 75.3, 66.3, 62.9, 
            71.5, 58.9, 79.4, 65.6, 71.7, 70.5, 70, 86.3, 62.6, 80.3, 70.3, 62.5, 69.4, 76.7, 66.2, 63.1, 71.4, 78.9, 69.3, 
            57.5, 58.2, 63.1, 65.3, 69.8, 76, 66.1, 60, 75.5, 72.5, NA, 54.9, 70.8, 82.2), siblings = c(4L, 3L, 2L, 4L, 4L, 
            4L, NA, 2L, 2L, 3L, 5L, 5L, 2L, 4L, NA, 4L, NA, 2L, 1L, 4L, NA, 3L, 1L, 2L, NA, 4L, 2L, 3L, 3L, NA, NA, 6L, 7L, 
            NA, NA, 3L, NA, NA, 3L, 5L, NA, 3L, NA, 6L, 5L, 2L, 1L, 4L, 6L, 2L, 2L, NA, NA, 1L, 1L, 2L, 3L, 1L, 6L, NA, 8L, 
            4L, 1L, 0L, NA, 4L, 6L, NA, 2L, 3L, NA, 1L, 2L, 1L, 4L, 0L, NA, NA, 4L, NA, NA, NA, 2L, NA, NA, NA, 2L, 3L, 2L, 
            1L, 5L, 2L, 4L, NA, NA, 2L, 2L, 1L, 5L, NA), study_level = structure(c(2L, 2L, 1L, 2L, 2L, 1L, 2L, 1L, 1L, 2L, 
            1L, 3L, 2L, 2L, 2L, 2L, 3L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 3L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 1L, 2L, 
            3L, 1L, 2L, 2L, 1L, 2L, 2L, 1L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 3L, 1L, 3L, 3L, 2L, 1L, 1L, 1L, 2L, 
            1L, 1L, 1L, 1L, 2L, 2L, 1L, 2L, 1L, 2L, 1L, 1L, 3L, 2L, 3L, 2L, 2L, 2L, 3L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 2L, 1L, 
            1L, 3L, 1L, 1L, 2L, 2L), .Label = c("primary", "secondary", "superior"), class = c("ordered", "factor")), quest = structure(c(1L, 
            0L, 2L, 3L, 1L, NA, NA, NA, 1L, NA, NA, NA, 2L, 2L, 4L, 2L, 1L, NA, 2L, 4L, 4L, 0L, 2L, 3L, NA, 1L, 0L, NA, 1L, 
            3L, 3L, 3L, 2L, 0L, 0L, 1L, 1L, 2L, 1L, NA, 0L, 1L, 2L, 1L, 0L, NA, 2L, 0L, 1L, 1L, 1L, 2L, NA, NA, 2L, 2L, NA, 
            2L, 1L, 2L, 0L, 2L, 0L, 3L, 0L, 1L, 2L, 1L, 1L, 1L, 2L, 2L, 0L, 1L, 1L, 1L, 2L, 0L, 1L, 0L, 1L, 2L, 1L, NA, 3L, 
            0L, 1L, 3L, NA, 0L, 2L, 3L, 0L, 0L, 2L, 0L, 1L, 0L, 2L, 0L, 2L, 2L, 1L, NA, 2L, 2L, 1L, 2L, 1L, 2L, 0L, 1L, NA, 
            2L, 0L, 1L, 2L, 1L, 3L, 0L, 1L, 1L, 0L, 1L, 1L, NA, 4L, 3L, 3L, NA, NA, 0L, 1L, 2L, 3L, NA, 1L, 0L, 3L, NA, 1L, 
            2L, 2L, 1L, 2L, 2L, 4L, 0L, 2L, 1L, 0L, 2L, 1L, 2L, 2L, 1L, 0L, 1L, 0L, 3L, 0L, 0L, 1L, 2L, NA, 1L, 1L, 2L, NA, 
            0L, 1L, 3L, 1L, 2L, 3L, 0L, 0L, 0L, 1L, 3L, 1L, 2L, 2L, 0L, 3L, 2L, 2L, 0L, 3L, 0L, 2L, NA, NA, 1L, 2L, 0L, 3L, 
            2L, 0L, NA, 2L, 0L, NA, 2L, 2L, 1L, 2L, 3L, 2L, 1L, 3L, 2L, 0L, 0L, 2L, 2L, 0L, 3L, NA, 3L, 2L, 1L, NA, 2L, 2L, 
            2L, 0L, 1L, 0L, 2L, 2L, 0L, 1L, 2L, 1L, NA, 1L, 2L, 1L, 3L, 1L, 2L, 1L, 1L, 0L, NA, 1L, 0L, 2L, 0L, 3L, 2L, NA, 
            3L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 0L, 1L, 0L, 1L, 2L, 1L, 0L, 2L, NA, 3L, 0L, 0L, NA, 3L, 1L, 4L, NA, 0L, 2L, 
            1L, 2L, 2L, 1L, 1L, 1L, NA, 2L, 2L, 1L, 0L, 3L, 2L, 0L, 0L, 2L, 1L, 1L, 1L, 2L, 1L, 2L, 3L, 2L, 1L, 1L, 2L, 3L, 
            3L, 0L, NA, 2L, 2L, 1L, 1L, 0L, 2L, NA, 2L, 2L, 1L, 4L, 2L, 2L, 0L, 3L, 2L, 2L, 0L, 1L, NA, 2L, NA, 2L, NA, 2L, 
            0L, 2L, 1L, NA, 3L, 1L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 1L, NA, 2L, NA, 2L, 1L, 1L, NA, NA, 2L, 2L, 1L, 1L, 2L, 3L, 
            2L, 3L, 1L, 1L, 2L, 1L, 1L, 2L, 2L, 1L, 2L, 1L, NA, 2L, 1L, 1L, 1L, 0L, 2L, 2L, 2L, 0L, NA, 0L, 1L, 0L, 2L, 2L, 
            0L, 2L, 1L, 2L, NA, 2L, 4L, 1L, 0L, 0L, 3L, 2L, 3L, 3L, 1L, 0L, 2L, 1L, 1L, 1L, NA, 0L, 2L, 2L, 1L, 1L, 1L, NA, 
            NA, NA, 2L, 2L, 2L, 3L, 1L, 2L, NA, 3L, 3L, 2L, 2L, 0L, 1L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, 3L, 0L, 1L, 2L, 2L, 1L, 
            2L, 0L, 1L, 2L, 0L, 0L, 1L, 2L, 1L, 1L, 2L, 0L, 1L, 3L, 1L, 1L, 0L, 3L, NA, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 0L, 1L, 
            4L, 1L, 3L, 0L, 1L, 2L, 1L, 1L, 2L, 0L, 1L, 1L, 3L, 1L, 1L, 0L, 1L, 1L, 0L, 2L, 1L, 2L, 0L, 2L, 1L, 1L, 1L, 1L, 
            2L, 0L, 1L, 1L, 1L, 0L, 1L, 0L, 1L, NA, NA, 1L, 2L, 1L, 1L, 3L, 2L, 1L, 4L, 1L, 1L, 2L, 3L, 1L, 3L, 3L, 2L, 1L, 
            2L, 1L, 3L, 0L, 1L, 2L, 1L, 3L, 2L, 1L, NA, 2L, 3L, 2L, NA, 3L, 2L, 2L, 1L, 0L, 3L, 1L, 0L, 1L, 1L, 2L, 2L, 1L, 
            0L, 2L, 2L, 1L, 1L, 1L, NA, 2L, 1L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, 2L, 1L, 4L, 3L, 1L, 0L, 2L, 0L, 3L, NA, 2L, 2L, 
            1L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 0L, 0L, 3L, 0L, 3L, NA, NA, 2L, 1L, 0L, 1L, 2L, 0L, 2L, 0L, 3L, NA, 2L, NA, 2L, 
            3L, 2L, 1L, 1L, 2L, 1L, 1L, 2L, 2L, 2L, 2L, 1L, 3L, NA, 2L, 1L, 3L, 1L, 1L, 2L, 2L, 3L, 2L, 1L, 1L, 1L, 2L, 0L, 
            2L, 2L, 2L, NA, 3L, 2L, 1L, 2L, 2L, 0L, 1L, NA, 2L, 1L, 4L, 2L, 1L, 0L, 2L, 0L, 4L, 2L, 1L, 1L, 3L, 1L, 0L, 2L, 
            2L, 1L, 0L, 3L, NA, 2L, 1L, 2L, 0L, 2L, 1L, 1L, 1L, 1L, NA, 0L, 2L, 0L, 1L, 0L, 2L, 2L, 0L, 0L, 2L, 2L, NA, 2L, 
            0L, 2L, 2L, 1L, 4L, 0L, 2L, 1L, 1L, 1L, 4L, 2L, 2L, 3L, 2L, 2L, 3L, 0L, 3L, NA, 0L, 2L, 2L, 2L, 1L, 0L, 1L, 1L, 
            1L, 1L, 0L, 2L, 2L, 0L, 1L, 4L, 3L, 0L, 2L, NA, 0L, 1L, NA, 1L, 3L, 1L, 1L, 2L, 0L, 1L, 4L, 0L, 2L, 2L, 1L, 1L, 
            4L, 1L, NA, 2L, 2L, 1L, 0L, NA, 1L, 0L, 2L, 0L, 1L, 2L, 1L, 1L, 1L, 2L, 0L, 0L, 3L, 2L, 2L, 1L, 0L, 0L, 1L, 1L, 
            0L, 1L, NA, 0L, NA, 1L, 3L, 0L, 2L, 2L, 0L, 2L, 1L, 0L, 0L, 2L, 1L, 1L, 2L, 0L, 0L, 2L, 2L, 1L, 2L, 2L, 3L, 1L, 
            NA, 3L, 1L, 1L, 2L, 2L, 2L, 2L, 1L, 2L, 1L, NA, 2L, 1L, 0L, 1L, NA, 3L, 0L, NA, 0L, 1L, 2L, 3L, 0L, 2L, 0L, 1L, 
            1L, 2L, 0L, NA, 2L, 2L, 1L, NA, 2L, 1L, 2L, 3L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 3L, 1L, 3L, 3L, NA, 1L, 0L, 3L, 4L, 
            2L, 2L, 2L, 2L, 1L, 2L, 1L, 3L, 1L, 1L, NA, 3L, 1L, 1L, 1L, 2L, 2L, 0L, 1L, 2L, 2L, 3L, 2L, 1L, 0L, NA, 0L, 4L, 
            0L, 2L, 1L, NA, 3L, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 2L, NA, 2L, NA, 3L, 0L, NA, 
            NA, NA, 2L, NA, NA, NA, NA, 2L, NA, NA, NA, NA, NA, 3L, NA, NA, 3L, NA, NA, NA, 2L, NA, 2L, NA, NA, NA, NA, 1L, 
            NA, NA, NA, 2L, 2L, 2L, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 1L, NA, NA, NA, NA, 2L, NA, 
            NA, NA, NA, NA, NA, NA, NA, NA, 2L, NA, NA, 1L, NA, 3L, NA, NA, NA, 3L, 2L), .Dim = c(100L, 10L), .Dimnames = list(NULL, 
            c("Q1", "Q2", "Q3", "Q4", "Q5", "Q6", "Q7", "Q8", "Q9", "Q10")))), row.names = c(NA, -100L), class = "data.frame")
    expect_equal(dfexplore:::data.frame.description(data_frame_source = dfdescription, data_frame_name = title), .ext.1)
})

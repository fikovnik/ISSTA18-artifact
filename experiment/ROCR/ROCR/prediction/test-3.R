library(testthat)

.Random.seed <<- .ext.seed

test_that("prediction", {
    ROCR.simple <- list(predictions = c(0.612547843484208, 0.364270970690995, 0.432136141695082, 0.140291077783331, 0.384895941475406, 
        0.244415489258245, 0.970641299150884, 0.890172811923549, 0.78178137098439, 0.868751832284033, 0.716680597979575, 
        0.360168795567006, 0.547983407042921, 0.38524046423845, 0.42373935948126, 0.101699993479997, 0.628095575375482, 0.744769965996966, 
        0.657732644351199, 0.490119890542701, 0.0723699212539941, 0.172741714166477, 0.10572211490944, 0.890078186057508, 
        0.945548940682784, 0.984667270444334, 0.360180428717285, 0.448687336174771, 0.0148235992528498, 0.543533782940358, 
        0.292368448572233, 0.701561486814171, 0.715459280414507, 0.714985913829878, 0.12060473789461, 0.319672177778557, 
        0.911723614670336, 0.75732558965683, 0.0909882804844528, 0.5294022441376, 0.257402979070321, 0.589909283909947, 0.708412104053423, 
        0.326672910246998, 0.0865462829824537, 0.879459890769795, 0.362693564267829, 0.23015718255192, 0.779771988745779, 
        0.876086216885597, 0.353281047893688, 0.212014560122043, 0.703293499303982, 0.689075677189976, 0.627012495882809, 
        0.240911145461723, 0.402801992371678, 0.13479414023459, 0.120473352726549, 0.665444678859785, 0.536339509300888, 
        0.623494622297585, 0.885179650736973, 0.353777439100668, 0.40893989498727, 0.265686094528064, 0.932159805903211, 
        0.248500489164144, 0.858876675134525, 0.491735594114289, 0.151350957341492, 0.694457482313737, 0.496513160411268, 
        0.123504904797301, 0.499788081273437, 0.310718619497493, 0.907651100074872, 0.340078179724514, 0.195097957272083, 
        0.371936985291541, 0.517308606300503, 0.419560072012246, 0.865639036288485, 0.0185275997500867, 0.53908600891009, 
        0.00542256166227162, 0.772728820564225, 0.703885140595958, 0.348213541787118, 0.277656868798658, 0.458674210123718, 
        0.0590458661317825, 0.133257804671302, 0.0836858830880374, 0.531958184437826, 0.429650396574289, 0.717845453182235, 
        0.53709134971723, 0.212404891382903, 0.930846937932074, 0.0830483769532293, 0.468610247364268, 0.39337810780853, 
        0.663367559900507, 0.349540913244709, 0.194398425286636, 0.844415442086756, 0.959417835110798, 0.211378771346062, 
        0.943432189058512, 0.598162949318066, 0.834803975652903, 0.576836208114401, 0.380396459484473, 0.161874325247481, 
        0.912325837183744, 0.642933593131602, 0.392173970583826, 0.122284044278786, 0.586857798974961, 0.180631657829508, 
        0.0859932180028409, 0.700501358835027, 0.0604136267211288, 0.531464014668018, 0.0842547949869186, 0.448484671069309, 
        0.938583020120859, 0.531006531557068, 0.785213140305132, 0.905121018877253, 0.74843814317137, 0.60523540340364, 0.842974299564958, 
        0.835981858661398, 0.364288578508422, 0.492596896132454, 0.488179708365351, 0.25927896797657, 0.991096434416249, 
        0.757364019053057, 0.288258273387328, 0.773336236132309, 0.0409069966990501, 0.110241033835337, 0.760726142209023, 
        0.9845991586335, 0.253271061228588, 0.697235327912495, 0.620501131983474, 0.814586046850309, 0.300973098259419, 0.378092079423368, 
        0.0166944121010602, 0.698826511390507, 0.65869255294092, 0.470206008059904, 0.501489336136729, 0.239143339684233, 
        0.0509991380386055, 0.0884509843308479, 0.107031842228025, 0.746588080422953, 0.480100183049217, 0.336592126172036, 
        0.57951108715497, 0.11855528363958, 0.233160826843232, 0.46115080663003, 0.370549293933436, 0.770178503822535, 0.5373360151425, 
        0.463227452943102, 0.790240205358714, 0.883431431138888, 0.745110672898591, 0.00774630531668663, 0.012653524056077, 
        0.86833121930249, 0.439399994909763, 0.540221346076578, 0.567043171497062, 0.0358153996057808, 0.806543942075223, 
        0.248707469552755, 0.696702150162309, 0.0814391288440675, 0.336315316613764, 0.126480399398133, 0.636728451121598, 
        0.030235062353313, 0.268138292944059, 0.983494404936209, 0.728536414681002, 0.739554340718314, 0.522384506650269, 
        0.858970525674522, 0.383807972306386, 0.606960208853707, 0.138387069804594), labels = c(1, 1, 0, 0, 0, 1, 1, 1, 1, 
        0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 
        1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 
        1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 
        0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 
        0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 
        0))
    expect_equal(ROCR:::prediction(predictions = ROCR.simple$predictions, labels = ROCR.simple$labels), .ext.1)
})

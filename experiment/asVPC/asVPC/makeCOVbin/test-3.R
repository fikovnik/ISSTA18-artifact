library(testthat)

.Random.seed <<- .ext.seed

test_that("makeCOVbin", {
    origdata <- structure(list(X.ID = c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 
        2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 5L, 5L, 5L, 5L, 5L, 5L, 
        5L, 5L, 5L, 5L, 5L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 8L, 8L, 
        8L, 8L, 8L, 8L, 8L, 8L, 8L, 8L, 8L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 
        10L, 10L, 10L, 10L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 12L, 12L, 12L, 12L, 12L, 12L, 12L, 
        12L, 12L, 12L, 12L), AMT = c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
        NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
        NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
        NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
        NA, NA, 4.92, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), TIME = c(0, 
        0.69, 1.02, 2.31, 3.79, 5, 5.68, 8.31, 9.34, 12.8, 19.99, 0, 0.11, 1.32, 2.59, 3.15, 4.05, 5.7, 8.72, 9.4, 15.61, 
        24.28, 0, 0.53, 1.27, 2.2, 3.43, 4.22, 5.63, 8.67, 9.03, 17.44, 19.43, 0, 0.27, 1.53, 2.48, 3.19, 4.25, 6.6, 7.64, 
        9.33, 13.91, 24.05, 0, 0.09, 1.72, 2.98, 3.91, 4.76, 6.89, 7.78, 8.36, 14.19, 22.03, 0, 0.54, 1.24, 2.41, 3.91, 4.54, 
        5.05, 5.78, 6.09, 10.41, 18.97, 0, 0.3, 1.67, 2.32, 3.21, 4.59, 7.36, 7.93, 8.07, 14.14, 23.45, 0, 0.81, 1.22, 2.92, 
        3.86, 4.1, 6.82, 7.03, 8.62, 10.21, 22.01, 0, 0.13, 1.89, 2.88, 3.35, 4.26, 8.02, 8.34, 8.64, 13.64, 21.02, 0, 0.79, 
        1.12, 2.24, 3.02, 4.87, 5.51, 7.37, 9.05, 15.6, 20.4, 0, 0, 0.58, 1.02, 2.88, 3.65, 4.66, 6.33, 7.82, 9.05, 15.21, 
        18.16, 0, 0.39, 1.31, 2.84, 3.15, 4.73, 5.64, 6.09, 9.53, 10.52, 18.19), DV = c(0, 5.88, 6.546, 6.545, 5.849, 5.535, 
        5.179, 4.411, 4.084, 3.225, 2.02, 0.134, 1.143, 3.582, 3.621, 3.502, 3.475, 3.468, 3.156, 2.985, 2.553, 1.833, 0, 
        4.109, 5.29, 5.253, 5.097, 4.936, 4.511, 3.941, 3.976, 2.664, 2.459, 0, 7.636, 12.622, 11.307, 10.367, 9.146, 6.948, 
        5.821, 4.668, 2.54, 0.672, 0.048, 2.756, 10.614, 9.814, 9.108, 8.504, 7.239, 6.737, 6.595, 4.048, 2.239, 0.016, 9.214, 
        10.854, 9.987, 8.407, 7.689, 7.376, 6.614, 6.455, 3.825, 1.534, 0, 7.502, 11.71, 11.138, 10.296, 8.813, 6.918, 6.477, 
        6.295, 3.369, 1.443, 0.112, 19.266, 20.095, 15.751, 13.16, 12.491, 7.61, 7.403, 5.618, 3.989, 0.54, 0.156, 6.412, 
        14.6, 11.287, 9.758, 7.826, 2.72, 2.65, 2.696, 0.537, 0.173, 0, 19.327, 19.938, 17.63, 15.66, 11.698, 10.753, 8.056, 
        6.12, 2.459, 1.149, 0, 0.093, 19.298, 20.837, 15.42, 13.665, 10.926, 7.772, 5.918, 4.493, 1.338, 0.798, 0.062, 1.824, 
        2.72, 2.617, 2.743, 2.551, 2.499, 2.514, 2.402, 2.294, 1.983), WT = c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
        NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
        NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
        NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
        NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 65, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 
        NA, NA, NA, NA, NA, NA)), row.names = c(2L, 3L, 4L, 5L, 6L, 7L, 8L, 9L, 10L, 11L, 12L, 14L, 15L, 16L, 17L, 18L, 19L, 
        20L, 21L, 22L, 23L, 24L, 26L, 27L, 28L, 29L, 30L, 31L, 32L, 33L, 34L, 35L, 36L, 38L, 39L, 40L, 41L, 42L, 43L, 44L, 
        45L, 46L, 47L, 48L, 50L, 51L, 52L, 53L, 54L, 55L, 56L, 57L, 58L, 59L, 60L, 62L, 63L, 64L, 65L, 66L, 67L, 68L, 69L, 
        70L, 71L, 72L, 74L, 75L, 76L, 77L, 78L, 79L, 80L, 81L, 82L, 83L, 84L, 86L, 87L, 88L, 89L, 90L, 91L, 92L, 93L, 94L, 
        95L, 96L, 98L, 99L, 100L, 101L, 102L, 103L, 104L, 105L, 106L, 107L, 108L, 110L, 111L, 112L, 113L, 114L, 115L, 116L, 
        117L, 118L, 119L, 120L, 121L, 122L, 123L, 124L, 125L, 126L, 127L, 128L, 129L, 130L, 131L, 132L, 134L, 135L, 136L, 
        137L, 138L, 139L, 140L, 141L, 142L, 143L, 144L), class = "data.frame")
    expect_equal(asVPC:::makeCOVbin(COV.data = origdata$TIME, N.covbin = 7), list(COV.bin = structure(c(1L, 2L, 2L, 3L, 4L, 
        4L, 5L, 6L, 6L, 6L, 7L, 1L, 1L, 2L, 3L, 3L, 4L, 5L, 6L, 6L, 7L, 7L, 1L, 2L, 2L, 2L, 3L, 4L, 4L, 6L, 6L, 7L, 7L, 1L, 
        1L, 2L, 3L, 3L, 4L, 5L, 5L, 6L, 7L, 7L, 1L, 1L, 2L, 3L, 4L, 4L, 5L, 5L, 6L, 7L, 7L, 1L, 2L, 2L, 3L, 4L, 4L, 4L, 5L, 
        5L, 6L, 7L, 1L, 1L, 2L, 3L, 3L, 4L, 5L, 5L, 5L, 7L, 7L, 1L, 2L, 2L, 3L, 4L, 4L, 5L, 5L, 6L, 6L, 7L, 1L, 1L, 2L, 3L, 
        3L, 4L, 5L, 6L, 6L, 6L, 7L, 1L, 2L, 2L, 3L, 3L, 4L, 4L, 5L, 6L, 7L, 7L, 1L, 1L, 2L, 2L, 3L, 3L, 4L, 5L, 5L, 6L, 7L, 
        7L, 1L, 1L, 2L, 3L, 3L, 4L, 5L, 5L, 6L, 6L, 7L), .Label = c("[0,0.51]", "(0.51,2.23]", "(2.23,3.73]", "(3.73,5.63]", 
        "(5.63,8.14]", "(8.14,13.7]", "(13.7,24.3]"), class = "factor"), COV.bin.summary = structure(list(cut.temp = structure(1:7, 
        .Label = c("[0,0.51]", "(0.51,2.23]", "(2.23,3.73]", "(3.73,5.63]", "(5.63,8.14]", "(8.14,13.7]", "(13.7,24.3]"), 
        class = "factor"), med.COV = c(0, 1.22, 2.92, 4.54, 6.89, 9.05, 18.97), n.bin = c(19L, 19L, 19L, 19L, 19L, 19L, 19L), 
        lower.COV = c(0, 0.51, 2.23, 3.73, 5.63, 8.14, 13.7), upper.COV = c(0.51, 2.23, 3.73, 5.63, 8.14, 13.7, 24.3)), row.names = c("[0,0.51]", 
        "(0.51,2.23]", "(2.23,3.73]", "(3.73,5.63]", "(5.63,8.14]", "(8.14,13.7]", "(13.7,24.3]"), class = "data.frame")))
})

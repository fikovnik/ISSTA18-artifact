library(testthat)

.Random.seed <<- .ext.seed

test_that("biviso", {
    u <- structure(c(0.914806043496355, 0.937075413297862, 0.286139534786344, 0.830447626067325, 0.641745518893003, 0.519095949130133, 
        0.736588314641267, 0.13466659723781, 0.656992290401831, 0.705064784036949, 0.45774177624844, 0.719112251652405, 0.934672247152776, 
        0.255428824340925, 0.462292822543532, 0.940014522755519, 0.978226428385824, 0.117487361654639, 0.474997081561014, 
        0.560332746244967, 0.904031387297437, 0.138710167724639, 0.988891728920862, 0.946668232558295, 0.0824375580996275, 
        0.514211784349754, 0.390203467104584, 0.905738130910322, 0.446969628101215, 0.836004259996116, 0.737595617771149, 
        0.811055141268298, 0.388108282815665, 0.685169729404151, 0.00394833879545331, 0.832916080253199, 0.00733414688147604, 
        0.207658972823992, 0.906601407798007, 0.611778643447906, 0.379559240536764, 0.435771584976465, 0.0374310328625143, 
        0.973539913771674, 0.431751248892397, 0.957576596643776, 0.887754905503243, 0.639978769468144, 0.970966610359028, 
        0.618838207330555, 0.333427211269736, 0.346748248208314, 0.39848541142419, 0.784692775690928, 0.038936491124332, 
        0.748795386170968, 0.67727683018893, 0.171264330390841, 0.261087963823229, 0.514412934659049, 0.67560727451928, 0.982817197917029, 
        0.759544267551973, 0.566488424083218, 0.849689718568698, 0.18947393540293, 0.271286614704877, 0.828158485237509, 
        0.693204820388928, 0.240544739644974, 0.0429887960199267, 0.140479094116017, 0.21638541505672, 0.479398564202711, 
        0.197410342283547, 0.719355837674811, 0.00788473873399198, 0.375489964615554, 0.514407708309591, 0.00157055421732366, 
        0.581604002509266, 0.157905208179727, 0.359028305858374, 0.645631878403947, 0.775823362637311, 0.563646841561422, 
        0.233703398611397, 0.0899805163498968, 0.0856120649259537, 0.305218369467184, 0.667426514672115, 0.000238896580412984, 
        0.208569956943393, 0.933034127345309, 0.925644748611376, 0.734094301005825, 0.333071983419359, 0.515063329832628, 
        0.743974646320567, 0.619159240042791, 0.62624534452334, 0.217157698236406, 0.216567310970277, 0.388945028651506, 
        0.942455691983923, 0.962608013767749, 0.73985527921468, 0.73324590572156, 0.535761289997026, 0.00227296608500183, 
        0.608937452547252, 0.836801559431478, 0.751522562699392, 0.452731572557241, 0.535789993824437, 0.53737669531256, 
        0.00138084357604384, 0.355665953829885, 0.612133090151474, 0.828942130552605, 0.356721999356523, 0.410635125823319, 
        0.573475898941979, 0.589678303571418, 0.719657292356715, 0.394973045215011, 0.919203929137439, 0.962570293573663, 
        0.233523525530472, 0.724497599992901, 0.903634525137022, 0.603474084753543, 0.631507298909128, 0.937385849654675, 
        0.850482750684023, 0.579820899059996, 0.821403923910111, 0.113718609092757, 0.764507758663967, 0.623613457195461, 
        0.148446606704965, 0.0802644665818661, 0.464069551322609, 0.779368161456659, 0.73352795955725, 0.817230444401503, 
        0.170162481255829, 0.94472032552585, 0.293623841367662, 0.149072052445263, 0.719378591282293, 0.324085952481255, 
        0.778809498529881, 0.394441001815721, 0.67859286791645, 0.775825042743236, 0.187869044020772, 0.0290858189109713, 
        0.135713797062635, 0.680164178134874, 0.9348229537718, 0.550494084367529, 0.601766235427931, 0.19699448812753, 0.535236610565335, 
        0.179555739276111, 0.451886494411156, 0.317053351784125, 0.116174670401961, 0.186102156760171, 0.729730096645653, 
        0.41187207121402, 0.414049681741744, 0.480310129001737, 0.427494465606287, 0.136490360135213, 0.824679406359792, 
        0.592304242542014, 0.794396977638826, 0.769032425712794, 0.918056417256594, 0.862629777053371, 0.316975237801671, 
        0.259260575985536, 0.74226645193994, 0.74736111680977, 0.917904034024104, 0.793191209202632, 0.133329618256539, 0.287749752169475, 
        0.194676143815741, 0.784109382657334, 0.128872161731124, 0.129089283524081, 0.0722531112842262, 0.0531294834800065, 
        0.531874436419457, 0.112308241659775, 0.74318771972321, 0.731315477285534, 0.885117687052116, 0.517111055552959, 
        0.851930984994397, 0.442796268267557, 0.157880100421607, 0.442324638832361, 0.967733667232096, 0.484587929444388, 
        0.252458439441398, 0.259689980186522, 0.542015940882266, 0.649875837611035, 0.336419132305309, 0.0609497462864965, 
        0.451310850214213, 0.838755033444613, 0.574637334328145, 0.353350377408788, 0.547426078235731, 0.892718593822792, 
        0.489990570582449, 0.171632113168016, 0.543030994012952, 0.961467695888132, 0.313683822052553, 0.820514548104256, 
        0.307054400444031, 0.185453581158072, 0.0483467767480761, 0.24567414727062, 0.351106922142208, 0.159022381762043, 
        0.304097996791825, 0.0175483247730881, 0.996552679222077, 0.804393312660977, 0.086580601753667, 0.869933269685134, 
        0.554585863370448, 0.421378421830013, 0.0676368190906942, 0.56143795652315, 0.0707218942698091, 0.211391938850284, 
        0.54962041345425, 0.481981448363513, 0.159469854552299, 0.149578995071352, 0.499272880377248, 0.940564878052101, 
        0.334231326589361, 0.188434329582378, 0.269716178299859, 0.530744078103453, 0.021450228523463, 0.7987603074871, 0.11033510020934, 
        0.53979828581214, 0.571233897469938, 0.618951546959579, 0.714853693498299, 0.123300578678027, 0.311049618758261, 
        0.945739162620157, 0.500025092391297, 0.135230499086902, 0.869257820537314, 0.205049612093717, 0.92504589096643, 
        0.886753598228097, 0.136295825242996, 0.785349442157894, 0.453303414164111, 0.135742419399321, 0.885221036849543, 
        0.336713540134951, 0.319274115143344, 0.403782814741135, 0.479077307041734, 0.367901820223778, 0.465690567623824, 
        0.0498921528924257, 0.187356711598113, 0.982659413712099, 0.328274069586769, 0.170996390515938, 0.488254894502461, 
        0.0186874116770923, 0.339485083706677, 0.0296633755788207, 0.867228663060814, 0.731707599712536, 0.315260796807706, 
        0.386454011779279, 0.332445990527049, 0.0897779711522162, 0.757055602502078, 0.6029684972018, 0.145399972563609, 
        0.0325174834579229, 0.483768141595647, 0.444569527870044, 0.060385589953512, 0.327506022062153, 0.878429047297686, 
        0.930604886263609, 0.392178456997499, 0.158846774837002, 0.319947601063177, 0.30696562025696, 0.107811254449189, 
        0.979334303410724, 0.496903428109363, 0.0930746719241142, 0.211773658171296, 0.930500746238977, 0.296846406767145, 
        0.653218248859048, 0.901070477906615, 0.990795793244615, 0.430333221331239, 0.393776922253892, 0.141908895457163, 
        0.279806696344167, 0.56482222257182, 0.935139505425468, 0.358400145079941, 0.842007180908695, 0.722409214358777, 
        0.750735989306122, 0.92398845218122, 0.00237810681574047, 0.160429914947599, 0.399272951297462, 0.675319577334449, 
        0.480372016318142, 0.533828780753538, 0.316950157284737, 0.814757590182126, 0.292219521244988, 0.409132091328502, 
        0.0909183076582849, 0.798596638021991, 0.359785249689594, 0.0404875767417252, 0.0410863398574293, 0.954434238374233, 
        0.373341244878247, 0.806419667555019, 0.91005900898017, 0.440076212864369, 0.57633650302887, 0.0736677951645106, 
        0.164627394406125, 0.73989077587612, 0.475711012724787, 0.68552095326595, 0.951514942804351, 0.497464487561956, 0.470500626601279, 
        0.56019195006229, 0.652510120533407, 0.279573498759419, 0.979907589498907, 0.643864108016714, 0.58257843577303, 0.615871025947854, 
        0.925140294479206, 0.390022895298898, 0.28791968501173, 0.0907359647098929, 0.322033904027194, 0.758270112564787, 
        0.104412929620594, 0.710277852602303, 0.966477383626625, 0.201491226209328, 0.108488654484972, 0.0554021787829697, 
        0.829723515082151, 0.58119775657542, 0.470092375297099, 0.365014120005071, 0.280124627286568, 0.599715854972601, 
        0.818569612922147, 0.0978322804439813, 0.96368952607736, 0.168736443389207, 0.0860834058839828, 0.86121069570072, 
        0.524790602037683, 0.656810875283554, 0.229519372805953, 0.72122603142634, 0.490750394994393, 0.965255592484027, 
        0.906942480476573, 0.551250527845696, 0.075599099509418), .Dim = c(20L, 20L))
    n <- 5L
    expect_equal(Iso:::biviso(y = u, ncycle = 50 * n, fatal = FALSE, warn = FALSE), structure(c(0.458165984798469, 0.458165984798469, 
        0.458165984798469, 0.481538397932277, 0.481538397932277, 0.481538397932277, 0.481538397932277, 0.481538397932277, 
        0.481538397932277, 0.481538397932277, 0.481538397932277, 0.481538397932277, 0.481538397932277, 0.481538397932277, 
        0.481538397932277, 0.481539535680129, 0.481539535680129, 0.481539535680129, 0.481539535680129, 0.481539535680129, 
        0.458165984798469, 0.458165984798469, 0.458165984798469, 0.481539245012307, 0.481539245012307, 0.481539245012307, 
        0.481539245012307, 0.481539245012307, 0.481539245012307, 0.481539245012307, 0.481539245012307, 0.481539245012307, 
        0.481539245012307, 0.481539245012307, 0.481539245012307, 0.481539245012307, 0.481539245012307, 0.481539245012307, 
        0.481539245012307, 0.481539245012307, 0.458165984798469, 0.458165984798469, 0.458165984798469, 0.48153951582479, 
        0.48153951582479, 0.48153951582479, 0.48153951582479, 0.48153951582479, 0.48153951582479, 0.48153951582479, 0.48153951582479, 
        0.48153951582479, 0.48153951582479, 0.48153951582479, 0.48153951582479, 0.48153951582479, 0.48153951582479, 0.48153951582479, 
        0.48153951582479, 0.48153951582479, 0.458165984798469, 0.458165984798469, 0.458165984798469, 0.481539677704386, 0.481539677704386, 
        0.481539677704386, 0.481539677704386, 0.481539677704386, 0.481539677704386, 0.481539677704386, 0.481539677704386, 
        0.481539677704386, 0.481539677704386, 0.481539677704386, 0.481539677704386, 0.481539677704386, 0.481539677704386, 
        0.481539677704386, 0.481539677704386, 0.481539677704386, 0.458165984798469, 0.458165984798469, 0.458165984798469, 
        0.481540318512153, 0.481540318512153, 0.481540318512153, 0.481540318512153, 0.481540318512153, 0.481540318512153, 
        0.481540318512153, 0.481540318512153, 0.481540318512153, 0.481540318512153, 0.481540318512153, 0.481540318512153, 
        0.481540318512153, 0.481540318512153, 0.481540318512153, 0.564082323049661, 0.595657908307788, 0.458165984798469, 
        0.458165984798469, 0.458165984798469, 0.481541101359586, 0.481541101359586, 0.481541101359586, 0.481541101359586, 
        0.481541101359586, 0.481541101359586, 0.481541101359586, 0.481541101359586, 0.481541101359586, 0.481541101359586, 
        0.481541101359586, 0.481541101359586, 0.481541101359586, 0.481541101359586, 0.481541101359586, 0.564082323049661, 
        0.595657908307788, 0.458165984798469, 0.458165984798469, 0.458165984798469, 0.48154134196709, 0.48154134196709, 0.48154134196709, 
        0.48154134196709, 0.48154134196709, 0.48154134196709, 0.48154134196709, 0.48154134196709, 0.48154134196709, 0.48154134196709, 
        0.48154134196709, 0.48154134196709, 0.48154134196709, 0.48154134196709, 0.48154134196709, 0.564082323049661, 0.595657908307788, 
        0.458165984798469, 0.458165984798469, 0.458165984798469, 0.48154134196709, 0.48154134196709, 0.48154134196709, 0.48154134196709, 
        0.48154134196709, 0.48154134196709, 0.48154134196709, 0.48154134196709, 0.48154134196709, 0.48154134196709, 0.48154134196709, 
        0.48154134196709, 0.48154134196709, 0.48154134196709, 0.48154134196709, 0.564082323049661, 0.595657908307788, 0.458165984798469, 
        0.458165984798469, 0.458165984798469, 0.481541217205921, 0.481541217205921, 0.481541217205921, 0.481541217205921, 
        0.481541217205921, 0.481541217205921, 0.481541217205921, 0.481541707806138, 0.481541707806138, 0.481541707806138, 
        0.481541707806138, 0.481544760344304, 0.481544760344304, 0.481544760344304, 0.481544760344304, 0.573466295583133, 
        0.595657908307788, 0.458165984798469, 0.458165984798469, 0.458165984798469, 0.481541831695426, 0.481541831695426, 
        0.481541831695426, 0.481541831695426, 0.481541831695426, 0.481541831695426, 0.481541831695426, 0.481541831695426, 
        0.481541831695426, 0.481541831695426, 0.481541831695426, 0.481544760344304, 0.481544760344304, 0.481544760344304, 
        0.481544760344304, 0.573466295583133, 0.595657908307788, 0.458165984798469, 0.458165984798469, 0.458165984798469, 
        0.481541848154119, 0.481541848154119, 0.481541848154119, 0.481541848154119, 0.481541848154119, 0.481541848154119, 
        0.481541848154119, 0.481541848154119, 0.481541848154119, 0.481541848154119, 0.481541848154119, 0.481541848154119, 
        0.481554941254954, 0.481554941254954, 0.481554941254954, 0.573466295583133, 0.595657908307788, 0.458165984798469, 
        0.458165984798469, 0.458165984798469, 0.481542093051032, 0.481542093051032, 0.481542093051032, 0.481542093051032, 
        0.481542093051032, 0.481542093051032, 0.481542093051032, 0.481542093051032, 0.481542093051032, 0.481542093051032, 
        0.481542093051032, 0.481554941254954, 0.481554941254954, 0.481554941254954, 0.573466197472578, 0.573466197472578, 
        0.595657908307788, 0.458165984798469, 0.458165984798469, 0.458165984798469, 0.481544725988606, 0.481544725988606, 
        0.481544725988606, 0.481544725988606, 0.481544725988606, 0.481544725988606, 0.481544725988606, 0.481544725988606, 
        0.481544725988606, 0.481544725988606, 0.481544725988606, 0.481554941254954, 0.481554941254954, 0.481554941254954, 
        0.573466197472578, 0.573466197472578, 0.595657908307788, 0.458165984798469, 0.458165984798469, 0.458165984798469, 
        0.481547716371474, 0.481547716371474, 0.481547716371474, 0.481547716371474, 0.481547716371474, 0.48155095417042, 
        0.48155095417042, 0.48155095417042, 0.481553625915172, 0.481553625915172, 0.481553625915172, 0.481560656282587, 0.481560656282587, 
        0.481560656282587, 0.573466197472578, 0.573466197472578, 0.595657908307788, 0.458165984798469, 0.458165984798469, 
        0.458165984798469, 0.481547716371474, 0.481547716371474, 0.481547716371474, 0.481547716371474, 0.481547716371474, 
        0.481558601032363, 0.481558601032363, 0.481558601032363, 0.481558601032363, 0.481558601032363, 0.481558601032363, 
        0.481558601032363, 0.481558601032363, 0.573467179450956, 0.573467179450956, 0.573467179450956, 0.595657908307788, 
        0.458165984798469, 0.458165984798469, 0.458165984798469, 0.481557665189919, 0.481557665189919, 0.481557665189919, 
        0.481557665189919, 0.481557665189919, 0.481557665189919, 0.481557665189919, 0.481557665189919, 0.481563927655593, 
        0.481563927655593, 0.481563927655593, 0.481563927655593, 0.573468908633853, 0.573468908633853, 0.573468908633853, 
        0.592338961336323, 0.595657908307788, 0.458165984798469, 0.458165984798469, 0.458165984798469, 0.48155174951505, 
        0.481564397894227, 0.481567264209396, 0.481567264209396, 0.509566441109235, 0.509566441109235, 0.509566441109235, 
        0.509566441109235, 0.509566441109235, 0.509566441109235, 0.509566441109235, 0.573469470925631, 0.573469470925631, 
        0.573469470925631, 0.573469470925631, 0.592338961336323, 0.595657908307788, 0.458165984798469, 0.458165984798469, 
        0.48156670070558, 0.48156670070558, 0.48156670070558, 0.48156670070558, 0.509566441558743, 0.509566441558743, 0.509566441558743, 
        0.509566441558743, 0.509566441558743, 0.509566441558743, 0.509566441558743, 0.509566441558743, 0.592338961334696, 
        0.592338961334696, 0.592338961334696, 0.592338961335919, 0.592338961336323, 0.595657908307788, 0.484763303538121, 
        0.484763303538121, 0.484763303538121, 0.509566441690059, 0.509566441690059, 0.509566441690059, 0.509566441690059, 
        0.509566441690059, 0.509566441690059, 0.509566441690059, 0.509566441690059, 0.509566441690059, 0.509566441690059, 
        0.509566441690059, 0.592338961335825, 0.592338961335825, 0.592338961335825, 0.592338961335825, 0.592338961335825, 
        0.665754243079573, 0.484763303539447, 0.484763303539447, 0.484763303539447, 0.509566441738082, 0.509566441738082, 
        0.509566441738082, 0.509566441738082, 0.509566441738082, 0.509566441738082, 0.509566441738082, 0.568082886456978, 
        0.568082886456978, 0.568082886456978, 0.568082886456978, 0.605988213210367, 0.605988213210367, 0.665754243079573, 
        0.665754243079573, 0.665754243079573, 0.665754243079573), .Dim = c(20L, 20L), icycle = 250L, ifault = 1L))
})

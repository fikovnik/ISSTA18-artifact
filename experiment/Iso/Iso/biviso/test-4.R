library(testthat)

.Random.seed <<- .ext.seed

test_that("biviso", {
    xy <- structure(c(3.87095844714667, 3.43530182860391, 5.86312841133734, 7.63286260496104, 8.904268323141, 9.89387548390852, 
        13.0115219974389, 12.9053409615869, 16.518423713877, 15.9372859009476, 18.8048696542235, 21.2866453927011, 19.1111392988877, 
        21.7212112331826, 23.3666786636063, 25.6359503980701, 26.2157470785839, 25.3435445790952, 27.0595330714245, 32.3201133457302, 
        3.69336140592153, 4.21869156602, 7.82808264424038, 11.2146746991726, 13.895193461265, 13.5695308683938, 15.7427306172311, 
        16.2368369148052, 20.4600973548313, 21.3600051240399, 24.4554501232412, 26.7048373372288, 29.0351035219699, 29.3910736245928, 
        32.504955123298, 32.2829913209267, 35.2155409916205, 37.1490924058235, 37.5857923500534, 42.0361226068923, 5.70599860020025, 
        7.63894270145133, 11.2581632356995, 12.2732951729234, 14.1317189555807, 18.4328180258887, 19.6886068238133, 24.4441012617213, 
        25.0685537973867, 28.6556478834022, 30.8219252652039, 32.2161610591196, 37.075727519792, 38.6428993057173, 40.5897606465996, 
        43.2765507472915, 46.1792888160553, 48.0898328865791, 47.5069099168471, 53.2848829535307, 6.63276535725903, 10.1852305648656, 
        13.5818237273655, 17.3997368272927, 18.2727079405255, 23.3025426320441, 25.3358481197521, 29.0385060986976, 31.9207285682906, 
        34.7208781628669, 35.9568810614321, 39.9098136133893, 43.6235181619995, 45.0464766422277, 48.4571711854261, 52.5809964976817, 
        55.7681787378346, 58.4637675885402, 60.1142237025903, 62.9002191013521, 10.0127070098049, 12.257921437532, 15.5884402291596, 
        18.8791034624609, 21.3056711048395, 26.6119968980404, 29.2828601542535, 32.8172432936681, 37.4333463285712, 40.8217731105082, 
        44.8921163759343, 46.5238260769453, 51.1503485607263, 55.39111045639, 56.3892111205521, 60.1392074131222, 63.3682613191462, 
        66.5407860004976, 71.5799825532412, 75.6532043396492, 11.2009653755985, 15.0447510871677, 16.9967913531602, 23.8484819016727, 
        25.3332265912422, 30.1055138124561, 33.5777441181311, 37.877649828045, 42.1881930345015, 46.119160957997, 49.9749074491326, 
        54.108072727942, 57.5145647641533, 61.4957828693121, 64.3389009200852, 69.6176662731262, 73.4873497421222, 80.7018910003448, 
        80.6378837688103, 86.1372562185586, 10.0063749326837, 14.5295642585632, 20.624702386197, 24.003360865116, 29.4981773856953, 
        33.5717411185742, 37.8863283935505, 40.9753221545809, 46.27525204964, 52.1795164411179, 57.0676205944235, 60.5071226464465, 
        65.5000628840654, 71.12288964338, 75.9398557429762, 77.9028862315942, 83.3826804397498, 89.2014984009197, 92.0302704194337, 
        96.947530515061, 12.9138927017629, 17.1123209820936, 22.5553159951153, 27.9705551209118, 32.5861311509421, 39.1133860233682, 
        42.519007158346, 47.5668309673993, 53.6968625765521, 56.9436315868291, 62.9593015248488, 66.4484551776524, 74.1671695492357, 
        77.7263542986259, 82.5321546753277, 86.7617476720138, 92.9922379662227, 97.1997178220483, 102.46650767005, 109.287675245585, 
        14.3244741297579, 18.9282176158493, 25.6632068824674, 30.6372615843721, 37.0900135479873, 43.432421927731, 46.5073074888905, 
        53.4546502975803, 58.5848980586785, 64.8955655822645, 69.2702218610537, 75.8366190684606, 78.7549441386633, 87.6894589213134, 
        92.3647779785186, 96.8492240111143, 101.050992869861, 108.643008700042, 113.983193863815, 118.993644373579, 16.1514558928624, 
        21.4158910296502, 28.3688067326302, 34.2946543397195, 39.7207406266574, 44.6637633451068, 52.70074881844, 58.554196622274, 
        63.1636934071986, 68.4054118379938, 76.2049585805876, 81.6549120220271, 88.2526117033645, 92.7059975345154, 99.0408295556196, 
        107.08577485368, 112.403774904716, 118.586487536719, 125.815228446154, 130.128821428602), .Dim = c(20L, 10L))
    expect_equal(Iso:::biviso(y = xy), structure(c(3.65313013787529, 3.65313013787529, 5.86312841133734, 7.63286260496104, 
        8.904268323141, 9.89387548390852, 12.9584314795129, 12.9584314795129, 16.2278548074123, 16.2278548074123, 18.8048696542235, 
        20.1988923457944, 20.1988923457944, 21.7212112331826, 23.3666786636063, 25.6359503980701, 25.7796458288396, 25.7796458288396, 
        27.0595330714245, 32.3201133457302, 3.69336140592153, 4.21869156602, 7.82808264424038, 11.2146746991726, 13.7323621648294, 
        13.7323621648294, 15.7427306172311, 16.2368369148052, 20.4600973548313, 21.3600051240399, 24.4554501232412, 26.7048373372288, 
        29.0351035219699, 29.3910736245928, 32.3939732221123, 32.3939732221123, 35.2155409916205, 37.1490924058235, 37.5857923500534, 
        42.0361226068923, 5.70599860020025, 7.63894270145133, 11.2581632356995, 12.2732951729234, 14.1317189555807, 18.4328180258887, 
        19.6886068238133, 24.4441012617213, 25.0685537973867, 28.6556478834022, 30.8219252652039, 32.2161610591196, 37.075727519792, 
        38.6428993057173, 40.5897606465996, 43.2765507472915, 46.1792888160553, 47.7983714017131, 47.7983714017131, 53.2848829535307, 
        6.63276535725903, 10.1852305648656, 13.5818237273655, 17.3997368272927, 18.2727079405255, 23.3025426320441, 25.3358481197521, 
        29.0385060986976, 31.9207285682906, 34.7208781628669, 35.9568810614321, 39.9098136133893, 43.6235181619995, 45.0464766422277, 
        48.4571711854261, 52.5809964976817, 55.7681787378346, 58.4637675885402, 60.1142237025903, 62.9002191013521, 10.0127070098049, 
        12.257921437532, 15.5884402291596, 18.8791034624609, 21.3056711048395, 26.6119968980404, 29.2828601542535, 32.8172432936681, 
        37.4333463285712, 40.8217731105082, 44.8921163759343, 46.5238260769453, 51.1503485607263, 55.39111045639, 56.3892111205521, 
        60.1392074131222, 63.3682613191462, 66.5407860004976, 71.5799825532412, 75.6532043396492, 10.6036701541411, 14.7871576728655, 
        16.9967913531602, 23.8484819016727, 25.3332265912422, 30.1055138124561, 33.5777441181311, 37.877649828045, 42.1881930345015, 
        46.119160957997, 49.9749074491326, 54.108072727942, 57.5145647641533, 61.4957828693121, 64.3389009200852, 69.6176662731262, 
        73.4873497421222, 80.6698873845775, 80.6698873845775, 86.1372562185586, 10.6036701541411, 14.7871576728655, 20.624702386197, 
        24.003360865116, 29.4981773856953, 33.5717411185742, 37.8863283935505, 40.9753221545809, 46.27525204964, 52.1795164411179, 
        57.0676205944235, 60.5071226464465, 65.5000628840654, 71.12288964338, 75.9398557429762, 77.9028862315942, 83.3826804397498, 
        89.2014984009197, 92.0302704194337, 96.947530515061, 12.9138927017629, 17.1123209820936, 22.5553159951153, 27.9705551209118, 
        32.5861311509421, 39.1133860233682, 42.519007158346, 47.5668309673993, 53.6968625765521, 56.9436315868291, 62.9593015248488, 
        66.4484551776524, 74.1671695492357, 77.7263542986259, 82.5321546753277, 86.7617476720138, 92.9922379662227, 97.1997178220483, 
        102.46650767005, 109.287675245585, 14.3244741297579, 18.9282176158493, 25.6632068824674, 30.6372615843721, 37.0900135479873, 
        43.432421927731, 46.5073074888905, 53.4546502975803, 58.5848980586785, 64.8955655822645, 69.2702218610537, 75.8366190684606, 
        78.7549441386633, 87.6894589213134, 92.3647779785186, 96.8492240111143, 101.050992869861, 108.643008700042, 113.983193863815, 
        118.993644373579, 16.1514558928624, 21.4158910296502, 28.3688067326302, 34.2946543397195, 39.7207406266574, 44.6637633451068, 
        52.70074881844, 58.554196622274, 63.1636934071986, 68.4054118379938, 76.2049585805876, 81.6549120220271, 88.2526117033645, 
        92.7059975345154, 99.0408295556196, 107.08577485368, 112.403774904716, 118.586487536719, 125.815228446154, 130.128821428602), 
        .Dim = c(20L, 10L), icycle = 3L, ifault = 0L))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("LHSdesign", {
    x <- list("X1", "X2", "X3", "X4")
    N <- 100
    k <- 4
    distrib.pars <- list(list(0, 2), list(0, 1), list(20, 150), list(2, 0, 1))
    distrib <- list("norm", "norm", "unif", "t.scaled")
    expect_equal(ATmet:::LHSdesign(N = N, k = k, distrib = distrib, distrib.pars = distrib.pars, x = x), list(design.unif = structure(list(X1 = c(0.910227000112645, 
        0.798792659451719, 0.340842775232159, 0.362401496081147, 0.762592226702254, 0.421148325370159, 0.545429128170945, 
        0.706899186051451, 0.244474573300686, 0.884140923994128, 0.876501286714338, 0.173009061515331, 0.0766580763179809, 
        0.216969567514025, 0.712551073450595, 0.813929018569179, 0.571147626775783, 0.653938296411652, 0.749112844537012, 
        0.375964720468037, 0.922329343846068, 0.728958911895752, 0.86083695293637, 0.69845393033931, 0.137591614678968, 0.58136505208211, 
        0.66115362012526, 0.0290280579635873, 0.892301233310718, 0.961544349682517, 0.508086017952301, 0.516494539515115, 
        0.824784688870423, 0.777919468733016, 0.400034677039366, 0.837169320799876, 0.265625401348807, 0.523458497624379, 
        0.446809630165808, 0.419164489551913, 0.287950512361713, 0.102845741298515, 0.145174370030873, 0.189930452820845, 
        0.730172918252647, 0.252458533479366, 0.782082854546607, 0.594507740365807, 0.974339755815454, 0.055387720009312, 
        0.194981565903872, 0.855155511819758, 0.63441774149891, 0.806852282471955, 0.39106309621362, 0.494717139250133, 0.311504840990528, 
        0.477213335733395, 0.0421625967789441, 0.32108096597949, 0.0831398168485612, 0.905203397579025, 0.609648041590117, 
        0.568739928323776, 0.33201800923096, 0.687723993051331, 0.0922003285982646, 0.118385697882622, 0.750827168372925, 
        0.952211261780467, 0.064914524925407, 0.30331920213066, 0.987281097117811, 0.558764346989337, 0.625347910551354, 
        0.847655204785988, 0.537680769644212, 0.993251312663779, 0.673858525371179, 0.0338543858891353, 0.351979919269215, 
        0.293140898328275, 0.64439058027463, 0.469707679636776, 0.203391352659091, 0.279482844248414, 0.38892355152173, 0.00925961389672011, 
        0.943911084968131, 0.935532470478211, 0.129922857941128, 0.0168649553856812, 0.154224393900949, 0.233802676403429, 
        0.459188577600289, 0.486255870922469, 0.436908808504231, 0.16390023997752, 0.616707601337694, 0.223991269050166), 
        X2 = c(0.165132395278197, 0.0910798707301728, 0.573859071757179, 0.957218878886197, 0.94777886260068, 0.414827568973415, 
            0.970723670870066, 0.375141573720612, 0.680838848403655, 0.922269760933705, 0.369213297783863, 0.884656624251511, 
            0.58061940979911, 0.756593196506146, 0.406725681533571, 0.490790505399928, 0.466399842700921, 0.658620260159951, 
            0.699517234489322, 0.569060509572737, 0.905770482090302, 0.634501373411622, 0.590486410746817, 0.0141629360453226, 
            0.283051433025394, 0.831771364114247, 0.898934217866044, 0.482530024694279, 0.823053993280046, 0.672663695686497, 
            0.519332703149412, 0.176903516575694, 0.202665205784142, 0.0364677486033179, 0.535311336689629, 0.259613435762003, 
            0.217592581696808, 0.713198317599017, 0.721375177586451, 0.74277060435852, 0.662056735930964, 0.133488098324742, 
            0.427594447226729, 0.730004050433636, 0.960267354713287, 0.649195250864141, 0.0848061773576774, 0.147148487861268, 
            0.159959922581911, 0.613410399083514, 0.222827642252669, 0.354779507732019, 0.235234076697379, 0.773517920221202, 
            0.622065289181192, 0.315860885020811, 0.106975533668883, 0.184744717071298, 0.392420581190381, 0.00519075873540714, 
            0.321158171424177, 0.546940110286232, 0.0292226125416346, 0.506973448314238, 0.241002293543424, 0.299010740013327, 
            0.707661237383727, 0.992873205875512, 0.0739451755024493, 0.44274119541049, 0.0687860262347385, 0.848241627963725, 
            0.985484208285343, 0.858423488156404, 0.129454572340474, 0.385050445795059, 0.797063770452514, 0.555718762348406, 
            0.527377721548546, 0.432981522826012, 0.916251078990754, 0.878151848998386, 0.786018282857258, 0.459145280232187, 
            0.936734358139802, 0.76573967065895, 0.194103063386865, 0.113774772079196, 0.341825614252593, 0.811480692764744, 
            0.307062105706427, 0.866812181917485, 0.805373200818431, 0.261980005775113, 0.609002287341282, 0.336559505211189, 
            0.0412748386734165, 0.470704256598838, 0.270211963022593, 0.0514581542951055), X3 = c(0.33630726151634, 0.879802786963992, 
            0.541248958271462, 0.891459286906756, 0.654264662996866, 0.289791735839099, 0.814664852460846, 0.135149230156094, 
            0.409301336917561, 0.420996405873448, 0.363626018071081, 0.951427306649275, 0.564309255683329, 0.614073507096618, 
            0.998943934335839, 0.738284230569843, 0.703205662001856, 0.983479114065412, 0.474909189830069, 0.0417300117900595, 
            0.318408770333044, 0.468941425378434, 0.85979815867031, 0.214893425428309, 0.271656782471109, 0.825195604504552, 
            0.515753528811038, 0.671505976002663, 0.435185696121771, 0.293507546167821, 0.0883386333752424, 0.0903204482444562, 
            0.528565107162576, 0.324243346906733, 0.265243071159348, 0.625182665996253, 0.246669713375159, 0.929048983976245, 
            0.761069946868811, 0.848857938772999, 0.940481933229603, 0.507374533254188, 0.126360845279414, 0.752065700250678, 
            0.886078405950684, 0.306722162016667, 0.179865185832605, 0.793165616125334, 0.938058112133294, 0.770520156044513, 
            0.397764450823888, 0.447688522245735, 0.0347691918862984, 0.148396312852856, 0.724866429117974, 0.80223950012587, 
            0.782641079048626, 0.453385869609192, 0.0756490467302501, 0.868521903445944, 0.205750040675048, 0.484999039894901, 
            0.642045927066356, 0.0151259378483519, 0.534725888746325, 0.5733522928413, 0.105607078510802, 0.224707207006868, 
            0.180956614073366, 0.0529905924969353, 0.387487298287451, 0.411326653833967, 0.586085174127948, 0.160462378135417, 
            0.97912029979052, 0.59202548482921, 0.11191624136176, 0.608824915254954, 0.917963193641044, 0.96057471152395, 
            0.711381828405429, 0.553683180969674, 0.354039069362916, 0.250828737083357, 0.156364859452005, 0.0253526905551553, 
            0.900500307474285, 0.662449209946208, 0.371336247846484, 0.00962896824115887, 0.741407783557661, 0.699175108824857, 
            0.194136464630719, 0.687250242263544, 0.497541538644582, 0.633813756175805, 0.232913185185753, 0.0686357293091714, 
            0.835952287607361, 0.348240817284677), X4 = c(0.314187716243323, 0.442649666313082, 0.455815542216878, 0.781528387703001, 
            0.0206004833616316, 0.528115167869255, 0.993399056459311, 0.895455143540166, 0.700164481862448, 0.414829238750972, 
            0.138551349900663, 0.868077189936303, 0.733968550814316, 0.103069202203769, 0.778457361562177, 0.220728918248788, 
            0.071887495261617, 0.32001433898462, 0.534636517153122, 0.887858810767066, 0.76132203776855, 0.142485451805405, 
            0.934841677411459, 0.621832878175192, 0.230328091429546, 0.838111207850743, 0.691465723942965, 0.397685471598525, 
            0.163345996667631, 0.0957845837878995, 0.371270027745049, 0.0892048914986663, 0.712291464777663, 0.0309506826801226, 
            0.262131855546031, 0.431745280222967, 0.822248729232233, 0.471991983801127, 0.680928593957797, 0.0677286464953795, 
            0.210388159311842, 0.332516635812353, 0.402039406853728, 0.206340280906297, 0.505705413527321, 0.0164545043930411, 
            0.819931198477279, 0.598336875606328, 0.554862421674188, 0.354587231131736, 0.003038527618628, 0.951639288556762, 
            0.125246432877611, 0.589219136915635, 0.913238220238127, 0.367340297200717, 0.984264649222605, 0.602405921388418, 
            0.247125680889003, 0.517146319421008, 0.808313719220459, 0.653541603987105, 0.849549029327463, 0.664808165153954, 
            0.643121796480846, 0.118239442463964, 0.174234555377625, 0.637808445333503, 0.341333332359791, 0.563747867725324, 
            0.74955186023144, 0.941246968538035, 0.281229467005469, 0.547070183285978, 0.294559785164893, 0.727171387223061, 
            0.422978998010512, 0.488771033764351, 0.387241614607628, 0.856736929642502, 0.793730785206426, 0.274396441262215, 
            0.909583182809874, 0.0447685961099342, 0.188592781145126, 0.979416944428813, 0.497782692946494, 0.300876359085087, 
            0.672574629134033, 0.159445228788536, 0.0500898262416013, 0.254084212142043, 0.570976446585264, 0.460110090409871, 
            0.879519218150526, 0.960656056352891, 0.756322208908387, 0.613851902070455, 0.92276241161162, 0.191404098826461)), 
        row.names = c(NA, -100L), class = "data.frame"), design.phys = structure(list(X1 = c(2.68430842067402, 1.67463302106435, 
        -0.820328263771746, -0.704094060710019, 1.42933169272592, -0.397913310648894, 0.228242332344446, 1.08869714542921, 
        -1.3839623642313, 2.39188933806634, 2.31534639076598, -1.88468184515909, -2.85583120171871, -1.56493752971335, 1.12170570516295, 
        1.78493665122319, 0.358593378191383, 0.79195017345749, 1.34340122639446, -0.632192531788271, 2.8418310965074, 1.21933473271758, 
        2.16817459608554, 1.03991803576247, -2.18240754014707, 0.410773693920862, 0.831227236993448, -3.79054792342106, 2.47771900564937, 
        3.53779117578239, 0.0405400584289637, 0.0827149320239829, 1.86750870003881, 1.53037110143828, -0.506514693833083, 
        1.96578090051229, -1.25219557696317, 0.11767132080714, -0.267451960694462, -0.408062754541417, -1.1187640542055, 
        -2.53100371697797, -2.11471377304774, -1.7563052202079, 1.22667209313881, -1.33354623354636, 1.55849378872617, 0.478312258905383, 
        3.89758033655237, -3.18943484672983, -1.71936845375218, 2.11760833036336, 0.687153753204387, 1.73271028587515, -0.553098618343971, 
        -0.026485110327489, -0.983178676705915, -0.114297579083128, -3.45224703724346, -0.929356372458518, -2.76851492676792, 
        2.62356693391448, 0.556803654954512, 0.346334047252837, -0.868695267469132, 0.978818428620256, -2.65465326756112, 
        -2.36619052217133, 1.35419005621638, 3.33336578451007, -3.0295527139533, -1.02975563052715, 4.46937701090258, 0.295674259403932, 
        0.639113990755023, 2.05285725261426, 0.189185117194612, 4.94073798825756, 0.901185898485966, -3.65388025820631, -0.759961139208529, 
        -1.08846410815587, 0.740439292276878, -0.15200939920488, -1.65913730891945, -1.16875699997847, -0.564251463977897, 
        -4.71013955555824, 3.17696008840505, 3.0366295952261, -2.25351172810186, -4.24657157886479, -2.03696468597437, -1.45276161755822, 
        -0.204956300264841, -0.0689164809139782, -0.317622418965699, -1.95710766610106, 0.593690132758805, -1.51756546031407), 
        X2 = c(-0.973580664700276, -1.33413462062028, 0.186207737429446, 1.71928636086732, 1.62368864902088, -0.215143887178587, 
            1.89153728834077, -0.318266033058249, 0.47004579004084, 1.42050581072896, -0.333937666978198, 1.19859168875519, 
            0.203478331463337, 0.695385720395132, -0.235975910407826, -0.023086830282401, -0.0843229254964454, 0.408700482464126, 
            0.523012533857827, 0.17398279850769, 1.31515136755452, 0.343799264792149, 0.22879638258034, -2.19274339787689, 
            -0.573800417722208, 0.961188750265088, 1.27550214823396, -0.0438047391855284, 0.927066489893302, 0.447280411379693, 
            0.0484788828421975, -0.927230186164032, -0.832139139827512, -1.79323411548539, 0.0886282871832529, -0.644537618916393, 
            -0.780349535014427, 0.562752594577075, 0.586931601502009, 0.651910685431315, 0.41808287102429, -1.11005298130074, 
            -0.182501860445018, 0.612825241141292, 1.75379703929094, 0.38314871893754, -1.37345045143665, -1.04874178822354, 
            -0.994622613037049, 0.288218874413457, -0.762678284259248, -0.372448411039729, -0.721717544178473, 0.750482500264176, 
            0.310909500744867, -0.479304853235012, -1.24277415930287, -0.897430142795481, -0.273015680025022, -2.5628557372107, 
            -0.464462608541773, 0.117934219209877, -1.89234352681861, 0.0174807329574895, -0.703082099290328, -0.527247855513289, 
            0.546565138173278, 2.45080819622092, -1.44702346750932, -0.144022894617482, -1.48489344599123, 1.02892111761664, 
            2.1830573970428, 1.07326323964825, -1.1289731873788, -0.292242928133155, 0.831179101223589, 0.140123421716263, 
            0.0686797253679254, -0.168788447314759, 1.38028847508411, 1.16579756489317, 0.792681460855823, -0.102587252529218, 
            1.52792450295892, 0.72488813781084, -0.862875128373843, -1.20669521079248, -0.407485790356159, 0.88336588929839, 
            -0.504195202462327, 1.1114478253884, 0.860971757131063, -0.637253074403264, 0.27671959402095, -0.421871230212929, 
            -1.73608007256738, -0.0734996617941984, -0.612172058657019, -1.63087684448889), X3 = c(63.7199439971242, 134.374362305319, 
            90.3623645752901, 135.889707297878, 105.054406189593, 57.6729256590828, 125.90643081991, 37.5693999202922, 73.2091737992829, 
            74.7295327635482, 67.2713823492406, 143.685549864406, 93.3602032388328, 99.8295559225604, 149.862711463659, 115.97694997408, 
            111.416736060241, 147.852284828504, 81.7381946779089, 25.4249015327077, 61.3931401432957, 80.9623852991965, 131.77376062714, 
            47.9361453056801, 55.3153817212442, 127.275428585592, 87.0479587454349, 107.295776880346, 76.5741404958302, 58.1559810018167, 
            31.4840223387815, 31.7416582717793, 88.7134639311349, 62.1516350978753, 54.4815992507152, 101.273746579513, 52.0670627387706, 
            140.776367916912, 118.939093092945, 130.35153204049, 142.262651319848, 85.9586893230444, 36.4269098863238, 117.768541032588, 
            135.190192773589, 59.8738810621668, 43.3824741582386, 123.111530096293, 141.947554577328, 120.167620285787, 71.7093786071055, 
            78.1995078919455, 24.5199949452188, 39.2915206708713, 114.232635785337, 124.291135016363, 121.743340276321, 78.940163049195, 
            29.8343760749325, 132.907847447973, 46.7475052877562, 83.0498751863372, 103.465970518626, 21.9663719202857, 89.5143655370222, 
            94.5357980693691, 33.7289202064043, 49.2119369108928, 43.5243598295376, 26.8887770246016, 70.3733487773687, 73.4724649984157, 
            96.1910726366332, 40.8601091576042, 147.285638972768, 96.9633130277973, 34.5491113770288, 99.1472389831441, 139.335215173336, 
            144.874712498114, 112.479637692706, 91.9788135260576, 66.0250790171791, 52.6077358208364, 40.3274317287607, 23.2958497721702, 
            137.065039971657, 106.118397293007, 68.2737122200429, 21.2517658713507, 116.383011862496, 110.892764147231, 45.2377404019935, 
            109.342531494261, 84.6804000237957, 102.395788302855, 50.2787140741479, 28.9226448101923, 128.673797388957, 65.271306247008), 
        X4 = c(-0.566098740218051, -0.163288930169515, -0.125463354767625, 0.963534579451263, -4.77302755596314, 0.0796477202068666, 
            8.61684799399322, 1.8278433515537, 0.61781783006845, -0.244472232249621, -1.47959047498465, 1.53820700009361, 
            0.748802467742045, -1.84623027923735, 0.948260422611754, -0.952285271918864, -2.34393693806941, -0.545655213019411, 
            0.0982027734206313, 1.7383376089753, 0.866963218483427, -1.44644760451051, 2.49167950209056, 0.35530455684229, 
            -0.905783560504291, 1.29812151933348, 0.58623129447502, -0.295645159240024, -1.28786869538537, -1.94242432860466, 
            -0.376805858215577, -2.03814736626963, 0.663196595804304, -3.83023525797588, -0.764895315450224, -0.194877796657632, 
            1.19206036596831, -0.0793432119320098, 0.54894328525257, -2.43284301324176, -1.00487915779459, -0.502758893363566, 
            -0.282550324315033, -1.02624297834927, 0.0161383970786971, -5.37542380214277, 1.17750740743874, 0.283679228873365, 
            0.156116995911114, -0.429870080901152, -12.769295486773, 2.97731091799949, -1.6011618333312, 0.256465819198092, 
            2.0761523278991, -0.389165779813235, 5.5030518780086, 0.295920803352502, -0.829085926295965, 0.0485256560571222, 
            1.10770051481455, 0.456329879090317, 1.38271087082588, 0.493740593020695, 0.422487778383475, -1.67205105161469, 
            -1.2145754942661, 0.405486629739733, -0.473236795692051, 0.181789762890198, 0.814546836086195, 2.65356541040477, 
            -0.68814233803444, 0.133728480158175, -0.637358268471507, 0.721282307701663, -0.220479872811675, -0.0317683250102097, 
            -0.327361953493686, 1.44003217876889, 1.02662218248493, -0.715026280768655, 2.0198136167774, -3.11319395237825, 
            -1.12580120101344, 4.77517890688983, -0.00627155308189309, -0.61399777293705, 0.520074478335093, -1.31556767601201, 
            -2.91692175558859, -0.798854469501392, 0.202805433363514, -0.113186483050868, 1.64879710080015, 3.35095716201008, 
            0.844383685445564, 0.330709397044157, 2.23950514314936, -1.10933768510844)), row.names = c(NA, -100L), class = "data.frame")))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("predict.smooth.Pspline", {
    xx <- c(4, 4.21212121212121, 4.42424242424242, 4.63636363636364, 4.84848484848485, 5.06060606060606, 5.27272727272727, 
        5.48484848484848, 5.6969696969697, 5.90909090909091, 6.12121212121212, 6.33333333333333, 6.54545454545454, 6.75757575757576, 
        6.96969696969697, 7.18181818181818, 7.39393939393939, 7.60606060606061, 7.81818181818182, 8.03030303030303, 8.24242424242424, 
        8.45454545454546, 8.66666666666667, 8.87878787878788, 9.09090909090909, 9.3030303030303, 9.51515151515152, 9.72727272727273, 
        9.93939393939394, 10.1515151515152, 10.3636363636364, 10.5757575757576, 10.7878787878788, 11, 11.2121212121212, 11.4242424242424, 
        11.6363636363636, 11.8484848484848, 12.0606060606061, 12.2727272727273, 12.4848484848485, 12.6969696969697, 12.9090909090909, 
        13.1212121212121, 13.3333333333333, 13.5454545454545, 13.7575757575758, 13.969696969697, 14.1818181818182, 14.3939393939394, 
        14.6060606060606, 14.8181818181818, 15.030303030303, 15.2424242424242, 15.4545454545455, 15.6666666666667, 15.8787878787879, 
        16.0909090909091, 16.3030303030303, 16.5151515151515, 16.7272727272727, 16.9393939393939, 17.1515151515152, 17.3636363636364, 
        17.5757575757576, 17.7878787878788, 18, 18.2121212121212, 18.4242424242424, 18.6363636363636, 18.8484848484849, 19.0606060606061, 
        19.2727272727273, 19.4848484848485, 19.6969696969697, 19.9090909090909, 20.1212121212121, 20.3333333333333, 20.5454545454545, 
        20.7575757575758, 20.969696969697, 21.1818181818182, 21.3939393939394, 21.6060606060606, 21.8181818181818, 22.030303030303, 
        22.2424242424242, 22.4545454545455, 22.6666666666667, 22.8787878787879, 23.0909090909091, 23.3030303030303, 23.5151515151515, 
        23.7272727272727, 23.9393939393939, 24.1515151515152, 24.3636363636364, 24.5757575757576, 24.7878787878788, 25)
    speed <- c(4, 4, 7, 7, 8, 9, 10, 10, 10, 11, 11, 12, 12, 12, 12, 13, 13, 13, 13, 14, 14, 14, 14, 15, 15, 15, 16, 16, 
        17, 17, 17, 18, 18, 18, 18, 19, 19, 19, 20, 20, 20, 20, 20, 22, 23, 24, 24, 24, 24, 25)
    sm.spline <- pspline::sm.spline
    dist <- c(2, 10, 4, 22, 16, 10, 18, 26, 34, 17, 28, 14, 20, 24, 28, 26, 34, 34, 46, 26, 36, 60, 80, 20, 26, 54, 32, 40, 
        32, 40, 50, 42, 56, 76, 84, 36, 46, 68, 32, 48, 52, 56, 64, 66, 54, 70, 92, 93, 120, 85)
    expect_equal(pspline:::predict.smooth.Pspline(object = sm.spline(speed, dist, df = 5), xarg = xx), structure(c(5.54321404495879, 
        5.97131278012541, 6.39437279046651, 6.81334917273296, 7.22919702367566, 7.64287144004548, 8.05532751859331, 8.46752035607004, 
        8.88040504922655, 9.29493669481373, 9.71207038958246, 10.1327612302836, 10.5579643136681, 10.9886347364868, 11.4257275954906, 
        11.8701979874304, 12.323001009057, 12.7850917571214, 13.2574253283744, 13.740959022573, 14.2377692665693, 14.7528690943368, 
        15.291747389165, 15.8598930343434, 16.462661475106, 17.1009997586978, 17.7705421208869, 18.4666064998275, 19.184510833674, 
        19.9197913824796, 20.6701292006306, 21.4344227054211, 22.2115842867465, 23.0005263345023, 23.8000916979519, 24.6088450638306, 
        25.4252815782418, 26.2478963872888, 27.0751763197857, 27.9048835607254, 28.7335035912092, 29.5573919346948, 30.3729041146398, 
        31.1764490812933, 31.9653331880419, 32.7376074241781, 33.491345318422, 34.2246203994938, 34.9361878432725, 35.6290094722249, 
        36.3076502419507, 36.9766782638237, 37.6406605531204, 38.3036073077461, 38.9680676280552, 39.6363538574095, 40.3107783391711, 
        40.9936039058998, 41.6854576999554, 42.384995600284, 43.0907561268935, 43.8012777997918, 44.514990418648, 45.2292557145215, 
        45.9408291938622, 46.6464594050182, 47.3428948963377, 48.0280341033046, 48.7043750099466, 49.3755654874274, 50.0452534069105, 
        50.7170854072814, 51.3946007651908, 52.0811496025918, 52.7800627870914, 53.4946711862965, 54.2282738685186, 54.9836357732808, 
        55.763078637428, 56.5689107824768, 57.4034405299445, 58.2689762013478, 59.1678261182037, 60.1022986020292, 61.0747019743413, 
        62.087347507378, 63.1440454397106, 64.2525393211743, 65.4212100573681, 66.658438553891, 67.9723501829413, 69.3626282502927, 
        70.8187820466894, 72.3297151540741, 73.8843311543892, 75.4715336295774, 77.0802261615811, 78.6993123323429, 80.3176957238054, 
        81.924279917911), .Dim = c(100L, 1L)))
})

library(testthat)

.Random.seed <<- .ext.seed

test_that("lines.theorLc", {
    sd <- stats::sd
    Lc.lognorm <- ineq::Lc.lognorm
    income.p <- c(78252, 169533, 120286, 91300, 53088, 75829, 72556, 120516, 212132, 29644, 49844, 65053, 47535, 104390, 
        107993, 50531, 40177, 60313, 45687, 244880, 138409, 76247, 101411, 57626, 96889, 37971, 36028, 57391, 87571, 30191, 
        67362, 68930, 28618, 109836, 189281, 58759, 56540, 178426, 140748, 110300, 112460, 125181, 137196, 108858, 89814, 
        130220, 138547, 244354, 196067, 82399, 43366, 104523, 113912, 195607, 137025, 216190, 123109, 300071, 63231, 226425, 
        145700, 294880, 226866, 64665, 257290, 171281, 369106, 54742, 172510, 47068, 39442, 114419, 70133, 22374, 196977, 
        303714, 36221, 50368, 46343, 114766, 77918, 78461, 202086, 116418, 312056, 66106, 241190, 53771, 84529, 32221, 95442, 
        71712, 45850, 49815, 33755, 58403, 212968, 62677, 57244, 50169, 60382, 46451, 163754, 111061, 56582, 167486, 179184, 
        48987, 39271, 69231, 47379, 71572, 36362, 121156, 61321, 91600, 73835, 19781, 129060, 116067, 121780, 172110, 197290, 
        57462, 55295, 150028, 134431, 111501, 167073, 121883, 190837, 131992, 162960, 200274, 121884, 198450, 125175, 55812, 
        51053, 40620, 399506, 235600, 43110, 51467, 215102, 36696, 60892, 142738, 70653, 361900, 74850, 582000, 389000, 25638, 
        46200, 87940, 64860, 639416, 56690, 835742, 38776, 46818, 41275, 100640, 144846, 42925, 118060, 148820, 308807, 169732, 
        72730, 72377, 108686, 127125, 42576, 78018, 50485, 151200, 133040, 89554, 69276, 77691, 76870, 126471, 59624, 86347, 
        140272, 40240, 24561, 83892, 132245, 113629, 59738, 176020, 85416, 148130, 324101, 60382, 172770, 329505, 266825, 
        121574, 60277, 36032, 77729, 167892, 116431, 74748, 36426, 158347, 262608, 205263, 135445, 150798, 282864, 118588, 
        51650, 719016, 79634, 147926, 116355, 41667, 109297, 54197, 357795, 124346, 175276, 166367, 145224, 49081, 101768, 
        140748, 93074, 63984, 71335, 30049, 120341, 187684, 233426, 45435, 274964, 136233, 34115, 180047, 267634, 23776, 
        137668, 47382, 90946, 149879, 57313, 36643, 123276, 70469, 51754, 34866, 126840, 115462, 50628, 96744, 31354, 30979, 
        32586, 64356, 20775, 27419, 77963, 61724, 31053, 32640, 149227, 39012, 48595, 61175, 66212, 255910, 37950, 84530, 
        375800, 78120, 37702, 20908, 151140, 54750, 45230, 38982, 42138, 27795, 72995, 78134, 65053, 27128, 128940, 47337, 
        37697, 69162, 59140, 148033, 37322, 23375, 38199, 23445, 30151, 6067, 264496, 82775, 66642, 98713, 66344, 136834, 
        54694, 79089, 47310, 99777, 109651, 648558, 110600, 35980, 92420, 22710, 138887, 137403, 141090, 64126, 64500, 85820, 
        278927, 66880, 81226, 149140, 54400, 25445, 46228, 48352, 196172, 35629, 90222, 52305, 40038, 124720, 51742, 192734, 
        212345, 225400, 101920, 65400, 73230, 279563, 84237, 45520, 70553, 159242, 131663, 56863, 51617, 89235, 142969, 54283, 
        70504, 133905, 101679, 58312, 33570, 78238, 50466, 67383, 39866, 24670, 29089, 38889, 67828, 39920, 122504, 61653, 
        63844, 49422, 39785, 36362, 65484, 52634, 51458, 64313, 61487)
    expect_equal(ineq:::lines.theorLc(x = Lc.lognorm, parameter = sd(log(income.p)), col = 4), NULL)
})
